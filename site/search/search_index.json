{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u64cd\u4f5c\u7cfb\u7edf\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u4e66\u200b - 2023\u200b\u79cb\u5b63\u200b | \u200b\u54c8\u5de5\u5927\u200b\uff08\u200b\u6df1\u5733\u200b\uff09","text":"<p>\u200b\u58f0\u660e\u200b</p> <p>\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u8d44\u6599\u200b\u4ec5\u9650\u4e8e\u200b\u54c8\u5c14\u6ee8\u5de5\u4e1a\u5927\u5b66\u200b\uff08\u200b\u6df1\u5733\u200b\uff09\u300a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u300b2023\u200b\u5e74\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u4f7f\u7528\u200b\uff0c\u200b\u5982\u200b\u6709\u200b\u5176\u4ed6\u200b\u7528\u9014\u200b\uff0c\u200b\u8bf7\u200b\u8054\u7cfb\u200b\u590f\u6587\u200b\u8001\u5e08\u200b\uff1axiawen@hit.edu.cn\u3002</p> <p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b</p> <p>\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u9075\u5b88\u200b\u5b66\u672f\u200b\u8bda\u4fe1\u200b\uff08What is Academic Integrity)\u3002 \u200b\u4f60\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5728\u200b\u540c\u4e00\u4e2a\u200b\u65f6\u95f4\u6bb5\u200b\u5185\u200b\u9700\u8981\u200b\u5b8c\u6210\u200b\u591a\u9879\u200b\u8bfe\u7a0b\u200b\u4efb\u52a1\u200b\uff0c\u200b\u6216\u8005\u200b\u51c6\u5907\u200b\u8003\u8bd5\u200b\uff0c\u200b\u6216\u8005\u200b\u5176\u4ed6\u200b\u2026\u2026\u200b\u4f46\u662f\u200b\uff0c\u200b\u65e0\u8bba\u200b\u4f60\u200b\u5904\u4e8e\u200b\u4f55\u79cd\u200b\u7a0b\u5ea6\u200b\u7684\u200b\u538b\u529b\u200b\u4e4b\u4e0b\u200b\uff0c\u200b\u6211\u4eec\u200b\u90fd\u200b\u5e0c\u671b\u200b\u4f60\u200b\u80fd\u200b\u505a\u5230\u200b\u7ba1\u7406\u200b\u597d\u200b\u65f6\u95f4\u200b\uff0c\u200b\u4ee5\u200b\u8bda\u5b9e\u200b\u6b63\u76f4\u200b\u7684\u200b\u6001\u5ea6\u200b\u6765\u200b\u5b8c\u6210\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u3002</p>"},{"location":"#0","title":"0. \u200b\u5bfc\u8bfb","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u6587\u6863\u200b\u4e3a\u200b\u54c8\u5c14\u6ee8\u5de5\u4e1a\u5927\u5b66\u200b\uff08\u200b\u6df1\u5733\u200b\uff09\u300a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u300b\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u200b\u6750\u6599\u200b\u3002\u200b\u9875\u9762\u200b\u5de6\u4fa7\u200b\u4e3a\u200b\u6307\u5bfc\u4e66\u200b\u7684\u200b\u5404\u4e2a\u200b\u5c0f\u8282\u200b\u76ee\u5f55\u200b\uff0c\u200b\u9875\u9762\u200b\u5de6\u4e0a\u89d2\u200b\u53ef\u200b\u8be6\u7ec6\u200b\u641c\u7d22\u200b\uff0c\u200b\u9875\u9762\u200b\u4e0b\u200b\u65b9\u53ef\u200b\u5207\u6362\u200b\u4e0a\u4e0b\u200b\u5c0f\u8282\u200b\u3002</p> <p>\u200b\u672c\u5b66\u671f\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u6709\u200b6\u200b\u6b21\u200b\u5b9e\u9a8c\u8bfe\u200b\uff0c5\u200b\u4e2a\u200b\u5b9e\u9a8c\u200b\u9879\u76ee\u200b\u3002\u200b\u524d\u200b4\u200b\u4e2a\u200b\u5b9e\u9a8c\u200b\u9879\u76ee\u200b\u5206\u522b\u200b\u5404\u200b\u5360\u200b4\u200b\u4e2a\u200b\u5b66\u65f6\u200b\uff0c\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u5b9e\u9a8c\u200b\u9879\u76ee\u200b8\u200b\u4e2a\u200b\u5b66\u65f6\u200b\uff0c\u200b\u603b\u5171\u200b24\u200b\u4e2a\u200b\u5b66\u65f6\u200b\u3002\u200b\u5176\u4e2d\u200b\uff0c\u200b\u524d\u200b4\u200b\u4e2a\u200b\u5b9e\u9a8c\u200b\u662f\u4ece\u200b\u5f00\u6e90\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b xv6-oslab23-hitsz \u200b\u7684\u200b\u5b9e\u9a8c\u200b\u8bfe\u7a0b\u200b\u4e2d\u200b\u9009\u53d6\u200b\uff0c\u200b\u5e76\u200b\u6839\u636e\u200b\u6211\u4eec\u200b\u5b66\u6821\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u8981\u6c42\u200b\u8fdb\u884c\u200b\u4fee\u6539\u200b\u3002\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u6765\u81ea\u200b\u6211\u6821\u200b\u5b66\u751f\u200b\u81ea\u4e3b\u200b\u8bbe\u8ba1\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5b9e\u9a8c\u200b\u6848\u4f8b\u200b\uff0c\u200b\u8be5\u200b\u5b9e\u9a8c\u200b\u6848\u4f8b\u200b\u83b7\u5f97\u200b2022\u200b\u5e74\u200b\u5168\u56fd\u200b\u5927\u5b66\u751f\u200b\u8ba1\u7b97\u673a\u7cfb\u7edf\u200b\u80fd\u529b\u200b\u5927\u8d5b\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u5927\u8d5b\u200bOS\u200b\u529f\u80fd\u200b\u6311\u6218\u8d5b\u200b\u9053\u200b\u4e8c\u7b49\u5956\u200b\u3002</p> <p> \u200b\u7531\u4e8e\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u5bf9\u200bXV6\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u53ca\u200b\u8981\u6c42\u200b\u8fdb\u884c\u200b\u4e86\u200b\u4fee\u6539\u200b\uff0c\u200b\u8bf7\u200b\u5927\u5bb6\u200b\u4ece\u200b\u4e0b\u9762\u200b\u7684\u200b\u201c3. \u200b\u83b7\u53d6\u200bXV6\u200b\u5b9e\u9a8c\u200b\u6846\u67b6\u200b\u4ee3\u7801\u200b\u201d\u200b\u4ed3\u5e93\u200b\u4e0b\u8f7d\u200b\u4ee3\u7801\u200b\uff0c\u200b\u52a1\u5fc5\u200b\u5728\u200b\u8fd9\u5957\u200b\u4ee3\u7801\u200b\u4e0a\u200b\u5b8c\u6210\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u4f7f\u7528\u200b\u5176\u4ed6\u200bxv6\u200b\u4ed3\u5e93\u200b\u4ee3\u7801\u200b\u7684\u200b\u540c\u5b66\u200b\u6781\u6709\u200b\u53ef\u80fd\u200b\u901a\u4e0d\u8fc7\u200b\u5b9e\u9a8c\u200b\u8003\u6838\u200b\uff01\uff01\uff01   \u200b\u5728\u200b\u5b9e\u9a8c\u200b\u5f00\u59cb\u200b\u4e4b\u524d\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u52a1\u5fc5\u200b\u5148\u200b\u6309\u200b\u987a\u5e8f\u200b\u9605\u8bfb\u200b\u6307\u5bfc\u4e66\u200b\uff0c\u200b\u638c\u63e1\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7684\u200b\u642d\u5efa\u200b/\u200b\u4f7f\u7528\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u638c\u63e1\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e0b\u200b\u7684\u200b\u4e00\u4e9b\u200b\u57fa\u672c\u200b\u547d\u4ee4\u200b/\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u719f\u7ec3\u200b\u4f7f\u7528\u200bGDB\u200b\u8c03\u8bd5\u200b\u5de5\u5177\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u6709\u200b\u5174\u8da3\u200b\u6709\u200b\u4f59\u529b\u200b\u7684\u200b\u540c\u5b66\u200b\uff0c\u200b\u5efa\u8bae\u200b\u5b8c\u6210\u200bXV6\u200b\u7684\u200b\u6240\u6709\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u82e5\u80fd\u200b\u5b8c\u6210\u200b\u4f1a\u200b\u6709\u200b\u610f\u60f3\u4e0d\u5230\u200b\u7684\u200b\u60ca\u559c\u200b\uff01</p> <p>\u200b\u4e3a\u4e86\u200b\u5e2e\u52a9\u200b\u540c\u5b66\u200b\u4eec\u200b\u7406\u89e3\u200bxv6\u200b\u7684\u200b\u6982\u8c8c\u200b\u3001\u200b\u4ee3\u7801\u200b\u7ed3\u6784\u200b\u4ee5\u53ca\u200b\u8c03\u8bd5\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u6211\u6821\u200bOS\u200b\u8bfe\u9898\u7ec4\u200b\u3001\u200b\u5404\u7ea7\u200b\u5b66\u957f\u200b\u52a9\u6559\u200b\u4eec\u200b\u5408\u529b\u200b\u4e3a\u200b\u5927\u5bb6\u200b\u5f55\u5236\u200b\u7684\u200bXV6\u200b\u8bb2\u89e3\u200b\u89c6\u9891\u200b\u548c\u200b\u8c03\u8bd5\u200b\u89c6\u9891\u200b\uff0c\u200b\u63a8\u8350\u200b\u5927\u5bb6\u200b\u6309\u200b\u9700\u200b\u89c2\u770b\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u540c\u5b66\u200b\u4eec\u200b\u5bf9\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u3001\u200b\u5b9e\u9a8c\u200b\u5b89\u6392\u200b\u3001\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u4e66\u200b\u6216\u8005\u200b\u4ee3\u7801\u200b\u6846\u67b6\u200b\u7b49\u200b\u5404\u200b\u65b9\u9762\u200b\u6709\u200b\u5b9d\u8d35\u200b\u7684\u200b\u610f\u89c1\u200b\u6216\u200b\u5efa\u8bae\u200b\uff0c\u200b\u8bf7\u200b\u5728\u200bpiazza\u200b\u5728\u7ebf\u200b\u4ea4\u6d41\u5e73\u53f0\u200b\uff08access code\uff1acomp3001\uff09\u200b\u63d0\u51fa\u200b\u6765\u200b\u6216\u200b\u79c1\u4fe1\u200b\u8001\u5e08\u200b\u6216\u200b\u52a9\u6559\u200b\u3002</p>"},{"location":"#1","title":"1. \u200b\u8bfe\u7a0b\u200b\u4fe1\u606f","text":"<ul> <li>\u200b\u8bfe\u7a0b\u540d\u79f0\u200b\uff1a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff08\u200b\u5b9e\u9a8c\u200b\uff09</li> <li>\u200b\u5b66\u671f\u200b\uff1a2023\u200b\u79cb\u5b63\u200b</li> <li>\u200b\u7406\u8bba\u8bfe\u200b\u6559\u5e08\u200b\uff1a\u200b\u9648\u658c\u200b\u3001\u200b\u5218\u5ddd\u610f\u200b\u3001\u200b\u9648\u82b3\u6797\u200b\u3001\u200b\u9648\u4fca\u6770\u200b\u3001\u200b\u590f\u6587\u200b\uff08\u200b\u6309\u200b\u4efb\u8bfe\u200b\u73ed\u7ea7\u200b1-8\u200b\u73ed\u200b\u987a\u5e8f\u200b\uff09</li> <li>\u200b\u5b9e\u9a8c\u8bfe\u200b\u6559\u5e08\u200b\uff1a\u200b\u4ec7\u6d01\u5a77\u200b\u3001\u200b\u82cf\u5a77\u200b</li> </ul>"},{"location":"#2","title":"2. \u200b\u5b9e\u9a8c\u200b\u76f8\u5173\u200b\u94fe\u63a5","text":"<ul> <li>\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b \u200b\u4e0b\u8f7d\u200b\u5730\u5740\u200b\uff1ahttps://gitee.com/greenhandzpx/xv6-oslab23-hitsz</li> <li>\u200b\u5b9e\u9a8c\u200b\u5de5\u5177\u200b \u200b\u4e0b\u8f7d\u200b\u5730\u5740\u200b\uff08\u200b\u6821\u5185\u200b\u7f51\u200b\uff09\uff1ahttps://mirrors.osa.moe/misc/</li> <li>\u200b\u5b9e\u9a8c\u200b\u63d0\u4ea4\u200b \u200b\u5730\u5740\u200b\uff08\u200b\u6821\u5185\u200b\u7f51\u200b\uff09\uff1ahttp://10.249.12.98:8000/#/login</li> <li>\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b \uff08\u200b\u6821\u5185\u200b\u7f51\u200b\uff09\uff0c\u200b\u8be6\u89c1\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u4f7f\u7528\u6307\u5357\u200b</li> <li>piazza\u200b\u5728\u7ebf\u200b\u4ea4\u6d41\u5e73\u53f0\u200b\uff08access code\uff1acomp3001\uff09 \u200b\u6b22\u8fce\u200b\u540c\u5b66\u200b\u4eec\u200b\u5728\u200bpiazza\u200b\u4e0a\u200b\u63d0\u95ee\u200b\uff0c\u200b\u63d0\u95ee\u200b\u7684\u200b\u5185\u5bb9\u200b\u7b2c\u4e00\u200b\u65f6\u95f4\u200b\u4f1a\u200b\u7531\u200b\u52a9\u6559\u200b\u6216\u200b\u8001\u5e08\u200b\u56de\u7b54\u200b\uff0c\u200b\u5f53\u7136\u200b\u4e5f\u200b\u6b22\u8fce\u200b\u540c\u5b66\u200b\u4eec\u200b\u6765\u200b\u56de\u7b54\u200b\uff1ahttps://piazza.com/harbin_institute_of_technology_shenzhen/fall2023/comp3001</li> </ul>"},{"location":"#3-xv6","title":"3. \u200b\u83b7\u53d6\u200bXV6\u200b\u5b9e\u9a8c\u200b\u6846\u67b6\u200b\u4ee3\u7801","text":"<p>\u200b\u5728\u200b\u4e0b\u8f7d\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\u524d\u200b\uff0c\u200b\u8bf7\u200b\u5148\u200b\u642d\u5efa\u200b\u597d\u200bxv6\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\uff0c\u200b\u642d\u5efa\u200b\u65b9\u6cd5\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u642d\u5efa\u200b\u4ee5\u53ca\u200b\u73af\u5883\u200b\u914d\u7f6e\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u5df2\u7ecf\u200b\u8fdb\u5165\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\uff0c\u200b\u8bf7\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u7ec8\u7aef\u200b\u4e2d\u200b\u6267\u884c\u200b\uff1a</p> <p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b</p> <p>\u200b\u7b2c\u4e00\u4e2a\u200b\u5b57\u7b26\u200b<code>$</code>\u200b\u4e0d\u200b\u9700\u8981\u200b\u8f93\u5165\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u8f93\u5165\u200b<code>$</code>\u200b\u540e\u200b\u7684\u200b\u5b57\u7b26\u4e32\u200b\u3002</p> <pre><code>$ git clone https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git\n</code></pre> <p>\u200b\u83b7\u53d6\u200b\u6846\u67b6\u200b\u4ee3\u7801\u200b\uff0c\u200b\u5c06\u200b\u514b\u9686\u200bxv6-oslab23-hitsz\u200b\u5230\u200b\u5f53\u524d\u76ee\u5f55\u200b\u3002\u200b\u5982\u9047\u200b\u95ee\u9898\u200b\u8bf7\u200b\u8054\u7cfb\u200b\u8001\u5e08\u200b\u6216\u200b\u52a9\u6559\u200b\u3002</p>"},{"location":"#4","title":"4. \u200b\u89c6\u9891\u200b\u94fe\u63a5","text":""},{"location":"#41-xv6","title":"4.1 xv6\u200b\u8bb2\u89e3\u200b\u89c6\u9891\u200b\u94fe\u63a5","text":"<ol> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e00\u200b\uff09\u200b\u542f\u52a8\u200b\u8fc7\u7a0b\u200b\u3011            </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1mK411S7N9?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e8c\u200b\uff09\u200b\u8fdb\u7a0b\u200b\u7ba1\u7406\u200b\u3011 </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1ge4y1J7Je?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e09\u200b\uff09\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u3011 </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1Te4y1i77z?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> </ol> <p>\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u89c2\u770b\u200bB\u200b\u7ad9\u4e0a\u200b\u7684\u200bMIT 6.S081/Fall 2020\u200b\u8bfe\u7a0b\u200b\u89c6\u9891\u200b\uff0c\u200b\u901a\u8fc7\u200b\u5b66\u4e60\u200b\u8fd9\u95e8\u200b\u8bfe\u7a0b\u200b\u53ef\u4ee5\u200b\u8ba9\u200b\u4f60\u200b\u5bf9\u200bxv6\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u6709\u200b\u4e00\u4e2a\u200b\u5168\u9762\u200b\u7684\u200b\u8ba4\u8bc6\u200b\u3002</p>"},{"location":"#42-xv6","title":"4.2 xv6\u200b\u8c03\u8bd5\u200b\u6f14\u793a\u200b\u89c6\u9891\u200b\u94fe\u63a5","text":"<ol> <li> <p>\u30101. VSCode\u200b\u8c03\u8bd5\u200bxv6\u200b\u5185\u6838\u200b\u4ee3\u7801\u200b\u3011 https://www.bilibili.com/video/BV1ZB4y1E7X5?share_source=copy_web&amp;vd_source=a822dcda3537564ccdd0bb45aa0afe33</p> </li> <li> <p>\u30102. VSCode\u200b\u8c03\u8bd5\u200bxv6\u200b\u7528\u6237\u200b\u4ee3\u7801\u200b\u3011 https://www.bilibili.com/video/BV1i14y1Y7ZZ?share_source=copy_web&amp;vd_source=a822dcda3537564ccdd0bb45aa0afe33</p> </li> <li> <p>\u30103. VSCode\u200b\u8c03\u8bd5\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fc7\u7a0b\u200b\uff08\u200b\u5305\u542b\u200bpagetable\u200b\u548c\u200b\u6c47\u7f16\u200b\uff09\u3011 https://www.bilibili.com/video/BV12P411J7xq?share_source=copy_webvd_source=a822dcda3537564ccdd0bb45aa0afe33</p> </li> <li> <p>\u30104. VSCode\u200b\u8c03\u8bd5\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u2014\u2014\u200b\u4ece\u200b\u5185\u6838\u200b\u5230\u200b\u7528\u6237\u200b\uff0c\u200b\u518d\u200b\u4ece\u200b\u7528\u6237\u200b\u8fd4\u56de\u200b\u5185\u6838\u200b\u3011 https://www.bilibili.com/video/BV1ug411m7ir?share_source=copy_web&amp;vd_source=a822dcda3537564ccdd0bb45aa0afe33vd_source=a822dcda3537564ccdd0bb45aa0afe33</p> </li> </ol>"},{"location":"#_1","title":"\u81f4\u8c22","text":"<p>\u200b\u5728\u200b\u5b9e\u9a8c\u6559\u5b66\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u6709\u5e78\u200b\u9080\u8bf7\u200b\u5230\u200b\u4e86\u200b\u4e00\u4e9b\u200b\u672c\u79d1\u751f\u200b\u52a9\u6559\u200b\u548c\u200b\u7814\u7a76\u751f\u200b\u52a9\u6559\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u540c\u5b66\u200b\u5171\u540c\u5b8c\u6210\u200b\u4e86\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u4e66\u200b\u7684\u200b\u7f16\u5199\u200b\u3001\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\u7684\u200b\u4fee\u6539\u200b\u3001\u200b\u8c03\u8bd5\u200b\u548c\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u7684\u200b\u642d\u5efa\u200b\u3002\u200b\u611f\u8c22\u200b\u8fd9\u4e9b\u200b\u540c\u5b66\u200b\u5bf9\u200b\u5b9e\u9a8c\u200b\u505a\u51fa\u200b\u7684\u200b\u8d21\u732e\u200b\u3002</p> <p>\u200b\u7279\u522b\u611f\u8c22\u200b\u5bf9\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u8d21\u732e\u200b\u7684\u200b\u52a9\u6559\u200b\u540c\u5b66\u200b\uff1a</p> <ul> <li>17\u200b\u7ea7\u200b\uff1a\u200b\u80e1\u535a\u6db5\u200b\u3001\u200b\u65bd\u6768\u200b</li> <li>18\u200b\u7ea7\u200b\uff1a\u200b\u674e\u7a0b\u200b\u6d69\u200b\u3001\u200b\u5bab\u6d69\u8fb0\u200b\u3001\u200b\u6f58\u5ef6\u200b\u9e92\u200b\u3001\u200b\u9ece\u5e9a\u7949\u200b\u3001\u200b\u5218\u5b9a\u200b\u90a6\u200b</li> <li>19\u200b\u7ea7\u200b\uff1a\u200b\u8d75\u9e4f\u5b87\u200b\u3001\u200b\u9648\u4e00\u90b9\u200b\u3001\u200b\u53f6\u200b\u81ea\u7acb\u200b\u3001\u200b\u5f20\u827a\u67ab\u200b</li> <li>20\u200b\u7ea7\u200b\uff1a\u200b\u66fe\u200b\u57f9\u946b\u200b\u3001\u200b\u9648\u4f73\u8c6a\u200b\u3001\u200b\u6ee1\u6d0b\u200b\u3001\u200b\u6768\u5927\u8363\u200b</li> </ul> <p>\u200b\u672a\u6765\u200b\u66f4\u200b\u591a\u200b\u7684\u200b\u53ef\u80fd\u200b\uff0c\u200b\u671f\u5f85\u200b\u7531\u200b\u73b0\u5728\u200b\u7684\u200b\u4f60\u4eec\u200b\u6765\u200b\u4e66\u5199\u200b\uff01</p>"},{"location":"Linux/","title":"Linux\u200b\u5f00\u53d1\u200b\u73af\u5883\u200b\u57fa\u7840\u77e5\u8bc6","text":"\u5b66\u4e60\u200b\u5efa\u8bae\u200b \uff1a\u300a\u200b\u9e1f\u54e5\u200b\u7684\u200bLinux\u200b\u79c1\u623f\u200b\u83dc\u200b\uff08\u200b\u57fa\u7840\u200b\u5b66\u4e60\u200b\u7bc7\u200b\uff09\u300b"},{"location":"Linux/#1-linux","title":"1. \u200b\u5982\u4f55\u200b\u767b\u9646\u200bLinux","text":"<p>Linux\u200b\u767b\u5f55\u200b\u65b9\u5f0f\u200b\u4e3b\u8981\u200b\u6709\u200b\u4e24\u79cd\u200b\uff1a</p> <ul> <li>\u200b\u672c\u5730\u200b\u767b\u5f55\u200b\uff1a\u200b\u53ea\u8981\u200b\u542f\u52a8\u200b\u865a\u62df\u673a\u200b\u5373\u53ef\u200b\uff0c\u200b\u7c7b\u4f3c\u200b\u4e8e\u200b\u6253\u5f00\u200b\u81ea\u5df1\u200b\u7535\u8111\u200b\u76f4\u63a5\u200b\u8fde\u63a5\u200b\u663e\u793a\u5668\u200b\u7684\u200b\u65b9\u5f0f\u200b\uff1b\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b<code>Ctrl + Alt + F[1-6]</code>\u200b\u5728\u200b6\u200b\u4e2a\u200b\u865a\u62df\u200b\u63a7\u5236\u53f0\u200b\u4e4b\u95f4\u200b\u8fdb\u884c\u200b\u5207\u6362\u200b\u3002\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u4e0d\u80fd\u200b\u7528\u200b\u672c\u5730\u200b\u767b\u5f55\u200b\u3002</li> <li>\u200b\u8fdc\u7a0b\u200b\u767b\u5f55\u200b\uff1a\u200b\u5bf9\u4e8e\u200bWindows\u200b\u7528\u6237\u200b\u6765\u8bf4\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200bMobaXterm\u3001Windows Terminal\u3001putty\u200b\u7b49\u200b\u5de5\u5177\u200b\u8fdc\u7a0b\u200b\u767b\u5f55\u200b\u3002</li> </ul>"},{"location":"Linux/#2-shell","title":"2. shell\u200b\u7b80\u4ecb","text":"<p>Shell\u200b\u610f\u601d\u200b\u4e3a\u200b\u547d\u4ee4\u884c\u200b\u754c\u9762\u200b\uff0c\u200b\u662f\u200b\u8fd0\u884c\u200b\u547d\u4ee4\u884c\u200b\u7684\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\uff0c\u200b\u5b83\u200b\u672c\u8eab\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7528\u200bC\u200b\u8bed\u8a00\u200b\u7f16\u5199\u200b\u7684\u200b\u7a0b\u5e8f\u200b\u3002shell\u200b\u662f\u200b\u7528\u6237\u200b\u4f7f\u7528\u200bLinux\u200b\u7684\u200b\u6865\u6881\u200b\uff0c\u200b\u7528\u6237\u200b\u901a\u8fc7\u200bshell\u200b\u6765\u200b\u63a7\u5236\u200bLinux\u200b\u7cfb\u7edf\u200b\uff0cLinux\u200b\u7cfb\u7edf\u200b\u901a\u8fc7\u200bshell\u200b\u5c55\u793a\u200b\u7cfb\u7edf\u200b\u4fe1\u606f\u200b\u3002</p> <p>\u200b\u5e38\u89c1\u200b\u7684\u200bshell\u200b\u6709\u200b\uff1a<code>bash</code>\u3001<code>sh</code>\u3001<code>csh</code>\u3001<code>ksh</code>\u200b\u7b49\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5728\u200b\u521b\u5efa\u200b\u7528\u6237\u200b\u65f6\u200b\u6307\u5b9a\u200b\u7528\u6237\u200b\u7684\u200b\u767b\u5f55\u200bshell\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u8f93\u5165\u200bshell\u200b\u540d\u79f0\u200b\u6253\u5f00\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200bshell\u3002</p> <p>openEuler\u200b\u7528\u6237\u200b\u7684\u200b\u9ed8\u8ba4\u200b\u767b\u5f55\u200bshell\u200b\u662f\u200b<code>bash</code>\u3002</p> <p>\u200b\u7cfb\u7edf\u200b\u63d0\u793a\u7b26\u200b\u9ed8\u8ba4\u200b\u8868\u793a\u200b\u7684\u200b\u662f\u200b\uff1a<code>[\u200b\u5f53\u524d\u200b\u767b\u5f55\u200b\u7528\u6237\u200b@\u200b\u4e3b\u673a\u540d\u200b \u200b\u5f53\u524d\u200b\u6240\u5728\u4f4d\u7f6e\u200b]$</code></p> <p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b</p> <p>root\u200b\u7528\u6237\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u63d0\u793a\u7b26\u200b\u901a\u5e38\u200b\u662f\u200b#\uff0c\u200b\u666e\u901a\u7528\u6237\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u63d0\u793a\u7b26\u200b\u901a\u5e38\u200b\u662f\u200b$\u3002</p> <p>\u200b\u4e0a\u200b\u56fe\u200b<code>[cs@localhost \\~]$</code>\uff0c\u200b\u5176\u4e2d\u200b<code>\\~</code>\u200b\u7b26\u53f7\u200b\u8868\u793a\u200b\u662f\u200b\u4e2a\u4eba\u200b\u76ee\u5f55\u200b\u7684\u200b\u5730\u5740\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u6bcf\u4e2a\u200b\u7528\u6237\u200b\u90fd\u200b\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u4e2a\u4eba\u200b\u76ee\u5f55\u200b\u5730\u5740\u200b\uff0c\u200b\u6240\u4ee5\u200b\u7528\u200b<code>\\~</code>\u200b\u4f5c\u4e3a\u200b\u7edf\u4e00\u200b\u66ff\u4ee3\u200b\u8fd9\u4e2a\u200b\u6839\u636e\u200b\u4e0d\u540c\u200b\u7528\u6237\u200b\u800c\u200b\u4e0d\u540c\u200b\u4f46\u200b\u53c8\u200b\u6709\u200b\u89c4\u5f8b\u200b\u53ef\u5faa\u200b\u7684\u200b\u5730\u5740\u200b\uff0c\u200b\u4ee5\u200b\u786e\u4fdd\u200b\u67d0\u4e9b\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u7684\u200b\u517c\u5bb9\u95ee\u9898\u200b\u3002\u200b\u4f8b\u5982\u200b\uff0c\u200b\u4ee5\u200broot\u200b\u7528\u6237\u200b\u767b\u5f55\u200b\uff0c<code>\\~</code>\u200b\u4ee3\u8868\u200b<code>/root/</code>\uff0c\u200b\u5982\u679c\u200b\u4ee5\u200bcs\u200b\u7528\u6237\u200b\u767b\u5f55\u200b\uff0c<code>\\~</code>\u200b\u4ee3\u8868\u200b<code>/home/cs/</code>\u3002</p>"},{"location":"Linux/#3-linux","title":"3. Linux\u200b\u7528\u6237","text":"<p>root\u200b\u662f\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b\u4e00\u4e2a\u200b\u7279\u6b8a\u200b\u7ba1\u7406\u5458\u200b\uff0c\u200b\u901a\u5e38\u200b\u79f0\u4e3a\u200b\u8d85\u7ea7\u200b\u7ba1\u7406\u5458\u200b\uff0c\u200b\u7c7b\u4f3c\u200b\u4e8e\u200bWindows\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200bAdministrator\u3002root\u200b\u7528\u6237\u200b\u62e5\u6709\u200b\u6700\u9ad8\u200b\u6743\u9650\u200b\uff0c\u200b\u751a\u81f3\u200b\u53ef\u4ee5\u200b\u65e0\u9650\u200b\u7684\u200b\u7834\u574f\u200b\u7cfb\u7edf\u200b\uff01\u200b\u9664\u975e\u200b\u5fc5\u8981\u200b\uff0c\u200b\u8bf7\u52ff\u200b\u4f7f\u7528\u200broot\u200b\u7528\u6237\u200b\uff01</p> <p>\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u547d\u4ee4\u63d0\u793a\u7b26\u200b\u6e05\u695a\u200b\u4e86\u89e3\u200b\u5f53\u524d\u200b\u662f\u200broot\u200b\u7528\u6237\u200b\uff08<code>#</code>\uff09\u200b\u8fd8\u662f\u200b\u666e\u901a\u7528\u6237\u200b\uff08<code>$</code>\uff09\u3002</p> <p>\u200b\u5e38\u7528\u200b\u7684\u200b\u7ba1\u7406\u200b\u7528\u6237\u200b\u7684\u200b\u547d\u4ee4\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li><code>useradd name</code>\uff1a\u200b\u589e\u52a0\u200b\u7528\u6237\u200b\uff0c\u200b\u9700\u8981\u200b\u5728\u200broot\u200b\u6743\u9650\u200b\u4e0b\u200b\uff0c\u200b\u901a\u8fc7\u200buseradd\u200b\u547d\u4ee4\u200b\u53ef\u4ee5\u200b\u4e3a\u200b\u7cfb\u7edf\u200b\u6dfb\u52a0\u200b\u65b0\u200b\u7528\u6237\u200b\u4fe1\u606f\u200b</li> <li><code>su - username</code>\uff1a\u200b\u5207\u6362\u200b\u7528\u6237\u200b</li> <li><code>sudo</code>\uff1a\u200b\u5141\u8bb8\u200b\u666e\u901a\u7528\u6237\u200b\u6267\u884c\u200b\u7ba1\u7406\u5458\u200b\u8d26\u53f7\u200b\u624d\u80fd\u200b\u6267\u884c\u200b\u7684\u200b\u547d\u4ee4\u200b</li> <li><code>id</code> \u200b\u67e5\u770b\u200b\u5f53\u524d\u200b\u7528\u6237\u540d\u200b</li> </ul> <p>\u200b\u5982\u679c\u200b\u8be5\u200b\u7528\u6237\u200b\u5728\u200broot\u200b\u4e0b\u200b\u6ca1\u6709\u200b\u6743\u9650\u200b\uff08\u200b\u4e00\u822c\u6765\u8bf4\u200b\uff0c\u200b\u7cfb\u7edf\u200b\u5f53\u7136\u200b\u4e0d\u4f1a\u200b\u5141\u8bb8\u200b\u4efb\u4f55\u200b\u7528\u6237\u200b\u90fd\u200b\u80fd\u591f\u200b\u4ee5\u200b\u8d85\u7ea7\u200b\u7528\u6237\u200b\u7684\u200b\u8eab\u4efd\u200b\u8fd0\u884c\u200b\u547d\u4ee4\u200b\uff09\uff0c\u200b\u9700\u8981\u200b\u5728\u200broot\u200b\u4e0b\u200b\u7ed9\u200b\u8be5\u200b\u7528\u6237\u200b\u6dfb\u52a0\u200b\u6743\u9650\u200b\u3002</p> <p>\u200b\u4e0b\u9762\u200b\u4ee5\u200bopenEuler\u200b\u7cfb\u7edf\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u4ecb\u7ecd\u200b\u5982\u4f55\u200b\u6dfb\u52a0\u200b\u7528\u6237\u200b\u6743\u9650\u200b\u3002\u200b\u4f7f\u7528\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u4ee5\u200b\u5ffd\u7565\u200b\u8fd9\u4e00\u200b\u5c0f\u8282\u200b\u3002</p> <p>\u200b\u5230\u200bopenEuler\u200b\u865a\u62df\u673a\u200b\u91cc\u200b\uff0c\u200b\u8f93\u5165\u200b</p> <pre><code># visudo\n</code></pre> <p>\u200b\u8fdb\u5165\u200bvi\u200b\u7f16\u8f91\u5668\u200b\uff0c\u200b\u8f93\u5165\u200b<code>/Allow root</code>\uff0c\u200b\u5b9a\u4f4d\u200b\u5230\u200b<code>## Allow root to run any commands anywhere</code>\uff0c\u200b\u63a5\u7740\u200b\u6309\u4e0b\u200b<code>i</code>\u200b\u952e\u200b\uff0c\u200b\u8fdb\u884c\u200b\u7f16\u8f91\u200b\u6a21\u5f0f\u200b\uff08\u200b\u6700\u200b\u4e0b\u9762\u200b\u4e00\u884c\u200b\u663e\u793a\u200b<code>-- INSERT --</code>\uff09\uff0c\u200b\u589e\u52a0\u200b\uff1a</p> <pre><code>cs  ALL=(ALL)   ALL\n</code></pre> <p>\u200b\u6388\u6743\u200bcs\u200b\u7528\u6237\u200b\u5728\u200b\u4efb\u4f55\u200b\u4e3b\u673a\u200b\u4e0a\u200b\u6267\u884c\u200b\u4efb\u4f55\u200b\u547d\u4ee4\u200b\u3002\u200b\u7b2c\u4e00\u4e2a\u200bALL\u200b\u8868\u793a\u200b\u6240\u6709\u200b\u8ba1\u7b97\u673a\u200b\uff1b\u200b\u7b2c\u4e8c\u4e2a\u200bALL\u200b\u8868\u793a\u200b\u6240\u6709\u200b\u7528\u6237\u200b\uff0c\u200b\u7b2c\u4e09\u4e2a\u200bALL\u200b\u8868\u793a\u200b\u6240\u6709\u200b\u547d\u4ee4\u200b\u3002</p> <p>\u200b\u7f16\u8f91\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u6309\u200b<code>Esc</code>\u200b\u952e\u200b\u9000\u51fa\u200b\u7f16\u8f91\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u518d\u200b\u8f93\u5165\u200b<code>:wq</code>\uff0c\u200b\u56de\u8f66\u200b\uff0c\u200b\u4fdd\u5b58\u200b\u5e76\u200b\u9000\u51fa\u200b\u3002\uff08\u200b\u8f93\u5165\u200b<code>:q!</code>\u200b\u662f\u200b\u4e0d\u200b\u4fdd\u5b58\u200b\u5e76\u200b\u9000\u51fa\u200b\uff09</p> <p>\u200b\u518d\u200b\u5230\u200bcs\u200b\u7528\u6237\u200b\u4e0b\u200b\uff0c\u200b\u6267\u884c\u200bsudo\u200b\u547d\u4ee4\u200b\uff0c\u200b\u8fd9\u65f6\u200b\u5c31\u200b\u80fd\u591f\u200b\u6267\u884c\u200bsudo\u200b\u547d\u4ee4\u200b\u4e86\u200b\u3002</p>"},{"location":"Linux/#4","title":"4. \u200b\u4fee\u6539\u200b\u5bc6\u7801","text":"<p>\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b<code>passwd</code>\u200b\u4fee\u6539\u200b\u81ea\u5df1\u200b\u7684\u200b\u5bc6\u7801\u200b\u3002</p> <p>openEuler\u200b\u7cfb\u7edf\u200b\u4fee\u6539\u200b\u7528\u6237\u200b\u5bc6\u7801\u200b\u65f6\u200b\u9700\u8981\u200b\u6ee1\u8db3\u200b\u5bc6\u7801\u200b\u590d\u6742\u5ea6\u200b\u8981\u6c42\u200b\uff0c\u200b\u5bc6\u7801\u200b\u7684\u200b\u590d\u6742\u5ea6\u200b\u8981\u6c42\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li> <p>\u200b\u53e3\u4ee4\u200b\u957f\u5ea6\u200b\u81f3\u5c11\u200b8\u200b\u4e2a\u5b57\u7b26\u200b\u3002</p> </li> <li> <p>\u200b\u53e3\u4ee4\u200b\u81f3\u5c11\u200b\u5305\u542b\u200b\u5927\u5199\u5b57\u6bcd\u200b\u3001\u200b\u5c0f\u5199\u5b57\u6bcd\u200b\u3001\u200b\u6570\u5b57\u200b\u548c\u200b\u7279\u6b8a\u5b57\u7b26\u200b\u7684\u200b\u4efb\u610f\u200b3\u200b\u79cd\u200b\u3002</p> </li> <li> <p>\u200b\u53e3\u4ee4\u200b\u4e0d\u80fd\u200b\u548c\u200b\u8d26\u53f7\u200b\u4e00\u6837\u200b\u3002</p> </li> <li> <p>\u200b\u53e3\u4ee4\u200b\u4e0d\u80fd\u200b\u4f7f\u7528\u200b\u5b57\u5178\u200b\u8bcd\u6c47\u200b\u3002</p> </li> </ul>"},{"location":"Linux/#5","title":"5. \u200b\u67e5\u770b\u200b\u7cfb\u7edf\u200b\u4fe1\u606f","text":"<ul> <li>\u200b\u67e5\u770b\u200b\u7cfb\u7edf\u200b\u4fe1\u606f\u200b\uff1a<code>cat /etc/os-release</code></li> <li>\u200b\u67e5\u770b\u200b CPU \u200b\u4fe1\u606f\u200b\uff1a<code>lscpu</code></li> <li>\u200b\u67e5\u770b\u200b\u5185\u5b58\u200b\u4fe1\u606f\u200b\uff1a<code>free</code></li> <li>\u200b\u67e5\u770b\u200b\u78c1\u76d8\u200b\u4fe1\u606f\u200b\uff1a<code>fdisk -l</code></li> <li>\u200b\u67e5\u770b\u200b\u7cfb\u7edf\u8d44\u6e90\u200b\u5b9e\u65f6\u200b\u4fe1\u606f\u200b\uff1a<code>top</code></li> <li>\u200b\u663e\u793a\u200b\u5f53\u524d\u200b\u7684\u200b\u65e5\u671f\u200b\u548c\u200b\u672c\u5730\u200b\u65f6\u95f4\u200b\uff1a<code>date</code></li> <li>\u200b\u663e\u793a\u200b\u5f53\u524d\u200b\u7684\u200b\u65e5\u671f\u200b\u548c\u200b UTC \u200b\u65f6\u95f4\u200b\uff1a<code>date --utc/--u</code></li> </ul>"},{"location":"Linux/#6-bash-shell","title":"6. bash shell\u200b\u5feb\u6377\u200b\u7684\u200b\u64cd\u4f5c","text":"<ul> <li><code>tab</code></li> </ul> <p>\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b<code>tab</code>\u200b\u952e\u200b\u8865\u5168\u200b\u529f\u80fd\u200b\uff0c\u200b\u5feb\u901f\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\u6216\u200b\u53c2\u6570\u200b</p> <ul> <li><code>history</code></li> </ul> <p><code>history</code>\u200b\u5de5\u5177\u200b\u8bb0\u5f55\u200b\u4e86\u200b\u5386\u53f2\u200b\u547d\u4ee4\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200bhistory\u200b\u67e5\u770b\u200b\u5386\u53f2\u200b\u547d\u4ee4\u200b\u3002</p> <ul> <li>\u200b\u4e0a\u4e0b\u200b\u952e\u200b</li> </ul> <p>\u200b\u53ef\u4ee5\u200b\u6309\u200b\u4e0a\u4e0b\u200b\u952e\u200b\u5feb\u901f\u200b\u7ffb\u9605\u200b\u5386\u53f2\u200b\u547d\u4ee4\u200b</p> <ul> <li><code>home</code>\u200b\u4e0e\u200b<code>end</code></li> </ul> <p>\u200b\u5f53\u200b\u60f3\u8981\u200b\u5c06\u200b\u5149\u6807\u200b\u5feb\u901f\u200b\u79fb\u52a8\u200b\u5230\u200b\u5f53\u524d\u200b\u884c\u9996\u200b\u6216\u200b\u884c\u5c3e\u200b\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u6309\u200bhome\u200b\u6216\u200bend\u200b\u952e\u200b\u3002</p> <ul> <li><code>clear</code>\u200b\u4e0e\u200b<code>Ctrl + L</code></li> </ul> <p>\u200b\u5f53\u200b\u9875\u9762\u200b\u88ab\u200b\u5b57\u7b26\u200b\u5145\u6ee1\u200b\uff0c\u200b\u60f3\u200b\u5feb\u901f\u200b\u6e05\u5c4f\u200b\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8f93\u5165\u200bclear\u200b\u6216\u8005\u200b\u6309\u4e0b\u200bCtrl + L\u200b\u7ec4\u5408\u952e\u200b\u5feb\u901f\u200b\u6e05\u5c4f\u200b\u3002</p> <ul> <li><code>Ctrl + C</code> \u200b\u7ec8\u6b62\u200b\u5f53\u524d\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u6267\u884c\u200b</li> <li><code>Ctrl + Z</code> \u200b\u6302\u200b\u8d77\u200b\u5f53\u524d\u200b\u7a0b\u5e8f\u200b</li> <li><code>Ctrl + D</code> \u200b\u7ec8\u6b62\u200b\u8f93\u5165\u200b\uff08\u200b\u82e5\u200b\u6b63\u5728\u200b\u4f7f\u7528\u200b Shell\uff0c\u200b\u5219\u200b\u9000\u51fa\u200b\u5f53\u524d\u200b Shell\uff09</li> </ul>"},{"location":"Linux/#7","title":"7. \u200b\u57fa\u7840\u200b\u547d\u4ee4","text":""},{"location":"Linux/#71-ls","title":"7.1 <code>ls</code> \u200b\u663e\u793a\u200b\u5185\u5bb9","text":"<p>Linux <code>ls</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1alist files\uff09\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u663e\u793a\u200b\u6307\u5b9a\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u4e4b\u200b\u5185\u5bb9\u200b\uff08\u200b\u5217\u51fa\u200b\u76ee\u524d\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u6240\u542b\u200b\u4e4b\u200b\u6587\u4ef6\u200b\u53ca\u200b\u5b50\u76ee\u5f55\u200b)\u3002</p> <pre><code> ls [-alrtAFR] [name...]\n</code></pre> <ul> <li><code>-a</code> <code>--all</code>\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u663e\u793a\u200b\u6240\u6709\u200b\u6587\u4ef6\u200b\u53ca\u200b\u76ee\u5f55\u200b\uff0c\u200b\u5305\u62ec\u200b\u9690\u85cf\u200b\u6587\u4ef6\u200b(\u200b\u4ee5\u200b<code>.</code>\u200b\u5f00\u5934\u200b\u7684\u200b\u6587\u4ef6\u200b)</li> <li><code>-l</code> \u200b\u9664\u200b\u6587\u4ef6\u540d\u79f0\u200b\u5916\u200b\uff0c\u200b\u4ea6\u200b\u5c06\u200b\u6587\u4ef6\u200b\u578b\u6001\u200b\u3001\u200b\u6743\u9650\u200b\u3001\u200b\u62e5\u6709\u8005\u200b\u3001\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u7b49\u200b\u8d44\u8baf\u200b\u8be6\u7ec6\u200b\u5217\u51fa\u200b</li> <li><code>-r</code> \u200b\u5c06\u200b\u6587\u4ef6\u200b\u4ee5\u200b\u76f8\u53cd\u200b\u6b21\u5e8f\u200b\u663e\u793a\u200b(\u200b\u539f\u5b9a\u200b\u4f9d\u200b\u82f1\u6587\u5b57\u6bcd\u200b\u6b21\u5e8f\u200b)</li> <li><code>-t</code> \u200b\u5c06\u200b\u6587\u4ef6\u200b\u4f9d\u200b\u5efa\u7acb\u200b\u65f6\u95f4\u200b\u4e4b\u200b\u5148\u540e\u200b\u6b21\u5e8f\u200b\u5217\u51fa\u200b</li> <li><code>-A</code> <code>--almost-all</code>\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u663e\u793a\u200b\u6240\u6709\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5305\u62ec\u200b\u9690\u85cf\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4f46\u200b\u4e0d\u200b\u5305\u62ec\u200b\u8868\u793a\u200b\u5f53\u524d\u76ee\u5f55\u200b<code>.</code> \u200b\u548c\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b<code>..</code> \u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u6587\u4ef6\u200b\u3002</li> <li><code>-F</code> \u200b\u5728\u200b\u5217\u51fa\u200b\u7684\u200b\u6587\u4ef6\u540d\u79f0\u200b\u540e\u52a0\u200b\u4e00\u200b\u7b26\u53f7\u200b\uff1b\u200b\u4f8b\u5982\u200b\u53ef\u200b\u6267\u884c\u200b\u6863\u5219\u52a0\u200b<code>*</code>, \u200b\u76ee\u5f55\u200b\u5219\u200b\u52a0\u200b<code>/</code></li> <li><code>-R</code> \u200b\u82e5\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u6709\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5219\u200b\u4ee5\u4e0b\u200b\u4e4b\u200b\u6587\u4ef6\u200b\u4ea6\u200b\u7686\u200b\u4f9d\u200b\u5e8f\u5217\u200b\u51fa\u200b</li> </ul> <p>\u200b\u793a\u4f8b\u200b\uff1a</p> <p>\u200b\u5047\u8bbe\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u6709\u200b\u6587\u4ef6\u200b<code>foo</code>, <code>bar</code>, <code>foobar</code>, <code>.foo</code>, <code>.bar</code>\u200b\u548c\u200b\u5b50\u76ee\u5f55\u200b<code>baz</code>, <code>.foobar</code>\uff0c\u200b\u90a3\u4e48\u200b\u8f93\u5165\u200b</p> <pre><code>$ ls\n</code></pre> <p>\u200b\u5219\u200b\u7ed3\u679c\u200b\u662f\u200b</p> <pre><code>bar  baz  foo  foobar\n</code></pre> <p>\u200b\u4ee5\u200b\u201c.\u201d\u200b\u5f00\u5934\u200b\u7684\u200b\u6587\u4ef6\u200b\u662f\u200b\u9690\u85cf\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4e0d\u200b\u5728\u200b\u8fd9\u91cc\u200b\u663e\u793a\u200b\u3002\u200b\u82e5\u200b\u8981\u200b\u663e\u793a\u200b\u9690\u85cf\u200b\u9879\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u52a0\u4e0a\u200b<code>-a</code>\u200b\u6216\u200b<code>-A</code>\u200b\u53c2\u6570\u200b\u3002\u200b\u8fd9\u200b\u4e24\u8005\u200b\u7684\u200b\u533a\u522b\u200b\u662f\u200b\uff0c\u200b\u524d\u8005\u200b\u4f1a\u200b\u663e\u793a\u200b<code>.</code>\u200b\u548c\u200b<code>..</code>\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u7279\u6b8a\u200b\u7684\u200b\u76ee\u5f55\u200b\uff0c\u200b\u540e\u8005\u200b\u5219\u200b\u4e0d\u200b\u663e\u793a\u200b\u3002\u200b\u4e0b\u9762\u200b\u7ed9\u51fa\u200b\u4e00\u6bb5\u200b<code>bash</code>\u200b\u8f93\u5165\u8f93\u51fa\u200b\u793a\u4f8b\u200b</p> <pre><code>$ ls -a\n.  ..  .bar  bar  baz  .foo  foo  .foobar  foobar\n$ ls -A\n.bar  bar  baz  .foo  foo  .foobar  foobar\n</code></pre> <p>\u200b\u6709\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u663e\u793a\u6587\u4ef6\u200b\u548c\u200b\u76ee\u5f55\u200b\u7684\u200b\u8be6\u7ec6\u4fe1\u606f\u200b\uff0c\u200b\u5982\u200b\u8bbf\u95ee\u200b\u6743\u9650\u200b\u3001\u200b\u6240\u6709\u8005\u200b\u3001\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u3001\u200b\u4fee\u6539\u200b\u65f6\u95f4\u200b\u7b49\u200b\uff0c\u200b\u8fd9\u65f6\u200b\u9700\u8981\u200b\u7528\u5230\u200b<code>-l</code>\u200b\u53c2\u6570\u200b</p> <pre><code>$ ls -l\ntotal 4\n-rw-rw-r-- 1 camel camel    0 Sep 16 23:31 bar\ndrwxrwxr-x 2 camel camel 4096 Sep 16 23:32 baz\n-rw-rw-r-- 1 camel camel    0 Sep 16 23:31 foo\n-rw-rw-r-- 1 camel camel    0 Sep 16 23:31 foobar\n</code></pre> <p>\u200b\u540c\u200b\u524d\u9762\u200b\u4e00\u6837\u200b\uff0c<code>ls</code>\u200b\u9ed8\u8ba4\u200b\u4e0d\u200b\u663e\u793a\u200b\u9690\u85cf\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u3002\u200b\u5982\u679c\u200b\u9700\u8981\u200b\u540c\u65f6\u200b\u663e\u793a\u200b\u9690\u85cf\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u7684\u200b\u8be6\u7ec6\u4fe1\u606f\u200b\uff0c\u200b\u5e94\u8be5\u200b\u518d\u200b\u52a0\u4e0a\u200b<code>-a</code>\u200b\u6216\u200b<code>-A</code>\u200b\u53c2\u6570\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8f93\u5165\u200b<code>ls -la</code>, <code>ls -lA</code>, <code>ls -l -a</code>, <code>ls -l -A</code>\u200b\u7b49\u200b\u3002\u200b\u53c2\u6570\u200b\u7684\u200b\u987a\u5e8f\u200b\u5728\u200b\u8fd9\u91cc\u200b\u4e0d\u200b\u91cd\u8981\u200b\u3002</p>"},{"location":"Linux/#72-mkdir","title":"7.2 <code>mkdir</code> \u200b\u5efa\u7acb\u200b\u6587\u4ef6\u5939","text":"<p>Linux <code>mkdir</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1amake directory\uff09\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u3002</p> <p>\u200b\u9ed8\u8ba4\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u4f7f\u7528\u200b<code>mkdir</code>\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u9700\u8981\u200b\u4e00\u5c42\u200b\u4e00\u5c42\u200b\u5efa\u7acb\u200b\u3002\u200b\u5047\u5982\u200b\u8981\u200b\u521b\u5efa\u200b<code>/home/cs/work/test</code>\uff0c\u200b\u5fc5\u987b\u200b\u8981\u200b\u6709\u200b<code>/home/cs/work</code>\u200b\u76ee\u5f55\u200b\uff0c\u200b\u624d\u80fd\u200b\u5728\u200bwork\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u521b\u5efa\u200btest\u200b\u5b50\u76ee\u5f55\u200b\u3002</p> <p><code>-p</code>\u200b\u9009\u9879\u200b\uff1a\u200b\u7cfb\u7edf\u200b\u4f1a\u200b\u81ea\u52a8\u200b\u4f9d\u5e8f\u200b\u5efa\u7acb\u200b/home\u3001/home/cs\u3001/home/cs/work\u3001/home/cs/work/test\uff0c\u200b\u5982\u679c\u200b\u8be5\u200b\u76ee\u5f55\u200b\u672c\u6765\u200b\u5df2\u200b\u5b58\u5728\u200b\uff0c\u200b\u7cfb\u7edf\u200b\u4e5f\u200b\u4e0d\u4f1a\u200b\u663e\u793a\u200b\u9519\u8bef\u4fe1\u606f\u200b\u3002\u200b\u5efa\u8bae\u200b\u5e38\u7528\u200b-p\u200b\u9009\u9879\u200b \u3002</p> <pre><code>$ mkdir [-p] dirName\n</code></pre> <p>\u200b\u793a\u4f8b\u200b\uff1a\u200b\u5728\u200b\u4e00\u4e2a\u200b\u4e0d\u200b\u5305\u542b\u200b\u4efb\u4f55\u200b\u6587\u4ef6\u200b\u548c\u200b\u5b50\u76ee\u5f55\u200b\u7684\u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b<code>foo</code>\u200b\u548c\u200b<code>foo/bar/foobar</code>\u3002</p> <pre><code>$ ls\n$ mkdir foo\n$ ls\nfoo\n$ mkdir foo/bar/foobar\nmkdir: cannot create directory 'foo/bar/foobar': No such file or directory\n$ mkdir -p foo/bar/foobar\n$ ls -R\n.:\nfoo\n\n./foo:\nbar\n\n./foo/bar:\nfoobar\n\n./foo/bar/foobar:\n</code></pre> <p>\u200b\u5728\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u5148\u200b\u521b\u5efa\u200b\u4e86\u200b\u76ee\u5f55\u200b<code>foo</code>\uff0c\u200b\u518d\u200b\u5c1d\u8bd5\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b<code>foo/bar/foobar</code>\uff0c\u200b\u4f46\u662f\u200b\u540e\u9762\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u65e0\u6cd5\u200b\u76f4\u63a5\u200b\u521b\u5efa\u200b\uff0c\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b<code>mkdir</code>\u200b\u9ed8\u8ba4\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u53ea\u80fd\u200b\u5728\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b\uff08\u200b\u8fd9\u91cc\u200b\u662f\u200b<code>foo/bar</code>\uff09\u200b\u5df2\u200b\u5b58\u5728\u200b\u7684\u200b\u65f6\u5019\u200b\u521b\u5efa\u200b\u6307\u5b9a\u200b\u76ee\u5f55\u200b\u3002\u200b\u5982\u679c\u200b\u5e0c\u671b\u200b\u80fd\u200b\u9010\u7ea7\u200b\u5c06\u200b<code>foo</code>\u3001<code>foo/bar</code>\u200b\u548c\u200b<code>foo/bar/foobar</code>\u200b\u4f9d\u6b21\u200b\u521b\u5efa\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u52a0\u4e0a\u200b<code>-p</code>\u200b\u53c2\u6570\u200b\uff0c\u200b\u5373\u200b\u8fd0\u884c\u200b<code>mkdir -p foo/bar/foobar</code>\u3002\u200b\u540e\u9762\u200b\u4f7f\u7528\u200b<code>ls -R</code>\u200b\u547d\u4ee4\u200b\u4f9d\u6b21\u200b\u5217\u51fa\u200b\u5f53\u524d\u76ee\u5f55\u200b\u53ca\u5176\u200b\u6240\u6709\u200b\u5b50\u76ee\u5f55\u200b\u4e0b\u9762\u200b\u5305\u542b\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8bf4\u660e\u200b\u524d\u9762\u200b\u547d\u4ee4\u200b\u6210\u529f\u200b\u6267\u884c\u200b\u3002</p>"},{"location":"Linux/#73-rmdir","title":"7.3 <code>rmdir</code> \u200b\u5220\u9664\u200b\u6587\u4ef6\u5939","text":"<p>Linux <code>rmdir</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1aremove directory\uff09\u200b\u547d\u4ee4\u200b\u5220\u9664\u200b\u7a7a\u200b\u7684\u200b\u76ee\u5f55\u200b\u3002</p> <p>\u200b\u5982\u540c\u200b\u4e0a\u8ff0\u200b<code>mkdir</code>\u200b\u4e00\u6837\u200b\uff0c<code>rmdir</code>\u200b\u5220\u9664\u200b\u76ee\u5f55\u200b\u4e5f\u200b\u9700\u8981\u200b\u4e00\u5c42\u200b\u4e00\u5c42\u200b\u5220\u9664\u200b\uff0c\u200b\u800c\u4e14\u200b\u88ab\u200b\u5220\u9664\u200b\u7684\u200b\u76ee\u5f55\u200b\u91cc\u9762\u200b\u4e0d\u80fd\u200b\u5b58\u5728\u200b\u5176\u4ed6\u200b\u7684\u200b\u76ee\u5f55\u200b\u6216\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5373\u200b\u53ea\u80fd\u200b\u5220\u9664\u200b\u7a7a\u76ee\u5f55\u200b\u3002</p> <p><code>-p</code>\u200b\u9009\u9879\u200b\uff1a\u200b\u53ef\u4ee5\u200b\u9012\u5f52\u200b\u5220\u9664\u200b\u6307\u5b9a\u200b\u7684\u200b\u591a\u7ea7\u200b\u76ee\u5f55\u200b\uff0c\u200b\u4f46\u662f\u200b\u8981\u6c42\u200b\u6bcf\u4e2a\u200b\u76ee\u5f55\u200b\u4e5f\u200b\u5fc5\u987b\u200b\u662f\u200b\u7a7a\u76ee\u5f55\u200b\u3002</p> <pre><code>$ rmdir [-p] dirName\n</code></pre>"},{"location":"Linux/#74-rm","title":"7.4 <code>rm</code> \u200b\u5220\u9664\u200b\u547d\u4ee4","text":"<p>\u200b\u4e0a\u8ff0\u200brmdir\u200b\u547d\u4ee4\u200b\u53ea\u80fd\u200b\u5220\u9664\u200b\u7a7a\u76ee\u5f55\u200b\uff0c\u200b\u5f53\u8981\u200b\u5220\u9664\u200b\u975e\u200b\u7a7a\u76ee\u5f55\u200b\u65f6\u200b\uff0c\u200b\u5c31\u8981\u200b\u4f7f\u7528\u200b\u5e26\u6709\u200b<code>-r</code>\u200b\u9009\u9879\u200b\u7684\u200b<code>rm</code>\u200b\u547d\u4ee4\u200b\u3002</p> <p>Linux <code>rm</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1aremove\uff09\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u5220\u9664\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u6216\u8005\u200b\u76ee\u5f55\u200b\u3002</p> <pre><code>$ rm [options] name...\n -i \u200b\u5220\u9664\u200b\u524d\u200b\u9010\u4e00\u200b\u8be2\u95ee\u200b\u786e\u8ba4\u200b\u3002\n -f \u200b\u5373\u4f7f\u200b\u539f\u200b\u6863\u6848\u200b\u5c5e\u6027\u200b\u8bbe\u4e3a\u200b\u552f\u8bfb\u200b\uff0c\u200b\u4ea6\u200b\u76f4\u63a5\u200b\u5220\u9664\u200b\uff0c\u200b\u65e0\u9700\u200b\u9010\u4e00\u200b\u786e\u8ba4\u200b\u3002\n -r \u200b\u5c06\u200b\u76ee\u5f55\u200b\u53ca\u200b\u4ee5\u4e0b\u200b\u4e4b\u200b\u6863\u6848\u200b\u4ea6\u200b\u9010\u4e00\u200b\u5220\u9664\u200b\u3002\n</code></pre> <p>\u200b\u5982\u679c\u200b\u9700\u8981\u200b\u5c06\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u53ca\u5176\u200b\u6240\u6709\u200b\u5185\u5bb9\u200b\u90fd\u200b\u5220\u9664\u200b\uff0c\u200b\u5219\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b<code>rm -r</code>\u3002</p>"},{"location":"Linux/#75-cd","title":"7.5 <code>cd</code> \u200b\u5207\u6362\u200b\u76ee\u5f55","text":"<p>Linux <code>cd</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1achange directory\uff09\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u5207\u6362\u200b\u5f53\u524d\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u3002</p> <p>\u200b\u5176\u4e2d\u200b dirName \u200b\u8868\u793a\u6cd5\u200b\u53ef\u200b\u4e3a\u200b\u7edd\u5bf9\u8def\u5f84\u200b\u6216\u200b\u76f8\u5bf9\u8def\u5f84\u200b\u3002\u200b\u82e5\u200b\u76ee\u5f55\u200b\u540d\u79f0\u200b\u7701\u7565\u200b\uff0c\u200b\u5219\u200b\u53d8\u6362\u200b\u81f3\u200b\u4f7f\u7528\u8005\u200b\u7684\u200b home \u200b\u76ee\u5f55\u200b (\u200b\u4e5f\u200b\u5c31\u662f\u200b\u521a\u200b login \u200b\u65f6\u200b\u6240\u5728\u200b\u7684\u200b\u76ee\u5f55\u200b)\u3002</p> <p>\u200b\u53e6\u5916\u200b\uff0c<code>~</code> \u200b\u4e5f\u200b\u8868\u793a\u200b\u4e3a\u200b \u200b\u4e2a\u4eba\u200b\u76ee\u5f55\u200b\u7684\u200b\u5730\u5740\u200b\uff0c <code>.</code> \u200b\u5219\u200b\u662f\u200b\u8868\u793a\u200b\u76ee\u524d\u200b\u6240\u5728\u200b\u7684\u200b\u76ee\u5f55\u200b\uff0c <code>..</code>\u200b\u5219\u200b\u8868\u793a\u200b\u76ee\u524d\u200b\u76ee\u5f55\u200b\u4f4d\u7f6e\u200b\u7684\u200b\u4e0a\u200b\u4e00\u5c42\u200b\u76ee\u5f55\u200b\u3002</p> <pre><code>$ cd [dirName]\n</code></pre> <ul> <li>dirName\uff1a\u200b\u8981\u200b\u5207\u6362\u200b\u7684\u200b\u76ee\u6807\u76ee\u5f55\u200b\u3002</li> </ul>"},{"location":"Linux/#76-vi","title":"7.6 <code>vi</code> \u200b\u6587\u672c\u7f16\u8f91\u200b\u6a21\u5f0f","text":"<pre><code>$ vi/vim/bash\n</code></pre>"},{"location":"Linux/#77-echo","title":"7.7 <code>echo</code> \u200b\u547d\u4ee4","text":"<ul> <li>\u200b\u663e\u793a\u200b\u666e\u901a\u200b\u5b57\u7b26\u4e32\u200b:  </li> </ul> <pre><code> $ echo \"It is a test\"  </code></pre> <p>\u200b\u8f93\u51fa\u200b  It is a test</p> <ul> <li>\u200b\u663e\u793a\u200b\u8f6c\u4e49\u5b57\u7b26\u200b  </li> </ul> <pre><code> $ echo \"\\\"It is a test\\\"\"\n</code></pre> <p>\u200b\u8f93\u51fa\u200b  \"It is a test\"</p> <ul> <li>\u200b\u663e\u793a\u200b\u7ed3\u679c\u200b\u5b9a\u5411\u200b\u81f3\u200b\u6587\u4ef6\u200b</li> </ul> <pre><code>$ echo \"It is a test\" &gt; myfile\n</code></pre> <ul> <li>\u200b\u663e\u793a\u200b\u53d8\u91cf\u200b </li> </ul> <pre><code>$ export temp_var=haha\n$ echo $temp_var\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c<code>export</code>\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u5b9a\u4e49\u200b\u53d8\u91cf\u200b\u3002\u200b\u4e4b\u540e\u200b\uff0c\u200b\u82e5\u200b\u9700\u8981\u200b\u5728\u200b<code>echo</code>\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u5230\u200b\u4e4b\u524d\u200b\u7684\u200b\u5b9a\u4e49\u200b\uff0c\u200b\u5e94\u200b\u5728\u200b\u53d8\u91cf\u540d\u200b\u524d\u200b\u52a0\u4e0a\u200b$\u200b\u7b26\u53f7\u200b\u3002</p>"},{"location":"Linux/#78-cat","title":"7.8 <code>cat</code> \u200b\u6253\u5370\u6587\u4ef6","text":"<p><code>cat</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1aconcatenate\uff09\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u8fde\u63a5\u200b\u6587\u4ef6\u200b\u5e76\u6253\u5370\u200b\u5230\u200b\u6807\u51c6\u200b\u8f93\u51fa\u8bbe\u5907\u200b\u4e0a\u200b\u3002</p> <pre><code>$ cat [-AbeEnstTuv] [--help] [--version] fileName\n</code></pre> <ul> <li><code>-n</code> \u200b\u6216\u200b <code>--number</code>\uff1a\u200b\u7531\u200b 1 \u200b\u5f00\u59cb\u200b\u5bf9\u200b\u6240\u6709\u200b\u8f93\u51fa\u200b\u7684\u200b\u884c\u6570\u200b\u7f16\u53f7\u200b\u3002</li> <li><code>-b</code> \u200b\u6216\u200b <code>--number-nonblank</code>\uff1a\u200b\u548c\u200b -n \u200b\u76f8\u4f3c\u200b\uff0c\u200b\u53ea\u4e0d\u8fc7\u200b\u5bf9\u4e8e\u200b\u7a7a\u767d\u884c\u200b\u4e0d\u200b\u7f16\u53f7\u200b\u3002</li> <li><code>-s</code> \u200b\u6216\u200b <code>--squeeze-blank</code>\uff1a\u200b\u5f53\u200b\u9047\u5230\u200b\u6709\u200b\u8fde\u7eed\u200b\u4e24\u884c\u200b\u4ee5\u4e0a\u200b\u7684\u200b\u7a7a\u767d\u884c\u200b\uff0c\u200b\u5c31\u200b\u4ee3\u6362\u200b\u4e3a\u200b\u4e00\u884c\u200b\u7684\u200b\u7a7a\u767d\u884c\u200b\u3002</li> <li><code>-v</code> \u200b\u6216\u200b <code>--show-nonprinting</code>\uff1a\u200b\u4f7f\u7528\u200b ^ \u200b\u548c\u200b M- \u200b\u7b26\u53f7\u200b\uff0c\u200b\u9664\u4e86\u200b LFD \u200b\u548c\u200b TAB \u200b\u4e4b\u5916\u200b\u3002</li> <li><code>-E</code> \u200b\u6216\u200b <code>--show-ends</code> : \u200b\u5728\u200b\u6bcf\u884c\u200b\u7ed3\u675f\u200b\u5904\u200b\u663e\u793a\u200b $\u3002</li> <li><code>-T</code> \u200b\u6216\u200b <code>--show-tabs</code>: \u200b\u5c06\u200b TAB \u200b\u5b57\u7b26\u200b\u663e\u793a\u200b\u4e3a\u200b ^I\u3002</li> <li><code>-A</code>, <code>--show-all</code>\uff1a\u200b\u7b49\u4ef7\u200b\u4e8e\u200b -vET\u3002</li> <li><code>-e</code>\uff1a\u200b\u7b49\u4ef7\u200b\u4e8e\u200b\"-vE\"\u200b\u9009\u9879\u200b\uff1b</li> <li><code>-t</code>\uff1a\u200b\u7b49\u4ef7\u200b\u4e8e\u200b\"-vT\"\u200b\u9009\u9879\u200b\uff1b</li> </ul> <p>\u200b\u793a\u4f8b\u200b\uff1a\u200b\u663e\u793a\u200b\u67d0\u4e2a\u200b\u6587\u4ef6\u200b\u5185\u5bb9\u200b\uff08\u200b\u5982\u200b<code>ln.c</code>\u200b\u6587\u4ef6\u200b\uff09\uff0c\u200b\u5e76\u200b\u5c06\u200b\u5176\u200b\u5404\u884c\u200b\u8fdb\u884c\u200b\u7f16\u53f7\u200b</p> <pre><code>$ cat -n ln.c\n     1  #include \"kernel/types.h\"\n2  #include \"kernel/stat.h\"\n3  #include \"user/user.h\"\n4\n5  int\n     6  main(int argc, char *argv[])\n7  {\n8    if(argc != 3){\n9      fprintf(2, \"Usage: ln old new\\n\");\n10      exit(1);\n11    }\n12    if(link(argv[1], argv[2]) &lt; 0)\n13      fprintf(2, \"link %s %s: failed\\n\", argv[1], argv[2]);\n14    exit(0);\n15  }\n</code></pre>"},{"location":"Linux/#79-cp","title":"7.9 <code>cp</code> \u200b\u590d\u5236\u200b\u6587\u4ef6","text":"<p>Linux <code>cp</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1acopy file\uff09\u200b\u547d\u4ee4\u200b\u4e3b\u8981\u200b\u7528\u4e8e\u200b\u590d\u5236\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u3002</p> <pre><code>$ cp [options] source dest\n\u200b\u6216\u200b\n$ cp [options] source... directory\n</code></pre> <ul> <li><code>-a</code>\uff1a\u200b\u6b64\u200b\u9009\u9879\u200b\u901a\u5e38\u200b\u5728\u200b\u590d\u5236\u200b\u76ee\u5f55\u200b\u65f6\u200b\u4f7f\u7528\u200b\uff0c\u200b\u5b83\u200b\u4fdd\u7559\u200b\u94fe\u63a5\u200b\u3001\u200b\u6587\u4ef6\u5c5e\u6027\u200b\uff0c\u200b\u5e76\u200b\u590d\u5236\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b\u6240\u6709\u200b\u5185\u5bb9\u200b\u3002\u200b\u5176\u200b\u4f5c\u7528\u200b\u7b49\u4e8e\u200bdpR\u200b\u53c2\u6570\u200b\u7ec4\u5408\u200b\u3002</li> <li><code>-d</code>\uff1a\u200b\u590d\u5236\u200b\u65f6\u200b\u4fdd\u7559\u200b\u94fe\u63a5\u200b\u3002\u200b\u8fd9\u91cc\u200b\u6240\u8bf4\u200b\u7684\u200b\u94fe\u63a5\u200b\u76f8\u5f53\u4e8e\u200bWindows\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b\u5feb\u6377\u65b9\u5f0f\u200b\u3002</li> <li><code>-f</code>\uff1a\u200b\u8986\u76d6\u200b\u5df2\u7ecf\u200b\u5b58\u5728\u200b\u7684\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u800c\u200b\u4e0d\u200b\u7ed9\u51fa\u200b\u63d0\u793a\u200b\u3002</li> <li><code>-i</code>\uff1a\u200b\u4e0e\u200b-f\u200b\u9009\u9879\u200b\u76f8\u53cd\u200b\uff0c\u200b\u5728\u200b\u8986\u76d6\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u4e4b\u524d\u200b\u7ed9\u51fa\u200b\u63d0\u793a\u200b\uff0c\u200b\u8981\u6c42\u200b\u7528\u6237\u200b\u786e\u8ba4\u200b\u662f\u5426\u200b\u8986\u76d6\u200b\uff0c\u200b\u56de\u7b54\u200b\"y\"\u200b\u65f6\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u5c06\u200b\u88ab\u200b\u8986\u76d6\u200b\u3002</li> <li><code>-p</code>\uff1a\u200b\u9664\u200b\u590d\u5236\u200b\u6587\u4ef6\u200b\u7684\u200b\u5185\u5bb9\u200b\u5916\u200b\uff0c\u200b\u8fd8\u200b\u628a\u200b\u4fee\u6539\u200b\u65f6\u95f4\u200b\u548c\u200b\u8bbf\u95ee\u200b\u6743\u9650\u200b\u4e5f\u200b\u590d\u5236\u5230\u200b\u65b0\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u3002</li> <li><code>-r</code>\uff1a\u200b\u82e5\u200b\u7ed9\u51fa\u200b\u7684\u200b\u6e90\u6587\u4ef6\u200b\u662f\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b\uff0c\u200b\u6b64\u65f6\u200b\u5c06\u200b\u590d\u5236\u200b\u8be5\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u6240\u6709\u200b\u7684\u200b\u5b50\u76ee\u5f55\u200b\u548c\u200b\u6587\u4ef6\u200b\u3002</li> <li><code>-l</code>\uff1a\u200b\u4e0d\u200b\u590d\u5236\u200b\u6587\u4ef6\u200b\uff0c\u200b\u53ea\u662f\u200b\u751f\u6210\u200b\u94fe\u63a5\u200b\u6587\u4ef6\u200b\u3002</li> </ul>"},{"location":"Linux/#710-mv","title":"7.10 <code>mv</code> \u200b\u6539\u540d\u200b\u6216\u200b\u79fb\u52a8\u200b\u6587\u4ef6","text":"<p>Linux <code>mv</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1amove file\uff09\u200b\u547d\u4ee4\u200b\u7528\u6765\u200b\u4e3a\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u6539\u540d\u200b\u3001\u200b\u6216\u200b\u5c06\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u79fb\u5165\u200b\u5176\u5b83\u200b\u4f4d\u7f6e\u200b\u3002</p> <pre><code>$ mv [options] source dest\n$ mv [options] source... directory\n</code></pre> <ul> <li><code>-b</code>: \u200b\u5f53\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u5b58\u5728\u200b\u65f6\u200b\uff0c\u200b\u5728\u200b\u6267\u884c\u200b\u8986\u76d6\u200b\u524d\u200b\uff0c\u200b\u4f1a\u4e3a\u200b\u5176\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u5907\u4efd\u200b\u3002</li> <li><code>-i</code>: \u200b\u5982\u679c\u200b\u6307\u5b9a\u200b\u79fb\u52a8\u200b\u7684\u200b\u6e90\u76ee\u5f55\u200b\u6216\u200b\u6587\u4ef6\u200b\u4e0e\u200b\u76ee\u6807\u200b\u7684\u200b\u76ee\u5f55\u200b\u6216\u200b\u6587\u4ef6\u200b\u540c\u540d\u200b\uff0c\u200b\u5219\u200b\u4f1a\u200b\u5148\u200b\u8be2\u95ee\u200b\u662f\u5426\u200b\u8986\u76d6\u200b\u65e7\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8f93\u5165\u200b y \u200b\u8868\u793a\u200b\u76f4\u63a5\u200b\u8986\u76d6\u200b\uff0c\u200b\u8f93\u5165\u200b n \u200b\u8868\u793a\u200b\u53d6\u6d88\u200b\u8be5\u200b\u64cd\u4f5c\u200b\u3002</li> <li><code>-f</code>: \u200b\u5982\u679c\u200b\u6307\u5b9a\u200b\u79fb\u52a8\u200b\u7684\u200b\u6e90\u76ee\u5f55\u200b\u6216\u200b\u6587\u4ef6\u200b\u4e0e\u200b\u76ee\u6807\u200b\u7684\u200b\u76ee\u5f55\u200b\u6216\u200b\u6587\u4ef6\u200b\u540c\u540d\u200b\uff0c\u200b\u4e0d\u4f1a\u200b\u8be2\u95ee\u200b\uff0c\u200b\u76f4\u63a5\u200b\u8986\u76d6\u200b\u65e7\u200b\u6587\u4ef6\u200b\u3002</li> <li><code>-n</code>: \u200b\u4e0d\u8981\u200b\u8986\u76d6\u200b\u4efb\u4f55\u200b\u5df2\u200b\u5b58\u5728\u200b\u7684\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u3002</li> <li><code>-u</code>\uff1a\u200b\u5f53\u200b\u6e90\u6587\u4ef6\u200b\u6bd4\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u65b0\u200b\u6216\u8005\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u4e0d\u200b\u5b58\u5728\u200b\u65f6\u200b\uff0c\u200b\u624d\u200b\u6267\u884c\u200b\u79fb\u52a8\u200b\u64cd\u4f5c\u200b\u3002</li> </ul> <p>\u200b\u793a\u4f8b\u200b\uff1a\u200b\u5047\u8bbe\u200b\u6709\u4e2a\u200b\u6587\u4ef6\u200b<code>foo</code>\uff0c\u200b\u73b0\u200b\u9700\u8981\u200b\u5c06\u200b\u5b83\u200b\u91cd\u547d\u540d\u200b\u4e3a\u200b<code>bar</code></p> <pre><code>$ ls\nfoo\n$ mv foo bar\n$ ls\nbar\n</code></pre>"},{"location":"Linux/#711-find","title":"7.11 <code>find</code> \u200b\u67e5\u627e\u6587\u4ef6","text":"<p>Linux <code>find</code> \u200b\u547d\u4ee4\u200b\u7528\u6765\u200b\u5728\u200b\u6307\u5b9a\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u67e5\u627e\u6587\u4ef6\u200b\u3002\u200b\u4efb\u4f55\u200b\u4f4d\u4e8e\u200b\u53c2\u6570\u200b\u4e4b\u524d\u200b\u7684\u200b\u5b57\u7b26\u4e32\u200b\u90fd\u200b\u5c06\u200b\u88ab\u200b\u89c6\u4e3a\u200b\u6b32\u200b\u67e5\u627e\u200b\u7684\u200b\u76ee\u5f55\u540d\u200b\u3002\u200b\u5982\u679c\u200b\u4f7f\u7528\u200b\u8be5\u200b\u547d\u4ee4\u200b\u65f6\u200b\uff0c\u200b\u4e0d\u200b\u8bbe\u7f6e\u200b\u4efb\u4f55\u200b\u53c2\u6570\u200b\uff0c\u200b\u5219\u200b <code>find</code> \u200b\u547d\u4ee4\u200b\u5c06\u200b\u5728\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e0b\u200b\u67e5\u627e\u200b\u5b50\u76ee\u5f55\u200b\u4e0e\u200b\u6587\u4ef6\u200b\u3002\u200b\u5e76\u4e14\u200b\u5c06\u200b\u67e5\u627e\u200b\u5230\u200b\u7684\u200b\u5b50\u76ee\u5f55\u200b\u548c\u200b\u6587\u4ef6\u200b\u5168\u90e8\u200b\u8fdb\u884c\u200b\u663e\u793a\u200b\u3002</p> <pre><code>$ find path -option [ -print ] [ -exec -ok command ] {} \\;\n</code></pre> <p>\u200b\u793a\u4f8b\u200b:</p> <pre><code>$ find . -name \"*.c\"\n</code></pre> <p>\u200b\u4e0a\u8ff0\u200b\u793a\u4f8b\u200b\u529f\u80fd\u200b\uff1a\u200b\u5bfb\u627e\u200b\u5f53\u524d\u76ee\u5f55\u200b\u53ca\u5176\u200b\u5404\u7ea7\u200b\u5b50\u76ee\u5f55\u200b\u4e0b\u200b.c\u200b\u540e\u7f00\u200b\u7684\u200b\u6587\u4ef6\u200b\u3002</p> <p>Linux locate\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u67e5\u627e\u200b\u7b26\u5408\u6761\u4ef6\u200b\u7684\u200b\u6587\u6863\u200b\uff0c\u200b\u4ed6\u4f1a\u200b\u53bb\u200b\u4fdd\u5b58\u6587\u6863\u200b\u548c\u200b\u76ee\u5f55\u200b\u540d\u79f0\u200b\u7684\u200b\u6570\u636e\u5e93\u200b\u5185\u200b\uff0c\u200b\u67e5\u627e\u200b\u5408\u4e4e\u200b\u8303\u672c\u200b\u6837\u5f0f\u200b\u6761\u4ef6\u200b\u7684\u200b\u6587\u6863\u200b\u6216\u200b\u76ee\u5f55\u200b\u3002</p> <p>\u200b\u4e00\u822c\u200b\u60c5\u51b5\u200b\u6211\u4eec\u200b\u53ea\u200b\u9700\u8981\u200b\u8f93\u5165\u200b<code>locate your_file_name</code>\u200b\u5373\u53ef\u200b\u67e5\u627e\u200b\u6307\u5b9a\u200b\u6587\u4ef6\u200b\u3002</p> <pre><code>locate [-d ][--help][--version][\u200b\u8303\u672c\u200b\u6837\u5f0f\u200b...]\n</code></pre> <p>\u200b\u793a\u4f8b\u200b:</p> <p>\u200b\u67e5\u627e\u200b passwd \u200b\u6587\u4ef6\u200b\uff0c\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\uff1a</p> <pre><code>locate passwd\n</code></pre> <p>PS: locate \u200b\u4e0e\u200b find \u200b\u4e0d\u540c\u200b: find \u200b\u662f\u200b\u53bb\u200b\u786c\u76d8\u200b\u627e\u200b\uff0clocate \u200b\u53ea\u200b\u5728\u200b /var/lib/slocate \u200b\u8d44\u6599\u5e93\u200b\u4e2d\u200b\u627e\u200b\u3002</p> <p><code>locate</code> \u200b\u7684\u200b\u901f\u5ea6\u200b\u6bd4\u200b <code>find</code> \u200b\u5feb\u200b\uff0c\u200b\u5b83\u200b\u5e76\u200b\u4e0d\u662f\u200b\u771f\u7684\u200b\u67e5\u627e\u200b\uff0c\u200b\u800c\u662f\u200b\u67e5\u200b\u6570\u636e\u5e93\u200b\uff0c\u200b\u4e00\u822c\u200b\u6587\u4ef6\u200b\u6570\u636e\u5e93\u200b\u5728\u200b <code>/var/lib/slocate/slocate.db</code> \u200b\u4e2d\u200b\uff0c\u200b\u6240\u4ee5\u200b <code>locate</code> \u200b\u7684\u200b\u67e5\u627e\u200b\u5e76\u200b\u4e0d\u662f\u200b\u5b9e\u65f6\u200b\u7684\u200b\uff0c\u200b\u800c\u662f\u200b\u4ee5\u200b\u6570\u636e\u5e93\u200b\u7684\u200b\u66f4\u65b0\u200b\u4e3a\u51c6\u200b\uff0c\u200b\u4e00\u822c\u200b\u662f\u200b\u7cfb\u7edf\u200b\u81ea\u5df1\u200b\u7ef4\u62a4\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u624b\u5de5\u200b\u5347\u7ea7\u200b\u6570\u636e\u5e93\u200b \uff0c\u200b\u547d\u4ee4\u200b\u4e3a\u200b\uff1a</p> <pre><code>updatedb\n</code></pre>"},{"location":"Linux/#712-grep","title":"7.12 <code>grep</code> \u200b\u6b63\u5219\u200b\u5339\u914d\u200b\u6587\u4ef6\u200b\u5185\u5bb9","text":"<p>Linux <code>grep</code> \u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u67e5\u627e\u6587\u4ef6\u200b\u91cc\u200b\u7b26\u5408\u6761\u4ef6\u200b\u7684\u200b\u5b57\u7b26\u4e32\u200b\u3002</p> <p><code>grep</code> \u200b\u6307\u4ee4\u200b\u7528\u4e8e\u200b\u67e5\u627e\u200b\u5185\u5bb9\u200b\u5305\u542b\u200b\u6307\u5b9a\u200b\u7684\u200b\u8303\u672c\u200b\u6837\u5f0f\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5982\u679c\u200b\u53d1\u73b0\u200b\u67d0\u200b\u6587\u4ef6\u200b\u7684\u200b\u5185\u5bb9\u200b\u7b26\u5408\u200b\u6240\u200b\u6307\u5b9a\u200b\u7684\u200b\u8303\u672c\u200b\u6837\u5f0f\u200b\uff0c\u200b\u9884\u8bbe\u200b <code>grep</code> \u200b\u6307\u4ee4\u200b\u4f1a\u200b\u628a\u200b\u542b\u6709\u200b\u8303\u672c\u200b\u6837\u5f0f\u200b\u7684\u200b\u90a3\u200b\u4e00\u5217\u200b\u663e\u793a\u200b\u51fa\u6765\u200b\u3002\u200b\u82e5\u200b\u4e0d\u200b\u6307\u5b9a\u200b\u4efb\u4f55\u200b\u6587\u4ef6\u540d\u79f0\u200b\uff0c\u200b\u6216\u662f\u200b\u6240\u200b\u7ed9\u4e88\u200b\u7684\u200b\u6587\u4ef6\u540d\u200b\u4e3a\u200b -\uff0c\u200b\u5219\u200b grep \u200b\u6307\u4ee4\u200b\u4f1a\u200b\u4ece\u200b\u6807\u51c6\u200b\u8f93\u5165\u200b\u8bbe\u5907\u200b\u8bfb\u53d6\u6570\u636e\u200b\u3002</p> <pre><code>grep [-abcEFGhHilLnqrsvVwxy][-A&lt;\u200b\u663e\u793a\u200b\u5217\u6570\u200b&gt;][-B&lt;\u200b\u663e\u793a\u200b\u5217\u6570\u200b&gt;][-C&lt;\u200b\u663e\u793a\u200b\u5217\u6570\u200b&gt;][-d&lt;\u200b\u8fdb\u884c\u200b\u52a8\u4f5c\u200b&gt;][-e&lt;\u200b\u8303\u672c\u200b\u6837\u5f0f\u200b&gt;][-f&lt;\u200b\u8303\u672c\u200b\u6587\u4ef6\u200b&gt;][--help][\u200b\u8303\u672c\u200b\u6837\u5f0f\u200b][\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b...]\n</code></pre> <p>\u200b\u793a\u4f8b\u200b:</p> <pre><code>grep test *file </code></pre> <p>\u200b\u7ed3\u679c\u200b\u5982\u4e0b\u200b:</p> <pre><code>$ grep test test* #\u200b\u67e5\u627e\u200b\u524d\u7f00\u200b\u6709\u200b\u201ctest\u201d\u200b\u7684\u200b\u6587\u4ef6\u200b\u5305\u542b\u200b\u201ctest\u201d\u200b\u5b57\u7b26\u4e32\u200b\u7684\u200b\u6587\u4ef6\u200b  \ntestfile1:This a Linux testfile! #\u200b\u5217\u51fa\u200btestfile1 \u200b\u6587\u4ef6\u200b\u4e2d\u200b\u5305\u542b\u200btest\u200b\u5b57\u7b26\u200b\u7684\u200b\u884c\u200b  \ntestfile_2:This is a linux testfile! #\u200b\u5217\u51fa\u200btestfile_2 \u200b\u6587\u4ef6\u200b\u4e2d\u200b\u5305\u542b\u200btest\u200b\u5b57\u7b26\u200b\u7684\u200b\u884c\u200b  \ntestfile_2:Linux test #\u200b\u5217\u51fa\u200btestfile_2 \u200b\u6587\u4ef6\u200b\u4e2d\u200b\u5305\u542b\u200btest\u200b\u5b57\u7b26\u200b\u7684\u200b\u884c\u200b \n</code></pre>"},{"location":"Linux/#713-man","title":"7.13 <code>man</code> \u200b\u5e2e\u52a9\u200b\u547d\u4ee4","text":"<p><code>man</code>\u200b\u547d\u4ee4\u200b\u662f\u200bLinux\u200b\u4e0b\u200b\u7684\u200b\u5e2e\u52a9\u200b\u6307\u4ee4\u200b\uff0c\u200b\u901a\u8fc7\u200b<code>man</code>\u200b\u6307\u4ee4\u200b\u53ef\u4ee5\u200b\u67e5\u770b\u200bLinux\u200b\u4e2d\u200b\u7684\u200b\u6307\u4ee4\u200b\u5e2e\u52a9\u200b\u3001\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u5e2e\u52a9\u200b\u548c\u200b\u7f16\u7a0b\u200b\u5e2e\u52a9\u200b\u7b49\u200b\u4fe1\u606f\u200b\u3002</p> <pre><code>man [options] [args]\n</code></pre> <ul> <li><code>-a</code>\uff1a\u200b\u5728\u200b\u6240\u6709\u200b\u7684\u200bman\u200b\u5e2e\u52a9\u200b\u624b\u518c\u200b\u4e2d\u200b\u641c\u7d22\u200b\uff1b</li> <li><code>-f</code>\uff1a\u200b\u7b49\u4ef7\u200b\u4e8e\u200bwhatis\u200b\u6307\u4ee4\u200b\uff0c\u200b\u663e\u793a\u200b\u7ed9\u5b9a\u200b\u5173\u952e\u5b57\u200b\u7684\u200b\u7b80\u77ed\u200b\u63cf\u8ff0\u200b\u4fe1\u606f\u200b\uff1b</li> <li><code>-P</code>\uff1a\u200b\u6307\u5b9a\u200b\u5185\u5bb9\u200b\u65f6\u200b\u4f7f\u7528\u200b\u5206\u9875\u200b\u7a0b\u5e8f\u200b\uff1b</li> <li><code>-M</code>\uff1a\u200b\u6307\u5b9a\u200bman\u200b\u624b\u518c\u200b\u641c\u7d22\u200b\u7684\u200b\u8def\u5f84\u200b\u3002</li> </ul> <p>\u200b\u793a\u4f8b\u200b\uff1a\u200b\u67e5\u8be2\u200b<code>ps</code>\u200b\u547d\u4ee4\u200b\u7684\u200b\u624b\u518c\u200b</p> <pre><code>man ps\n</code></pre>"},{"location":"Linux/#714-diff","title":"7.14 <code>diff</code>\u200b\u6bd4\u8f83\u200b\u5dee\u5f02","text":"<p>Linux <code>diff</code>\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u6bd4\u8f83\u200b\u6587\u4ef6\u200b\u7684\u200b\u5dee\u5f02\u200b\u3002</p> <p><code>diff</code>\u200b\u4ee5\u200b\u9010\u884c\u200b\u7684\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u6bd4\u8f83\u200b\u6587\u672c\u6587\u4ef6\u200b\u7684\u200b\u5f02\u540c\u200b\u5904\u200b\u3002\u200b\u5982\u679c\u200b\u6307\u5b9a\u200b\u8981\u200b\u6bd4\u8f83\u200b\u76ee\u5f55\u200b\uff0c\u200b\u5219\u200bdiff\u200b\u4f1a\u200b\u6bd4\u8f83\u200b\u76ee\u5f55\u200b\u4e2d\u200b\u76f8\u540c\u200b\u6587\u4ef6\u540d\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4f46\u200b\u4e0d\u4f1a\u200b\u6bd4\u8f83\u200b\u5176\u4e2d\u200b\u5b50\u76ee\u5f55\u200b\u3002</p> <pre><code>diff [-abBcdefHilnNpPqrstTuvwy][-&lt;\u200b\u884c\u200b\u6570\u200b&gt;][-C &lt;\u200b\u884c\u200b\u6570\u200b&gt;][-D &lt;\u200b\u5de8\u96c6\u200b\u540d\u79f0\u200b&gt;][-I &lt;\u200b\u5b57\u7b26\u200b\u6216\u200b\u5b57\u7b26\u4e32\u200b&gt;][-S &lt;\u200b\u6587\u4ef6\u200b&gt;][-W &lt;\u200b\u5bbd\u5ea6\u200b&gt;][-x &lt;\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b&gt;][-X &lt;\u200b\u6587\u4ef6\u200b&gt;][--help][--left-column][--suppress-common-line][\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b1][\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b2]\n</code></pre> <p>\u200b\u793a\u4f8b\u200b\uff1a\u200b\u6709\u200b\u4e24\u4e2a\u200b\u6587\u4ef6\u200b<code>foo.txt</code>\u200b\u548c\u200b<code>bar.txt</code>\uff0c\u200b\u5185\u5bb9\u200b\u5206\u522b\u200b\u4e3a\u200b</p> <pre><code>$ cat -n foo.txt\nabc\ndef\n$ cat -n bar.txt\nabd\ndef\nghj\n</code></pre> <p>\u200b\u4f7f\u7528\u200b<code>diff</code>\u200b\u547d\u4ee4\u200b\u6bd4\u8f83\u200b\u5b83\u4eec\u200b\u7684\u200b\u4e0d\u540c\u200b</p> <pre><code>1c1\n&lt; abc\n----\n&gt; abd\n2a3,\n&gt; ghj\n</code></pre>"},{"location":"Linux/#715-ps","title":"7.15 <code>ps</code>\u200b\u67e5\u770b\u200b\u8fdb\u7a0b\u200b\u72b6\u6001","text":"<p>Linux <code>ps</code> \uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1aprocess status\uff09\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u663e\u793a\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u72b6\u6001\u200b.</p> <pre><code>ps [options] [--help]\n</code></pre> <ul> <li>-A \u200b\u5217\u51fa\u200b\u6240\u6709\u200b\u7684\u200b\u884c\u7a0b\u200b</li> <li>-w \u200b\u663e\u793a\u200b\u52a0\u5bbd\u200b\u53ef\u4ee5\u200b\u663e\u793a\u200b\u8f83\u200b\u591a\u200b\u7684\u200b\u8d44\u8baf\u200b</li> <li>-au \u200b\u663e\u793a\u200b\u8f83\u200b\u8be6\u7ec6\u200b\u7684\u200b\u8d44\u8baf\u200b</li> <li>-aux \u200b\u663e\u793a\u200b\u6240\u6709\u200b\u5305\u542b\u200b\u5176\u4ed6\u200b\u4f7f\u7528\u8005\u200b\u7684\u200b\u884c\u7a0b\u200b</li> </ul>"},{"location":"Linux/#716-top","title":"7.16 <code>top</code>\u200b\u4efb\u52a1\u200b\u7ba1\u7406\u5668","text":"<p>Linux <code>top</code>\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u5b9e\u65f6\u200b\u663e\u793a\u200b process \u200b\u7684\u200b\u52a8\u6001\u200b\u3002</p> <pre><code>top [-] [d delay] [q] [c] [S] [s] [i] [n] [b]\n</code></pre> <p></p>"},{"location":"Linux/#717-tar","title":"7.17 <code>tar</code>\u200b\u6253\u5305\u200b\u548c\u89e3\u200b\u5305","text":"<p>Linux <code>tar</code>\uff08\u200b\u82f1\u6587\u200b\u5168\u62fc\u200b\uff1atape archive \uff09\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u5907\u4efd\u6587\u4ef6\u200b\u3002</p> <p><code>tar</code> \u200b\u662f\u200b\u7528\u6765\u200b\u5efa\u7acb\u200b\uff0c\u200b\u8fd8\u539f\u200b\u5907\u4efd\u6587\u4ef6\u200b\u7684\u200b\u5de5\u5177\u200b\u7a0b\u5e8f\u200b\uff0c\u200b\u5b83\u200b\u53ef\u4ee5\u200b\u52a0\u5165\u200b\uff0c\u200b\u89e3\u5f00\u200b\u5907\u4efd\u6587\u4ef6\u200b\u5185\u200b\u7684\u200b\u6587\u4ef6\u200b\u3002</p> <p>\u200b\u9996\u5148\u200b\u8981\u200b\u5f04\u6e05\u200b\u4e24\u4e2a\u200b\u6982\u5ff5\u200b\uff1a\u200b\u6253\u5305\u200b\u548c\u200b\u538b\u7f29\u200b\u3002\u200b\u6253\u5305\u200b\u662f\u200b\u6307\u200b\u5c06\u200b\u4e00\u5927\u5806\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\u53d8\u6210\u200b\u4e00\u4e2a\u200b\u603b\u200b\u7684\u200b\u6587\u4ef6\u200b\uff1b\u200b\u538b\u7f29\u200b\u5219\u200b\u662f\u200b\u5c06\u200b\u4e00\u4e2a\u200b\u5927\u200b\u7684\u200b\u6587\u4ef6\u200b\u901a\u8fc7\u200b\u4e00\u4e9b\u200b\u538b\u7f29\u7b97\u6cd5\u200b\u53d8\u6210\u200b\u4e00\u4e2a\u200b\u5c0f\u200b\u6587\u4ef6\u200b\u3002</p> <p>\u200b\u4e3a\u4ec0\u4e48\u200b\u8981\u200b\u533a\u5206\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u6982\u5ff5\u200b\u5462\u200b\uff1f\u200b\u8fd9\u200b\u6e90\u4e8e\u200bLinux\u200b\u4e2d\u200b\u5f88\u591a\u200b\u538b\u7f29\u200b\u7a0b\u5e8f\u200b\u53ea\u80fd\u200b\u9488\u5bf9\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u8fdb\u884c\u200b\u538b\u7f29\u200b\uff0c\u200b\u8fd9\u6837\u200b\u5f53\u200b\u4f60\u200b\u60f3\u8981\u200b\u538b\u7f29\u200b\u4e00\u5927\u5806\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u4f60\u200b\u5f97\u200b\u5148\u200b\u5c06\u200b\u8fd9\u200b\u4e00\u5927\u5806\u200b\u6587\u4ef6\u200b\u5148\u200b\u6253\u6210\u200b\u4e00\u4e2a\u5305\u200b\uff08tar\u200b\u547d\u4ee4\u200b\uff09\uff0c\u200b\u7136\u540e\u200b\u518d\u7528\u200b\u538b\u7f29\u200b\u7a0b\u5e8f\u200b\u8fdb\u884c\u200b\u538b\u7f29\u200b\uff08gzip bzip2\u200b\u547d\u4ee4\u200b\uff09\u3002</p> <p>linux\u200b\u4e0b\u200b\u6700\u200b\u5e38\u7528\u200b\u7684\u200b\u6253\u5305\u200b\u7a0b\u5e8f\u200b\u5c31\u662f\u200btar\u200b\u4e86\u200b\uff0c\u200b\u4f7f\u7528\u200btar\u200b\u7a0b\u5e8f\u200b\u6253\u200b\u51fa\u6765\u200b\u7684\u200b\u5305\u200b\u6211\u4eec\u200b\u5e38\u200b\u79f0\u4e3a\u200btar\u200b\u5305\u200b\uff0ctar\u200b\u5305\u200b\u6587\u4ef6\u200b\u7684\u200b\u547d\u4ee4\u200b\u901a\u5e38\u200b\u90fd\u200b\u662f\u200b\u4ee5\u200b.tar\u200b\u7ed3\u5c3e\u200b\u7684\u200b\u3002\u200b\u751f\u6210\u200btar\u200b\u5305\u540e\u200b\uff0c\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u7528\u200b\u5176\u5b83\u200b\u7684\u200b\u7a0b\u5e8f\u200b\u6765\u200b\u8fdb\u884c\u200b\u538b\u7f29\u200b\u3002</p> <p>\u200b\u6253\u5305\u200b\u547d\u4ee4\u200b\u793a\u4f8b\u200b:</p> <pre><code>tar -cvf log.tar log2012.log\n\ntar -zcvf log.tar.gz log2012.log\n\ntar -jcvf log.tar.bz2 log2012.log\n\nzip FileName.zip DirName\n</code></pre> <p>tar -cvf log.tar log2012.log  \u200b\u4ec5\u200b\u6253\u5305\u200b\uff0c\u200b\u4e0d\u200b\u538b\u7f29\u200b.</p> <p>tar -zcvf log.tar.gz log2012.log  \u200b\u6253\u5305\u200b\u540e\u200b\uff0c\u200b\u4ee5\u200b gzip \u200b\u538b\u7f29\u200b </p> <p>tar -jcvf log.tar.bz2 log2012.log \u200b\u6253\u5305\u200b\u540e\u200b\uff0c\u200b\u4ee5\u200b bzip2 \u200b\u538b\u7f29\u200b </p> <p>\u200b\u89e3\u5305\u200b\u793a\u4f8b\u200b:</p> <pre><code>tar -zxvf file.tar.gz //\u200b\u89e3\u538b\u200btar.gz\n\ntar -jxvf file.tar.bz2 //\u200b\u89e3\u538b\u200b tar.bz2\n\nunzip file.zip //\u200b\u89e3\u538b\u200bzip\n</code></pre>"},{"location":"Linux/#718-ln","title":"7.18 ln\u200b\u94fe\u63a5","text":"<p><code>ln</code>\u200b\u547d\u4ee4\u200b\u7528\u4e8e\u200b\u521b\u5efa\u200b\u94fe\u63a5\u200b\uff0c\u200b\u5206\u4e3a\u200b\u786c\u200b\u94fe\u63a5\u200b\u548c\u200b\u8f6f\u200b\u94fe\u63a5\u200b\u3002</p> <p>\u200b\u521b\u5efa\u200b\u786c\u200b\u94fe\u63a5\u200b\u7684\u200b\u65b9\u5f0f\u200b\u4e3a\u200b</p> <pre><code>ln file_name link_name\n</code></pre> <p>\u200b\u521b\u5efa\u200b\u8f6f\u200b\u94fe\u63a5\u200b\u7684\u200b\u65b9\u5f0f\u200b\u4e3a\u200b</p> <pre><code>ln -s file_name link_name\n</code></pre>"},{"location":"Linux/#719-ip-addr","title":"7.19 <code>ip addr</code> \u200b\u663e\u793a\u200b\u6216\u200b\u8bbe\u7f6e\u200b\u7f51\u7edc\u200b\u72b6\u6001","text":"<p>\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b <code>ip addr</code>\u200b\u547d\u4ee4\u200b\u67e5\u770b\u200bIP\u200b\u5730\u5740\u200b</p> <pre><code># ip addr\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000\nlink/ether 00:0c:29:61:40:aa brd ff:ff:ff:ff:ff:ff\n    inet 192.168.163.134/24 brd 192.168.163.255 scope global dynamic noprefixroute ens33\n       valid_lft 1729sec preferred_lft 1729sec\n    inet6 fe80::3b1e:b490:7d7f:ebd0/64 scope link noprefixroute\n       valid_lft forever preferred_lft forever\n</code></pre> <p>\u200b\u4e0a\u8ff0\u200b\u547d\u4ee4\u200b\u7ed3\u679c\u663e\u793a\u200b\u4e24\u200b\u90e8\u5206\u200b\uff0clo\u200b\u548c\u200bens33\uff0c\u200b\u5982\u679c\u200b\u6709\u200b\u591a\u5757\u200b\u7f51\u5361\u200b\uff0c\u200b\u6bcf\u5757\u200b\u7f51\u5361\u200b\u90fd\u200b\u4f1a\u200b\u663e\u793a\u200b\u4e00\u90e8\u5206\u200b\u3002</p> <ol> <li><code>lo</code>\uff1a\u200b\u5168\u79f0\u200bloopback\uff0c\u200b\u662f\u200b\u56de\u73af\u200b\u5730\u5740\u200b\uff0c\u200b\u7ecf\u5e38\u200b\u88ab\u200b\u5206\u914d\u200b\u5230\u200b<code>127.0.0.1</code>\u200b\u5730\u5740\u200b\u4e0a\u200b\uff0c\u200b\u7528\u4e8e\u200b\u672c\u200b\u673a\u200b\u901a\u4fe1\u200b\uff0c\u200b\u7ecf\u8fc7\u200b\u5185\u6838\u200b\u5904\u7406\u200b\u540e\u200b\u76f4\u63a5\u200b\u8fd4\u56de\u200b\uff0c\u200b\u4e0d\u4f1a\u200b\u5728\u200b\u4efb\u4f55\u200b\u7f51\u7edc\u200b\u4e2d\u200b\u51fa\u73b0\u200b\u3002</li> <li><code>ens33</code>\uff1a\u200b\u7f51\u5361\u200b\u540d\u200b\uff0c\u200b\u5982\u679c\u200b\u6709\u200b\u591a\u5757\u200b\u7f51\u5361\u200b\uff0c\u200b\u4f1a\u200b\u6709\u200b\u591a\u4e2a\u200bens \u200b\u6216\u200b\u5176\u5b83\u200b\u540d\u79f0\u200b\u3002\u200b\u4e0a\u8ff0\u200bIP\u200b\u5730\u5740\u200b\u662f\u200b<code>192.168.163.134/24</code></li> </ol>"},{"location":"Linux/#8-linux","title":"8. Linux\u200b\u91cd\u5b9a\u5411\u200b\u548c\u200b\u7ba1\u9053","text":"<pre><code>command &lt; input.txt 1&gt; output.txt 2&gt;err.txt  \ncommand1 | command2 | command3 | ...  </code></pre>"},{"location":"Linux/#81","title":"8.1 \u200b\u91cd\u5b9a\u5411","text":"<p> \u200b\u547d\u4ee4\u200b \u200b\u8bf4\u660e\u200b command &gt; file \u200b\u5c06\u200b\u8f93\u51fa\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\u3002 command &lt; file \u200b\u5c06\u200b\u8f93\u5165\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\u3002 command &gt;&gt; file \u200b\u5c06\u200b\u8f93\u51fa\u200b\u4ee5\u200b\u8ffd\u52a0\u200b\u7684\u200b\u65b9\u5f0f\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\u3002 n &gt; file \u200b\u5c06\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u4e3a\u200b n \u200b\u7684\u200b\u6587\u4ef6\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\u3002 n &gt;&gt; file \u200b\u5c06\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u4e3a\u200b n \u200b\u7684\u200b\u6587\u4ef6\u200b\u4ee5\u200b\u8ffd\u52a0\u200b\u7684\u200b\u65b9\u5f0f\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\u3002 n &gt;&amp; m \u200b\u5c06\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200b m \u200b\u548c\u200b n \u200b\u5408\u5e76\u200b\u3002 n &lt;&amp; m \u200b\u5c06\u200b\u8f93\u5165\u200b\u6587\u4ef6\u200b m \u200b\u548c\u200b n \u200b\u5408\u5e76\u200b\u3002 &lt;&lt; tag \u200b\u5c06\u200b\u5f00\u59cb\u200b\u6807\u8bb0\u200b tag \u200b\u548c\u200b\u7ed3\u675f\u200b\u6807\u8bb0\u200b tag \u200b\u4e4b\u95f4\u200b\u7684\u200b\u5185\u5bb9\u200b\u4f5c\u4e3a\u200b\u8f93\u5165\u200b\u3002 <p></p> <p>\u200b\u4e00\u822c\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u6bcf\u4e2a\u200b Unix/Linux \u200b\u547d\u4ee4\u200b\u8fd0\u884c\u200b\u65f6\u200b\u90fd\u200b\u4f1a\u200b\u6253\u5f00\u200b\u4e09\u4e2a\u200b\u6587\u4ef6\u200b\uff1a</p> <ul> <li>\u200b\u6807\u51c6\u200b\u8f93\u5165\u200b\u6587\u4ef6\u200b(stdin)\uff1astdin\u200b\u7684\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u4e3a\u200b0\uff0cUnix\u200b\u7a0b\u5e8f\u200b\u9ed8\u8ba4\u200b\u4ece\u200bstdin\u200b\u8bfb\u53d6\u6570\u636e\u200b\u3002</li> <li>\u200b\u6807\u51c6\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200b(stdout)\uff1astdout \u200b\u7684\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u4e3a\u200b1\uff0cUnix\u200b\u7a0b\u5e8f\u200b\u9ed8\u8ba4\u200b\u5411\u200bstdout\u200b\u8f93\u51fa\u200b\u6570\u636e\u200b\u3002</li> <li>\u200b\u6807\u51c6\u200b\u9519\u8bef\u200b\u6587\u4ef6\u200b(stderr)\uff1astderr\u200b\u7684\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u4e3a\u200b2\uff0cUnix\u200b\u7a0b\u5e8f\u200b\u4f1a\u200b\u5411\u200bstderr\u200b\u6d41\u4e2d\u200b\u5199\u5165\u200b\u9519\u8bef\u4fe1\u606f\u200b\u3002</li> </ul> <p>\u200b\u9ed8\u8ba4\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c<code>command &gt; file</code> \u200b\u5c06\u200b stdout \u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\uff0c<code>command &lt; file</code> \u200b\u5c06\u200bstdin \u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\u3002</p> <p>\u200b\u5982\u679c\u200b\u5e0c\u671b\u200b stderr \u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file\uff0c\u200b\u53ef\u4ee5\u200b\u8fd9\u6837\u200b\u5199\u200b\uff1a</p> <pre><code>$ command 2 &gt; file\n</code></pre> <p>\u200b\u5982\u679c\u200b\u5e0c\u671b\u200b stderr \u200b\u8ffd\u52a0\u200b\u5230\u200b file \u200b\u6587\u4ef6\u200b\u672b\u5c3e\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8fd9\u6837\u200b\u5199\u200b\uff1a</p> <pre><code>$ command 2 &gt;&gt; file\n</code></pre>"},{"location":"Linux/#82","title":"8.2 \u200b\u7ba1\u9053","text":"<p>\u200b\u82e5\u60f3\u200b\u7edf\u8ba1\u200b /etc\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u6587\u4ef6\u200b\u7684\u200b\u8be6\u7ec6\u4fe1\u606f\u200b\uff0c\u200b\u6b63\u5e38\u200b\u7684\u200b\u4f7f\u7528\u200b\u9700\u8981\u200b\u4e24\u4e2a\u200b\u6b65\u9aa4\u200b\u3002</p> <p>\u200b\u663e\u7136\u200b\uff0cetc.txt \u200b\u4f5c\u4e3a\u200b\u4e2d\u95f4\u200bbuffer\uff0c\u200b\u6ca1\u6709\u200b\u4e8c\u6b21\u200b\u4f7f\u7528\u200b\u7684\u200b\u9700\u8981\u200b\uff0c\u200b\u4e3a\u200b\u7701\u7565\u200b\u8fd9\u79cd\u200b\u9ebb\u70e6\u200b\uff0c\u200b\u540c\u65f6\u200b\u63d0\u9ad8\u200b\u4ee3\u7801\u200b\u6548\u7387\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u7ba1\u9053\u200b\u8fd9\u4e2a\u200b\u529f\u80fd\u200b\u3002</p> <p>\u200b\u5bf9\u6bd4\u200b\u4ee5\u4e0a\u200b\u4e24\u79cd\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u7406\u89e3\u200b\u4e3a\u200b\uff0c\u200b\u7ba1\u9053\u200b\u672c\u8d28\u200b\u4e0a\u200b\u5c31\u662f\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\uff0c\u200b\u524d\u9762\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u4ee5\u5199\u200b\u65b9\u5f0f\u200b\u6253\u5f00\u200b\u6587\u4ef6\u200b\uff0c\u200b\u540e\u9762\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u4ee5\u8bfb\u200b\u65b9\u5f0f\u200b\u6253\u5f00\u200b\u3002\u200b\u8fd9\u6837\u200b\u524d\u9762\u200b\u5199\u200b\u5b8c\u200b\u540e\u9762\u200b\u8bfb\u200b\uff0c\u200b\u4e8e\u662f\u200b\u5c31\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u901a\u4fe1\u200b\u3002\u200b\u5b9e\u9645\u4e0a\u200b\u7ba1\u9053\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u4e5f\u200b\u662f\u200b\u9075\u5faa\u200bUNIX\u200b\u7684\u200b\u201c\u200b\u4e00\u5207\u200b\u7686\u200b\u6587\u4ef6\u200b\u201d\u200b\u8bbe\u8ba1\u200b\u539f\u5219\u200b\u7684\u200b\uff0c\u200b\u5b83\u200b\u672c\u8d28\u200b\u4e0a\u200b\u5c31\u662f\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u3002Linux\u200b\u7cfb\u7edf\u200b\u76f4\u63a5\u200b\u628a\u200b\u7ba1\u9053\u200b\u5b9e\u73b0\u200b\u6210\u200b\u4e86\u200b\u4e00\u79cd\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u501f\u52a9\u200bVFS\u200b\u7ed9\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u63d0\u4f9b\u200b\u64cd\u4f5c\u200b\u63a5\u53e3\u200b\u3002</p> <p>\u200b\u867d\u7136\u200b\u5b9e\u73b0\u200b\u5f62\u6001\u200b\u4e0a\u200b\u662f\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4f46\u662f\u200b\u7ba1\u9053\u200b\u672c\u8eab\u200b\u5e76\u200b\u4e0d\u200b\u5360\u7528\u200b\u78c1\u76d8\u200b\u6216\u8005\u200b\u5176\u4ed6\u200b\u5916\u90e8\u200b\u5b58\u50a8\u200b\u7684\u200b\u7a7a\u95f4\u200b\u3002\u200b\u5728\u200bLinux\u200b\u7684\u200b\u5b9e\u73b0\u200b\u4e0a\u200b\uff0c\u200b\u5b83\u200b\u5360\u7528\u200b\u7684\u200b\u662f\u200b\u5185\u5b58\u7a7a\u95f4\u200b\u3002\u200b\u6240\u4ee5\u200b\uff0cLinux\u200b\u4e0a\u200b\u7684\u200b\u7ba1\u9053\u200b\u5c31\u662f\u200b\u4e00\u4e2a\u200b\u64cd\u4f5c\u200b\u65b9\u5f0f\u200b\u4e3a\u200b\u6587\u4ef6\u200b\u7684\u200b\u5185\u5b58\u200b\u7f13\u51b2\u533a\u200b\u3002</p>"},{"location":"env/","title":"\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u642d\u5efa\u200b\u4ee5\u53ca\u200b\u73af\u5883\u200b\u914d\u7f6e","text":"<p>\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u4e86\u200b \u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b \u200b\u4f9b\u200b\u540c\u5b66\u200b\u4eec\u200b\u505a\u200b\u5b9e\u9a8c\u200b\u3002\u200b\u5f53\u7136\u200b\uff0c\u200b\u540c\u5b66\u200b\u4eec\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5c1d\u8bd5\u200b\u81ea\u5df1\u200b\u90e8\u7f72\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\uff0c\u200b\u4f53\u9a8c\u200b\u4e00\u4e0b\u200b\u81ea\u5df1\u200b\u52a8\u624b\u200b\u7684\u200b\u4e50\u8da3\u200b: )</p>"},{"location":"env/#1","title":"1. \u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0","text":"<p>\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u5df2\u7ecf\u200b\u5c06\u200bXV6\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u90e8\u7f72\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u4e2d\u5fc3\u200b\u7684\u200b\u670d\u52a1\u5668\u200b\u4e0a\u200b\uff0c\u200b\u6211\u4eec\u200b\u628a\u200b\u6240\u6709\u200b\u4f9d\u8d56\u200b\u7684\u200b\u914d\u7f6e\u200b\u90fd\u200b\u5df2\u7ecf\u200b\u4e8b\u5148\u200b\u642d\u5efa\u200b\u5b8c\u6bd5\u200b\u3002\u200b\u65e0\u8bba\u200b\u4f60\u200b\u7684\u200b\u7535\u8111\u200b\u6027\u80fd\u200b\u5982\u4f55\u200b\uff0c\u200b\u65e0\u8bba\u200b\u4f60\u200b\u662f\u200b\u5728\u200b\u5bbf\u820d\u200b\u3001\u200b\u5b9e\u9a8c\u5ba4\u200b\u8fd8\u662f\u200b\u81ea\u4e60\u5ba4\u200b\uff0c\u200b\u53ea\u8981\u200b\u4f60\u200b\u8fd8\u200b\u80fd\u200b\u8fde\u200b\u4e0a\u200b\u6821\u56ed\u7f51\u200b\uff0c\u200b\u4f60\u200b\u5c31\u200b\u80fd\u200b\u5b8c\u6210\u200b\u4f60\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u3002\u200b\u5177\u4f53\u200b\u8be6\u89c1\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u4f7f\u7528\u6307\u5357\u200b\u3002</p> <p>Warning</p> <p>\u200b\u867d\u7136\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u505a\u200b\u4e86\u200b\u4e00\u4e9b\u200b\u65b9\u6848\u200b\u4fdd\u8bc1\u200b\u8fdc\u7a0b\u200b\u73af\u5883\u200b\u7684\u200b\u53ef\u9760\u6027\u200b\uff0c\u200b\u4f46\u200b\u5728\u200b\u67d0\u4e9b\u200b\u7279\u6b8a\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u4e5f\u200b\u4e0d\u80fd\u200b\u786e\u4fdd\u200b\u4e0d\u200b\u51fa\u200b\u6545\u969c\u200b\uff0c\u200b\u4e3a\u200b\u5b89\u5168\u200b\u8d77\u200b\u89c1\u200b\uff0c\u200b\u5efa\u8bae\u200b\u540c\u5b66\u200b\u4eec\u200b\u5c06\u200b\u4ee3\u7801\u200b\u53ca\u65f6\u200b\u4e0a\u200b\u4f20\u5230\u200bgit\u200b\u4ed3\u5e93\u200b\u6216\u8005\u200b\u4e0b\u8f7d\u200b\u5230\u200b\u672c\u5730\u200b\u4fdd\u5b58\u200b\u3002</p>"},{"location":"env/#2","title":"2.  \u200b\u81ea\u884c\u200b\u90e8\u7f72\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u73af\u5883","text":"<p>Note</p> <p>\u200b\u6211\u4eec\u200b\u5728\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u4e0a\u200b\u5df2\u7ecf\u200b\u90e8\u7f72\u200b\u597d\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\uff0c\u200b\u4f60\u200b\u53ea\u200b\u9700\u8981\u200b\u6309\u7167\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u7f16\u5199\u200b\u76f8\u5e94\u200b\u7684\u200b\u4ee3\u7801\u200b\u5c31\u884c\u200b\u3002\u200b\u4f46\u200b\u5b9e\u9645\u4e0a\u200b\uff0c\u200b\u4f60\u200b\u65e0\u6cd5\u200b\u77e5\u9053\u200b\u9879\u76ee\u200b\u91cc\u200b\u7684\u200b\u6240\u6709\u200b\u7ec6\u8282\u200b\uff0c\u200b\u96be\u4ee5\u200b\u638c\u63e1\u200b\u6574\u4e2a\u200b\u9879\u76ee\u200b\u7684\u200b\u67b6\u6784\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u540c\u5b66\u200b\u4eec\u200b\u80fd\u591f\u200b\u81ea\u5df1\u200b\u52a8\u624b\u200b\u642d\u5efa\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\uff0c\u200b\u8fd9\u6837\u200b\u4f60\u200b\u5f97\u5230\u200b\u7684\u200b\u6536\u83b7\u200b\u624d\u200b\u662f\u200b\u6700\u5927\u200b\u7684\u200b: )</p> <p>\u200b\u7528\u4e8e\u200b\u90e8\u7f72\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u5de5\u5177\u200b</p> <p>\u200b\u5bf9\u4e8e\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u642d\u5efa\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u7528\u5230\u200b\u51e0\u4e2a\u200b\u5de5\u5177\u200b\uff1a</p> <ul> <li>VirtualBox\u200b\u865a\u62df\u673a\u200b</li> </ul> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b\u7535\u8111\u200b\u88c5\u200b\u7684\u200b\u662f\u200bWindows\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5fc5\u987b\u200b\u8981\u88c5\u200b\u4e00\u4e2a\u200b\u80fd\u200b\u8fd0\u884c\u200bLinux\u200b\u7cfb\u7edf\u200b\u7684\u200b\u865a\u62df\u673a\u200b\u3002VirtualBox\u200b\u662f\u200b\u4e00\u6b3e\u200b\u5f00\u6e90\u200b\u865a\u62df\u673a\u200b\u8f6f\u4ef6\u200b\uff0c\u200b\u76f8\u5bf9\u200bVMWare\u200b\u7b49\u200b\u5176\u4ed6\u200b\u865a\u62df\u673a\u200b\u6765\u8bf4\u200b\uff0c\u200b\u901f\u5ea6\u200b\u7a0d\u6162\u200b\uff0c\u200b\u7075\u6d3b\u6027\u200b\u8f83\u5dee\u200b\uff0c\u200b\u4f46\u200b\u514d\u8d39\u200b\uff01</p> <ul> <li>Linux\u200b\u53d1\u884c\u7248\u200b</li> </ul> <p>Linux\u200b\u53d1\u884c\u7248\u200b\u662f\u200b\u7531\u200bLinux\u200b\u5185\u6838\u200b\u3001GNU\u200b\u5de5\u5177\u200b\u3001\u200b\u9644\u52a0\u200b\u8f6f\u4ef6\u200b\u548c\u200b\u8f6f\u4ef6\u5305\u200b\u7ba1\u7406\u5668\u200b\u7ec4\u6210\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u3002\u200b\u6240\u8c13\u200b\u201c\u200b\u53d1\u884c\u200b\u201d\uff0c\u200b\u662f\u200b\u7531\u200b\u67d0\u4e9b\u200b\u673a\u6784\u200b\u201c\u200b\u53d1\u884c\u200b\u201d\u200b\u4e86\u200bLinux\u200b\u5185\u6838\u200b\u4ee5\u53ca\u200b\u6240\u6709\u200b\u5fc5\u8981\u200b\u7684\u200b\u8f6f\u4ef6\u200b\u53ca\u200b\u5b9e\u7528\u7a0b\u5e8f\u200b\uff0c\u200b\u4f7f\u200b\u5176\u200b\u53ef\u4ee5\u200b\u4f5c\u4e3a\u200b\u4e00\u4e2a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4f7f\u7528\u200b\u3002\u200b\u4e3b\u6d41\u200b\u7684\u200bLinux\u200b\u53d1\u884c\u7248\u200b\u6709\u200bUbuntu\u3001Debian\u3001Fedora\u3001Centos\u200b\u7b49\u200b\uff0c\u200b\u56fd\u4ea7\u200bLinux\u200b\u53d1\u884c\u7248\u200b\u6709\u200bopenEuler\u3001Deepin\u200b\u7b49\u200b\uff0c\u200b\u4e3a\u200b\u652f\u6301\u200b\u56fd\u4ea7\u200bLinux\u200b\u53d1\u884c\u7248\u200b\uff0c\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u540c\u5b66\u200b\u4eec\u200b\u4f7f\u7528\u200b\u534e\u4e3a\u516c\u53f8\u200b\u53d1\u884c\u200b\u7684\u200b openEuler \u200b\u4f5c\u4e3a\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\uff0c\u200b\u4ee5\u6b64\u200b\u63ed\u5f00\u200bopenEuler\u200b\u7684\u200b\u795e\u79d8\u200b\u9762\u7eb1\u200b: )</p> <ul> <li>RISC-V\u200b\u5de5\u5177\u200b\u94fe\u200b</li> </ul> <p>\u200b\u5305\u62ec\u200b\u4e00\u7cfb\u5217\u200b\u4ea4\u53c9\u200b\u7f16\u8bd1\u200b\u7684\u200b\u5de5\u5177\u200b\uff0c\u200b\u7528\u4e8e\u200b\u628a\u200b\u6e90\u7801\u200b\u7f16\u8bd1\u6210\u200b\u673a\u5668\u7801\u200b\uff0c\u200b\u5982\u200bgcc\u3001binutils\u3001glibc\u200b\u7b49\u200b\u3002</p> <ul> <li>QEMU\u200b\u6a21\u62df\u5668\u200b</li> </ul> <p>qemu\u200b\u6a21\u62df\u5668\u200b\u7528\u4e8e\u200b\u5728\u200b\u7535\u8111\u200b\uff08X86\uff09\u200b\u4e0a\u200b\u6a21\u62df\u200bRISC-V\u200b\u67b6\u6784\u200b\u7684\u200bCPU\u3002\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u901a\u8fc7\u200bqemu\u200b\u6a21\u62df\u5668\u200b\u6765\u200b\u89c2\u5bdf\u200bxv6\u200b\u7684\u200b\u8fd0\u884c\u200b\u8fc7\u7a0b\u200b\u3002QEMU\u200b\u672c\u8d28\u200b\u4e0a\u200b\u662f\u200b\u901a\u8fc7\u200b\u9ad8\u7ea7\u200b\u8bed\u8a00\u200b\u6765\u200b\u6a21\u62df\u200b\u4eff\u771f\u200bRISC-V\u200b\u5904\u7406\u5668\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u6bcf\u200b\u4e00\u4e2a\u200bCPU\u200b\u6838\u200b\uff0cQEMU\u200b\u90fd\u200b\u4f1a\u200b\u8fd0\u884c\u200b\u8fd9\u4e48\u200b\u4e00\u4e2a\u200b\u5faa\u73af\u200b\uff1a (1)\u200b\u53d6\u6307\u200b\uff1a\u200b\u8bfb\u53d6\u200b4/8\u200b\u5b57\u8282\u200b\u7684\u200bRISC-V\u200b\u6307\u4ee4\u200b\uff1b (2)\u200b\u8bd1\u7801\u200b\uff1a\u200b\u89e3\u6790\u200bRISC-V\u200b\u6307\u4ee4\u200b\uff0c\u200b\u5e76\u200b\u627e\u51fa\u200b\u5bf9\u5e94\u200b\u7684\u200bOP code\uff1b (3)\u200b\u6267\u884c\u200b\uff1a\u200b\u5728\u200b\u8f6f\u4ef6\u200b\u4e2d\u200b\u6267\u884c\u200b\u76f8\u5e94\u200b\u7684\u200b\u6307\u4ee4\u200b\u3002 QEMU\u200b\u4e3b\u200b\u5faa\u73af\u200b\u91cc\u200b\u4e5f\u200b\u9700\u8981\u200b\u6709\u200b\u5bc4\u5b58\u5668\u200b\u6587\u4ef6\u200b\uff0c\u200b\u7528\u4e8e\u200b\u7ef4\u62a4\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u72b6\u6001\u200b\u3002\u200b\u56de\u60f3\u200b\u6211\u4eec\u200b\u5728\u200b\u300a\u200b\u8ba1\u7b97\u673a\u200b\u8bbe\u8ba1\u200b\u4e0e\u200b\u5b9e\u8df5\u200b\u300b\u200b\u7684\u200bCPU\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u662f\u4e0d\u662f\u200b\u6709\u200b\u4f3c\u66fe\u76f8\u8bc6\u200b\u7684\u200b\u611f\u89c9\u200b: )</p> <p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b</p> <p>\u200b\u8bf7\u200b\u786e\u4fdd\u200b\u4f60\u200b\u5df2\u7ecf\u200b\u5b89\u88c5\u200b\u6709\u200bubuntu\u3001Centos\u200b\u6216\u200bDebian\u200b\u7b49\u200b\u5176\u4ed6\u200bLinux\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u4e0b\u9762\u200b\u7684\u200b\u5b89\u88c5\u200b\u6b65\u9aa4\u200b\u4ee5\u200bUbuntu\u200b\u7cfb\u7edf\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u5982\u679c\u200b\u662f\u200b\u5176\u4ed6\u200bLinux\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u5176\u200b\u5177\u4f53\u200b\u5b89\u88c5\u200b\u6b65\u9aa4\u200b\u8bf7\u200b\u53c2\u8003\u200b:https://pdos.csail.mit.edu/6.S081/2020/tools.html</p>"},{"location":"env/#21-xv6","title":"2.1 XV6\u200b\u73af\u5883\u200b\u914d\u7f6e","text":""},{"location":"env/#211","title":"2.1.1 \u200b\u5b89\u88c5\u200b\u4f9d\u8d56\u200b\u5305","text":"<p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b</p> <p>\u200b\u7b2c\u4e00\u4e2a\u200b\u5b57\u7b26\u200b\u201c#\u201d\u200b\u6216\u200b\"$\"\u200b\u4e0d\u200b\u9700\u8981\u200b\u8f93\u5165\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u8f93\u5165\u200b\u201c#\u201d\u200b\u6216\u200b\"$\"\u200b\u540e\u200b\u7684\u200b\u5b57\u7b26\u4e32\u200b\u3002</p> <p>\u200b\u5b89\u88c5\u200bXV6\u200b\u9700\u8981\u200b\u7528\u5230\u200b\u7684\u200b\u4f9d\u8d56\u200b\u5305\u200b</p> <pre><code>$ sudo apt-get install git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu </code></pre>"},{"location":"env/#212-risc-v-gnu","title":"2.1.2 \u200b\u5b89\u88c5\u200bRISC-V GNU\u200b\u7f16\u8bd1\u5668\u200b\u5de5\u5177\u200b\u94fe","text":"<pre><code>$ git clone --recursive https://github.com/riscv/riscv-gnu-toolchain\n</code></pre> <p>\u200b\u5982\u679c\u200b\u4e0b\u8f7d\u200b\u592a\u6162\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u7528\u200b\u5df2\u7ecf\u200b\u4e0b\u8f7d\u200b\u597d\u200b\u7684\u200b\u5305\u200b\u3002</p> <p>\u200b\u4e0b\u8f7d\u200b\u5730\u5740\u200b\uff1a https://mirrors.osa.moe/misc/\uff0c \u200b\u9009\u62e9\u200briscv-gnu-toolchain.tar.gz\u3002\u200b\u4e0b\u8f7d\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u9700\u8981\u200b\u5c06\u200briscv-gnu-toolchain.tar.gz\u200b\u4e0a\u4f20\u200b\u81f3\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\uff0c\u200b\u4e0a\u4f20\u200b\u65b9\u6cd5\u200b\u8be6\u89c1\u200bMobaXterm(SSH\u200b\u5de5\u5177\u200b)\u200b\u8fd9\u200b\u4e00\u8282\u200b\u4e2d\u200b\u7684\u200b\u6587\u4ef6\u4f20\u8f93\u200bSFTP\u200b\u670d\u52a1\u200b\u3002\u200b\u4e0a\u200b\u4f20\u5230\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\uff0c\u200b\u9700\u8981\u200b\u5bf9\u200bRISC-V GNU\u200b\u7f16\u8bd1\u5668\u200b\u5de5\u5177\u200b\u94fe\u200b\u8fdb\u884c\u200b\u89e3\u538b\u200b\uff0c\u200b\u89e3\u538b\u200b\u547d\u4ee4\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>$ tar zxvf riscv-gnu-toolchain.tar.gz\n</code></pre> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u4e0b\u8f7d\u200b\u7f16\u8bd1\u200b\u5de5\u5177\u200b\u94fe\u200b\u6240\u200b\u9700\u200b\u7684\u200b\u4f9d\u8d56\u200b\u5305\u200b\uff1a <pre><code>$ sudo apt-get install autoconf automake autotools-dev curl libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev\n</code></pre></p> <p>\u200b\u5b89\u88c5\u200bRISC-V GNU\u200b\u7f16\u8bd1\u5668\u200b\u5de5\u5177\u200b\u94fe\u200b</p> <pre><code>$ cd riscv-gnu-toolchain\n$ ./configure --prefix=/usr/local\n$ sudo make\n$ cd ..\n\n$ rm riscv-gnu-toolchain.tar.gz\nrm: remove regular file 'riscv-gnu-toolchain.tar.gz'? y\n$ \n</code></pre>"},{"location":"env/#213-qemu","title":"2.1.3 \u200b\u5b89\u88c5\u200bQEMU","text":"<p>\u200b\u4e0b\u8f7d\u200bQEMU</p> <pre><code>$ wget https://download.qemu.org/qemu-5.1.0.tar.xz\n$ tar xf qemu-5.1.0.tar.xz\n</code></pre> <p>\u200b\u5b89\u88c5\u200b</p> <pre><code>$ cd qemu-5.1.0\n$ ./configure --disable-kvm --disable-werror --prefix=/usr/local --target-list=\"riscv64-softmmu\"\n$ make\n$ make install\n$ cd ..\n\n$ rm qemu-5.1.0.tar.xz\nrm: remove regular file 'qemu-5.1.0.tar.xz'? y\n$ \n</code></pre> <p>\u200b\u68c0\u67e5\u200b\u5b89\u88c5\u200b\u662f\u5426\u200b\u6210\u529f\u200b</p> <pre><code>$ riscv64-unknown-elf-gcc --version\nriscv64-unknown-elf-gcc (GCC) 10.2.0\n...\n\n$ qemu-system-riscv64 --version\nQEMU emulator version 5.1.0\n</code></pre>"},{"location":"env/#22-xv6","title":"2.2 \u200b\u8fd0\u884c\u200bXV6","text":"<p><pre><code>$ git clone https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git\nCloning into 'xv6-oslab23-hitsz'...\n...\n# \u200b\u5982\u679c\u200b\u662f\u200b\u521d\u6b21\u200b\u8fd0\u884c\u200bgit\uff0c\u200b\u8bbe\u7f6e\u200b\u4f60\u200b\u81ea\u5df1\u200b\u7684\u200bgitee\u200b\u7528\u6237\u200b\u4fe1\u606f\u200b\n$ git config --global user.email \"you@example.com\"\n$ git config --global user.name \"Your Name\"\n...\n$ cd xv6-oslab23-hitsz\n$ git checkout util\n$ make qemu\n# ... lots of output ...\ninit: starting sh\n$\n</code></pre> \u200b\u5f53\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u201cinit: starting sh\u201d\u200b\u7684\u200b\u5b57\u6837\u200b\u8868\u793a\u200bxv6\u200b\u5df2\u7ecf\u200b\u6b63\u5e38\u200b\u542f\u52a8\u200b\uff0c\u200b\u6b64\u65f6\u200b\u5728\u200b\u201c$\u201d\u200b\u63d0\u793a\u7b26\u200b\u540e\u200b\u53ef\u200b\u8f93\u5165\u200bxv6\u200b\u652f\u6301\u200b\u7684\u200bshell\u200b\u547d\u4ee4\u200b\u3002</p> <p>QEMU\u200b\u9000\u51fa\u200b\u65b9\u6cd5\u200b</p> <p>\u200b\u5148\u200b\u6309\u200b\u201cCtrl+a\u201d\u200b\u7ec4\u5408\u952e\u200b\uff0c\u200b\u63a5\u7740\u200b\u5168\u90e8\u200b\u677e\u5f00\u200b\uff0c\u200b\u518d\u200b\u6309\u200b\u4e0b\u200b\u201cx\u201d\u200b\u952e\u200b</p> <p>\u200b\u81f3\u6b64\u200b\uff0cXV6\u200b\u5df2\u7ecf\u200b\u80fd\u591f\u200b\u6b63\u5e38\u200b\u8fd0\u884c\u200b\u4e86\u200b: )</p>"},{"location":"remote_env/","title":"\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u4f7f\u7528\u6307\u5357","text":"<p>\u200b\u901a\u77e5\u200b</p> <p>\u200b\u4e25\u7981\u200b\u4f7f\u7528\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u505a\u200b\u4e0e\u200b\u6559\u5b66\u200b\u65e0\u5173\u200b\u4e8b\u5b9c\u200b\uff0c\u200b\u675c\u7edd\u200b\u4f7f\u7528\u200b\u516c\u5171\u8d44\u6e90\u200b\u6316\u77ff\u200b\u7b49\u200b\uff0c\u200b\u4e00\u7ecf\u200b\u53d1\u73b0\u200b\u5c06\u200b\u4e25\u8083\u5904\u7406\u200b\uff0c\u200b\u611f\u8c22\u200b\u914d\u5408\u200b\uff01</p>"},{"location":"remote_env/#0","title":"0 \u200b\u901f\u67e5\u200b\u4fe1\u606f","text":"<p>\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200bIP\u200b\u5730\u5740\u200b\uff1a <code>10.249.12.98</code> \uff0c\u200b\u7aef\u53e3\u53f7\u200b\uff1a <code>6666</code></p> <p>\u200b\u6ca1\u9519\u200b: ) \u200b\u672c\u200b\u8bfe\u7a0b\u200b\u4e0e\u200b\u300a\u200b\u8ba1\u7b97\u673a\u200b\u8bbe\u8ba1\u200b\u4e0e\u200b\u5b9e\u8df5\u200b\u300b\u200b\u5171\u7528\u200b\u540c\u4e00\u4e2a\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u3002\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u5728\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u4e0a\u200b\u90e8\u7f72\u200b\u4e86\u200bXV6\u200b\u7684\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\uff0c\u200b\u4f60\u200b\u53ea\u200b\u9700\u8981\u200b\u767b\u5f55\u200b\u540e\u200b\u4e0b\u8f7d\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u505a\u200b\u5b9e\u9a8c\u200b\u3002</p> <p>\u200b\u7528\u6237\u540d\u200b\u548c\u200b\u521d\u59cb\u5bc6\u7801\u200b\u90fd\u200b\u662f\u200b<code>\u200b\u4f60\u200b\u7684\u200b\u5b66\u53f7\u200b</code>\uff0c\u200b\u51fa\u4e8e\u200b\u5b89\u5168\u200b\u8003\u8651\u200b\uff0c\u200b\u5efa\u8bae\u200b\u4f60\u200b\u521d\u6b21\u200b\u767b\u5f55\u200b\u540e\u200b\u4fee\u6539\u200b\u521d\u59cb\u5bc6\u7801\u200b\u3002\u200b\u5982\u679c\u200b\u9047\u5230\u200b\u95ee\u9898\u200b\uff0c\u200b\u8bf7\u200b\u5bfb\u6c42\u200b\u52a9\u6559\u200b\u6216\u200b\u8001\u5e08\u200b\u7684\u200b\u5e2e\u52a9\u200b\u3002</p> <p>\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u5171\u6709\u200b8\u200b\u4e2a\u200b\u8ba1\u7b97\u200b\u8282\u70b9\u200b\uff0c\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u8ba1\u7b97\u200b\u8282\u70b9\u200b\u90fd\u200b\u63d0\u4f9b\u200b\u76f8\u540c\u200b\u7684\u200b\u670d\u52a1\u200b\uff0c\u200b\u53ef\u80fd\u200b\u4f60\u200b\u6bcf\u6b21\u200b\u767b\u5f55\u200b\u7684\u200b\u8ba1\u7b97\u200b\u8282\u70b9\u200b\u4f1a\u200b\u4e0d\u200b\u4e00\u6837\u200b\uff0c\u200b\u4f46\u200b\u65e0\u987b\u200b\u62c5\u5fc3\u200b\uff0c\u200b\u4f60\u200b\u770b\u5230\u200b\u7684\u200b\u6587\u4ef6\u200b\u90fd\u200b\u662f\u200b\u4e00\u6837\u200b\u7684\u200b\u3002</p>"},{"location":"remote_env/#1","title":"1 \u200b\u5feb\u901f\u200b\u5165\u95e8","text":""},{"location":"remote_env/#11","title":"1.1 \u200b\u73af\u5883\u200b\u51c6\u5907","text":"<p>\u200b\u9700\u8981\u200b\u914d\u5408\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u4f7f\u7528\u200b\u7684\u200b\u8f6f\u4ef6\u200b\uff1a</p> <ul> <li>Visual Studio Code\uff08\u200b\u5fc5\u987b\u200b\uff09</li> <li>MobaXterm\uff08\u200b\u63a8\u8350\u200b\uff09</li> </ul>"},{"location":"remote_env/#111-visual-studio-code","title":"1.1.1 \u200b\u5982\u4f55\u200b\u5b89\u88c5\u200bVisual Studio Code\uff1f","text":"<p>\u200b\u6253\u5f00\u200bVisual Studio Code\u200b\u7684\u200b\u5b98\u65b9\u7f51\u7ad9\u200b\uff0c\u200b\u70b9\u51fb\u200b\u4e2d\u95f4\u200b\u7684\u200b\u201cDownload for Windows\u201d\u200b\u4e0b\u8f7d\u200b\u5b83\u200b\u7684\u200b\u5b89\u88c5\u5305\u200b\u3002\u200b\u53cc\u51fb\u200b\u8fd0\u884c\u200b\u5b89\u88c5\u5305\u200b\uff0c\u200b\u5e76\u200b\u5b8c\u6210\u200b\u5b89\u88c5\u200b\u5373\u53ef\u200b\u3002\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u5f00\u59cb\u83dc\u5355\u200b\u627e\u5230\u200b\u65b0\u200b\u5b89\u88c5\u200b\u4e0a\u200b\u7684\u200bVisual Studio Code\u3002</p>"},{"location":"remote_env/#12","title":"1.2 \u200b\u8fde\u63a5\u200b\u5230\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0","text":""},{"location":"remote_env/#121-visual-studio-code","title":"1.2.1 \u200b\u5c06\u200bVisual Studio Code\u200b\u8fde\u63a5\u200b\u5230\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0","text":"<p>Visual Studio Code\u200b\u5b89\u88c5\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u4ece\u200b\u5f00\u59cb\u83dc\u5355\u200b\u6253\u5f00\u200b\u5b83\u200b\u3002\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5b89\u88c5\u200bRemote - SSH\u200b\u63d2\u4ef6\u200b\u3002\u200b\u70b9\u51fb\u200bVSCode\u200b\u5de6\u4fa7\u200b\u6269\u5c55\u200b(extension)\u200b\u6309\u94ae\u200b\uff0c\u200b\u5728\u200b\u641c\u7d22\u200b\u6846\u4e2d\u200b\u952e\u5165\u200b\u201cremote ssh\u201d\uff0c\u200b\u70b9\u51fb\u200bRemote - SSH\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u5b89\u88c5\u200b\u3002</p> <p></p> <p>\u200b\u5de6\u4fa7\u200b\u8fb9\u680f\u200b\u5e94\u8be5\u200b\u4f1a\u200b\u591a\u51fa\u200b\u4e00\u4e2a\u200b\u8fd9\u6837\u200b\u7684\u200b\u56fe\u6807\u200b\uff1a \u200b\u70b9\u51fb\u200b\u8fd9\u4e2a\u200b\u56fe\u6807\u200b\uff0c\u200b\u9009\u62e9\u200bSSH TARGETS\u200b\u53f3\u4fa7\u200b\u7684\u200b<code>+</code>\u200b\u53f7\u200b\uff1a</p> <p>\u200b\u8fd9\u4f1a\u200b\u5728\u200b\u5c4f\u5e55\u200b\u4e0a\u65b9\u200b\u4e2d\u592e\u200b\u5f39\u200b\u51fa\u200b\u8f93\u5165\u6846\u200b\uff0c\u200b\u8981\u6c42\u200b\u8f93\u5165\u200bssh\u200b\u6307\u4ee4\u200b\u3002\u200b\u5728\u200b\u8fd9\u91cc\u200b\u8f93\u5165\u200b<code>ssh \u200b\u4f60\u200b\u7684\u200b\u5b66\u53f7\u200b@\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200bIP</code>\uff0c\u200b\u4f8b\u5982\u200b<code>ssh 200110101@10.249.12.98 -p 6666</code>\u200b\u5c31\u662f\u200b\u5b66\u53f7\u200b\u4e3a\u200b200110101\u200b\u7684\u200b\u540c\u5b66\u200b\u5e0c\u671b\u200b\u8fde\u63a5\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u3002</p> <p></p> <p>\u200b\u8f93\u5165\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\u3002\u200b\u5982\u679c\u200b\u5f39\u200b\u51fa\u200b\u4e0b\u56fe\u200b\u6240\u793a\u200b\u7684\u200b\u754c\u9762\u200b\uff0c\u200b\u5219\u200b\u518d\u6b21\u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\uff1a</p> <p></p> <p>\u200b\u73b0\u5728\u200b\uff0cSSH Target\u200b\u6dfb\u52a0\u200b\u6210\u529f\u200b\uff0c\u200b\u5de6\u4fa7\u200bSSH Target\u200b\u4e2d\u200b\u5e94\u8be5\u200b\u589e\u52a0\u200b\u4e86\u200b\u4e00\u680f\u200b\u3002\u200b\u5c06\u200b\u9f20\u6807\u200b\u79fb\u4e0a\u53bb\u200b\uff0c\u200b\u70b9\u51fb\u200b\u8fd9\u200b\u4e00\u680f\u200b\u53f3\u4fa7\u200b\u7684\u200b\u5c0f\u56fe\u6807\u200b\uff1a</p> <p>\u200b\u8fd9\u4f1a\u200b\u6253\u5f00\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200bVSCode\u200b\u7a97\u53e3\u200b\u3002\u200b\u65b0\u200b\u6253\u5f00\u200b\u7684\u200b\u7a97\u53e3\u200b\u4f1a\u200b\u8981\u6c42\u200b\u4f60\u200b\u9009\u62e9\u200b\u76ee\u6807\u200b\u673a\u5668\u200b\u7684\u200b\u5e73\u53f0\u200b\uff0c\u200b\u9009\u62e9\u200bLinux\uff0c\u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\uff1a</p> <p></p> <p>\u200b\u5982\u679c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\u8981\u6c42\u200b\u4f60\u200b\u786e\u8ba4\u200b\u662f\u5426\u200b\u8fde\u63a5\u200b\uff0c\u200b\u5219\u200b\u518d\u6b21\u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\uff1a</p> <p></p> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u5b83\u4f1a\u200b\u8981\u6c42\u200b\u4f60\u200b\u8f93\u5165\u200b\u5bc6\u7801\u200b\u3002\u200b\u521d\u59cb\u5bc6\u7801\u200b\u5373\u5b66\u200b\u53f7\u200b\u3002</p> <p></p> <p>\u200b\u6700\u540e\u200b\u4e00\u6b21\u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\u3002\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u66f4\u200b\u591a\u200b\u63d0\u793a\u200b\uff0c\u200b\u5de6\u4e0b\u89d2\u200b\u663e\u793a\u200b<code>SSH: \u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7684\u200bIP\u200b\u5730\u5740\u200b</code>\uff0c\u200b\u8bf4\u660e\u200b\u8fde\u63a5\u200b\u6210\u529f\u200b\u3002</p> <p></p> <p>\u200b\u73b0\u5728\u200b\uff0c\u200b\u70b9\u51fb\u200b\u4e0b\u65b9\u200b\u7684\u200b\u201c\u200b\u7ec8\u7aef\u200b\u201d\u200b\u6309\u94ae\u200b\uff0c\u200b\u6253\u5f00\u200b\u7ec8\u7aef\u200b\uff1a</p> <p></p> <p>\u200b\u51fa\u4e8e\u200b\u5b89\u5168\u200b\u8003\u8651\u200b\uff0c\u200b\u6211\u4eec\u200b\u9996\u5148\u200b\u4fee\u6539\u200b\u9ed8\u8ba4\u200b\u5bc6\u7801\u200b\u3002 \u200b\u70b9\u51fb\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u5728\u200b\u5176\u4e2d\u200b\u952e\u5165\u200b\u4ee5\u4e0b\u5185\u5bb9\u200b\uff0c\u200b\u5e76\u200b\u56de\u8f66\u200b\uff1a</p> <pre><code>passwd\n</code></pre> <p>\u200b\u6b64\u65f6\u200b\uff0c\u200b\u5b83\u4f1a\u200b\u8981\u6c42\u200b\u4f60\u200b\u8f93\u5165\u200b\u65e7\u200b\u5bc6\u7801\u200b\u3002\u200b\u65e7\u200b\u5bc6\u7801\u200b\uff08\u200b\u5373\u200b\u9ed8\u8ba4\u200b\u5bc6\u7801\u200b\uff09\u200b\u4e3a\u200b\u4f60\u200b\u7684\u200b\u5b66\u53f7\u200b\u3002\u200b\u5b8c\u6210\u200b\u540e\u200b\u56de\u8f66\u200b\u3002 \u200b\u968f\u540e\u200b\uff0c\u200b\u5b83\u4f1a\u200b\u8981\u6c42\u200b\u4f60\u200b\u8f93\u5165\u200b\u65b0\u5bc6\u7801\u200b\uff0c\u200b\u5e76\u200b\u8fdb\u884c\u200b\u786e\u8ba4\u200b\u3002</p> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5b58\u653e\u200bxv6-oslab23-hitsz\u200b\u590d\u5236\u5230\u200b\u81ea\u5df1\u200b\u7684\u200b\u5de5\u4f5c\u200b\u7a7a\u95f4\u200b\u3002 \u200b\u5728\u200b\u7ec8\u7aef\u200b\u4e2d\u200b\u952e\u5165\u200b\u4ee5\u4e0b\u5185\u5bb9\u200b\uff0c\u200b\u5e76\u200b\u56de\u8f66\u200b\uff1a</p> <pre><code>git clone https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git\n</code></pre> <p>\u200b\u4f60\u200b\u5e94\u8be5\u200b\u4f1a\u200b\u770b\u5230\u200b\u8fd9\u6837\u200b\u7684\u200b\u8f93\u51fa\u200b\uff1a</p> <pre><code>Cloning into 'xv6-oslab23-hitsz'...\ndone.\n</code></pre> <p>\u200b\u8fd9\u200b\u4ee3\u8868\u200b\u4f60\u200b\u5df2\u7ecf\u200b\u5c06\u200bxv6\u200b\u7684\u200b\u526f\u672c\u200b\u4e0b\u8f7d\u200b\u5230\u200b\u81ea\u5df1\u200b\u7684\u200b\u5de5\u4f5c\u200b\u7a7a\u95f4\u200b\u4e86\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u70b9\u51fb\u200b\u5de6\u4fa7\u200b\u8fb9\u680f\u200b\u6700\u200b\u4e0a\u9762\u200b\u7684\u200b\u6309\u94ae\u200b\uff0c\u200b\u5e76\u200b\u6253\u5f00\u200b\u6587\u4ef6\u5939\u200b\uff1a</p> <p></p> <p>\u200b\u5728\u200b\u5f39\u51fa\u200b\u7684\u200b\u83dc\u5355\u200b\u4e2d\u200b\uff0c\u200b\u9009\u62e9\u200b<code>xv6-oslab23-hitsz</code>\uff0c\u200b\u5e76\u200b\u6309\u200b\u4e0b\u200b\u201c\u200b\u786e\u8ba4\u200b\u201d\uff1a</p> <p></p> <p>\u200b\u518d\u6b21\u200b\u8f93\u5165\u200b\u5bc6\u7801\u200b\uff0c\u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\u786e\u8ba4\u200b\uff0c\u200b\u5e76\u200b\u4fe1\u4efb\u200b\u4f5c\u8005\u200b\u3002</p> <p></p> <p>\u200b\u4f60\u200b\u521d\u6b65\u200b\u5b8c\u6210\u200b\u4e86\u200b\u5bf9\u200b\u5de5\u4f5c\u200b\u533a\u200b\u7684\u200b\u8bbe\u7f6e\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u6d4b\u8bd5\u200bxv6\u200b\u80fd\u5426\u200b\u6b63\u5e38\u200b\u7f16\u8bd1\u200b\u3001\u200b\u6267\u884c\u200b\u3002 \u200b\u5982\u679c\u200b\u4e0b\u65b9\u200b\u672a\u200b\u663e\u793a\u7ec8\u7aef\u200b\uff0c\u200b\u70b9\u51fb\u200b\u4e0a\u65b9\u200b\u83dc\u5355\u200b\u201c\u200b\u67e5\u770b\u200b\u201d-\u201c\u200b\u7ec8\u7aef\u200b\u201d\uff0c\u200b\u6216\u8005\u200b\u6309\u4e0b\u200bCtrl-`\uff08\u200b\u6ce8\u610f\u200b\uff1a`\u200b\u4e0d\u662f\u200b\u2018\uff08\u200b\u5355\u5f15\u53f7\u200b\uff09\uff0c\u200b\u662f\u200b\u952e\u76d8\u200b\u5de6\u4e0a\u89d2\u200b\u7684\u200b\u90a3\u4e2a\u200b\u6309\u952e\u200b\u3002\uff09\u200b\u4ee5\u200b\u6253\u5f00\u200b\u7ec8\u7aef\u200b\u754c\u9762\u200b\u3002\u200b\u5728\u200b\u65b0\u5f39\u200b\u51fa\u200b\u7684\u200b\u7ec8\u7aef\u200b\u4e2d\u200b\uff0c\u200b\u8f93\u5165\u200b\u4e0b\u9762\u200b\u7684\u200b\u547d\u4ee4\u200b\uff0c\u200b\u4ee5\u200b\u7f16\u8bd1\u200b\u5e76\u200b\u5728\u200bQEMU\u200b\u4e2d\u200b\u8fd0\u884c\u200bxv6\uff1a</p> <pre><code>make qemu\n</code></pre> <p>\u200b\u5982\u679c\u200b\u770b\u5230\u200b\u8bb8\u591a\u200b\u8f93\u51fa\u200b\uff0c\u200b\u5e76\u200b\u6700\u7ec8\u200b\u505c\u7559\u200b\u5728\u200b\u8fd9\u4e2a\u200b\u8f93\u51fa\u200b\u4e0a\u200b\uff1a</p> <pre><code>xv6 kernel is booting\n\nhart 2 starting\nhart 1 starting\ninit: starting sh\n$\n</code></pre> <p>\u200b\u90a3\u4e48\u200b\u8bf4\u660e\u200b\u4f60\u200b\u7684\u200b\u73af\u5883\u200b\u5df2\u7ecf\u200b\u914d\u7f6e\u200b\u5b8c\u6210\u200b\u3002\u200b\u540c\u65f6\u200b\u6309\u4e0b\u200bCtrl + A\uff0c\u200b\u5168\u90e8\u200b\u677e\u5f00\u200b\uff0c\u200b\u518d\u200b\u6309\u200b\u4e0b\u200bx\u200b\u4ee5\u200b\u9000\u51fa\u200bQEMU\u3002 \u200b\u5982\u679c\u200b\u9047\u5230\u200b\u95ee\u9898\u200b\uff0c\u200b\u8bf7\u200b\u8be2\u95ee\u200b\u8001\u5e08\u200b\u6216\u200b\u52a9\u6559\u200b\u3002</p>"},{"location":"remote_env/#_2","title":"\u9644\u5f55","text":""},{"location":"remote_env/#_3","title":"\u4e00\u4e9b\u200b\u8fdb\u9636\u200b\u6307\u5f15","text":""},{"location":"remote_env/#ssh","title":"\u4f7f\u7528\u200bssh\u200b\u5bc6\u94a5\u200b\u5feb\u6377\u200b\u8ba4\u8bc1","text":"<p>\u200b\u6709\u6ca1\u6709\u200b\u611f\u89c9\u200b\u6bcf\u6b21\u200b\u90fd\u200b\u8981\u200b\u8f93\u5165\u200b\u5bc6\u7801\u200b\u975e\u5e38\u200b\u9ebb\u70e6\u200b\uff1fssh\u200b\u5bc6\u94a5\u200b\u53ef\u4ee5\u200b\u8ba9\u200b\u8ba4\u8bc1\u200b\u6d41\u7a0b\u200b\u81ea\u52a8\u5316\u200b\uff0c\u200b\u5927\u5927\u200b\u89e3\u653e\u200b\u53cc\u624b\u200b\u3002\u200b\u5728\u200b \u200b\u672c\u5730\u200b windows\u200b\u4e0b\u200b\uff0c\u200b\u4ee5\u200b\u7ba1\u7406\u5458\u200b\u8eab\u4efd\u200b\u6253\u5f00\u200bCMD\uff0c\u200b\u8f93\u5165\u200b</p> <pre><code>ssh-keygen\n</code></pre> <p>\u200b\u8ddf\u968f\u200b\u6307\u5f15\u200b\uff0c\u200b\u4e00\u8def\u200b\u56de\u8f66\u200b\uff0c\u200b\u4fbf\u200b\u53ef\u200b\u5b8c\u6210\u200bssh\u200b\u5bc6\u94a5\u200b\u7684\u200b\u751f\u6210\u200b\u3002\u200b\u8bf7\u200b\u52a1\u5fc5\u200b\u4fdd\u5b58\u200b\u597d\u200b\u81ea\u5df1\u200b\u7684\u200b\u79c1\u94a5\u200b\uff0c\u200b\u4e0d\u8981\u200b\u6cc4\u9732\u200b\uff01</p> <p></p> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u79c1\u94a5\u200b\u52a0\u5165\u200b\u5230\u200b\u81ea\u5df1\u200b\u7684\u200b\u8eab\u4efd\u200b\u8ba4\u8bc1\u200b\u4e2d\u200b\u3002\u200b\u5728\u200b\u7ec8\u7aef\u200b\u7ee7\u7eed\u200b\u8f93\u5165\u200b\uff1a</p> <pre><code>ssh-add \u200b\u4f60\u200b\u7684\u200b\u79c1\u94a5\u200b\u7684\u200b\u5b8c\u6574\u200b\u8def\u5f84\u200b\n# \u200b\u4f8b\u5982\u200b\uff0c\u200b\u5982\u4e0a\u56fe\u200b\u6240\u793a\u200b\uff0c\u200b\u6211\u200b\u5e94\u8be5\u200b\u952e\u5165\u200bssh-add C:\\Users\\willson\\.ssh\\id_rsa_priv_20210909\n</code></pre> <p>\u200b\u5728\u200b\u4f60\u200b\u7684\u200bWindows\u200b\u4e0a\u5c06\u200b\u516c\u94a5\u200b\u6587\u4ef6\u200b\u6253\u5f00\u200b\uff08\u200b\u7528\u200b\u4f60\u200b\u559c\u6b22\u200b\u7684\u200b\u7eaf\u200b\u6587\u672c\u7f16\u8f91\u200b\u5668\u200b\uff0c\u200b\u6bd4\u5982\u200b\u8bb0\u4e8b\u672c\u200b\u6216\u8005\u200bVSCode\uff09\uff0c\u200b\u590d\u5236\u200b\u5176\u4e2d\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u6700\u540e\u200b\uff0c\u200b\u767b\u5f55\u200b\u4f60\u200b\u60f3\u8981\u200b\u5feb\u6377\u200b\u8ba4\u8bc1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u5e76\u200b\u6267\u884c\u200b\u4e0b\u9762\u200b\u7684\u200b\u547d\u4ee4\u200b\uff1a</p> <pre><code>mkdir -p ~/.ssh\nvi ~/.ssh/authorized_keys\n</code></pre> <p>\u200b\u8fd9\u4f1a\u200b\u6253\u5f00\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u7f16\u8f91\u200b\u754c\u9762\u200b\u3002\u200b\u6309\u4e0b\u200b<code>i</code>\u200b\u6309\u952e\u200b\uff0c\u200b\u8fdb\u5165\u200b\u7f16\u8f91\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u5e76\u200b\u7c98\u8d34\u200b\u5230\u200b\u4e0a\u9762\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7ec8\u7aef\u200b\u4e2d\u200b\u7f16\u8f91\u200b\u754c\u9762\u200b\u7684\u200b\u4e00\u4e2a\u200b\u65b0\u884c\u200b\u91cc\u200b\u3002\u200b\u6309\u4e0b\u200b<code>Esc</code>\uff0c\u200b\u6309\u4e0b\u200b<code>:wq</code>\u200b\u53ef\u200b\u4fdd\u5b58\u200b\u5e76\u200b\u9000\u51fa\u200b\u3002\u200b\u5982\u679c\u200b\u4e0d\u200b\u653e\u5fc3\u200b\uff0c\u200b\u53ef\u4ee5\u200b<code>cat ~/.ssh/authorized_keys</code>\u200b\u5e76\u200b\u68c0\u67e5\u200b\u8f93\u51fa\u200b\u548c\u200b\u4f60\u200b\u521a\u624d\u200b\u8d34\u8fdb\u53bb\u200b\u7684\u200b\u662f\u4e0d\u662f\u200b\u4e00\u6837\u200b\u7684\u200b\u3002 \u200b\u914d\u7f6e\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u4e0b\u6b21\u200b\u4f60\u200b\u4ece\u200bWindows\u200b\u767b\u9646\u200b\u65f6\u200b\uff0c\u200b\u5e94\u8be5\u200b\u5c31\u200b\u65e0\u9700\u200b\u5bc6\u7801\u200b\u8ba4\u8bc1\u200b\u4e86\u200b\u3002</p>"},{"location":"remote_env/#visual-studio-code","title":"Visual Studio Code\uff1a\u200b\u8fdb\u9636\u200b\u4f7f\u7528","text":"<p>\u200b\u6709\u6ca1\u6709\u200b\u6000\u5ff5\u200bVisual Studio\u3001CodeBlock\u200b\u7b49\u200bIDE\u200b\u4e2d\u200b\u4fbf\u6377\u200b\u7684\u200b\u4e00\u952e\u200b\u8fd0\u884c\u200b\u529f\u80fd\u200b\uff1f\u200b\u6ca1\u5173\u7cfb\u200b\uff0c\u200b\u5b8c\u5907\u200b\u7684\u200b\u63d2\u4ef6\u200b\u5e02\u573a\u200b\u914d\u5408\u200b\u81ea\u52a8\u5316\u200b\u811a\u672c\u200b\u53ef\u4ee5\u200b\u5b8c\u6210\u200b\u4f60\u200b\u7684\u200b\u4e00\u5207\u200b\u529f\u80fd\u200b\u9700\u6c42\u200b\uff01 \u200b\u4e0b\u200b\u7565\u200b\uff1a\u200b\u611f\u5174\u8da3\u200b\u7684\u8bdd\u200b\u53ef\u4ee5\u200b\u4e86\u89e3\u200b\u4e00\u4e0b\u200bIntelli Sense\u3001MakeFile\u200b\u4ee5\u53ca\u200bVSCode\u200b\u4e2d\u200b\u7684\u200bTask\u3002</p>"},{"location":"remote_env/#qa","title":"Q&amp;A","text":""},{"location":"remote_env/#_4","title":"\u4e3a\u4f55\u200b\u8981\u200b\u4f7f\u7528\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\uff1f","text":"<p>\u200b\u4e3b\u8981\u200b\u662f\u200b\u5b9e\u9a8c\u200b\u642d\u200b\u8d77\u6765\u200b\u6bd4\u8f83\u200b\u9ebb\u70e6\u200b\u3002\u200b\u6709\u200b\u51e0\u4e2a\u200b\u9009\u9879\u200b\u53ef\u4ee5\u200b\u9009\u62e9\u200b\uff0c1\u200b\u662f\u200b\u642d\u5efa\u200b\u4e00\u53f0\u200bLinux\u200b\u865a\u62df\u673a\u200b\uff0c2\u200b\u662f\u200b\u5728\u200b\u81ea\u5df1\u200b\u7535\u8111\u200b\u4e0a\u200b\u542f\u7528\u200bWSL\uff08Windows Subsystem for Linux\uff09\uff0c3\u200b\u662f\u200b\u6574\u200b\u4e00\u53f0\u200b\u8fd0\u884c\u200bLinux\u200b\u7684\u200b\u7535\u8111\u200b\u2014\u2014\u200b\u90fd\u200b\u53ef\u4ee5\u200b\uff0c\u200b\u4f46\u662f\u200b\u90fd\u200b\u633a\u200b\u9ebb\u70e6\u200b\u3002\u200b\u6211\u4eec\u200b\u5e2e\u200b\u4f60\u200b\u628a\u200b\u914d\u7f6e\u200b\u7684\u200b\u9ebb\u70e6\u200b\u4e8b\u5148\u200b\u505a\u200b\u5b8c\u200b\u4e86\u200b\uff0c\u200b\u4e8e\u662f\u200b\u4f60\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u4e13\u5fc3\u200b\u4e8e\u200b\u5b9e\u9a8c\u200b\u672c\u8eab\u200b\u3002\u200b\u65e0\u8bba\u200b\u4f60\u200b\u7684\u200b\u7535\u8111\u200b\u6027\u80fd\u200b\u5982\u4f55\u200b\uff0c\u200b\u65e0\u8bba\u200b\u4f60\u200b\u662f\u200b\u5728\u200b\u5bbf\u820d\u200b\u3001\u200b\u5b9e\u9a8c\u5ba4\u200b\u8fd8\u662f\u200b\u81ea\u4e60\u5ba4\u200b\uff0c\u200b\u53ea\u8981\u200b\u4f60\u200b\u8fd8\u200b\u80fd\u200b\u8fde\u200b\u4e0a\u200b\u6821\u56ed\u7f51\u200b\uff0c\u200b\u4f60\u200b\u5c31\u200b\u80fd\u200b\u5b8c\u6210\u200b\u4f60\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u3002</p>"},{"location":"remote_env/#troubleshooting","title":"Troubleshooting","text":""},{"location":"remote_env/#windows-10","title":"\u6211\u200b\u4e0d\u662f\u200bWindows 10\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u8fd9\u4f1a\u200b\u5e26\u6765\u200b\u4ec0\u4e48\u200b\u95ee\u9898\u200b\u5417\u200b\uff1f","text":""},{"location":"remote_env/#linuxmacos","title":"\u6211\u200b\u5728\u200b\u4f7f\u7528\u200bLinux/macOS\uff1f","text":"<p>Visual Studio Code\u200b\u4e5f\u200b\u6709\u200bLinux\u200b\u7248\u200b\u548c\u200bmacOS\u200b\u7248\u200b\uff0c\u200b\u5177\u4f53\u64cd\u4f5c\u200b\u5927\u540c\u5c0f\u5f02\u200b\uff0c\u200b\u6bd5\u7adf\u200b\u73af\u5883\u200b\u4e3b\u8981\u200b\u5728\u200b\u670d\u52a1\u5668\u200b\u4e0a\u200b\u3002</p>"},{"location":"remote_env/#windowswindows-10","title":"\u6211\u200b\u6b63\u5728\u200b\u4f7f\u7528\u200b\u65e7\u200b\u7684\u200bWindows\u200b\u7248\u672c\u200b/\u200b\u6211\u200b\u6ca1\u6709\u200b\u66f4\u65b0\u200b\u6211\u200b\u7684\u200bWindows 10\u200b\u7cfb\u7edf\u200b\uff1f","text":"<p>\u200b\u8bf7\u200b\u66f4\u65b0\u200b\u4f60\u200b\u7684\u200b\u7cfb\u7edf\u200b\u3002\u200b\u4f7f\u7528\u200b\u8fc7\u65f6\u200b\u7684\u200b\u7cfb\u7edf\u200b\u6709\u200b\u5404\u79cd\u5404\u6837\u200b\u7684\u200b\u98ce\u9669\u200b\uff0c\u200b\u5176\u4e2d\u200b\u6700\u5927\u200b\u7684\u200b\u662f\u200b\u4e0e\u200b\u65f6\u4ee3\u200b\u8131\u8f68\u200b\u3002</p>"},{"location":"remote_env/#windows-11","title":"\u6211\u200b\u6b63\u5728\u200b\u4f7f\u7528\u200bWindows 11\uff1f","text":"<p>\u200b\u8fd9\u7bc7\u200b\u6559\u7a0b\u200b\u5b8c\u5168\u200b\u517c\u5bb9\u200bWindows 11\u3002\u200b\u7b14\u8005\u200b\u6b63\u5728\u200b\u7528\u200b\u7684\u200b\u5c31\u662f\u200bWindows 11\u3002</p>"},{"location":"remote_env/#_5","title":"\u6211\u200b\u8f93\u5165\u200b\u7684\u200b\u6240\u6709\u200b\u547d\u4ee4\u200b\u770b\u8d77\u6765\u200b\u90fd\u200b\u662f\u200b\u5bf9\u200b\u7684\u200b\uff0c\u200b\u4f46\u662f\u200b\u4e3a\u4ec0\u4e48\u200b\u8fd0\u884c\u200b\u5931\u8d25\u200b\u4e86\u200b\uff1f","text":""},{"location":"remote_env/#_6","title":"\u5168\u89d2\u200b\u6807\u70b9\u7b26\u53f7\u200b/\u200b\u82f1\u6587\u200b\u5b57\u7b26\u200b\uff1f","text":"<p>\u200b\u786e\u4fdd\u200b\u4f60\u200b\u8f93\u5165\u200b\u7684\u200b\u662f\u200b\u6b63\u5e38\u200b\u7684\u200b\u534a\u89d2\u200b\u82f1\u6587\u200b\u5b57\u7b26\u200b\u4e0e\u200b\u82f1\u6587\u200b\u6807\u70b9\u7b26\u53f7\u200b\uff0c\u200b\u5982\u56fe\u6240\u793a\u200b\uff1a</p> <p>\u200b\u8fd9\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u4e00\u8d77\u200b\u6309\u4e0b\u200bshift+\u200b\u7a7a\u683c\u200b\uff0c\u200b\u6216\u8005\u200b\u5207\u6362\u200b\u5230\u200b\u82f1\u6587\u200b\u8f93\u5165\u6cd5\u200b\u89e3\u51b3\u200b\u3002\u200b\u6c38\u8fdc\u200b\u4e0d\u8981\u200b\u5728\u200b\u4e2d\u6587\u200b\u8f93\u5165\u6cd5\u200b\u4e0b\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\uff01</p>"},{"location":"remote_env/#xv6","title":"\u5982\u4f55\u200b\u9000\u51fa\u200bXV6\uff1f","text":"<p>\u200b\u540c\u65f6\u200b\u6309\u4e0b\u200b<code>Ctrl + A</code>\uff0c\u200b\u63a5\u7740\u200b\u5168\u90e8\u200b\u677e\u5f00\u200b\uff0c\u200b\u518d\u200b\u6309\u200b\u4e0b\u200b<code>x</code>\u200b\u4ee5\u200b\u9000\u51fa\u200bQEMU\u3002</p>"},{"location":"remote_env/#vscodebad-owner-or-permission","title":"VSCode\u200b\u8fde\u63a5\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u65f6\u200b\u51fa\u73b0\u200bbad owner or permission\u200b\u62a5\u9519\u200b\uff1f","text":"<p>\u200b\u89e3\u51b3\u200b\u65b9\u6cd5\u200b\uff1a\u200b\u8fdb\u5165\u200b\u8def\u5f84\u200bC:\\Users\\\u200b\u7528\u6237\u540d\u200b.ssh\uff0c\u200b\u53f3\u51fb\u200bconfig\u200b\u6587\u4ef6\u200b\u8fdb\u5165\u200b\u5c5e\u6027\u200b\u4e2d\u9ad8\u7ea7\u200b\u5b89\u5168\u200b\u7ba1\u7406\u200b\uff0c\u200b\u9009\u62e9\u200b\u7981\u6b62\u200b\u7ee7\u627f\u200b\uff0c\u200b\u5e76\u4e14\u200b\u5220\u9664\u200b\u6240\u6709\u200b\u6b64\u200b\u5bf9\u8c61\u200b\u4e2d\u200b\u7ee7\u627f\u200b\u7684\u200b\u6743\u9650\u200b\u3002</p> <p>\u200b\u5177\u4f53\u200b\u53ef\u4ee5\u200b\u67e5\u770b\u200b\uff1ahttps://www.cnblogs.com/Akkuman/p/11187776.html</p>"},{"location":"remote_env_gdb/","title":"\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u73af\u5883\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5\u200b\u6307\u5357","text":"<p>\u200b\u8c03\u8bd5\u200b\u8bf4\u660e\u200b</p> <p>\u200b\u901a\u5e38\u200b\u6765\u8bf4\u200b\uff0c\u200b\u4f7f\u7528\u200b\u7b80\u5355\u200b\u7c97\u66b4\u200b\u7684\u200b<code>printf\u200b\u5927\u6cd5\u200b</code>\uff08\u200b\u5728\u200b\u7279\u5b9a\u200b\u7684\u200b\u5730\u65b9\u200b\u6253\u5370\u200b\u65e5\u5fd7\u200b\uff09\u200b\u5c31\u200b\u80fd\u591f\u200b\u5904\u7406\u200b\u7edd\u5927\u591a\u6570\u200b\u7684\u200bbug\u3002\u200b\u4f46\u662f\u200b\u5bf9\u4e8e\u200b\u5927\u578b\u200b\u7684\u200b\u9879\u76ee\u200b\u5f00\u53d1\u200b\u6216\u200b\u6570\u91cf\u200b\u8d85\u591a\u200b\u7684\u200b\u6e90\u7801\u200b\uff0cprintf\u200b\u5927\u6cd5\u200b\u5c31\u200b\u4e0d\u80fd\u200b\u5feb\u901f\u200b\u5730\u53bb\u200b\u5b9a\u4f4d\u95ee\u9898\u200b\u6240\u5728\u200b\u3002\u200b\u529f\u80fd\u5f3a\u5927\u200b\u7684\u200bGDB\u200b\u8c03\u8bd5\u200b\u662f\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e0b\u200b\u7684\u200b\u4e00\u4e2a\u200b\u7a0b\u5e8f\u8c03\u8bd5\u200b\u5229\u5668\u200b\uff0c\u200b\u4f7f\u7528\u200bGDB\u200b\u8c03\u8bd5\u200b\u53ef\u4ee5\u200b\u8bf4\u200b\u662f\u200b\u4f5c\u4e3a\u200bLinux\u200b\u4e0b\u200b\u7684\u200b\u7a0b\u5e8f\u5458\u200b\u5e94\u5f53\u200b\u8981\u200b\u638c\u63e1\u200b\u7684\u200b\u4e00\u5927\u200b\u6280\u80fd\u200b\u3002\u200b\u7136\u800c\u200b\uff0cGDB\u200b\u56e0\u200b\u5176\u200b\u547d\u4ee4\u884c\u200b\u7684\u200b\u65b9\u5f0f\u200b\u60f3\u5fc5\u200b\u4f1a\u200b\u6321\u4f4f\u200b\u4e86\u200b\u4e00\u5927\u200b\u6ce2\u200b\u540c\u5b66\u200b\uff0c\u200b\u9ed8\u9ed8\u5730\u200b\u7ee7\u7eed\u200b\u4f7f\u7528\u200bprintf\u3002\u200b\u90a3\u200b\u6709\u6ca1\u6709\u200b\u5e26\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5\u200b\u754c\u9762\u200b\u7684\u200b\u8c03\u8bd5\u200b\u65b9\u6cd5\u200b\u5462\u200b\uff1f</p> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e3a\u200b\u540c\u5b66\u200b\u4eec\u200b\u4ecb\u7ecd\u200b\u8c03\u8bd5\u200b\u624b\u6bb5\u200b\u7684\u200b\u91cd\u5934\u620f\u200b\uff1a\u200b\u4f7f\u7528\u200bVSCode\u200b\u6765\u200b\u8c03\u8bd5\u200bxv6 : ) </p> <p>\u200b\u4e3a\u4e86\u200b\u7ed9\u200b\u540c\u5b66\u200b\u4eec\u200b\u6f14\u793a\u200b\u5982\u4f55\u200b\u7528\u200bVSCode\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5\u200bXV6\uff0c\u200b\u6211\u4eec\u200b\u5f55\u5236\u200b\u4e86\u200b\u4e24\u4e2a\u200b\u6f14\u793a\u200b\u89c6\u9891\u200b\uff0c\u200b\u5efa\u8bae\u200b\u5230\u200bbilibili\u200b\u4e0a\u200b\u89c2\u770b\u200b\u3002</p> <ol> <li>\u30101. VSCode\u200b\u8c03\u8bd5\u200bxv6\u200b\u5185\u6838\u200b\u4ee3\u7801\u200b\u3011 https://www.bilibili.com/video/BV1ZB4y1E7X5?share_source=copy_web&amp;vd_source=a822dcda3537564ccdd0bb45aa0afe33</li> <li>\u30102. VSCode\u200b\u8c03\u8bd5\u200bxv6\u200b\u7528\u6237\u200b\u4ee3\u7801\u200b\u3011 https://www.bilibili.com/video/BV1i14y1Y7ZZ?share_source=copy_web&amp;vd_source=a822dcda3537564ccdd0bb45aa0afe33</li> </ol> <p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b</p> <p>\u200b\u5982\u679c\u200b\u4e0d\u60f3\u200b\u4f7f\u7528\u200bVSCode\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u8fd8\u662f\u200b\u60f3\u200b\u5728\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u4f7f\u7528\u200bgdb\u200b\u547d\u4ee4\u884c\u200b\u7684\u200b\u540c\u5b66\u200b\uff0c\u200b\u8bf7\u200b\u4f7f\u7528\u200b\u53ef\u4ee5\u200b\u652f\u6301\u200b\u591a\u79cd\u200b\u786c\u4ef6\u200b\u4f53\u7cfb\u200b\u67b6\u6784\u200b\u7684\u200b\u201cgdb-multiarch\u201d\u200b\u800c\u200b\u975e\u200b\u201cgdb\u201d\u200b\u6216\u8005\u200b\u201criscv64-unknown-elf-gdb\u201d\u3002</p> <ol> <li>\u200b\u6253\u5f00\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u5230\u200bxv6-oslab23-hitsz\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8f93\u5165\u200b\uff1a</li> </ol> <pre><code>make qemu-gdb\n</code></pre> <ol> <li>\u200b\u6253\u5f00\u200b\u53e6\u5916\u200b\u4e00\u4e2a\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u5230\u200bxv6-oslab23-hitsz\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8f93\u5165\u200b</li> </ol> <pre><code>gdb-multiarch\n</code></pre> <p></p> <p>\u200b\u4f7f\u7528\u200bVSCode\u200b\u53ef\u4ee5\u200b\u65b9\u4fbf\u5feb\u6377\u200b\u5730\u200b\u4f7f\u7528\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u8c03\u8bd5\u200b\u529f\u80fd\u200b\u3002\u200b\u4ee5\u4e0b\u200b\u662f\u200b\u8bbe\u7f6e\u200b\u6b65\u9aa4\u200b\u3002</p>"},{"location":"remote_env_gdb/#1-gdb","title":"1. \u200b\u8bbe\u7f6e\u200bGDB\u200b\u4fe1\u4efb","text":"<p>\u200b\u5728\u200b\u7ec8\u7aef\u200b\u4e2d\u200b\uff0c\u200b\u8f93\u5165\u200b\uff1a</p> <pre><code>echo \"set auto-load safe-path /\" &gt;&gt;  ~/.gdbinit\n</code></pre> <p>\u200b\u8fd9\u4f1a\u200b\u5173\u95ed\u200bgdb\u200b\u7684\u200bautoload\u200b\u4fe1\u4efb\u200b\u673a\u5236\u200b\u2014\u2014\u200b\u522b\u200b\u62c5\u5fc3\u200b\uff0c\u200b\u4f60\u4eec\u200b\u6ca1\u6709\u200b\u7ba1\u7406\u5458\u200b\u6743\u9650\u200b\uff0c\u200b\u641e\u200b\u4e0d\u574f\u200b\u8fdc\u7a0b\u200b\u73af\u5883\u200b\u7684\u200b\u3002</p>"},{"location":"remote_env_gdb/#2-gdb","title":"2. \u200b\u83b7\u53d6\u200b\u4e13\u5c5e\u200bGDB\u200b\u7aef\u53e3\u53f7","text":"<p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u83b7\u53d6\u200b\u4f60\u200b\u4e13\u5c5e\u200b\u7684\u200bGDB\u200b\u7aef\u53e3\u53f7\u200b\u3002\u200b\u5728\u200b\u63a7\u5236\u53f0\u200b\u8f93\u5165\u200b<code>expr $(id -u) % 5000 + 25000</code>\u200b\u5e76\u200b\u56de\u8f66\u200b\uff0c\u200b\u4f60\u200b\u5e94\u8be5\u200b\u80fd\u200b\u5f97\u5230\u200b\u4e00\u4e32\u200b\u6570\u5b57\u200b\uff1a</p> <pre><code>ldap_example@OSLabExecNode0:~$ expr $(id -u) % 5000 + 25000\n25001    // \u2190 \u200b\u8fd9\u4e2a\u200b\n</code></pre> <p>\u200b\u8bf7\u200b\u8bb0\u597d\u200b\u8fd9\u4e32\u200b\u6570\u5b57\u200b\uff0c\u200b\u540e\u9762\u200b\u4f1a\u200b\u7528\u5230\u200b\u3002</p>"},{"location":"remote_env_gdb/#3-vscode","title":"3. \u200b\u8bbe\u7f6e\u200bVSCode","text":"<p>\u200b\u9996\u5148\u200b \u200b\u786e\u8ba4\u200b\u4f60\u200b\u7684\u200bVSCode\u200b\u5de5\u4f5c\u200b\u533a\u200b\u8def\u5f84\u200b\u662f\u5426\u662f\u200b\u4f60\u200b\u7684\u200bxv6\u200b\u8def\u5f84\u200b\uff0c\u200b\u6ca1\u6709\u200b\u989d\u5916\u200b\u5d4c\u5957\u200b\u4e00\u5c42\u200b\u6587\u4ef6\u5939\u200b \u3002\u200b\u6309\u4e0b\u200b<code>Ctrl+`</code>\uff0c\u200b\u547c\u200b\u51fa\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u8f93\u5165\u200b<code>ls</code>\u3002\u200b\u4f60\u200b\u5e94\u8be5\u200b\u4f1a\u200b\u770b\u5230\u200b\u5982\u4e0b\u200b\u60c5\u666f\u200b\uff1a</p> <pre><code>ldap_example@OSLabExecNode0:~/xv6-oslab23-hitsz$ ls\nconf  fs.img  grade-lab-util  gradelib.py  gradelib.pyc  kernel  LICENSE  Makefile  mkfs  README  user\n</code></pre> <p>\u200b\u5982\u679c\u200b\u4e0d\u662f\u200b\uff0c\u200b\u6253\u5f00\u200b\u65b0\u200b\u7684\u200b\u5de5\u4f5c\u200b\u533a\u200b\uff0c\u200b\u9009\u62e9\u200bxv6\u200b\u6240\u5728\u200b\u7684\u200b\u6587\u4ef6\u5939\u200b\u6253\u5f00\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u5728\u200bVSCode\u200b\u5de6\u4fa7\u200b\uff0c\u200b\u70b9\u51fb\u200b\u6269\u5c55\u200b\u9009\u9879\u200b\uff0c\u200b\u641c\u7d22\u200b\u3001\u200b\u5b89\u88c5\u200b<code>Native Debug</code>\u200b\u63d2\u4ef6\u200b \uff0c\u200b\u70b9\u51fb\u200b\u5b89\u88c5\u200b\uff1a</p> <p></p> <p>\u200b\u63d2\u4ef6\u200b\u63a8\u8350\u200b</p> <p>\u200b\u540c\u65f6\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e5f\u200b\u5f3a\u70c8\u63a8\u8350\u200b\u4f60\u200b\u5b89\u88c5\u200bVSCode\u200b\u7684\u200bC/C++\u200b\u63d2\u4ef6\u200b\u3002\u200b\u8fd9\u4f1a\u200b\u7ed9\u200b\u4f60\u200b\u5e26\u6765\u200b\u81ea\u52a8\u200b\u8865\u5168\u200b\u3001Ctrl-\u200b\u70b9\u51fb\u200b\u8df3\u8f6c\u200b\u7b49\u200b\u5404\u79cd\u200b\u65b9\u4fbf\u200b\u7684\u200b\u529f\u80fd\u200b\u3002</p> <p>\u200b\u5728\u200bVSCode\u200b\u5de6\u4fa7\u200b\uff0c\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u548c\u200b\u8c03\u8bd5\u200b\u201d\u200b\u9009\u9879\u200b\uff0c\u200b\u5982\u56fe\u200b\uff1a</p> <p></p> <p>\u200b\u9009\u62e9\u200b<code>\u200b\u521b\u5efa\u200blaunch.json\u200b\u6587\u4ef6\u200b</code>\uff0c\u200b\u9009\u62e9\u200bGDB\u3002</p> <p></p> <p>\u200b\u8fd9\u4f1a\u200b\u6253\u5f00\u200b\u4e00\u4e2a\u200b\u540d\u4e3a\u200b<code>launch.json</code>\u200b\u7684\u200b\u6587\u4ef6\u200b\u3002\u200b\u5c06\u200b\u5176\u4e2d\u200b\u5185\u5bb9\u200b\u5168\u90e8\u200b\u66ff\u6362\u200b\u4e3a\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>{\n\"version\": \"0.2.0\",\n\"configurations\": [\n{\n\"type\": \"gdb\",\n\"request\": \"attach\",\n\"name\": \"Attach to gdbserver\",\n\"executable\": \"${workspaceRoot}/kernel/kernel\",\n\"gdbpath\": \"gdb-multiarch\",\n\"remote\": true,            \"target\": \"127.0.0.1:\u200b\u6b64\u524d\u200b\u4f60\u200b\u5f97\u5230\u200b\u7684\u200bGDB\u200b\u7aef\u53e3\u53f7\u200b\",\n\"cwd\": \"${workspaceRoot}\",\n\"setupCommands\": {\n\"text\": \"source ${workspaceFolder}/.gdbinit\"\n}\n}\n]\n}\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c\u200b\u7b2c\u5341\u200b\u884c\u200b<code>\"target\": \"127.0.0.1:\u200b\u6b64\u524d\u200b\u4f60\u200b\u5f97\u5230\u200b\u7684\u200bGDB\u200b\u7aef\u53e3\u53f7\u200b\",</code>\u200b\u7b2c\u4e8c\u4e2a\u200b\u5192\u53f7\u200b\u540e\u200b\u4e2d\u6587\u200b\u5185\u5bb9\u200b \u200b\u66ff\u6362\u200b \u200b\u4e3a\u200b\u6b64\u524d\u200b\u4f60\u200b\u901a\u8fc7\u200b<code>expr $(id -u) % 5000 + 25000</code>\u200b\u5f97\u5230\u200b\u7684\u200b\u6570\u5b57\u200b\uff0c\u200b\u6bd4\u5982\u200b25001\u3002Ctrl+S\u200b\u4ee5\u200b\u4fdd\u5b58\u200b\u3002</p> <p>\u200b\u5982\u6b64\u200b\uff0c\u200b\u914d\u7f6e\u200b\u4fbf\u200b\u5ba3\u544a\u200b\u5b8c\u6210\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u3002</p>"},{"location":"remote_env_gdb/#4","title":"4. \u200b\u57fa\u7840\u200b\u4f7f\u7528\u200b\u6559\u5b66","text":"<p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u9ed8\u8ba4\u200b\u542f\u7528\u200b\u7684\u200b\u662f\u200bxv6\u200b\u5185\u6838\u200b\u7684\u200b\u8c03\u8bd5\u200b\u3002\u200b\u82e5\u200b\u8981\u200b\u8c03\u8bd5\u200b\u7528\u6237\u7a0b\u5e8f\u200b\uff0c\u200b\u65b9\u6cd5\u200b\u53c2\u89c1\u200b\u4e0b\u65b9\u200b4.4.4 \u200b\u7528\u6237\u200b\u6001\u200b\u7a0b\u5e8f\u8c03\u8bd5\u200b\u8282\u200b\u3002</p> <p>\u200b\u4e3a\u200b\u6f14\u793a\u200b\u8d77\u200b\u89c1\u200b\uff0c\u200b\u6211\u4eec\u200b\u5728\u200b<code>kernel/main.c</code>\u200b\u7684\u200b\u7b2c\u200b13\u200b\u884c\u200b\u6253\u4e0b\u200b\u4e00\u4e2a\u200b\u65ad\u70b9\u200b\uff0c\u200b\u5982\u56fe\u200b\u3002  \u200b\u65ad\u70b9\u200b\u53ef\u4ee5\u200b\u9760\u200b\u4f7f\u7528\u200b\u9f20\u6807\u200b\u70b9\u51fb\u200b\u884c\u53f7\u200b\u5de6\u4fa7\u200b\u8bbe\u7f6e\u200b\u3002</p> <p>\u200b\u5728\u200b\u4e0b\u65b9\u200b\u547d\u4ee4\u884c\u200b\u8f93\u5165\u200b<code>make qemu-gdb</code>\u3002qemu\u200b\u4f1a\u200b\u81ea\u52a8\u200b\u542f\u52a8\u200b\uff0cgdb\u200b\u5f00\u59cb\u200b\u7b49\u5f85\u200b\u63a5\u5165\u200b\u3002\u200b\u6309\u4e0b\u200bF5\uff0c \u200b\u6216\u8005\u200b \u200b\u70b9\u51fb\u200b\u5de6\u4fa7\u200b\u6309\u94ae\u200b\u8fd0\u884c\u200b\u4e0e\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u89d2\u200b\u7eff\u8272\u200b\u4e09\u89d2\u200b\uff08Attach to gdb)\uff1a</p> <p> \u200b\u73b0\u5728\u200b\uff0c\u200b\u5185\u6838\u200b\u6210\u529f\u200b\u8fd0\u884c\u200b\uff0c\u200b\u5e76\u4e14\u200b\u505c\u6b62\u200b\u5728\u200b\u4e86\u200b\u65ad\u70b9\u200b\u5904\u200b\uff0c\u200b\u5982\u56fe\u6240\u793a\u200b\uff1a  \u200b\u8fd9\u200b\u8bc1\u660e\u200b\u4e86\u200b\u6211\u4eec\u200b\u7684\u200b\u914d\u7f6e\u200b\u4e0e\u200bGDB\u200b\u8fd0\u884c\u200b\u6b63\u5e38\u200b\u3002</p> <p>\u200b\u4e0a\u65b9\u200b\u7684\u200b\u6570\u4e2a\u200b\u6309\u952e\u200b\uff0c\u200b\u5206\u522b\u200b\u662f\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\u3001\u201c\u200b\u5355\u6b65\u200b\u8df3\u8fc7\u200b\uff08\u200b\u4e0b\u200b\u4e00\u884c\u200b\uff09\u201d\uff0c\u201c\u200b\u5355\u6b65\u200b\u8c03\u8bd5\u200b\uff08\u200b\u6b65\u5165\u200b\u51fd\u6570\u200b\uff09\u201d\uff0c\u201c\u200b\u5355\u6b65\u200b\u8df3\u51fa\u200b\uff08\u200b\u8df3\u51fa\u200b\u51fd\u6570\u200b\uff09\u201d\uff0c\u201c\u200b\u56de\u9000\u200b\uff08\u200b\u4e0d\u200b\u652f\u6301\u200b\uff09\u201d\uff0c\u201c\u200b\u53cd\u5411\u200b\uff08\u200b\u4e0d\u200b\u652f\u6301\u200b\uff09\u201d\uff0c\u201c\u200b\u91cd\u542f\u200b\uff08\u200b\u4e0d\u200b\u652f\u6301\u200b\uff09\u201d\uff0c\u201c\u200b\u65ad\u5f00\u200b\u201d\uff0c\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a </p> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u6bcf\u6b21\u200b\u8c03\u8bd5\u200b\u5b8c\u6210\u200b\uff0c\u200b\u52a1\u5fc5\u200b\u4f7f\u7528\u200b\u7ea2\u8272\u200b\u6309\u94ae\u200b \u200b\u65ad\u5f00\u200b GDB\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u4e2d\u200b <code>Ctrl-A, X</code>\u200b\u4ee5\u200b\u505c\u6b62\u200bqemu\u3002</p> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u8fd0\u884c\u200b\u65f6\u200b\u4e0d\u200b\u5e94\u5bf9\u200b\u6e90\u6587\u4ef6\u200b\u8fdb\u884c\u200b\u4efb\u4f55\u200b\u4fee\u6539\u200b\u3002\u200b\u6b64\u65f6\u200b\u4fee\u6539\u200b\u5e76\u200b\u65e0\u200b\u4efb\u4f55\u200b\u610f\u4e49\u200b\u3002\u200b\u5982\u679c\u200b\u9700\u8981\u200b\u66f4\u6539\u200b\u7a0b\u5e8f\u200b\uff0c\u200b\u8bf7\u200b\u505c\u6b62\u200b\u8c03\u8bd5\u200b\u3001\u200b\u5b8c\u6210\u200b\u4fee\u6539\u200b\u518d\u200b\u91cd\u65b0\u200b\u5f00\u59cb\u200b\u8c03\u8bd5\u200b\u3002</p> <p>\u200b\u70b9\u51fb\u200b\u5355\u6b65\u200b\uff0c\u200b\u4f60\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u53d1\u73b0\u200b\u8bed\u53e5\u200b\u98de\u200b\u7684\u200b\u5230\u5904\u200b\u90fd\u200b\u662f\u200b\u3002\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b\uff0cxv6\u200b\u5b9e\u9a8c\u200b\u65f6\u200b\u9ed8\u8ba4\u200b\u662f\u200b\u5f00\u542f\u200b\u591a\u6838\u200b\u5904\u7406\u200b\u7684\u200b\u3002\u200b\u5982\u4e0b\u200b\u56fe\u200b\u5de6\u4fa7\u200b\u6240\u793a\u200b\uff0c\u200b\u73b0\u5728\u200b\u6709\u200b\u4e09\u4e2a\u200b\u7ebf\u7a0b\u200b\u5728\u200b\u540c\u65f6\u200b\u8fd0\u884c\u200b\uff0c\u200b\u4ee3\u8868\u200b\u4e09\u9897\u200bCPU\u200b\u6838\u5fc3\u200b\uff1a</p> <p></p> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u5982\u679c\u200b\u4e0d\u60f3\u200b\u5f00\u542f\u200b\u591a\u200b\u6838\u5fc3\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5728\u200b\u8fd0\u884c\u200b<code>make qemu-gdb</code>\u200b\u65f6\u200b\u4f7f\u7528\u200b<code>CPUS=1</code>\uff0c\u200b\u4ee5\u200b\u5355\u6838\u200b\u6a21\u5f0f\u200b\u542f\u52a8\u200b\uff0c\u200b\u5373\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\u53d8\u4e3a\u200b<code>make qemu-gdb CPUS=1</code>\u3002</p> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u5f00\u542f\u200b\u591a\u200b\u6838\u5fc3\u200b\u662f\u200b\u8bb8\u591a\u200blab\u200b\u68c0\u67e5\u200b\u7684\u200b\u5fc5\u8981\u6761\u4ef6\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u6709\u4e9b\u200blab\u200b\u4e0b\u200b\u9700\u8981\u200b\u5904\u7406\u200b\u591a\u200b\u6838\u5fc3\u200b\u4e4b\u95f4\u200b\u7ade\u4e89\u200b\u95ee\u9898\u200b\u3002\u200b\u624b\u52a8\u200b\u6307\u5b9a\u200bCPUS\u200b\u4ec5\u200b\u7528\u4e8e\u200b\u8c03\u8bd5\u200b\u7528\u9014\u200b\uff0c\u200b\u5982\u679c\u200b\u4f60\u200b\u63d0\u4ea4\u200b\u7684\u200b\u4ee3\u7801\u200b\u4ec5\u200b\u53ef\u200b\u5728\u200b\u5355\u6838\u200b\u4e0b\u200b\u8fd0\u884c\u200b\u3001\u200b\u800c\u200b\u4e0d\u80fd\u200b\u5728\u200b\u901a\u5e38\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u8fd0\u884c\u200b\uff0c\u200b\u4f60\u200b\u5c06\u200b\u65e0\u6cd5\u200b\u5f97\u5230\u200b\u5206\u6570\u200b\u6216\u200b\u53ea\u80fd\u200b\u5f97\u5230\u200b\u90e8\u5206\u200b\u5206\u6570\u200b\u3002\u200b\u6b64\u65f6\u200b\u4f60\u200b\u5e94\u5f53\u200b\u5173\u6ce8\u200b\u9501\u200b\u4e0e\u200b\u7ade\u4e89\u200b\u76f8\u5173\u200b\u7684\u200b\u95ee\u9898\u200b\u3002</p> <p>\u200b\u4e3a\u4e86\u200b\u4fbf\u4e8e\u200b\u6f14\u793a\u200b\u8d77\u200b\u89c1\u200b\uff0c\u200b\u540e\u7eed\u200b\u4ee5\u200b\u5355\u6838\u200b\u6a21\u5f0f\u200b\u6267\u884c\u200b\u3002</p>"},{"location":"remote_env_gdb/#41","title":"4.1 \u200b\u5355\u6b65\u200b\u8df3\u8fc7","text":"<p>\u200b\u5de6\u4fa7\u200b\u7b2c\u4e8c\u4e2a\u200b\u6309\u94ae\u200b\u4e3a\u200b\u5355\u6b65\u200b\u8df3\u8fc7\u200b\uff08\u200b\u5411\u4e0b\u200b\u4e00\u884c\u200b\uff09\u200b\u6309\u94ae\u200b\u3002\u200b\u70b9\u51fb\u200b\u5b83\u200b\u53ef\u4ee5\u200b\u8ba9\u200b\u7a0b\u5e8f\u200b\u5411\u4e0b\u200b\u8fd0\u884c\u200b\u4e00\u884c\u200b\u3002\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\u4e3a\u200b\u521d\u6001\u200b\uff1a</p> <p></p> <p>\u200b\u6309\u4e0b\u200b\u5355\u6b65\u200b\u8df3\u8fc7\u200b\u6309\u94ae\u200b\uff0c\u200b\u5219\u200b\u7a0b\u5e8f\u200b\u5411\u4e0b\u200b\u6267\u884c\u200b\u4e00\u884c\u200b\uff1a</p> <p></p>"},{"location":"remote_env_gdb/#42","title":"4.2 \u200b\u65ad\u70b9\u200b\u529f\u80fd","text":"<p>\u200b\u8fd0\u884c\u200b\u65f6\u200b\u4e5f\u200b\u53ef\u200b\u8bbe\u7f6e\u200b\u65ad\u70b9\u200b\u3002\u200b\u7a0b\u5e8f\u200b\u5c06\u200b\u5728\u200b\u8fd0\u884c\u200b\u5230\u200b\u65ad\u70b9\u200b\u65f6\u200b\u505c\u6b62\u200b\u3002\u200b\u70b9\u51fb\u200b\u884c\u53f7\u200b\u5de6\u4fa7\u200b\u5373\u53ef\u200b\u8bbe\u7f6e\u200b\u65ad\u70b9\u200b\u3002\u200b\u4ee5\u8be5\u200b\u72b6\u6001\u200b\u4e3a\u200b\u521d\u6001\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u53d1\u73b0\u200b\u5728\u200b17\u200b\u884c\u5904\u200b\u6709\u200b\u4e00\u4e2a\u200b\u672a\u200b\u89e6\u53d1\u200b\u7684\u200b\u65ad\u70b9\u200b\uff1a</p> <p></p> <p>\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\uff08\u200b\u5de6\u4fa7\u200b\u7b2c\u4e00\u4e2a\u200b\u6309\u94ae\u200b\uff09\uff0c\u200b\u7a0b\u5e8f\u200b\u5c06\u200b\u81ea\u52a8\u200b\u8fd0\u884c\u200b\u5230\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u65ad\u70b9\u200b\u5e76\u200b\u505c\u6b62\u200b\uff1a</p> <p></p> <p>\u200b\u4ece\u200b\u8f93\u51fa\u200b\u53ef\u89c1\u200b\u5176\u200b\u8f93\u51fa\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u56de\u8f66\u200b\uff0c\u200b\u5e76\u200b\u505c\u6b62\u200b\u5728\u200b\u4e86\u200b\u8be5\u200b\u8bed\u53e5\u200b\u6267\u884c\u200b\u4e4b\u524d\u200b\u3002</p>"},{"location":"remote_env_gdb/#43","title":"4.3 \u200b\u5355\u6b65\u200b\u8c03\u8bd5\u200b\uff08\u200b\u6b65\u5165\u200b\u51fd\u6570\u200b\uff09\u3001\u200b\u5355\u6b65\u200b\u8df3\u51fa\u200b\u4e0e\u200b\u5c40\u90e8\u53d8\u91cf","text":"<p>\u200b\u4e0a\u200b\u56de\u200b\u6211\u4eec\u200b\u505c\u200b\u5728\u200b\u4e86\u200b\u4e00\u4e2a\u200b<code>printf</code>\u200b\u5904\u200b\u3002\u200b\u6211\u4eec\u200b\u73b0\u5728\u200b\u5c06\u200b\u8fdb\u5165\u200b<code>printf</code>\u200b\u51fd\u6570\u200b\u5185\u90e8\u200b\u8fdb\u884c\u200b\u7814\u7a76\u200b\u3002\u200b\u6211\u4eec\u200b\u70b9\u51fb\u200b\u5355\u6b65\u200b\u8c03\u8bd5\u200b\u6309\u94ae\u200b\uff08\u200b\u5de6\u6570\u200b\u7b2c\u200b3\u200b\u4e2a\u200b\uff09\uff0c\u200b\u8fd9\u4f1a\u200b\u5e26\u200b\u6211\u4eec\u200b\u8fdb\u5165\u200b<code>printf</code>\u200b\u51fd\u6570\u200b\u7684\u200b\u7b2c\u4e00\u6761\u200b\u53ef\u200b\u6267\u884c\u200b\u8bed\u53e5\u200b\uff1a</p> <p></p> <p>\u200b\u6b64\u65f6\u200b\uff0c\u200b\u5de6\u4e0a\u89d2\u200b\u4f1a\u200b\u663e\u793a\u200b\u5f53\u524d\u200b\u7684\u200b\u5c40\u90e8\u53d8\u91cf\u200b\u3002<code>&lt;optimized out&gt;</code>\u200b\u8868\u660e\u200b\u5176\u200b\u5df2\u200b\u88ab\u200b\u4f18\u5316\u200b\u6389\u200b\u4e0d\u200b\u53ef\u89c1\u200b\uff0c\u200b\u8fd9\u6709\u200b\u53ef\u80fd\u200b\u56e0\u4e3a\u200b\u5176\u200b \u200b\u6682\u65f6\u200b\u5c1a\u672a\u200b\u88ab\u200b\u521d\u59cb\u5316\u200b \u3002\u200b\u5982\u56fe\u200b\uff0c\u200b\u7ee7\u7eed\u200b\u4f7f\u7528\u200b\u5355\u6b65\u200b\u8df3\u8fc7\u200b\uff08\u200b\u4e0b\u200b\u4e00\u884c\u200b\uff09\uff0c\u200b\u8fdb\u5165\u200b\u7b2c\u200b78\u200b\u884c\u200b\uff0c\u200b\u6211\u4eec\u200b\u4f1a\u200b\u53d1\u73b0\u200b\u90e8\u5206\u200b\u6b64\u524d\u200b\u663e\u793a\u200b<code>&lt;optimized out&gt;</code>\u200b\u7684\u200b\u53d8\u91cf\u200b\u5df2\u7ecf\u200b\u53ef\u89c1\u200b\uff1a</p> <p></p> <p>\u200b\u590d\u6742\u200b\u7684\u200b\u53d8\u91cf\u200b\uff08\u200b\u5982\u200b\u7ed3\u6784\u200b\u4f53\u200b\uff09\u200b\u53ef\u4ee5\u200b\u5c55\u5f00\u200b\u4ee5\u200b\u67e5\u770b\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u5f53\u200b\u4f60\u200b\u5b8c\u6210\u200b\u8be5\u200b\u51fd\u6570\u200b\u5904\u200b\u7684\u200b\u8c03\u8bd5\u200b\u4e0e\u200b\u7814\u7a76\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u70b9\u51fb\u200b\u5355\u6b65\u200b\u8df3\u51fa\u200b\uff08\u200b\u5de6\u4fa7\u200b\u7b2c\u200b4\u200b\u4e2a\u200b\u6309\u94ae\u200b\uff09\u200b\u4ee5\u200b\u8df3\u51fa\u200b\u8be5\u200b\u51fd\u6570\u200b\u3002\u200b\u5982\u56fe\u200b\uff0c\u200b\u547d\u4ee4\u884c\u200b\u5904\u200b\u663e\u793a\u200b\u5bf9\u5e94\u200b\u4fe1\u606f\u200b\uff0c\u200b\u8868\u660e\u200b\u8be5\u200b\u51fd\u6570\u200b\u5df2\u200b\u88ab\u200b\u6267\u884c\u200b\u5b8c\u6210\u200b\uff1b\u200b\u8c03\u8bd5\u5668\u200b\u73b0\u5728\u200b\u505c\u200b\u5728\u200b\u4e86\u200b\u51fd\u6570\u200b\u5916\u200b\uff1a</p> <p></p>"},{"location":"remote_env_gdb/#44","title":"4.4 \u200b\u7565\u5fae\u200b\u9ad8\u7ea7\u200b\u4e00\u70b9\u200b\u7684\u200b\u6280\u5de7","text":"<p>\u200b\u4ee5\u4e0a\u200b\u5185\u5bb9\u200b\u7686\u200b\u53ef\u200b\u4f9d\u9760\u200bGUI\u200b\u5b8c\u6210\u200b\uff0c\u200b\u5e76\u4e14\u200b\u5df2\u7ecf\u200b\u53ef\u4ee5\u200b\u8986\u76d6\u200b\u7edd\u5927\u591a\u6570\u200b\u9700\u6c42\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u9700\u8981\u200b\u5176\u4ed6\u200b\u4e00\u4e9b\u200b\u9ad8\u7ea7\u200b\u529f\u80fd\u200b\uff0c\u200b\u6216\u8005\u200b\u4ec5\u4ec5\u53ea\u662f\u200b\u60f3\u8981\u200b\u4e86\u89e3\u200b\u66f4\u200b\u591a\u200b\u2014\u2014\u200b\u6b22\u8fce\u200b\u3002 \u200b\u8fd9\u90e8\u5206\u200b\u5c06\u200b\u66f4\u4e3a\u200b\u7b80\u77ed\u200b\uff0c\u200b\u5e76\u4e14\u200b\u9ed8\u8ba4\u200b\u4f60\u4eec\u200b\u62e5\u6709\u200b\u4e00\u5b9a\u200b\u7a0b\u5ea6\u200b\u7684\u200b\u524d\u7f6e\u200b\u77e5\u8bc6\u200b\u3002 \u200b\u4ee5\u4e0b\u5185\u5bb9\u200b\u5747\u200b\u9700\u8981\u200b\u901a\u8fc7\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\u64cd\u4f5c\u200b\u3002 </p>"},{"location":"remote_env_gdb/#441","title":"4.4.1 \u200b\u5355\u6b65\u200b\u6c47\u7f16\u200b\u8c03\u8bd5\u200b\u3001\u200b\u6c47\u7f16\u200b\u663e\u793a","text":"<p>\u200b\u6211\u4eec\u200b\u4ee5\u200bTrampoline\u200b\u5904\u200b\u7684\u200b\u8c03\u8bd5\u200b\u4f5c\u4e3a\u200b\u793a\u4f8b\u200b\u3002\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u8fdb\u5165\u200buserret\u200b\u5904\u200b\uff1a</p> <p></p> <p>\u200b\u5355\u6b65\u200b\u8df3\u8fc7\u200b\u8be5\u200b\u6307\u4ee4\u200b\uff0c\u200b\u8fdb\u5165\u200btrampoline\u200b\u7684\u200buserret\u3002\u200b\u901a\u8fc7\u200b<code>disas $pc, $pc+20</code>\uff0c\u200b\u53ef\u4ee5\u200b\u663e\u793a\u200b\u63a5\u4e0b\u6765\u200b20byte\u200b\u7684\u200b\u6c47\u7f16\u200b\u6307\u4ee4\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u53d1\u73b0\u200b\u6211\u4eec\u200b\u786e\u5b9e\u200b\u8fdb\u5165\u200b\u4e86\u200buserret\u200b\u5904\u200b\uff1a</p> <p></p> <p>\u200b\u6216\u8005\u200b\u4f7f\u7528\u200b<code>display/10i $pc</code>\u200b\u53ef\u4ee5\u200b\u8ba9\u200bgdb\u200b\u6301\u7eed\u200b\u81ea\u52a8\u200b\u663e\u793a\u200b\u4ece\u200bpc\u200b\u8d77\u200b\u7684\u200b10\u200b\u6761\u200b\u6307\u4ee4\u200b\u3002</p> <p></p> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u8fd9\u91cc\u200b\u76f4\u63a5\u200b<code>b uservec</code>\u200b\u662f\u200b\u4e0d\u200b\u53ef\u884c\u200b\u7684\u200b\uff0c\u200b\u8fd9\u200b\u662f\u200b\u7531\u200bTrampoline\u200b\u7684\u200b\u7279\u6b8a\u6027\u200b\u5bfc\u81f4\u200b\u7684\u200b\u3002\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u9605\u8bfb\u200b\u3001\u200b\u7406\u89e3\u200b\u4e00\u4e0b\u200b\u4e3a\u4ec0\u4e48\u200b\u3002</p>"},{"location":"remote_env_gdb/#442","title":"4.4.2 \u200b\u5bc4\u5b58\u5668\u200b\u5185\u5bb9\u5206\u6790","text":"<p>\u200b\u4f7f\u7528\u200b<code>info reg</code>\u200b\u53ef\u4ee5\u200b\u663e\u793a\u200b\u5f53\u524d\u200bCPU\u200b\u7684\u200b\u5bc4\u5b58\u5668\u200b\u3002</p> <p></p>"},{"location":"remote_env_gdb/#443","title":"4.4.3 \u200b\u5185\u5b58\u200b\u5185\u5bb9","text":"<p>\u200b\u4f7f\u7528\u200b<code>x/\u200b\u5b57\u8282\u6570\u200bb *\u200b\u5730\u5740\u200b</code>\u200b\u53ef\u4ee5\u200b\u5c55\u793a\u200b\u5185\u5b58\u200b\u5185\u5bb9\u200b\uff1a</p> <p></p>"},{"location":"remote_env_gdb/#444","title":"4.4.4 \u200b\u7528\u6237\u200b\u6001\u200b\u7a0b\u5e8f\u8c03\u8bd5","text":"<p>xv6\u200b\u7684\u200b\u5185\u6838\u200b\u6001\u200b\u548c\u200b\u7528\u6237\u200b\u6001\u200b\u5e76\u200b\u4e0d\u200b\u5171\u4eab\u200b\u9875\u8868\u200b\uff0c\u200b\u8c03\u8bd5\u200b\u7b26\u53f7\u200b\u4e5f\u200b\u5b8c\u5168\u200b\u4e0d\u540c\u200b\u3002\u200b\u8c03\u8bd5\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u9700\u8981\u200b\u52a0\u8f7d\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7528\u6237\u200b\u7a0b\u5e8f\u8c03\u8bd5\u200b\u7b26\u53f7\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u901a\u8fc7\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\u5b8c\u6210\u200b\u8fd9\u200b\u4e00\u9879\u200b\u64cd\u4f5c\u200b\u3002\u200b\u6211\u4eec\u200b\u4ee5\u200b\u8c03\u8bd5\u200b\u81ea\u5e26\u200b\u7684\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u201cls\"\u200b\u4e3a\u4f8b\u200b\u3002  </p> <p>Step1\uff1a \u200b\u5148\u200b\u5728\u200b\u7ec8\u7aef\u200b\u8f93\u5165\u200b\u201cmake qemu-gdb\u201d\u3002</p> <p>\u200b\u63a5\u7740\u200b\uff0c\u200b\u6309\u4e0b\u200bF5\uff0c \u200b\u6216\u8005\u200b \u200b\u70b9\u51fb\u200b\u5de6\u4fa7\u200b\u6309\u94ae\u200b\u8fd0\u884c\u200b\u4e0e\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u89d2\u200b\u7eff\u8272\u200b\u4e09\u89d2\u200b\uff08Attach to gdb)\u3002</p> <p>\u200b\u518d\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\uff0c\u200b\u8ba9\u200bxv6\u200b\u6b63\u5e38\u200b\u8fd0\u884c\u200b\uff0c\u200b\u76f4\u5230\u200b\u51fa\u73b0\u200b\u201c$\u201d\uff0c\u200b\u8868\u793a\u200b\u5df2\u7ecf\u200b\u8fdb\u5165\u200bshell\u200b\u4e2d\u200b\u3002</p> <p></p> <p>Step2\uff1a \u200b\u5728\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff0c\u200b\u8f93\u5165\u200b\u201cinterrupt\u201d\u3002</p> <p></p> <p>Step3\uff1a \u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\uff0c\u200b\u5728\u200b\u8fdb\u5165\u200bTrampoline\u200b\u5207\u6362\u200b\u524d\u200b\u6700\u540e\u200b\u4e00\u884c\u200bC\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b<code>kernel/trap.c:128</code>\u200b\u5904\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u65ad\u70b9\u200b\u6253\u200b\u5728\u200b\u6b64\u5904\u200b\uff0c\u200b\u7ee7\u7eed\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\u3002</p> <p></p> <p>Step4\uff1a \u200b\u5728\u200bxv6\u200b\u7684\u200bshell\u200b\u4e2d\u200b\u8f93\u5165\u200b<code>ls</code>\uff0c\u200b\u4ee5\u200b\u542f\u52a8\u200b<code>ls</code>\u200b\u7a0b\u5e8f\u200b\uff1b\u200b\u7a0b\u5e8f\u200b\u505c\u7559\u200b\u5728\u200b<code>kernel/trap.c:128</code>\u200b\u5904\u200b\u3002</p> <p></p> <p>Step5\uff1a \u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u786e\u8ba4\u200b\u5bf9\u5e94\u200bxv6\u200b\u7684\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u5165\u53e3\u200b\u70b9\u200b\uff0c\u200b\u6211\u4eec\u200b\u6709\u200b\u4e24\u79cd\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u786e\u8ba4\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u7684\u200b\u5165\u53e3\u200b\u70b9\u200b\uff1a</p> <ol> <li>\u200b\u901a\u8fc7\u200breadelf\u200b\u786e\u8ba4\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u5165\u53e3\u200b\u70b9\u200b\u3002</li> <li>\u200b\u5728\u200bVSCode\u200b\u4e0a\u200b\u76f4\u63a5\u200b\u6253\u5f00\u200b\u8be5\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u7684\u200b\u6e90\u4ee3\u7801\u200b\uff0c\u200b\u627e\u200b\u6253\u200bmain()\u200b\u51fd\u6570\u200b\uff0c\u200b\u5e76\u200b\u5728\u200bmain()\u200b\u51fd\u6570\u200b\u91cc\u200b\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\u3002</li> </ol> <p>\u200b\u4ee5\u4e0b\u200b\u5206\u522b\u200b\u4ecb\u7ecd\u200b\u4e24\u79cd\u200b\u65b9\u6cd5\u200b\uff1a</p> <p>\u200b\u65b9\u6cd5\u200b\u4e00\u200b:  \u200b\u901a\u8fc7\u200breadelf\u200b\u786e\u8ba4\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u5165\u53e3\u200b\u70b9\u200b</p> <p>ls\u200b\u7684\u200belf\u200b\u6587\u4ef6\u200b\u4f4d\u4e8e\u200b<code>user/_ls</code>\uff1a</p> <pre><code>lgz_stu@OSLabExecNode1:~/xv6-oslab23-hitsz$ readelf -h user/_ls\nELF Header:\n  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 \n  Class:                             ELF64\n  Data:                              2's complement, little endian\n  Version:                           1 (current)\n  OS/ABI:                            UNIX - System V\n  ABI Version:                       0\n  Type:                              EXEC (Executable file)\n  Machine:                           RISC-V\n  Version:                           0x1\n  Entry point address:               0x27a\n  Start of program headers:          64 (bytes into file)\n  Start of section headers:          25064 (bytes into file)\n  Flags:                             0x5, RVC, double-float ABI\n  Size of this header:               64 (bytes)\n  Size of program headers:           56 (bytes)\n  Number of program headers:         1\n  Size of section headers:           64 (bytes)\n  Number of section headers:         18\n  Section header string table index: 17\n</code></pre> <p>\u200b\u53ef\u89c1\u200b\u5176\u4e2d\u200b\u663e\u793a\u200b<code>Entry point address: 0x27a</code>\uff0c\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u5165\u53e3\u200b\u70b9\u200b\u4f4d\u4e8e\u200b<code>0x27a</code>\u200b\u5904\u200b\u3002\u200b\u968f\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u7528\u200b\u4e0a\u9762\u200b\u7684\u200b\u65b9\u6cd5\u200b\u5f00\u59cb\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u65ad\u70b9\u200b\u6253\u200b\u5728\u200b\u5373\u5c06\u200b\u8fd4\u56de\u200b\u7528\u6237\u200b\u6001\u5904\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u524d\u5f80\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff0c\u200b\u5728\u200b\u5176\u4e2d\u200b\u8f93\u5165\u200b<code>b *0x27a</code>\uff0c\u200b\u5373\u5c06\u200b\u65ad\u70b9\u200b\u7f6e\u4e8e\u200b<code>ls</code>\u200b\u7a0b\u5e8f\u200b\u5165\u53e3\u5904\u200b\uff1a</p> <p></p> <p>\u200b\u65b9\u6cd5\u200b\u4e8c\u200b:  \u200b\u5728\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u7684\u200b\u6e90\u4ee3\u7801\u200bmain()\u200b\u51fd\u6570\u200b\u6253\u65ad\u200b\u70b9\u200b</p> <p>\u200b\u5728\u200bVSCode\u200b\u4e2d\u200b\uff0c\u200b\u6253\u5f00\u200buser/ls.c\u200b\u6587\u4ef6\u200b\uff0c\u200b\u627e\u5230\u200bmain()\u200b\u51fd\u6570\u200b\uff0c\u200b\u5728\u200b\u7b2c\u200b78\u200b\u884c\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\u3002</p> <p></p> <p>\u200b\u901a\u8fc7\u200b\u4e0a\u8ff0\u200b\u4e24\u4e2a\u200b\u65b9\u6cd5\u200b\u90fd\u200b\u53ef\u4ee5\u200b\u786e\u8ba4\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u7684\u200b\u5165\u53e3\u200b\u70b9\u200b\uff0c\u200b\u5c06\u200b\u65ad\u70b9\u200b\u6253\u200b\u5728\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u7684\u200bmain()\u200b\u4e0a\u200b\u3002</p> <p>Step6\uff1a \u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5728\u200b\u8c03\u8bd5\u200b\u7a97\u53e3\u200b\u5de6\u4e0b\u89d2\u200b\u5220\u9664\u200b\u539f\u6709\u200b\u7684\u200b\u5185\u6838\u200b\u6001\u200b\u65ad\u70b9\u200b\uff0c\u200b\u5e76\u200b\u901a\u8fc7\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff0c\u200b\u52a0\u8f7d\u200b<code>ls</code>\u200b\u7684\u200b\u8c03\u8bd5\u200b\u7b26\u53f7\u200b\u3002\u200b\u5728\u200b\u5176\u4e2d\u200b\u8f93\u5165\u200b<code>file user/_ls</code>\uff1a</p> <p> </p> <p>Step7\uff1a \u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\u3002\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u5df2\u7ecf\u200b\u8fdb\u5165\u200b\u4e86\u200bls.c\u200b\u7684\u200bmain\u200b\u51fd\u6570\u200b\u4e2d\u200b\u3002</p> <p></p> <p>Step8\uff1a \u200b\u6b64\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5728\u200buser/ls.c\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u76f4\u63a5\u200b\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\uff0c\u200b\u4e0b\u56fe\u200b\u662f\u200b\u5728\u200buser/ls.c\u200b\u4e2d\u200b\u7684\u200b\u7b2c\u200b78\u200b\u884c\u200b\u6253\u65ad\u200b\u70b9\u200b\u3002\u200b\u5982\u679c\u200b\u5df2\u7ecf\u200b\u5728\u200b78\u200b\u884c\u6253\u8fc7\u200b\u65ad\u70b9\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5ffd\u7565\u200b\u8fd9\u200b\u4e00\u6b65\u200b\u3002</p> <p></p> <p>Step9\uff1a \u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u7ee7\u7eed\u6267\u884c\u200b\u3002qemu\u200b\u5c06\u200b\u505c\u6b62\u200b\u5728\u200b<code>ls</code>\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u7b2c\u200b78\u200b\u884c\u200b\u3002</p> <p></p> <p>\u200b\u70b9\u51fb\u200b\u4e0a\u65b9\u200b\u7684\u200b\u5355\u6b65\u200b\u8c03\u8bd5\u200b\u6309\u94ae\u200b\uff0c\u200b\u6211\u4eec\u200b\u53d1\u73b0\u200bvscode\u200b\u7684\u200bGUI\u200b\u8c03\u8bd5\u200b\u5de5\u5177\u200b\u73b0\u200b\u4e5f\u200b\u4ee5\u200b\u53ef\u4ee5\u200b\u6b63\u5e38\u200b\u5de5\u4f5c\u200b\u3002</p> <p></p> <p>\u200b\u6b64\u540e\u200b\u7684\u200b\u5404\u79cd\u200b\u8c03\u8bd5\u200b\u6d41\u7a0b\u200b\u4e0e\u200b\u8c03\u8bd5\u200b\u5185\u6838\u200b\u65f6\u200b\u76f8\u540c\u200b\u3002</p>"},{"location":"remote_env_gdb/#445","title":"4.4.5 \u200b\u5176\u4ed6\u200b...","text":"<p>\u200b\u5269\u4e0b\u200b\u7684\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u5bfb\u627e\u200bGDB\u200b\u7684\u200b\u624b\u518c\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u7531\u4e8e\u200b\u6211\u4eec\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u8fd0\u884c\u200b\u5728\u200bqemu\u200b\u4e0a\u200b\uff0c\u200b\u4e14\u200b\u4f7f\u7528\u200b\u7684\u200b\u662f\u200b\u8f83\u4e3a\u200b\u65b0\u9896\u200b\u7684\u200bRISC-V\u200b\u67b6\u6784\u200b\uff0c\u200b\u6545\u800c\u200b\u5e38\u5e38\u200b\u4f1a\u200b\u6709\u200b\u4e0d\u200b\u652f\u6301\u200b\u6216\u8005\u200b\u9519\u8bef\u200b\u7684\u200b\u60c5\u51b5\u200b\u53d1\u751f\u200b\uff0c\u200b\u8fd9\u662f\u200b\u6b63\u5e38\u200b\u7684\u200b\u3002\u200b\u540c\u5b66\u200b\u4eec\u200b\u53ef\u4ee5\u200b\u8bd5\u8bd5\u200b\u81ea\u884c\u89e3\u51b3\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"remote_env_gdb2/","title":"\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u73af\u5883\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5\u200b\u6307\u5357\u200b(\u200b\u4e8c\u200b)\u2014\u2014\u200b\u7cfb\u7edf\u200b\u8c03\u7528","text":"<p>\u200b\u8fd9\u90e8\u5206\u200b\u6df1\u5165\u200b\u4ecb\u7ecd\u200b\u4e86\u200bVSCode\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200bGDB\u200b\u8c03\u8bd5\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u6d89\u53ca\u200b\u5230\u200b\u4e86\u200bpage table\u200b\u7684\u200b\u90e8\u5206\u200b\u5185\u5bb9\u200b\u4ee5\u53ca\u200b\u6c47\u7f16\u200b\u4ee3\u7801\u200b\uff0c\u200b\u867d\u7136\u200b\u6709\u4e9b\u200b\u6666\u6da9\u200b\u96be\u61c2\u200b\uff0c\u200b\u4f46\u200b\u5982\u679c\u200b\u60f3\u8981\u200b\u6df1\u5165\u200b\u4e86\u89e3\u200b\u6574\u4e2a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u90fd\u200b\u662f\u200b\u8981\u200b\u638c\u63e1\u200b\u7684\u200b\u5fc5\u4e0d\u53ef\u5c11\u200b\u7684\u200b\u77e5\u8bc6\u70b9\u200b\u3002\u200b\u4e0b\u9762\u200b\u4ee5\u200bls.c\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200b<code>fstat</code>\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u6267\u884c\u200b\u8fc7\u7a0b\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u91c7\u7528\u200bGDB\u200b\u8c03\u8bd5\u200b\u5206\u6790\u200b<code>ecall</code>\u200b\u6307\u4ee4\u200b\u524d\u540e\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u4f9b\u200b\u540c\u5b66\u200b\u4eec\u200b\u8fdb\u884c\u200b\u53c2\u8003\u200b\u3002</p> <p>\u200b\u4e3a\u4e86\u200b\u7ed9\u200b\u540c\u5b66\u200b\u4eec\u200b\u6f14\u793a\u200b\u5982\u4f55\u200b\u7528\u200bVSCode\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5\u200bXV6\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u5728\u200bVSCode\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5\u200b\u6307\u5357\u200b\uff08\u200b\u4e00\u200b\uff09\u200b\u91cc\u200b\u7684\u200b\u4e24\u4e2a\u200b\u89c6\u9891\u200b\u4e4b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u518d\u200b\u5f55\u5236\u200b\u4e86\u200b2\u200b\u4e2a\u200b\u6f14\u793a\u200b\u89c6\u9891\u200b\uff1a</p> <ol> <li>\u30103. VSCode\u200b\u8c03\u8bd5\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fc7\u7a0b\u200b\uff08\u200b\u5305\u542b\u200bpagetable\u200b\u548c\u200b\u6c47\u7f16\u200b\uff09\u3011 https://www.bilibili.com/video/BV12P411J7xq?share_source=copy_web&amp;vd_source=a822dcda3537564ccdd0bb45aa0afe33</li> <li>\u30104. VSCode\u200b\u8c03\u8bd5\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u2014\u2014\u200b\u4ece\u200b\u5185\u6838\u200b\u5230\u200b\u7528\u6237\u200b\uff0c\u200b\u518d\u200b\u4ece\u200b\u7528\u6237\u200b\u8fd4\u56de\u200b\u5185\u6838\u200b\u3011 https://www.bilibili.com/video/BV1ug411m7ir?share_source=copy_web&amp;vd_source=a822dcda3537564ccdd0bb45aa0afe33vd_source=a822dcda3537564ccdd0bb45aa0afe33</li> </ol>"},{"location":"remote_env_gdb2/#1-ecall","title":"1. ECALL\u200b\u6307\u4ee4\u200b\u4e4b\u524d\u200b\u7684\u200b\u72b6\u6001","text":"<p>\u200b\u9996\u5148\u200b\uff0c\u200b\u53c2\u8003\u200b\u7528\u6237\u200b\u6001\u200b\u7a0b\u5e8f\u8c03\u8bd5\u200b\u4ece\u200b\u5185\u6838\u200b\u8fdb\u5165\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200buser/ls.c\u3002</p> <p>\u200b\u5728\u200b\u7b2c\u200b38\u200b\u884c\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\u3002</p> <p></p> <p>\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\uff0c\u200b\u7a0b\u5e8f\u200b\u5c06\u200b\u81ea\u52a8\u200b\u8fd0\u884c\u200b\u5230\u200b\u7b2c\u200b38\u200b\u884c\u200b\u5e76\u200b\u505c\u6b62\u200b\uff1a</p> <p></p> <p>\u200b\u5728\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\u8f93\u5165\u200b<code>display/10i $pc</code>\uff0c\u200b\u8ba9\u200bgdb\u200b\u6301\u7eed\u200b\u81ea\u52a8\u200b\u663e\u793a\u200b\u4ece\u200bpc\u200b\u8d77\u200b\u7684\u200b10\u200b\u6761\u200b\u6307\u4ee4\u200b\u3002</p> <p></p> <p>\u200b\u5728\u200buser/ls.asm\u200b\u53cd\u6c47\u7f16\u200b\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200becall\u200b\u6307\u4ee4\u200b\u6c47\u7f16\u200b\u5730\u5740\u200b\u662f\u200b0x59c\u3002</p> <p></p> <p>\u200b\u63a5\u7740\u200b\uff0c\u200b\u8f93\u5165\u200b<code>b *0x59c</code>\u200b\u5728\u200becall\u200b\u6307\u4ee4\u200b\u4e0a\u200b\u6253\u65ad\u200b\u70b9\u200b\u3002\u200b\u518d\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\uff0c\u200b\u7a0b\u5e8f\u200b\u81ea\u52a8\u200b\u505c\u200b\u5728\u200b\u4e86\u200becall\u200b\u6307\u4ee4\u200b\u90a3\u200b\u4e00\u884c\u200b\u4e0a\u200b\u3002</p> <p>\u200b\u6216\u8005\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u8fde\u7eed\u200b\u591a\u6b21\u200b\u8f93\u5165\u200b<code>si</code>\uff08stepi\u200b\u547d\u4ee4\u200b\uff09\uff0c\u200b\u5355\u6b65\u200b\u6267\u884c\u200b\u6bcf\u200b\u4e00\u6761\u200b\u6c47\u7f16\u200b\u6307\u4ee4\u200b\uff0c\u200b\u76f4\u5230\u200b\u7a0b\u5e8f\u200b\u505c\u6b62\u200becall\u200b\u6307\u4ee4\u200b\u5904\u200b\u3002</p> <p></p> <p>\u200b\u6211\u4eec\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u8f93\u5165\u200b<code>info reg</code>\u200b\u6253\u5370\u200b\u5168\u90e8\u200b32\u200b\u4e2a\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u503c\u200b</p> <p></p> <p>\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5173\u5fc3\u200b\u7684\u200b\u662f\u200ba0\u3001a1\u200b\u5bc4\u5b58\u5668\u200b\uff0cls\u200b\u7a0b\u5e8f\u200b\u4f20\u9012\u200b\u7ed9\u200bfstat\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u53c2\u6570\u200b\u3002\u200b\u5176\u4e2d\u200b\uff0ca0\u200b\u662f\u200b<code>fd</code>\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\uff0ca1\u200b\u662f\u200b\u8981\u200b\u83b7\u53d6\u200bstat\u200b\u7ed3\u6784\u200b\u4f53\u200b\u4fe1\u606f\u200b\u7684\u200b\u6307\u9488\u200b\u3002</p> <p>\u200b\u6b64\u65f6\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u8f93\u5165\u200b<code>print/x $satp</code>\u200b\u6216\u8005\u200b<code>p/x $satp</code>\u200b\u67e5\u770b\u200bsatp\u200b\u5bc4\u5b58\u5668\u200b\uff08\u200b\u9875\u8868\u200b\u6240\u5728\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\uff09\u3002</p> <p></p> <p>satp\u200b\u5bc4\u5b58\u5668\u200b\u7ed9\u51fa\u200b\u7684\u200b\u7269\u7406\u200b\u5185\u5b58\u5730\u5740\u200b\u662f\u200b0x8000000000087f48\u3002</p> <p>\u200b\u5982\u679c\u200b\u60f3\u200b\u8fdb\u4e00\u6b65\u200b\u67e5\u770b\u200bpage table\u200b\u7684\u200b\u6620\u5c04\u200b\u5173\u7cfb\u200b\uff0c\u200b\u5728\u200bQEMU\u200b\u754c\u9762\u200b\u4e2d\u200b\uff08\u200b\u6ce8\u610f\u200b\uff0c\u200b\u662f\u200b\u5728\u200b<code>\u200b\u7ec8\u7aef\u200b</code>\uff0c\u200b\u4e0d\u662f\u200b\u5728\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff09\uff0c\u200b\u8f93\u5165\u200b<code>ctrl a + c</code>\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u8fdb\u5165\u200bQEMU\u200b\u7684\u200bconsole\uff0c\u200b\u4e4b\u540e\u200b\u518d\u200b\u8f93\u5165\u200b<code>info mem</code>\u3002</p> <p></p> <p>\u200b\u4e0a\u9762\u200b\u6253\u5370\u200b\u51fa\u6765\u200b\u7684\u200b\u662f\u200b\u7528\u6237\u7a0b\u5e8f\u200b<code>ls</code>\u200b\u7684\u200bpage table\uff0c\u200b\u975e\u5e38\u200b\u5c0f\u200b\uff0c\u200b\u53ea\u200b\u5305\u542b\u200b\u4e86\u200b5\u200b\u6761\u200b\u6620\u5c04\u200b\u5173\u7cfb\u200b\u3002</p> <p>page table\u200b\u62d3\u5c55\u200b\u77e5\u8bc6\u200b</p> <p>\u200b\u5728\u200b\u4e0a\u200b\u56fe\u200b\u4e2d\u200b\uff0c<code>attr</code>\u200b\u662f\u200bPTE\uff08\u200b\u9875\u8868\u200b\uff0cPage Table Entry\uff09\u200b\u7684\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u3002  </p> <ul> <li><code>r</code>\uff1aReadable\uff0c\u200b\u53ef\u200b\u8bfb\u200b</li> <li><code>w</code>\uff1aWritable\uff0c\u200b\u53ef\u200b\u5199\u200b</li> <li><code>x</code>\uff1aExecutable\uff0c\u200b\u53ef\u200b\u6267\u884c\u200b</li> <li><code>u</code>\uff1aUser\uff0c\u200b\u8868\u660e\u200bPTE_u\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u662f\u5426\u200b\u88ab\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u7528\u6237\u200b\u4ee3\u7801\u200b\u53ea\u80fd\u200b\u8bbf\u95ee\u200bu\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u8bbe\u7f6e\u200b\u4e86\u200b\u7684\u200bPTE\u3002\u200b\u4e5f\u200b\u5c31\u662f\u200b\u5982\u679c\u200b\u6709\u200b\u8fd9\u4e2a\u200b\u6807\u5fd7\u200b\u4f4d\u200b\uff0c\u200b\u5219\u200b\u8bf4\u660e\u200b\u8fd9\u4e2a\u200bpage\u200b\u53ef\u4ee5\u200b\u88ab\u200b\u8fd0\u884c\u200b\u5728\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u8bbf\u95ee\u200b\u3002</li> <li><code>a</code>\uff1aAccessed\uff0c\u200b\u8868\u660e\u200b\u8fd9\u200b\u6761\u200bPTE\u200b\u662f\u5426\u200b\u88ab\u200b\u4f7f\u7528\u200b\u8fc7\u200b\u3002</li> <li><code>g</code>\uff1aGlobal</li> <li><code>d</code>\uff1aDirty\uff0c\u200b\u8868\u660e\u200b\u8fd9\u200b\u6761\u200bPTE\u200b\u662f\u5426\u200b\u88ab\u200b\u5199\u200b\u8fc7\u200b\u3002</li> </ul> <p>\u200b\u6700\u540e\u200b\u4e24\u6761\u200bPTE\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u975e\u5e38\u200b\u5927\u200b\uff08\u200b\u63a5\u8fd1\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b\u9876\u7aef\u200b\uff09\uff0c\u200b\u5b83\u4eec\u200b\u5206\u522b\u200b\u662f\u200btrapframe page\u200b\u548c\u200b trampoline page\uff08\u200b\u8be6\u89c1\u200bxv6 book P24-26\uff09\u3002\u200b\u8fd9\u200b\u4e24\u4e2a\u200bPTE\u200b\u6ca1\u6709\u200bu\u200b\u6807\u5fd7\u200b\u4f4d\u200b\uff0c\u200b\u7528\u6237\u200b\u4ee3\u7801\u200b\u4e0d\u80fd\u200b\u8bbf\u95ee\u200b\u5b83\u4eec\u200b\u3002\u200b\u5f53\u200b\u8fdb\u5165\u200bsupervisor mode\u200b\u65f6\u200b\uff0c\u200b\u624d\u200b\u80fd\u591f\u200b\u8bbf\u95ee\u200b\u3002\u200b\u53ef\u80fd\u200b\u6709\u200b\u540c\u5b66\u200b\u6ce8\u610f\u200b\u5230\u200b\uff0c\u200b\u7b2c\u4e8c\u6761\u200bPTE\u200b\u4e5f\u200b\u6ca1\u6709\u200bu\u200b\u6807\u5fd7\u200b\u4f4d\u200b\uff0c\u200b\u8fd9\u662f\u200b\u4e00\u4e2a\u200b\u65e0\u6548\u200b\u7684\u200bpage\uff08guard page\uff09\uff0c\u200b\u4ee5\u200b\u9632\u6b62\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u5c1d\u8bd5\u200b\u4f7f\u7528\u200b\u8fc7\u591a\u200b\u7684\u200bstack page\u3002</p> <p></p> <p>\u200b\u6211\u4eec\u200b\u5728\u200bkernel/memlayout.h\u200b\u5934\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200btrapframe\u200b\u7684\u200b\u5b9a\u4e49\u200b\u3002</p> <pre><code>// map the trampoline page to the highest address,\n// in both user and kernel space.\n#define TRAMPOLINE (MAXVA - PGSIZE)\n</code></pre> <p>PGSIZE\u200b\u548c\u200bMAXVA\u200b\u7684\u200b\u5b9a\u4e49\u200b\u5728\u200bkernel/riscv.h\u3002</p> <pre><code>#define PGSIZE 4096 // bytes per page\n\n// one beyond the highest possible virtual address.\n// MAXVA is actually one bit less than the max allowed by\n// Sv39, to avoid having to sign-extend virtual addresses\n// that have the high bit set.\n#define MAXVA (1L &lt;&lt; (9 + 9 + 9 + 12 - 1))\n</code></pre> <p>\u200b\u8fd9\u6837\u200b\uff0c\u200b\u5c31\u200b\u80fd\u200b\u8ba1\u7b97\u200b\u51fa\u200bTRAMPOLINE\u200b\u7684\u200b\u5730\u5740\u200b\u662f\u200b<code>1&lt;&lt;38 - 4096 = 0x3ffffff000</code>\uff0c\u200b\u8fd9\u4e2a\u200b\u5730\u5740\u200b\u548c\u200b\u4e0a\u9762\u200b\u7528\u200b<code>info mem</code>\u200b\u547d\u4ee4\u200b\u67e5\u5230\u200b\u7684\u200b\u6700\u540e\u200b\u4e00\u6761\u200bPTE\u200b\u662f\u200b\u4e00\u6837\u200b\u7684\u200b\u3002\u200b\u4e5f\u200b\u5c31\u662f\u200b\uff0c\u200b\u6700\u540e\u200b\u4e00\u6761\u200bPTE\u200b\u6b63\u662f\u200bTRAMPOLINE\u3002</p>"},{"location":"remote_env_gdb2/#2-ecall","title":"2. ECALL\u200b\u6307\u4ee4\u200b\u4e4b\u540e\u200b\u7684\u200b\u72b6\u6001","text":"<p>\u200b\u4e3a\u4e86\u200b\u80fd\u591f\u200b\u8ba9\u200b\u7a0b\u5e8f\u200b\u505c\u7559\u200b\u5728\u200btrampoline.S\u200b\u7684\u200buserver\u200b\u6bb5\u200b\u7684\u200b\u7b2c\u4e00\u6761\u200b\u6307\u4ee4\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>0x3ffffff000</code>\u200b\u5730\u5740\u200b\u4e0a\u200b\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\u3002</p> <p>\u200b\u5728\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u200b\u53f0\u4e0a\u200b\u8f93\u5165\u200b<code>b *0x3ffffff000</code>\u3002</p> <p></p> <p>\u200b\u70b9\u51fb\u200b\u201d\u200b\u8fd0\u884c\u200b\u201c\uff0c\u200b\u6216\u8005\u200b\u8f93\u5165\u200b<code>si</code>\u200b\u5355\u6b65\u200b\u6267\u884c\u200becall\u200b\u6307\u4ee4\u200b\u3002</p> <p></p> <p>\u200b\u4ece\u200b\u8fd9\u91cc\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\uff0c\u200b\u5df2\u7ecf\u200b\u8fdb\u5165\u200b\u4e86\u200btrampoline\u3002</p> <p>\u200b\u6b64\u65f6\u200b\uff0c\u200b\u6211\u4eec\u200b\u5728\u200bQEMU\u200b\u7684\u200bconsole\uff0c\u200b\u4e4b\u540e\u200b\u518d\u200b\u8f93\u5165\u200b<code>info mem</code>\u3002</p> <p></p> <p>\u200b\u53ef\u4ee5\u200b\u770b\u51fa\u200b\uff0cpage table\u200b\u5e76\u200b\u6ca1\u6709\u200b\u53d1\u751f\u200b\u6539\u53d8\u200b\uff0c\u200b\u4e5f\u5c31\u662f\u8bf4\u200becall\u200b\u5e76\u200b\u6ca1\u6709\u200b\u5207\u6362\u200bpage table\u3002</p> <p>\u200b\u7ee7\u7eed\u200b\u89c2\u5bdf\u200buservec\u200b\u6c47\u7f16\u200b\u4ee3\u7801\u200b\uff0c\u200b\u91cc\u9762\u200b\u6709\u200b\u5f88\u591a\u200bsd\u200b\u6307\u4ee4\u200b\uff0c\u200b\u7528\u6765\u200b\u4fdd\u5b58\u200b\u7528\u6237\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u6307\u4ee4\u200b\u6bd4\u8f83\u200b\u65e0\u8da3\u200b\uff0c\u200b\u6682\u65f6\u200b\u4e0d\u7ba1\u200b\u5b83\u4eec\u200b\uff08\u200b\u540e\u9762\u200b\u6211\u4eec\u200b\u8fd8\u4f1a\u200b\u56de\u6765\u200b\u5206\u6790\u200b\u7684\u200b:-\uff09\u3002\u200b\u6211\u4eec\u200b\u5148\u770b\u200b\u5728\u200b\u7b2c\u200b76-85\u200b\u884c\u200b\uff0c\u200b\u901a\u8fc7\u200b\u9605\u8bfb\u200b\u6ce8\u91ca\u200b\u4e86\u89e3\u200b\u5230\u200b\uff0c\u200b\u5728\u200b\u51c6\u5907\u200b\u8df3\u5165\u200busertrap()\u200b\u4e4b\u524d\u200b\uff0c\u200b\u9700\u8981\u200b\u5148\u200b\u5207\u6362\u200bkernel page\u3002</p> <pre><code>76        # restore kernel page table from p-&gt;trapframe-&gt;kernel_satp\n77        ld t1, 0(a0)\n78        csrw satp, t1\n79        sfence.vma zero, zero\n80\n81        # a0 is no longer valid, since the kernel page\n82        # table does not specially map p-&gt;tf.\n83\n84        # jump to usertrap(), which does not return\n85        jr t0\n</code></pre> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u65ad\u70b9\u200b\u6253\u200b\u5728\u200b<code>0x3ffffff08e</code>\u200b\u5730\u5740\u200b\u4e0a\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u8ba9\u200b\u7a0b\u5e8f\u200b\u505c\u7559\u200b\u5728\u200b\u8df3\u5165\u200busertrap()\u200b\u4e4b\u524d\u200b\u3002</p> <p>\u200b\u5982\u4f55\u200b\u77e5\u9053\u200b\u7b2c\u200b85\u200b\u884c\u200b<code>jr t0</code>\u200b\u8bed\u53e5\u200b\u7684\u200b\u5730\u5740\u200b\u662f\u200b<code>0x3ffffff08e</code>\uff1f</p> <p>\u200b\u5728\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff0c\u200b\u8f93\u5165\u200b<code>x/40i $pc</code>\u200b\u663e\u793a\u200b\u5f53\u524d\u200bPC\u200b\u540e\u9762\u200b\u7684\u200b40\u200b\u6761\u200b\u6307\u4ee4\u200b\uff0c\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b<code>jr t0</code>\u200b\u5bf9\u5e94\u200b\u7684\u200b\u5730\u5740\u200b\u3002</p> <p>\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u67e5\u770b\u200bkernel.asm\u200b\u53cd\u6c47\u7f16\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5728\u200b<code>0000000080007000 &lt;_trampoline&gt;:</code>\u200b\u6bb5\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b<code>jr t0</code>\u200b\u76f8\u5bf9\u200buservec\u200b\u7b2c\u4e00\u6761\u200b\u6307\u4ee4\u200b\u4f4d\u7f6e\u200b\u504f\u79fb\u200b\u4e86\u200b<code>0x8e</code>\uff0c\u200b\u5c06\u200b<code>0x3ffffff000</code> + <code>0x8e</code>\uff0c\u200b\u5c31\u662f\u200b<code>0x3ffffff08e</code>\u3002</p> <p>\u200b\u8f93\u5165\u200b<code>b *0x3ffffff08e</code></p> <p></p> <p>\u200b\u70b9\u51fb\u200b\u201d\u200b\u8fd0\u884c\u200b\u201c\u3002</p> <p></p> <p>\u200b\u5728\u200b\u8df3\u8f6c\u200b\u5230\u200b\u5185\u6838\u200bC\u200b\u8bed\u8a00\u200b\u4ee3\u7801\u8fd0\u884c\u200b\u4e4b\u524d\u200b\uff0c\u200b\u52a0\u8f7d\u200bkernel\u200b\u7684\u200b\u8c03\u8bd5\u200b\u7b26\u53f7\u200b\uff0c\u200b\u8f93\u5165\u200b<code>file kernel/kernel</code></p> <p></p> <p>\u200b\u63a5\u7740\u200b\uff0c\u200b\u8f93\u5165\u200b<code>si</code>\u200b\u5355\u6b65\u200b\u6267\u884c\u200b\u6c47\u7f16\u200b\u6307\u4ee4\u200b\u3002</p> <p></p> <p>\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u5df2\u7ecf\u200b\u8fdb\u5165\u200b\u4e86\u200btrap.c\u200b\u7684\u200busertrap\u200b\u51fd\u6570\u200b\u4e2d\u200b\u4e86\u200b\u3002</p> <p>\u200b\u6b64\u65f6\u200b\u6211\u4eec\u200b\u518d\u200b\u89c2\u5bdf\u200bpage table\uff0c\u200b\u5728\u200bqemu\u200b\u63a7\u5236\u53f0\u200b\u8f93\u5165\u200b<code>info mem</code></p> <p></p> <p>\u200b\u53ef\u4ee5\u200b\u770b\u51fa\u200b\u4e0e\u200b\u4e4b\u524d\u200b\u7684\u200bpage table\u200b\u4e0d\u200b\u4e00\u6837\u200b\u4e86\u200b\uff0c\u200b\u5df2\u7ecf\u200b\u4ece\u200buser page table\u200b\u5207\u6362\u200b\u5230\u200b\u4e86\u200bkernel page table\uff0c\u200b\u8bf4\u660e\u200b\u5df2\u7ecf\u200b\u51c6\u5907\u200b\u597d\u200b\u4e86\u200b\u6267\u884c\u200b\u5185\u6838\u200b\u4e2d\u200b\u7684\u200bC\u200b\u4ee3\u7801\u200b\u4e86\u200b\u3002</p> <p><code>trampoline</code>\u200b\u62d3\u5c55\u200b\u77e5\u8bc6\u200b</p> <p>\u200b\u6ce8\u610f\u200b\u89c2\u5bdf\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u80fd\u200b\u5df2\u7ecf\u200b\u53d1\u73b0\u200b\u4e86\u200b\uff0cuser page table\u200b\u548c\u200bkernel page table\u200b\u7684\u200btrampoline page\u200b\u7684\u200b\u6620\u5c04\u200b\u662f\u200b\u5b8c\u5168\u200b\u4e00\u6837\u200b\u7684\u200b\uff08\u200b\u865a\u62df\u5730\u5740\u200b\u90fd\u200b\u662f\u200b<code>0x3ffffff000</code>\uff09\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u5728\u200b\u5207\u6362\u200bpage table\u200b\u65f6\u200b\uff0c\u200b\u5bfb\u5740\u200b\u7684\u200b\u7ed3\u679c\u200b\u4e0d\u4f1a\u200b\u6539\u53d8\u200b\uff0c\u200b\u5426\u5219\u200b\u5f53\u200btrampoline\u200b\u5207\u5b8c\u200b\u9875\u8868\u200b\u5c31\u200b\u53ef\u80fd\u200b\u56e0\u627e\u200b\u4e0d\u5230\u200b\u6307\u4ee4\u200b\u800c\u200b\u5d29\u6e83\u200b\u4e86\u200b\u3002\u200b\u8fd9\u200b\u4e5f\u200b\u6b63\u662f\u200btrampoline page\u200b\u7684\u200b\u7279\u6b8a\u200b\u4e4b\u200b\u5904\u200b\u3002</p> <p><code>trapframe</code>\u200b\u62d3\u5c55\u200b\u77e5\u8bc6\u200b</p> <p>\u200b\u53ef\u80fd\u200b\u8fd8\u6709\u200b\u540c\u5b66\u200b\u6ce8\u610f\u200b\u5230\u200b\uff0cuser page table\u200b\u4e2d\u200b\u5012\u6570\u200b\u7b2c\u4e8c\u4e2a\u200bPTE\u200b\u7684\u200bvaddr\uff08\u200b\u865a\u62df\u5730\u5740\u200b\uff1a0x3ffffffe00\uff09\u200b\u4e5f\u200b\u662f\u200b\u6bd4\u8f83\u200b\u5927\u200b\u3002\u200b\u5b83\u200b\u662f\u200b\u7531\u200bkernel\u200b\u8bbe\u7f6e\u200b\u597d\u200b\u7684\u200b\u6620\u5c04\u200b\u5173\u7cfb\u200b\uff0c\u200b\u7528\u4e8e\u200b\u6307\u5411\u200b\u4e00\u4e2a\u200b\u53ef\u4ee5\u200b\u7528\u6765\u200b\u5b58\u653e\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7528\u6237\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u5185\u5b58\u200b\u4f4d\u7f6e\u200b\uff08\u200b\u5982\u679c\u200b\u4f60\u200b\u60f3\u200b\u67e5\u770b\u200bxv6\u200b\u5728\u200btrapframe page\u200b\u4e2d\u200b\u5b58\u653e\u200b\u4e86\u200b\u4ec0\u4e48\u200b\uff0c\u200b\u8be6\u89c1\u200bproc.h\u200b\u7684\u200btrapframe\u200b\u7ed3\u6784\u200b\u4f53\u200b\uff09\u3002\u200b\u5728\u200b\u5185\u6838\u200b\u5207\u6362\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u65f6\u200b\uff0c\u200b\u5185\u6838\u200b\u4f1a\u200b\u6267\u884c\u200bset sscratch\u200b\u6307\u4ee4\u200b\uff0c\u200b\u5c06\u200bSSCRATCH\uff08Supervisor Scratch Register\uff09\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u5185\u5bb9\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b0x3ffffffe00\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200btrapframe page\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u3002\u200b\u5728\u200b\u8fd0\u884c\u200b\u7528\u6237\u200b\u4ee3\u7801\u200b\u65f6\u200b\uff0cSSCRATCH\u200b\u5bc4\u5b58\u5668\u200b\u4fdd\u5b58\u200b\u7684\u200b\u5c31\u662f\u200b\u6307\u5411\u200bTRAPFRAME\u200b\u7684\u200b\u5730\u5740\u200b\u3002</p> <p>\u200b\u90a3\u200b\u4e3a\u4ec0\u4e48\u200b\u5185\u6838\u200b\u8981\u200b\u4fdd\u5b58\u200b\u8fd9\u4e9b\u200b\u7528\u6237\u200b\u5bc4\u5b58\u5668\u200b\u5462\u200b\uff1f</p> <p>\u200b\u662f\u56e0\u4e3a\u200b\u5185\u6838\u200b\u5373\u5c06\u200b\u8981\u200b\u8fd0\u884c\u200b\u4f1a\u200b\u8986\u76d6\u200b\u8fd9\u4e9b\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200bC\u200b\u4ee3\u7801\u200b\u3002\u200b\u5f53\u200b\u4ece\u200b\u5185\u6838\u200b\u518d\u6b21\u200b\u5207\u56de\u200b\u81f3\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u65f6\u200b\uff0c\u200b\u5982\u679c\u200b\u8981\u200b\u60f3\u200b\u6b63\u786e\u200b\u6062\u590d\u200b\u7528\u6237\u7a0b\u5e8f\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u5c06\u200b\u7528\u6237\u200b\u5bc4\u5b58\u5668\u200b\u6062\u590d\u200b\u6210\u5728\u200becall\u200b\u6307\u4ee4\u200b\u6267\u884c\u200b\u4e4b\u524d\u200b\u7684\u200b\u72b6\u6001\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u9700\u8981\u200b\u5c06\u200b\u6240\u6709\u200b\u7684\u200b\u5bc4\u5b58\u5668\u200b\u90fd\u200b\u4fdd\u5b58\u200b\u5728\u200btrapframe\u200b\u4e2d\u200b\uff0c\u200b\u8fd9\u6837\u200b\u624d\u80fd\u200b\u5728\u200b\u4e4b\u540e\u200b\u6062\u590d\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u503c\u200b\u3002</p> <p>\u200b\u5c0f\u7ed3\u200b</p> <p>\u200b\u901a\u8fc7\u200b\u4e0a\u8ff0\u200b\u5206\u6790\u200b\u53ef\u77e5\u200b\uff0c\u200b\u662f\u200b\u901a\u8fc7\u200becall\u200b\u6307\u4ee4\u200b\u8d70\u200b\u5230\u200b<code>trampoline page</code>\uff0c\u200b\u90a3\u200becall\u200b\u6307\u4ee4\u200b\u90fd\u200b\u505a\u200b\u4e86\u200b\u4ec0\u4e48\u200b\u4e8b\u60c5\u200b\u5462\u200b\uff1f\u200b\u5b9e\u9645\u4e0a\u200b\uff0cecall\u200b\u53ea\u4f1a\u200b\u6539\u53d8\u200b\u4e09\u4ef6\u200b\u4e8b\u60c5\u200b\uff08\u200b\u90fd\u200b\u662f\u200b\u786c\u4ef6\u200b\u6765\u200b\u505a\u200b\u7684\u200b\uff09\uff1a</p> <ol> <li>ecall\u200b\u5c06\u200b\u4ee3\u7801\u200b\u4ece\u200buser mode\u200b\u6539\u200b\u5230\u200bsupervisor mode\uff0c\u200b\u5373\u200b\u66f4\u65b0\u200bCPU\u200b\u4e2d\u200b\u7684\u200bmode\u200b\u6807\u5fd7\u200b\u4f4d\u4f4d\u200bsupervisor\u3002</li> <li>ecall\u200b\u5c06\u200b\u7a0b\u5e8f\u200b\u8ba1\u6570\u5668\u200b\u7684\u200b\u503c\u200b\u4fdd\u5b58\u200b\u5728\u200bSEPC\uff08Supervisor Exception Program Counter\uff09\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u5c31\u662f\u200becall\u200b\u6307\u4ee4\u200b\u5728\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u5730\u5740\u200b\u3002\u200b\u5728\u200busertrap\u200b\u51fd\u6570\u200b\u4e2d\u200b\uff0c\u200b\u518d\u200b\u5c06\u200bSEPC\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u503c\u200b\u4fdd\u5b58\u200b\u5230\u200b<code>trapframe</code>\u200b\u7684\u200bepc\u200b\u91cc\u9762\u200b\u3002 </li> <li>ecall\u200b\u4f1a\u200b\u8df3\u8f6c\u200b\u5230\u200bSTVEC\uff08Supervisor Trap Vector Base Address Register\uff09\u200b\u5bc4\u5b58\u5668\u200b\u6307\u5411\u200b\u7684\u200b\u6307\u4ee4\u200b\u3002STVEC\u200b\u5bc4\u5b58\u5668\u200b\u662f\u200b\u5728\u200busertrapret\u200b\u51fd\u6570\u200b\uff08\u200b\u4f4d\u4e8e\u200btrap.c\u200b\u4e2d\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u5b8c\u6210\u200b\u4e86\u200b\u90e8\u5206\u200b\u65b9\u4fbf\u200b\u5728\u200bC\u200b\u4ee3\u7801\u200b\u4e2d\u200b\u5b9e\u73b0\u200b\u7684\u200b\u8fd4\u56de\u200b\u5230\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u5de5\u4f5c\u200b\uff09\u200b\u4e2d\u200b\u88ab\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b<code>TRAMPOLINE + (uservec - trampoline)</code>\uff0c\u200b\u5373\u200b<code>0x3ffffff000</code>\uff0c\u200b\u8fd9\u200b\u5c31\u662f\u200b\u6267\u884c\u200becall\u200b\u6307\u4ee4\u200b\u4e4b\u540e\u200b\u4e0b\u200b\u4e00\u6761\u200b\u6307\u4ee4\u200b\u6240\u5728\u200b\u7684\u200b\u4f4d\u7f6e\u200b\u3002\u200b\u4e5f\u200b\u5c31\u662f\u200b\uff0c\u200b\u5728\u200b\u8fdb\u5165\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u4e4b\u524d\u200b\uff0c\u200b\u5185\u6838\u200b\u4f1a\u200b\u5c06\u200btrampoline page\u200b\u7684\u200b\u5730\u5740\u200b\u5b58\u5728\u200bSTVEC\u200b\u5bc4\u5b58\u5668\u200b\u4e2d\u200b\u3002 </li> </ol> <p>\u200b\u800c\u200b\u5728\u200becall\u200b\u4e4b\u540e\u200b\uff0c\u200b\u5728\u200b\u6267\u884c\u200b\u5185\u6838\u200b\u4e2d\u200b\u7684\u200bC\u200b\u4ee3\u7801\u200b\u4e4b\u524d\u200b\uff0c\u200b\u63a5\u4e0b\u6765\u200b\u8fd8\u6709\u200b\u4e00\u4e9b\u200b\u5de5\u4f5c\u200b\u662f\u200b\u6c47\u7f16\u200b\u6765\u200b\u505a\u200b\u7684\u200b\uff1a</p> <ol> <li>\u200b\u4fdd\u5b58\u200b32\u200b\u4e2a\u200b\u7528\u6237\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u8fd9\u6837\u200b\u5f53\u200b\u4ece\u200b\u5185\u6838\u200b\u6001\u200b\u8fd4\u56de\u200b\u7528\u6237\u200b\u6001\u65f6\u200b\uff0c\u200b\u624d\u80fd\u200b\u6062\u590d\u200b\u8fd9\u4e9b\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</li> <li>\u200b\u4ece\u200buser page table\u200b\u5207\u6362\u200b\u5230\u200bkernel page table\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u627e\u5230\u200b<code>kernel satp</code>\u3002</li> <li>\u200b\u5c06\u200bsp\uff08Stack Pointer\uff09\u200b\u5bc4\u5b58\u5668\u200b\u6307\u5411\u200b<code>kernel stack</code>\uff0c\u200b\u8fd9\u6837\u200b\u624d\u80fd\u200b\u7ed9\u200b\u5185\u6838\u200bC\u200b\u4ee3\u7801\u200b\u63d0\u4f9b\u200b\u6808\u200b\u3002</li> </ol> <p>\u200b\u5176\u4e2d\u200b\uff0c<code>kernel satp</code>\u200b\u548c\u200b<code>kernel stack</code>\u200b\u662f\u200b\u5728\u200busertrapret\u200b\u51fd\u6570\u200b\u4e2d\u200b\u8bbe\u7f6e\u200b\u597d\u200b\u7684\u200b\uff0c\u200b\u5373\u200b\u4e4b\u524d\u200b\u5185\u6838\u200b\u5728\u200b\u8fdb\u5165\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u65f6\u200b\u5c31\u200b\u8bbe\u7f6e\u200b\u597d\u200b\u7684\u200b\u3002  </p> <p>\u200b\u4e4b\u540e\u200b\uff0c\u200b\u624d\u80fd\u200b\u8df3\u8f6c\u200b\u5230\u200b\u5185\u6838\u200b\u4e2d\u200bC\u200b\u4ee3\u7801\u200b\u7684\u200busertrap\u200b\u51fd\u6570\u200b\u4e2d\u200b\u3002</p>"},{"location":"remote_env_gdb2/#3-c","title":"3. \u200b\u6c47\u7f16\u200b\u4e4b\u540e\u200b\u7684\u200bC\u200b\u4ee3\u7801","text":"<p>\u200b\u81ea\u4ece\u200b\u89c1\u5230\u200b\u4e86\u200busertrap\uff0c\u200b\u6211\u4eec\u200b\u5c31\u200b\u5df2\u7ecf\u200b\u8fdb\u5165\u200b\u4e86\u200bC\u200b\u8bed\u8a00\u200b\u7684\u200b\u4e16\u754c\u200b\uff0c\u200b\u76f8\u6bd4\u200b\u4e0a\u8ff0\u200b\u6c47\u7f16\u200b\u4ee3\u7801\u200b\u6765\u8bf4\u200b\uff0c\u200b\u5c11\u200b\u4e86\u200b\u5f88\u591a\u200b\u6666\u6da9\u200b\u96be\u61c2\u200b\u7684\u200b\u5730\u65b9\u200b\uff0c\u200b\u662f\u4e0d\u662f\u200b\u89c9\u5f97\u200b\u751f\u6d3b\u200b\u66f4\u52a0\u200b\u7f8e\u597d\u200b\u4e86\u200b\u5462\u200b: )</p> <p>\u200b\u4ece\u200b\u524d\u9762\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u7684\u200b\u90e8\u5206\u200b\uff0c\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u77e5\u9053\u200b\uff0c\u200b\u6709\u200b\u5f88\u591a\u200b\u539f\u56e0\u200b\u90fd\u200b\u53ef\u4ee5\u200b\u8ba9\u200b\u7a0b\u5e8f\u200b\u8fdb\u5165\u200busertrap\u200b\u51fd\u6570\u200b\u4e2d\u6765\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u6765\u8bf4\u200b\uff0c\u200b\u6211\u4eec\u200b\u66f4\u200b\u5173\u5fc3\u200b\u7684\u200b\u662f\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4ee3\u7801\u200b\uff0c\u200b\u90a3\u4e48\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b\u7b2c\u200b67\u200b\u884c\u200b<code>syscall();</code>\u200b\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\uff0c\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\uff0c\u200b\u8ba9\u200b\u7a0b\u5e8f\u200b\u505c\u7559\u200b\u5728\u200bsyscall()\u200b\u51fd\u6570\u200b\u3002\u200b\u5f53\u7136\u200b\uff0c\u200b\u559c\u6b22\u200b\u63a2\u7d22\u200b\u7684\u200b\u540c\u5b66\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u6df1\u5165\u5206\u6790\u200busertrap()\u200b\u51fd\u6570\u200b\u7684\u200b\u6267\u884c\u200b\u6d41\u7a0b\u200b\u3002</p> <p>\u200b\u63a5\u7740\u200b\u8fdb\u5165\u200bsyscall.c\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200bsyscall()\uff0c\u200b\u90a3\u4e48\u200b\u540c\u5b66\u200b\u4eec\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u6109\u5feb\u200b\u5730\u200b\u8fdb\u884c\u200b\u8c03\u8bd5\u200b\u5206\u6790\u200b\u540e\u9762\u200b\u7684\u200b\u4ee3\u7801\u200b\u5427\u200b\u3002</p>"},{"location":"remote_env_gdb2/#4","title":"4. \u200b\u4e00\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200b\u4ece\u200b\u7528\u6237\u200b\u5230\u200b\u5185\u6838\u200b\u7a7a\u95f4\u200b\u7684\u200b\u8c03\u8bd5\u200b\u65b9\u6cd5","text":"<p>\u200b\u6709\u200b\u540c\u5b66\u200b\u53ef\u80fd\u200b\u95ee\u200b\uff0c\u200b\u80fd\u200b\u4e0d\u80fd\u200b\u8df3\u8fc7\u200b\u6c47\u7f16\u200b\u4ee3\u7801\u200b\uff0c\u200b\u76f4\u63a5\u200b\u6253\u200b\u6253\u65ad\u200b\u70b9\u5230\u200bC\u200b\u4ee3\u7801\u200b\u5462\u200b\uff1f\u200b\u7b54\u6848\u200b\u662f\u200b\u53ef\u4ee5\u200b\u7684\u200b\u3002\u200b\u4e0b\u9762\u200b\u8fd8\u662f\u200b\u4ee5\u200bls\u200b\u4e2d\u200b\u7684\u200bfstat\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u4ecb\u7ecd\u200b\u4e00\u4e2a\u200b\u8f83\u4e3a\u7b80\u5355\u200b\u7684\u200b\u8c03\u8bd5\u200b\u6b65\u9aa4\u200b\uff1a</p> <p>Step1\uff1a \u200b\u5148\u200b\u5728\u200b\u7ec8\u7aef\u200b\u8f93\u5165\u200b\u201cmake qemu-gdb\u201d\u3002</p> <p>\u200b\u63a5\u7740\u200b\uff0c\u200b\u6309\u4e0b\u200bF5\uff0c \u200b\u6216\u8005\u200b \u200b\u70b9\u51fb\u200b\u5de6\u4fa7\u200b\u6309\u94ae\u200b\u8fd0\u884c\u200b\u4e0e\u200b\u8c03\u8bd5\u200b\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u89d2\u200b\u7eff\u8272\u200b\u4e09\u89d2\u200b\uff08Attach to gdb)\u3002</p> <p>\u200b\u518d\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\uff0c\u200b\u8ba9\u200bxv6\u200b\u6b63\u5e38\u200b\u8fd0\u884c\u200b\uff0c\u200b\u76f4\u5230\u200b\u51fa\u73b0\u200b\u201c$\u201d\uff0c\u200b\u8868\u793a\u200b\u5df2\u7ecf\u200b\u8fdb\u5165\u200bshell\u200b\u4e2d\u200b\u3002</p> <p>Step2\uff1a \u200b\u5728\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff0c\u200b\u8f93\u5165\u200b\u201cinterrupt\u201d\u3002</p> <p>Step3\uff1a \u200b\u5728\u200bkernel/trap.c:128\u200b\u5904\u200b\u6253\u65ad\u200b\u70b9\u200b\uff0c\u200b\u7ee7\u7eed\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\u3002</p> <p>Step4\uff1a \u200b\u5728\u200bxv6\u200b\u7684\u200bshell\u200b\u4e2d\u200b\u8f93\u5165\u200b<code>ls</code>\uff0c\u200b\u4ee5\u200b\u542f\u52a8\u200b<code>ls</code>\u200b\u7a0b\u5e8f\u200b\uff1b\u200b\u7a0b\u5e8f\u200b\u505c\u7559\u200b\u5728\u200b<code>kernel/trap.c:128</code>\u200b\u5904\u200b\u3002</p> <p>Step5\uff1a \u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5728\u200b\u8c03\u8bd5\u200b\u7a97\u53e3\u200b\u5de6\u4e0b\u89d2\u200b\u5220\u9664\u200b\u539f\u6709\u200b\u7684\u200b\u5185\u6838\u200b\u6001\u200b\u65ad\u70b9\u200b\uff0c\u200b\u5e76\u200b\u901a\u8fc7\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff0c\u200b\u52a0\u8f7d\u200bls\u200b\u7684\u200b\u8c03\u8bd5\u200b\u7b26\u53f7\u200b\u3002\u200b\u5728\u200b\u5176\u4e2d\u200b\u8f93\u5165\u200b<code>file user/_ls</code>\u3002</p> <p>Step6\uff1a \u200b\u6253\u5f00\u200buser/ls.c\u200b\u6587\u4ef6\u200b\uff0c\u200b\u627e\u5230\u200bmain()\u200b\u51fd\u6570\u200b\uff0c\u200b\u5728\u200b\u7b2c\u200b78\u200b\u884c\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\u3002\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\u3002</p> <p>Step7\uff1a \u200b\u5728\u200bls.c\u200b\u7b2c\u200b38\u200b\u884c\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\uff0c\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fd0\u884c\u200b\u201d\uff0c\u200b\u8ba9\u200b\u7a0b\u5e8f\u200b\u505c\u7559\u200b\u5728\u200b\u6267\u884c\u200bfstat\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5730\u65b9\u200b\u3002</p> <p>Step8\uff1a \u200b\u5728\u200b\u8c03\u8bd5\u200b\u63a7\u5236\u53f0\u200b\uff0c\u200b\u8f93\u5165\u200b<code>file kernel/kernel</code>\uff0c\u200b\u52a0\u8f7d\u200bkernel\u200b\u7684\u200b\u8c03\u8bd5\u200b\u7b26\u53f7\u200b\u3002</p> <p>Step9\uff1a \u200b\u5728\u200bsyscall.c\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7b2c\u200b138\u200b\u884c\u200b<code>syscall();</code>\u200b\u6253\u200b\u4e0a\u200b\u65ad\u70b9\u200b\uff0c\u200b\u70b9\u51fb\u200b<code>\u201c\u200b\u8fd0\u884c\u200b\u201d</code>\uff0c\u200b\u8ba9\u200b\u7a0b\u5e8f\u200b\u505c\u7559\u200b\u5728\u200bsyscall()\u200b\u51fd\u6570\u200b\u3002</p> <p>Step10\uff1a \u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u4f60\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u6839\u636e\u200b\u9700\u8981\u200b\u6765\u200b\u8c03\u8bd5\u200b\u4f60\u200b\u60f3\u8981\u200b\u5206\u6790\u200b\u7684\u200b\u4ee3\u7801\u200b\u5427\u200b\u3002</p>"},{"location":"tools/","title":"\u5b9e\u9a8c\u200b\u5b9e\u7528\u5de5\u5177","text":"<p>\u200b\u5bf9\u4e8e\u200b\u521d\u5165\u200bLinux\u200b\u7684\u200b\u540c\u5b66\u200b\uff0c\u200b\u53ef\u80fd\u200b\u5bf9\u4e8e\u200bLinux\u200b\u7684\u200b\u547d\u4ee4\u884c\u200b\u611f\u89c9\u200b\u5230\u200b\u4e00\u8138\u832b\u7136\u200b\u3002\u200b\u4e3a\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u7ed9\u200b\u540c\u5b66\u200b\u4eec\u200b\u63a8\u8350\u200b\u51e0\u6b3e\u200b\u5b9e\u7528\u5de5\u5177\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u5e2e\u52a9\u200b\u540c\u5b66\u200b\u4eec\u200b\u80fd\u200b\u5feb\u901f\u200b\u4e0a\u200b\u624b\u200bLinux\u200b\u5f00\u53d1\u200b\u5de5\u4f5c\u200b\u3002</p>"},{"location":"tools/#1-ssh","title":"1. SSH","text":"<p>question 1</p> <p>\u200b\u5982\u4f55\u200b\u5b9e\u73b0\u200bLinux\u200b\u548c\u200bWindows\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u6570\u636e\u901a\u4fe1\u200b\u3001\u200b\u6587\u4ef6\u5171\u4eab\u200b\uff1f</p> <p>\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u5927\u5bb6\u200b\u4f7f\u7528\u200bssh\uff08Secure Shell\uff09\u200b\u8fdc\u7a0b\u200b\u767b\u5f55\u200b\u534f\u8bae\u200b\u3002</p>"},{"location":"tools/#11-mobaxtermssh","title":"1.1 MobaXterm\uff08SSH\u200b\u5de5\u5177\u200b\uff09","text":"<p>\u200b\u5e38\u7528\u200b\u7684\u200bSSH\u200b\u5de5\u5177\u200b\u6709\u200bPutty\u3001XShell\u3001SecureCRT\u3001MobaXterm\u200b\u7b49\u200b\u3002\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u540c\u5b66\u200b\u4eec\u200b\u4f7f\u7528\u200bMobaXterm\u3002</p> <p>MobaXterm \u200b\u662f\u200b\u4e00\u6b3e\u200b\u8fdc\u7a0b\u200b\u63a7\u5236\u200b\u5de5\u5177\u200b\uff0c\u200b\u652f\u6301\u200b\u521b\u5efa\u200bSSH\u3001Telnet\u3001Rsh\u3001Xdmc\u3001RDP\u3001VNC\u3001FTP\u3001 SFTP\u3001\u200b\u4e32\u53e3\u200b(Serial COM)\u3001\u200b\u672c\u5730\u200bShell\u3001Mosh\u3001Aws\u3001WSL(\u200b\u5fae\u8f6f\u200b\u5b50\u7cfb\u7edf\u200b)\u200b\u7b49\u200b\u8d85\u591a\u200b\u8fde\u63a5\u529f\u80fd\u200b\u3002MobaXterm \u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4eba\u6027\u5316\u200b\u7684\u200b\u64cd\u4f5c\u754c\u9762\u200b\uff0c\u200b\u652f\u6301\u200b\u4e0e\u200b\u4e3b\u6d41\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8fde\u63a5\u200b\u8fdb\u884c\u200b\u63a7\u5236\u200b\u548c\u200b\u7ba1\u7406\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u529f\u80fd\u200b\u5341\u5206\u200b\u5f3a\u5927\u200b\u3002</p> <p>MobaXterm \u200b\u4e0b\u8f7d\u200b\u94fe\u63a5\u200b\uff1a https://mirrors.osa.moe/misc/</p> <p>\u200b\u6253\u5f00\u200bMobaXterm\uff0c\u200b\u5355\u51fb\u200b\u6253\u5f00\u200b\u5de5\u5177\u200bSession\uff08\u200b\u4f4d\u4e8e\u200b\u5de6\u4e0a\u89d2\u200b\uff09\u200b\u9009\u62e9\u200bNew sessions\u200b\u6253\u5f00\u200b\u65b0\u5efa\u200b\u7a97\u53e3\u200b\uff0c\u200b\u9009\u62e9\u200bSSH\uff0c\u200b\u8f93\u5165\u200b\u8fdc\u7a0b\u200b\u670d\u52a1\u5668\u200b\u7684\u200bIP\u200b\u5730\u5740\u200b\u3001\u200b\u767b\u9646\u200b\u7528\u6237\u540d\u200b\u53ca\u200b\u7aef\u53e3\u200b\uff08\u200b\u9ed8\u8ba4\u200b\u662f\u200b22\uff0c\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7aef\u53e3\u53f7\u200b\u662f\u200b6666\uff09\uff0c\u200b\u70b9\u51fb\u200bOK\u3002</p> <p>SSH\u200b\u914d\u7f6e\u200b\u4fe1\u606f\u200b\u6839\u636e\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u6765\u200b\u914d\u7f6e\u200b\uff1a</p> <ul> <li>\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u3002IP\u200b\u5730\u5740\u200b\uff1a <code>10.249.12.98</code> \uff0c\u200b\u7aef\u53e3\u53f7\u200b\uff1a <code>6666</code> \uff0c\u200b\u7528\u6237\u540d\u200b\u548c\u200b\u521d\u59cb\u5bc6\u7801\u200b\u90fd\u200b\u662f\u200b <code>\u200b\u4f60\u200b\u7684\u200b\u5b66\u53f7\u200b</code> \u3002</li> </ul> <ul> <li>\u200b\u81ea\u884c\u200b\u90e8\u7f72\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u7528\u200b\u7684\u200b\u662f\u200b\u4f60\u200b\u81ea\u5df1\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200bip addr\u200b\u547d\u4ee4\u200b\u6765\u200b\u67e5\u8be2\u200bIP\u200b\u5730\u5740\u200b\uff0c\u200b\u8be6\u89c1\u200bip addr \u200b\u663e\u793a\u200b\u6216\u200b\u8bbe\u7f6e\u200b\u7f51\u7edc\u200b\u72b6\u6001\u200b\u3002\u200b\u7aef\u53e3\u53f7\u200b\u5982\u679c\u200b\u5728\u200b\u6ca1\u6709\u200b\u4fee\u6539\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u662f\u200b22\u3002\u200b\u7528\u6237\u540d\u200b\u548c\u200b\u5bc6\u7801\u200b\u662f\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b\u7528\u6237\u540d\u200b\u548c\u200b\u5bc6\u7801\u200b\u3002</li> </ul> <p>\u200b\u70b9\u51fb\u200bOK\u200b\u540e\u200b\uff0c\u200b\u8f93\u5165\u200b\u5bc6\u7801\u200b\uff08\u200b\u8f93\u5165\u200b\u8fc7\u7a0b\u200b\u662f\u200b\u6ca1\u6709\u200b\u663e\u793a\u200b\u7684\u200b\uff0c\u200b\u8f93\u5165\u200b\u5b8c\u6210\u200b\u540e\u200b\u6572\u200b\u56de\u8f66\u952e\u200b\uff09</p> <p></p> <p>\u200b\u5373\u53ef\u200b\u8fdb\u5165\u200bLinux\u200b\u7cfb\u7edf\u200b\u7684\u200b\u547d\u4ee4\u884c\u200b\u7a97\u53e3\u200b\uff08shell\uff09\u3002</p>"},{"location":"tools/#12-sftp","title":"1.2 \u200b\u6587\u4ef6\u4f20\u8f93\u200bSFTP\u200b\u670d\u52a1","text":"<p>SSH\u200b\u8fdc\u7a0b\u200b\u767b\u5f55\u200b\u5b8c\u6bd5\u200b\uff0c\u200b\u5728\u200b\u5de6\u4e0b\u89d2\u200b\u6709\u200bSftp\u200b\u56fe\u6807\u200b\uff0c\u200b\u53cc\u51fb\u200b\u5b83\u200b\uff0c\u200b\u5c31\u200b\u51fa\u73b0\u200b\u4e86\u200b\u8fdc\u7a0b\u200b\u670d\u52a1\u5668\u200b\u7684\u200b\u6587\u4ef6\u76ee\u5f55\u200b</p> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u70b9\u51fb\u200b\u7ea2\u8272\u200b\u6846\u6846\u200b\u7684\u200b\u6309\u94ae\u200b\u201cUpload to current folder\u201d\u200b\u6216\u8005\u200b\u201cDownload selected files\u201d\uff0c\u200b\u5728\u200bwindows\u200b\u7cfb\u7edf\u200b\u548c\u200b\u865a\u62df\u673a\u200b/\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u4e4b\u95f4\u200b\u4e0a\u4f20\u200b\u6216\u200b\u4e0b\u8f7d\u200b\u6587\u4ef6\u200b\u3002</p>"},{"location":"tools/#2-vscode","title":"2 VScode","text":"<p>question 2</p> <p>\u200b\u5982\u4f55\u200b\u67e5\u9605\u200b\u3001\u200b\u7f16\u8f91\u200b\u3001\u200b\u8fd0\u884c\u200b\u548c\u200b\u8c03\u8bd5\u200b\u4ee3\u7801\u200b\uff1f</p> <p>\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u5f3a\u70c8\u63a8\u8350\u200b\u540c\u5b66\u200b\u4eec\u200b\u4f7f\u7528\u200bVScode\u200b\u4ee3\u7801\u200b\u7f16\u8f91\u5668\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u5728\u200b\u7269\u7406\u200b\u673a\u4e0a\u200b\u7f16\u8f91\u200b\u4ee3\u7801\u200b\u518d\u200b\u62f7\u8d1d\u200b\u8fc7\u53bb\u200b\u624b\u52a8\u200b\u8fd0\u884c\u200b\uff0c\u200b\u8fd9\u200b\u5c06\u200b\u8282\u7701\u200b\u5927\u91cf\u200b\u7684\u200b\u65f6\u95f4\u200b\u3002</p> <p>\u200b\u901a\u8fc7\u200bVSCode\u200b\u7684\u200b\u5f3a\u5927\u200b\u6269\u5c55\u200b\u5e93\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200bWindows\u200b\u7cfb\u7edf\u200b\u4e0a\u200b\u4f7f\u7528\u200bVScode\u200b\u4e00\u7ad9\u5f0f\u200b\u521b\u5efa\u200b\uff0c\u200b\u7f16\u8f91\u200b\uff0c\u200b\u6784\u5efa\u200b\uff0c\u200b\u8fd0\u884c\u200b\u548c\u200b\u8c03\u8bd5\u200b\u8fdc\u7a0b\u200b\u4e3b\u673a\u200b\u4e0a\u200b\u7684\u200b\u5de5\u7a0b\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5c31\u200b\u50cf\u200b\u4f7f\u7528\u200bCode::Blocks\u200b\u64cd\u4f5c\u200b\u672c\u5730\u200b\u5de5\u7a0b\u200b\u4e00\u6837\u200b\u3002</p>"},{"location":"tools/#21-vscode","title":"2.1 \u200b\u5b89\u88c5\u200bVScode","text":"<p>\u200b\u5728\u200b https://code.visualstudio.com/ \u200b\u4e0b\u8f7d\u200b\u5e76\u200b\u5728\u200b\u7269\u7406\u200b\u673a\u200b\uff08Windows\u200b\u7cfb\u7edf\u200b\uff09\u200b\u4e0a\u200b\u5b89\u88c5\u200bVSCode\u200b\u8f6f\u4ef6\u200b\u3002</p> <p>\u200b\u6253\u5f00\u200b\u540e\u200b\u5728\u200b\u5de6\u4fa7\u200b\u8fb9\u680f\u200b\u7684\u200b\u6269\u5c55\u200b\u5546\u5e97\u200b\u4e2d\u200b\u641c\u7d22\u200b\u5e76\u200b\u5b89\u88c5\u200b\u4ee5\u4e0b\u200b\u6269\u5c55\u200b</p> <ol> <li>Chinese (Simplified) Language Pack for Visual Studio Code</li> <li>Remote-SSH</li> <li>C/C++</li> </ol> <p>\u200b\u5b89\u88c5\u200b\u5b8c\u6210\u200b\u540e\u200b\u91cd\u542f\u200bVSCode\u3002</p>"},{"location":"tools/#22-vscode","title":"2.2 \u200b\u4f7f\u7528\u200bVSCode\u200b\u767b\u5f55\u200b\u8fdc\u7a0b\u200b\u73af\u5883","text":"<p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u524d\u200b\uff0c\u200b\u9700\u8981\u200b\u5b89\u88c5\u200bRemote-SSH\u200b\u63d2\u4ef6\u200b\u3002</p> <p>\u200b\u5728\u200b\u5de6\u4fa7\u200b\u8fb9\u680f\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u8d44\u6e90\u7ba1\u7406\u200b\u5668\u200b\u5de5\u5177\u680f\u200b\u4e2d\u200b\u70b9\u51fb\u200b+\u200b\u53f7\u200b\uff0c\u200b\u5728\u200b\u9876\u90e8\u200b\u8f93\u5165\u200b<code>ssh \u200b\u4f60\u200b\u7684\u200b\u7528\u6237\u540d\u200b@IP\u200b\u5730\u5740\u200b -p \u200b\u7aef\u53e3\u53f7\u200b</code> \u200b\u547d\u4ee4\u200b\u5e76\u200b\u4e00\u8def\u200b\u56de\u8f66\u200b\u3002</p> <p>\u200b\u6b64\u65f6\u200b\u5728\u200b\u5de5\u5177\u680f\u200b\u4e2d\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u65b0\u200b\u6dfb\u52a0\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4e3b\u673a\u200b\u3002\u200b\u5728\u200b\u8fdc\u7a0b\u200b\u7535\u8111\u200b\u4e0a\u200b\u70b9\u51fb\u200b\u8fde\u63a5\u200b\uff0c\u200b\u8f93\u5165\u200b\u5bc6\u7801\u200b\u540e\u200b\u5c06\u200b\u4f1a\u200b\u6253\u5f00\u200b\u65b0\u7a97\u53e3\u200b\u8fde\u63a5\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4e3b\u673a\u200b\u4e2d\u200b\u3002</p> <p>\u200b\u5728\u200b\u8fde\u63a5\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4e3b\u673a\u200b\u4e4b\u540e\u200b\uff0c\u200b\u9700\u8981\u200b\u5728\u200b\u518d\u6b21\u200b\u641c\u7d22\u200b\u5e76\u200b\u5b89\u88c5\u200b\u4e0a\u8ff0\u200b\u6269\u5c55\u200b\uff0c\u200b\u5c06\u200b\u5176\u200b\u5b89\u88c5\u200b\u5728\u200b\u8fdc\u7a0b\u200b\u4e3b\u673a\u200b\u4e0a\u200b\u3002C/C++\u200b\u6269\u5c55\u200b\u5728\u200b\u5b89\u88c5\u200b\u540e\u200b\u53ef\u80fd\u200b\u9700\u8981\u200b\u4e00\u6bb5\u65f6\u95f4\u200b\u6765\u200b\u4e0b\u8f7d\u200b\u4f9d\u8d56\u200b\u6587\u4ef6\u200b\u3002</p> <p>\u200b\u56de\u8f66\u200b\uff0c\u200b\u63d0\u793a\u200bHost Added!</p> <p>\u200b\u5728\u200b\u6b64\u5904\u200b\u70b9\u51fb\u200b\u8fde\u63a5\u200b\uff1a</p> <p>\u200b\u8f93\u5165\u200b\u5bc6\u7801\u200b\u540e\u200b\uff0c\u200b\u7a0d\u7b49\u7247\u523b\u200b\uff0c\u200b\u7b49\u5f85\u200b\u7a97\u53e3\u200b\u6210\u4e3a\u200b\u5982\u4e0b\u200b\u65f6\u200b\uff0c\u200b\u5373\u200b\u8fde\u63a5\u200b\u6210\u529f\u200b\uff1a</p> <p>\u200b\u6b64\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u50cf\u200b\u672c\u5730\u200b\u4e00\u6837\u200b\u4f7f\u7528\u200b\u8fdc\u7a0b\u200b\u673a\u5668\u200b\u8fdb\u884c\u200b\u5de5\u4f5c\u200b\u4e86\u200b\u3002</p>"},{"location":"tools/#3-git","title":"3 git","text":"<p>question 3</p> <p>\u200b\u4f60\u200b\u662f\u5426\u200b\u9047\u5230\u200b\u8fc7\u200b\u8fd9\u6837\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u4e00\u4e2a\u200b\u9879\u76ee\u200b\u7531\u4e8e\u200b\u4e0d\u505c\u200b\u5730\u200b\u4fee\u6539\u200b\uff0c\u200b\u6bcf\u6b21\u200b\u90fd\u200b\u662f\u200b\u590d\u5236\u7c98\u8d34\u200b\u526f\u672c\u200b\uff0c\u200b\u4ea7\u51fa\u200b\u7684\u200b\u6587\u4ef6\u200b\u526f\u672c\u200b\u5c31\u200b\u8d8a\u6765\u8d8a\u200b\u591a\u200b\u3002\u200b\u800c\u200b\u968f\u7740\u200b\u7248\u672c\u200b\u7684\u200b\u589e\u591a\u200b\uff0c\u200b\u4f60\u200b\u8fd8\u200b\u8bb0\u5f97\u200b\u8fd9\u4e9b\u200b\u7248\u672c\u200b\u5404\u81ea\u200b\u90fd\u200b\u4fee\u6539\u200b\u4e86\u200b\u4ec0\u4e48\u200b\u5417\u200b\uff1a\uff1f</p> <p>\u200b\u4e3a\u4e86\u200b\u80fd\u591f\u200b\u66f4\u200b\u65b9\u4fbf\u200b\u6211\u4eec\u200b\u7ba1\u7406\u200b\u4e0d\u540c\u200b\u7248\u672c\u200b\u7684\u200b\u6587\u4ef6\u200b/\u200b\u4ee3\u7801\u200b\uff0c\u200b\u5f3a\u70c8\u5efa\u8bae\u200b\u540c\u5b66\u200b\u4eec\u200b\u4f7f\u7528\u200bgit\u200b\u8fdb\u884c\u200b\u7248\u672c\u63a7\u5236\u200b\u3002</p>"},{"location":"tools/#31","title":"3.1 \u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93","text":"<p>\u200b\u5982\u679c\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u4fee\u6539\u200b\u4e86\u200b\u5b9e\u9a8c\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff08\u200b\u5982\u679c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u6709\u200b\u4fee\u6539\u200b\uff0c\u200b\u7b2c\u4e00\u200b\u65f6\u95f4\u200b\u5c06\u200b\u5728\u200b\u7fa4\u91cc\u200b\u63a8\u9001\u200b\u901a\u77e5\u200b\uff0c\u200b\u8bf7\u200b\u5173\u6ce8\u200b\u7fa4\u200b\u6d88\u606f\u200b\uff01\uff09\uff0c\u200b\u800c\u200b\u4f60\u200b\u9700\u8981\u200b\u5c06\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u4fee\u6539\u200b\u540c\u6b65\u200b\u5230\u200b\u81ea\u5df1\u200b\u7684\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u8bf7\u200b\u6309\u200b\u4ee5\u4e0b\u200b\u6b65\u9aa4\u200b\u64cd\u4f5c\u200b\uff1a</p>"},{"location":"tools/#311","title":"3.1.1 \u200b\u68c0\u67e5\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u8bbe\u7f6e","text":"<p>\u200b\u4e3a\u4e86\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5148\u200b\u8bbe\u7f6e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u3002\u200b\u68c0\u67e5\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u662f\u5426\u200b\u5df2\u7ecf\u200b\u8bbe\u7f6e\u200b\u597d\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b<code>git remote -v</code>\u200b\u6307\u4ee4\u200b\u67e5\u770b\u200b\u3002 \u200b\u5982\u679c\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u672a\u200b\u8bbe\u7f6e\u200b\u5b8c\u6210\u200b\uff0c\u200b\u90a3\u4e48\u200b\u6307\u4ee4\u200b\u7684\u200b\u6267\u884c\u200b\u6548\u679c\u200b\u5927\u6982\u200b\u662f\u200b\u8fd9\u6837\u200b\u7684\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/xv6-oslab23-hitsz$ git remote -v\norigin  git@gitee.com:willson0v0/xv6-oslab23-hitsz.git (fetch)\norigin  git@gitee.com:willson0v0/xv6-oslab23-hitsz.git (push)\n</code></pre> <p>\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\uff0c\u200b\u5176\u4e2d\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u5373\u200b<code>origin</code>\uff1b\u200b\u5982\u679c\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u5df2\u7ecf\u200b\u8bbe\u7f6e\u200b\u5b8c\u6210\u200b\uff0c\u200b\u90a3\u4e48\u200b\u6307\u4ee4\u200b\u7684\u200b\u6267\u884c\u200b\u6548\u679c\u200b\u5927\u6982\u200b\u662f\u200b\u8fd9\u6837\u200b\u7684\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/xv6-oslab23-hitsz$ git remote -v\norigin  git@gitee.com:willson0v0/xv6-oslab23-hitsz.git (fetch)\norigin  git@gitee.com:willson0v0/xv6-oslab23-hitsz.git (push)\nupstream        https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git (fetch)\nupstream        https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git (push)\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b<code>origin</code>\u200b\u7684\u200b\u5730\u5740\u200b\uff08\u200b\u5728\u200b\u6b64\u5904\u200b\u663e\u793a\u200b\u4e3a\u200b<code>git@gitee.com:willson0v0/xv6-oslab23-hitsz.git</code>\uff09\u200b\u5e94\u8be5\u200b\u662f\u200b\u662f\u200b\u4f60\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5730\u5740\u200b\uff0c\u200b\u800c\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b<code>upstream</code>\u200b\u7684\u200b\u5730\u5740\u200b\u5e94\u8be5\u200b\u663e\u793a\u200b\u4e3a\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5730\u5740\u200b\uff0c\u200b\u5373\u200b<code>https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git</code>\u3002 \u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5df2\u7ecf\u200b\u8bbe\u7f6e\u200b\u5b8c\u6210\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8df3\u200b\u5230\u200b3.1.3 \u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u66f4\u6539\u200b\u7ee7\u7eed\u200b\u3002\u200b\u5426\u5219\u200b\uff0c\u200b\u8bf7\u200b\u6309\u7167\u200b3.1.2 \u200b\u5b8c\u6210\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u8bbe\u7f6e\u200b\u8282\u200b\u5b8c\u6210\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u8bbe\u7f6e\u200b\u3002</p>"},{"location":"tools/#312","title":"3.1.2 \u200b\u5b8c\u6210\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u8bbe\u7f6e","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u6ca1\u6709\u200b\u8bbe\u7f6e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff08\u200b\u5373\u200b<code>upstream</code>\uff09\uff0c\u200b\u5e76\u4e14\u200b origin\u200b\u4ed3\u5e93\u200b\u7684\u200b\u94fe\u63a5\u200b\u88ab\u200b\u8bbe\u7f6e\u200b\u4e3a\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u800c\u200b\u975e\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b \uff0c\u200b\u90a3\u4e48\u200b\u8bf7\u200b\u5148\u200b\u53c2\u7167\u200b3.2 \u200b\u5c06\u200b\u4ee3\u7801\u200b\u53d1\u5e03\u200b\u81f3\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u8282\u200b\uff0c\u200b\u5c06\u200b\u4ee3\u7801\u200b\u53d1\u5e03\u200b\u81f3\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002 \u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b<code>origin</code>\u200b\u4ed3\u5e93\u200b\u6b63\u786e\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8bf7\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u6307\u4ee4\u200b\uff0c\u200b\u8bbe\u7f6e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u4e3a\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u7684\u200b\u4ed3\u5e93\u200b\uff1a</p> <pre><code>git remote add upstream https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git\n</code></pre> <p>\u200b\u6b64\u65f6\u200b\uff0c\u200b\u5982\u679c\u200b\u5728\u200b\u8f93\u5165\u200b<code>git remote -v</code>\uff0c\u200b\u5e94\u8be5\u200b\u80fd\u200b\u663e\u793a\u200b\u51fa\u200b3.1.1 \u200b\u68c0\u67e5\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u8bbe\u7f6e\u200b\u4e2d\u200b\u8bbe\u7f6e\u200b\u5b8c\u6210\u200b\u4e00\u6837\u200b\u7684\u200b\u6548\u679c\u200b\u3002</p>"},{"location":"tools/#313","title":"3.1.3 \u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u66f4\u6539","text":"<p>\u200b\u5728\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u4ee5\u200b\u5c06\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u7684\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u540c\u6b65\u200b\u5230\u200b\u672c\u5730\u200b\u7684\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u4e3a\u4f8b\u200b\u3002\u200b\u952e\u5165\u200b\u4ee5\u4e0b\u200b\u6307\u4ee4\u200b\uff0c\u200b\u4ee5\u200b\u83b7\u53d6\u200b\u4e0a\u6e38\u200b\u66f4\u6539\u200b\u3001\u200b\u5207\u6362\u200b\u5230\u200b\u672c\u5730\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u3001\u200b\u5b8c\u6210\u200b\u4e0e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u7684\u200b\u5408\u5e76\u200b\uff0c\u200b\u5e76\u200b\u6700\u540e\u200b\u4e0a\u200b\u4f20\u5230\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff1a</p> <pre><code>git fetch --all\ngit checkout syscall\ngit merge upstream/syscall --no-edit\ngit push origin\n</code></pre> <p>\u200b\u68c0\u67e5\u200b\u5de5\u4f5c\u200b\u533a\u200b\u66f4\u6539\u200b</p> <p>\u200b\u5207\u6362\u200b\u5206\u652f\u200b\u4e4b\u524d\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4fdd\u5b58\u200b\u5de5\u4f5c\u200b\u533a\u200b\u7684\u200b\u66f4\u6539\u200b\u3002\u200b\u5982\u679c\u200b\u5207\u6362\u200b\u65f6\u200b\u63d0\u793a\u200b<code>error: Your local changes to the following files would be overwritten by checkout</code>\uff0c\u200b\u53c2\u8003\u200b\u8fd9\u7bc7\u200bQ&amp;A\uff0c\u200b\u68c0\u67e5\u200b\u5de5\u4f5c\u200b\u533a\u200b\u5e76\u200bcommit\u200b\u4f60\u200b\u7684\u200b\u66f4\u6539\u200b\u3002</p> <p>\u200b\u521d\u6b21\u200bCheckout\uff1f</p> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u6b64\u524d\u200b\u4ece\u672a\u200bCheckout\u200b\u8fc7\u8be5\u200b\u5206\u652f\u200b\uff0cCheckout\u200b\u65f6\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5411\u200b\u4f60\u200b\u62a5\u544a\u200b\u5982\u4e0b\u200b\u9519\u8bef\u200b\uff1a</p> <p><pre><code>lgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git checkout syscall\nerror: pathspec 'syscall' did not match any file(s) known to git\nhint: 'syscall' matched more than one remote tracking branch.\nhint: We found 2 remotes with a reference that matched. So we fell back\nhint: on trying to resolve the argument as a path, but failed there too!\nhint:\nhint: If you meant to check out a remote tracking branch on, e.g. 'origin',\nhint: you can do so by fully qualifying the name with the --track option:\nhint:\nhint:     git checkout --track origin/&lt;name&gt;\nhint:\nhint: If you'd like to always have checkouts of an ambiguous &lt;name&gt; prefer\nhint: one remote, e.g. the 'origin' remote, consider setting\nhint: checkout.defaultRemote=origin in your config.\n</code></pre>  \u200b\u8fd9\u662f\u200b\u7531\u4e8e\u200b\uff0c\u200b\u4e24\u4e2a\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff08\u200b\u4f60\u200b\u81ea\u5df1\u200b\u7684\u200b\u548c\u200b\u4e0a\u6e38\u200b\u7684\u200b\uff09\u200b\u90fd\u200b\u5b58\u5728\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\uff0cgit\u200b\u4e0d\u200b\u77e5\u9053\u200b\u8ddf\u8e2a\u200b\u54ea\u200b\u4e00\u4e2a\u200b\u5bfc\u81f4\u200b\u7684\u200b\u3002\u200b\u8fd9\u4e2a\u200b\u65f6\u5019\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u6267\u884c\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\uff1a  <pre><code>git checkout --track origin/syscall\n</code></pre>  \u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u5728\u200b<code>git merge upstream/syscall</code>\u200b\u4e00\u6b65\u200b\u63d0\u793a\u200b\u5b58\u5728\u200b\u51b2\u7a81\u200b\uff0c\u200b\u8bf4\u660e\u200b\u4f60\u200b\u548c\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u4fee\u6539\u200b\u8fc7\u200b\u540c\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\uff0cgit\u200b\u65e0\u6cd5\u200b\u81ea\u52a8\u200b\u5408\u5e76\u200b\u3002\u200b\u51b2\u7a81\u200b\u7684\u200b\u8f93\u51fa\u200b\u5e94\u8be5\u200b\u7c7b\u4f3c\u200b\u4e8e\u200b\u4e0b\u9762\u200b\u8fd9\u6837\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git merge upstream/syscall\nCONFLICT (add/add): Merge conflict in time.txt\nAuto-merging time.txt\nAutomatic merge failed; fix conflicts and then commit the result.\n</code></pre> <p>\u200b\u5982\u679c\u200b\u53d1\u751f\u51b2\u7a81\u200b\uff0c\u200b\u8bf7\u200b\u53c2\u7167\u200b3.3.3 \u200b\u5408\u5e76\u200b\u51b2\u7a81\u200b\u66f4\u6539\u200b\u8282\u200b\u5b8c\u6210\u200b\u51b2\u7a81\u200b\u5408\u5e76\u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"tools/#32","title":"3.2 \u200b\u5c06\u200b\u4ee3\u7801\u200b\u53d1\u5e03\u200b\u81f3\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b\u4ee3\u7801\u200b\u662f\u200b\u76f4\u63a5\u200b\u4ece\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u4ed3\u5e93\u200bclone\u200b\u800c\u200b\u6765\u200b\uff0c\u200b\u800c\u200b\u975e\u5148\u200bfork\u200b\u51fa\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3001\u200b\u518d\u200b\u8fdb\u884c\u200bclone\uff0c\u200b\u90a3\u4e48\u200b\u8fd9\u7bc7\u200b\u6559\u7a0b\u200b\u4f1a\u200b\u6307\u5f15\u200b\u4f60\u200b\u8bbe\u7f6e\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3001\u200b\u5e76\u200b\u5c06\u200b\u4ee3\u7801\u200b\u53d1\u5e03\u200b\u81f3\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5904\u200b\u3002</p> <p>\u200b\u8fd9\u4e48\u200b\u505a\u200b\u6709\u200b\u4ec0\u4e48\u200b\u597d\u5904\u200b\uff1f</p> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200b\u7535\u8111\u200b\u4e0a\u200b\u5de5\u4f5c\u200b\uff0c\u200b\u6bd4\u5982\u200b\u540c\u65f6\u200b\u5728\u200b\u5b9e\u9a8c\u5ba4\u200b\u7684\u200b\u7535\u8111\u200b\u3001\u200b\u81ea\u5df1\u200b\u7684\u200b\u7535\u8111\u200b\u548c\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u4e0a\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u53ef\u4ee5\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u5728\u200b\u4e0d\u540c\u200b\u8bbe\u5907\u200b\u4e4b\u95f4\u200b\u540c\u6b65\u200b\u81ea\u5df1\u200b\u7684\u200b\u5de5\u4f5c\u8fdb\u5ea6\u200b\u3002</p>"},{"location":"tools/#321-gitee","title":"3.2.1 \u200b\u8bbe\u7acb\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff08\u200b\u4ee5\u200bgitee\u200b\u4e3a\u4f8b\u200b\uff09","text":"<p>\u200b\u767b\u5f55\u200bgitee\uff0c\u200b\u53f3\u4e0a\u89d2\u200b\u53ef\u89c1\u200b\u4e00\u4e2a\u200b\u52a0\u53f7\u200b\uff0c\u200b\u70b9\u51fb\u200b\u5b83\u200b\u4e0b\u62c9\u83dc\u5355\u200b\u4e2d\u200b\u7684\u200b\u201c\u200b\u65b0\u5efa\u200b\u4ed3\u5e93\u200b\u201d\u3002</p> <p>\u200b\u70b9\u51fb\u200b\u8fdb\u5165\u200b\uff0c\u200b\u5e76\u200b\u4e3a\u200b\u81ea\u5df1\u200b\u7684\u200b\u4ed3\u5e93\u200b\u8bbe\u7f6e\u200b\u4e00\u4e2a\u200b\u4f60\u200b\u559c\u6b22\u200b\u7684\u200b\u540d\u79f0\u200b\u3002\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u9009\u62e9\u200b\u516c\u5f00\u200b\u4ed3\u5e93\u200b\u6216\u8005\u200b\u79c1\u6709\u200b\u4ed3\u5e93\u200b\u3002\u200b\u5b8c\u6210\u200b\u540e\u200b\u70b9\u51fb\u200b\u201c\u200b\u521b\u5efa\u200b\u201d\uff0c\u200b\u5373\u53ef\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u7a7a\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002</p> <p>\u200b\u8bf7\u200b\u4e0d\u8981\u200b\u521d\u59cb\u5316\u200b\u4ed3\u5e93\u200b\uff01</p> <p>\u200b\u4f60\u200b\u7684\u200b\u4ed3\u5e93\u200b\u5728\u200b\u672c\u5730\u200b\uff0c\u200b\u56e0\u6b64\u200b\u8bf7\u200b\u4e0d\u8981\u200b\u521d\u59cb\u5316\u200b\u4ed3\u5e93\u200b\u3001\u200b\u8bbe\u7f6e\u200b\u6a21\u677f\u200b\u6216\u200b\u9009\u62e9\u200b\u5206\u652f\u200b\u6a21\u578b\u200b\u3002\u200b\u603b\u200b\u7684\u200b\u800c\u8a00\u200b\uff0c\u200b\u6211\u4eec\u200b\u7684\u200b\u76ee\u6807\u200b\u662f\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u7a7a\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u5e76\u4e14\u200b\u628a\u200b\u6211\u4eec\u200b\u672c\u5730\u200b\u7684\u200b\u4ed3\u5e93\u200b\u585e\u8fdb\u53bb\u200b\u3002</p> <p>\u200b\u4ed3\u5e93\u200b\u521b\u5efa\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u4f1a\u200b\u6765\u5230\u200b\u8fd9\u4e2a\u200b\u754c\u9762\u200b\u3002\u200b\u5c06\u200b\u8fd9\u4e2a\u200b\u754c\u9762\u200b\u7684\u200bSSH\u200b\u5730\u5740\u200b\u590d\u5236\u200b\u4e0b\u6765\u200b\uff1a</p>"},{"location":"tools/#322","title":"3.2.2 \u200b\u6e05\u7406\u200b\u672c\u5730\u200b\u5de5\u4f5c\u200b\u6811","text":"<p>\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u754c\u9762\u200b\uff0c\u200b\u8f93\u5165\u200b<code>git status</code>\u3002\u200b\u5982\u679c\u200b\u5de5\u4f5c\u200b\u6811\u200b\u5e72\u51c0\u200b\uff0c\u200b\u5176\u4f1a\u200b\u663e\u793a\u200b\u5982\u4e0b\u200b\u5185\u5bb9\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git status\nOn branch syscall\nYour branch is up to date with 'origin/syscall'.\n\nnothing to commit, working tree clean\n</code></pre> <p>\u200b\u90a3\u4e48\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u8df3\u8fc7\u200b\u8fd9\u200b\u4e00\u6b65\u200b\uff0c\u200b\u524d\u5f80\u200b3.2.3 \u200b\u4fee\u6539\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5730\u5740\u200b\u5e76\u200b\u63a8\u9001\u200b\u7ee7\u7eed\u200b\u3002\u200b\u5982\u679c\u200b\u672c\u5730\u200b\u6709\u200b\u5c1a\u672a\u200bcommit\u200b\u7684\u200b\u66f4\u6539\u200b\uff0c\u200b\u5219\u200b\u547d\u4ee4\u200b\u4f1a\u200b\u663e\u793a\u200b\u51fa\u200b\u4f60\u200b\u66f4\u6539\u200b\u8fc7\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u63d0\u793a\u200b\u5176\u200b\u5c1a\u672a\u200b\u88ab\u200b\u8ddf\u8e2a\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git status\nOn branch syscall\nYour branch is up to date with 'origin/syscall'.\n\nChanges not staged for commit:\n  (use \"git add &lt;file&gt;...\" to update what will be committed)\n  (use \"git restore &lt;file&gt;...\" to discard changes in working directory)\n        modified:   time.txt\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\n</code></pre> <p>\u200b\u5982\u679c\u200b\u672c\u5730\u200b\u6709\u200b\u5c1a\u672a\u200bcommit\u200b\u7684\u200b\u66f4\u6539\u200b\uff0c\u200b\u8bf7\u200b\u53c2\u7167\u200b3.3.1.1 Commit\u200b\u4e2d\u200b\u7684\u200b\u64cd\u4f5c\u200b\uff08\u200b\u547d\u4ee4\u884c\u200b\u64cd\u4f5c\u200b\uff09\u200b\u6216\u8005\u200b3.3.2 \u200b\u4f7f\u7528\u200bVSCode\u200b\u5185\u5efa\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u4e2d\u200b\u7684\u200b\u64cd\u4f5c\u200b\uff08VSCode\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u64cd\u4f5c\u200b\uff09\uff0c\u200b\u5b8c\u6210\u200bcommit\u3002\u200b\u4f60\u200b\u6ca1\u6709\u200b\u63a8\u9001\u200b\u5230\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff08\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff09\u200b\u7684\u200b\u6743\u9650\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4e0d\u5fc5\u200bpush\u3002</p>"},{"location":"tools/#323","title":"3.2.3 \u200b\u4fee\u6539\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5730\u5740\u200b\u5e76\u200b\u63a8\u9001","text":"<p>\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u4e2d\u200b\uff0c\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\uff1a</p> <pre><code>git remote set-url origin git@gitee.com:willson0v0/my_xv6_repo.git\n</code></pre> <p>\u200b\u5c06\u200b\u5176\u4e2d\u200b<code>git@gitee.com:willson0v0/my_xv6_repo.git</code>\u200b\u66ff\u6362\u6210\u200b3.2.1 \u200b\u8bbe\u7acb\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff08\u200b\u4ee5\u200bgitee\u200b\u4e3a\u4f8b\u200b\uff09\u200b\u4e2d\u200b\u590d\u5236\u200b\u4e0b\u6765\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5730\u5740\u200b\u3002\u200b\u53ef\u4ee5\u200b\u8f93\u5165\u200b<code>git remote -v</code>\u200b\u68c0\u89c6\u200b\u8fdc\u7a0b\u200b\u8fde\u63a5\u200b\u6709\u6ca1\u6709\u200b\u66f4\u6539\u200b\u6210\u529f\u200b\u3002\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u5207\u6362\u200b\u5230\u200b\u4f60\u200b\u60f3\u8981\u200b\u63a8\u9001\u200b\u7684\u200b\u5206\u652f\u200b\uff0c\u200b\u5e76\u200b\u4e0a\u200b\u4f20\u5230\u200b\u8fdc\u7a0b\u200b\u3002\u200b\u8fd9\u91cc\u200b\u4ee5\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u4e3a\u4f8b\u200b\uff1a</p> <pre><code>git push -u origin syscall\n</code></pre> <p>\u200b\u8fd9\u4f1a\u200b\u5c06\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u8bbe\u7f6e\u200b\u6210\u200b\u8ddf\u8e2a\u200b\u8fdc\u7a0b\u200b<code>origin</code>\u200b\u7684\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\uff0c\u200b\u5e76\u200b\u63a8\u9001\u200b\u3002\u200b\u73b0\u5728\u200b\u56de\u5230\u200b\u6d4f\u89c8\u5668\u200b\u5e76\u200b\u5237\u65b0\u200b\u4ed3\u5e93\u200b\u9875\u9762\u200b\uff0c\u200b\u4f60\u200b\u5e94\u8be5\u200b\u80fd\u200b\u770b\u5230\u200b\u4e0a\u4f20\u200b\u5df2\u7ecf\u200b\u5b8c\u6210\u200b\u3002</p>"},{"location":"tools/#33-git","title":"3.3 \u200b\u5e38\u7528\u200bgit\u200b\u64cd\u4f5c","text":"<p>\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u9009\u62e9\u200b\u4f7f\u7528\u200b\u547d\u4ee4\u884c\u200b\u5b8c\u6210\u200b<code>commit</code>/<code>push</code>/<code>pull</code>/<code>merge</code>\u200b\u7b49\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200bVSCode\u200b\u5185\u5efa\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u8fd9\u4e9b\u200b\u64cd\u4f5c\u200b\u3002</p> <p>git\u200b\u5de5\u4f5c\u200b\u8fc7\u7a0b\u200b</p> <p>\u200b\u8bf4\u660e\u200b\uff1a</p> <ul> <li>workspace\uff1a\u200b\u5de5\u4f5c\u200b\u533a\u200b</li> <li>staging area\uff1a\u200b\u6682\u5b58\u533a\u200b/\u200b\u7f13\u5b58\u200b\u533a\u200b</li> <li>local respository\uff1a\u200b\u7248\u672c\u200b\u5e93\u200b\u6216\u200b\u672c\u5730\u200b\u4ed3\u5e93\u200b</li> <li>remote repository\uff1a\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b</li> </ul> <p>\u200b\u4ee5\u4e0b\u200b\u662f\u200bgit\u200b\u7684\u200b\u8bf4\u660e\u200b\uff1a</p> <p>https://git-scm.com/book/zh/v2</p> <p>\u200b\u4ec0\u4e48\u200b\u662f\u200bCommit\uff1f</p> <p>\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5c06\u200b<code>Commit</code>\u200b\u89c6\u4f5c\u200b\u662f\u200b\u4e00\u4e2a\u4e2a\u200b\u5c0f\u5c0f\u7684\u200b\u91cc\u7a0b\u7891\u200b\uff0c\u200b\u5b83\u200b\u6807\u793a\u200b\u4e86\u200b\u4f60\u200b\u7684\u200b\u4ee3\u7801\u200b\u8fdb\u5ea6\u200b\uff1b\u200b\u7248\u672c\u63a7\u5236\u200b\u5de5\u5177\u200b\uff08\u200b\u6bd4\u5982\u200bgit\uff09\u200b\u7684\u200b\u7248\u672c\u200b\u5c31\u662f\u200b\u57fa\u4e8e\u200b\u8fd9\u200b\u4e00\u4e2a\u4e2a\u200b\u5c0f\u200b\u91cc\u7a0b\u7891\u200b\u5b9e\u73b0\u200b\u7684\u200b\uff1a\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u4fee\u6539\u200b\u5b8c\u200b\u4ee3\u7801\u200b\u540e\u200b\u521b\u5efa\u200b\u65b0\u200b\u7684\u200b\u91cc\u7a0b\u7891\u200b\uff1b\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u653e\u5f03\u200b\u51fa\u73b0\u200b\u4e86\u200b\u95ee\u9898\u200b\u7684\u200b\u4ee3\u7801\u200b\u4fee\u6539\u200b\uff0c\u200b\u5c06\u200b\u4ee3\u7801\u200b\u56de\u6eaf\u5230\u200b\u6b64\u524d\u200b\u7684\u200b\u67d0\u4e2a\u200b\u91cc\u7a0b\u7891\u200b\u5904\u200b\u3002 </p> <p>\u200b\u6bcf\u200b\u4e00\u4e2a\u200bCommit\u200b\u90fd\u200b\u6709\u200b\u4e00\u4e2a\u200b\u72ec\u7279\u200b\u7684\u200bhash\u200b\u503c\u200b\uff0c\u200b\u7528\u4ee5\u200b\u548c\u200b\u5176\u4ed6\u200bCommit\u200b\u533a\u5206\u200b\uff1bCommit\u200b\u8fd8\u4f1a\u200b\u6807\u793a\u200b\u662f\u200b\u8c01\u200b\u3001\u200b\u5728\u200b\u4f55\u65f6\u200b\u8fdb\u884c\u200b\u4e86\u200b\u8fd9\u4e2a\u200bCommit\uff0c\u200b\u8fd9\u200b\u5bf9\u200b\u534f\u4f5c\u200b\u5f00\u53d1\u200b\u6709\u200b\u5f88\u5927\u200b\u7684\u200b\u5e2e\u52a9\u200b\u3002</p> <p>\u200b\u4ec0\u4e48\u200b\u662f\u200bPush/Pull\uff1f</p> <p>\u200b\u901a\u8fc7\u200bCommit\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5b8c\u6210\u200b\u4e00\u5b9a\u200b\u7684\u200b\u7248\u672c\u63a7\u5236\u200b\u529f\u80fd\u200b\u3002\u200b\u4f46\u662f\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u5b8c\u6210\u200b\u4ee3\u7801\u200b\u534f\u4f5c\u200b\u4e0e\u200b\u540c\u6b65\u200b\uff0c\u200b\u6211\u4eec\u200b\u8fd8\u200b\u9700\u8981\u200b\u628a\u200b\u4ee3\u7801\u200b\u653e\u5728\u200b\u4e00\u4e2a\u200b\u5404\u4e2a\u200b\u5199\u4f5c\u8005\u200b\u6216\u8005\u200b\u81ea\u5df1\u200b\u7684\u200b\u5404\u4e2a\u200b\u5de5\u4f5c\u200b\u73af\u5883\u200b\u90fd\u200b\u80fd\u200b\u8bbf\u95ee\u200b\u5230\u200b\u7684\u200b\u5730\u65b9\u200b\u2014\u2014\u200b\u4e00\u822c\u800c\u8a00\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002Push\u200b\u64cd\u4f5c\u200b\u5c31\u662f\u200b\u5c06\u200b\u672c\u5730\u200b\u7684\u200b\u66f4\u6539\u200b\uff08\u200b\u4e5f\u200b\u5c31\u662f\u200bCommit\u200b\u4eec\u200b\uff09\u200b\u63a8\u9001\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u7684\u200b\u4fee\u6539\u200b\uff1b\u200b\u800c\u200bPull\u200b\u5219\u200b\u662f\u200b\u5c06\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u7684\u200b\u66f4\u6539\u200b\u540c\u6b65\u200b\u5230\u200b\u672c\u5730\u200b\u3002</p> <p>\u200b\u4ec0\u4e48\u200b\u662f\u200bMerge\uff1f</p> <p>\u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\uff0cGit\u200b\u4f5c\u4e3a\u200b\u7248\u672c\u63a7\u5236\u200b\u5de5\u5177\u200b\u53ef\u4ee5\u200b\u5141\u8bb8\u200b\u6211\u4eec\u200b\u5728\u200b\u540c\u4e00\u4e2a\u200b\u4ee3\u7801\u200b\u4ed3\u5e93\u200b\u5185\u200b\u8fdb\u884c\u200b\u534f\u4f5c\u200b\u3002\u200b\u5982\u679c\u200b\u4e24\u4e2a\u200b\u5f00\u53d1\u8005\u200b\u540c\u65f6\u200b\u8fdb\u884c\u200b\u4e86\u200b\u4fee\u6539\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c31\u200b\u6709\u200b\u53ef\u80fd\u200b\u51fa\u73b0\u200b\u51b2\u7a81\u200b\uff1b\u200b\u53c8\u200b\u6216\u8005\u200b\u6211\u4eec\u200b\u8981\u200b\u5c06\u200b\u4ee3\u7801\u200b\u7684\u200b\u4e24\u4e2a\u200b\u5206\u652f\u200b\u5408\u5e76\u200b\u3002\u200b\u8fd9\u4e2a\u200b\u65f6\u5019\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c31\u200b\u9700\u8981\u200b\u8fdb\u884c\u200bMerge\u200b\u64cd\u4f5c\u200b\u3002\u200b\u5982\u679c\u200b\u65e0\u6cd5\u200b\u5b8c\u6210\u200b\u81ea\u52a8\u200b\u51b2\u7a81\u200b\u5408\u5e76\u200b\uff0c\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u9700\u8981\u200b\u624b\u52a8\u200b\u5b8c\u6210\u200b\u51b2\u7a81\u200b\u5408\u5e76\u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"tools/#331","title":"3.3.1 \u200b\u4f7f\u7528\u200b\u547d\u4ee4\u884c\u200b\u5b8c\u6210\u200b\u64cd\u4f5c","text":""},{"location":"tools/#3311-commit","title":"3.3.1.1 Commit","text":"<pre><code>$ git add \u200b\u4f60\u200b\u8981\u200b\u4fdd\u5b58\u200b\u66f4\u6539\u200b\u7684\u200b\u6587\u4ef6\u200b\u4eec\u200b\n# \u200b\u6216\u8005\u200b\uff0cgit add --all \u200b\u4ee5\u200b\u6dfb\u52a0\u200b\u6240\u6709\u200b\u66f4\u6539\u200b\u3002\n$ git commit -m \"\u200b\u672c\u6b21\u200bCommit\u200b\u4f60\u200b\u505a\u200b\u4e86\u200b\u4ec0\u4e48\u200b\"\n</code></pre> <p>\u200b\u5efa\u8bae\u200b\u6bcf\u6b21\u200bCommit\u200b\u90fd\u200b\u4f7f\u7528\u200b\u6709\u6548\u200b\u7684\u200bCommit\u200b\u4fe1\u606f\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u4e8e\u200b\u81ea\u5df1\u200b\u8ffd\u8e2a\u200b\u4ee3\u7801\u200b\u8fdb\u5ea6\u200b\u3002</p>"},{"location":"tools/#3312-push","title":"3.3.1.2 push","text":"<p>push\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdb\u5ea6\u200b\u540c\u6b65\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002</p> <pre><code>git push\n</code></pre>"},{"location":"tools/#3313-pull","title":"3.3.1.3 pull","text":"<p>pull\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u7684\u200b\u8fdb\u5ea6\u200b\u540c\u6b65\u200b\u5230\u200b\u672c\u5730\u200b\u3002</p> <pre><code>git pull\n</code></pre>"},{"location":"tools/#3314-merge","title":"3.3.1.4 merge","text":"<p>merge\u200b\u4e00\u822c\u200b\u7528\u4e8e\u200b\u5206\u652f\u200b\u4e4b\u95f4\u200b\u7684\u200b\u5408\u5e76\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u4e0a\u6e38\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u5206\u652f\u200b\u548c\u200b\u672c\u5730\u200b\u5206\u652f\u200b\u8fdb\u884c\u200b\u5408\u5e76\u200b\u3002</p> <pre><code>git checkout \u200b\u4f60\u200b\u60f3\u200b\u5408\u5e76\u200b\u7684\u200b\u672c\u5730\u200b\u5206\u652f\u200b\ngit merge \u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u540d\u79f0\u200b/\u200b\u5206\u652f\u200b\u540d\u79f0\u200b\n</code></pre> <p>\u200b\u4ed3\u5e93\u200b\u6743\u9650\u200b</p> <p>\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u516c\u5171\u200b\u4ed3\u5e93\u200b\u62c9\u53d6\u200b\uff0c\u200b\u4f46\u200b\u4f60\u200b\u53ea\u80fd\u200b\u63a8\u9001\u200b\u5230\u200b\u4f60\u200b\u62e5\u6709\u200b\u6743\u9650\u200b\u7684\u200b\u4ed3\u5e93\u200b\u3002\u200b\u4e3a\u4e86\u200b\u9a8c\u8bc1\u200b\u4f60\u200b\u7684\u200b\u8eab\u4efd\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u8bbe\u7f6e\u200b\u81ea\u5df1\u200b\u7684\u200bssh\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\u3002\u200b\u8bf7\u200b\u53c2\u7167\u200b3.4\u200b\u8282\u200b ssh\u200b\u5bc6\u94a5\u200b\u8bbe\u7f6e\u200b\u5b8c\u6210\u200b\u8bbe\u7f6e\u200b\u3002</p>"},{"location":"tools/#332-vscode","title":"3.3.2 \u200b\u4f7f\u7528\u200bVSCode\u200b\u5185\u5efa\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u64cd\u4f5c","text":"<p>VSCode\u200b\u7684\u200b\u7248\u672c\u63a7\u5236\u200b\u754c\u9762\u200b\u5728\u200b\u5de6\u4fa7\u200b\u4ece\u200b\u4e0a\u200b\u5f80\u200b\u4e0b\u6570\u200b\u7b2c\u4e8c\u4e2a\u200b\u6309\u94ae\u200b\u5904\u200b\uff1b\u200b\u4e0b\u65b9\u200b\u4f1a\u200b\u663e\u793a\u200b\u5f53\u524d\u200b\u6240\u5904\u200b\u7684\u200b\u5206\u652f\u200b\uff0c\u200b\u70b9\u51fb\u200b\u53ef\u4ee5\u200b\u5207\u6362\u200b\u5f53\u524d\u200b\u6240\u200b\u5904\u200b\u5206\u652f\u200b\uff1b\u200b\u53f3\u4fa7\u200b\u7684\u200b\u5706\u5f62\u200b\u53cc\u200b\u7bad\u5934\u200b\u5219\u200b\u4ee3\u8868\u200b\u4e0e\u200b\u8fdc\u7a0b\u200b\u73af\u5883\u200b\u540c\u6b65\u200b\u3002\u200b\u53f3\u4fa7\u200bChanges\u200b\u663e\u793a\u200b\u5de5\u4f5c\u200b\u533a\u4e2d\u200b\u88ab\u200b\u4fee\u6539\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u800c\u200bStaged\u200b\u5219\u200b\u663e\u793a\u200b\u5c06\u200b\u88ab\u200b\u52a0\u5165\u200b\u5230\u200b\u4e0b\u6b21\u200bCommit\u200b\u4e2d\u200b\u7684\u200b\u4fee\u6539\u200b\u3002\u200b\u5982\u56fe\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u754c\u9762\u663e\u793a\u200b\u6211\u4eec\u200b\u6709\u200b\u4e24\u4e2a\u200b\u88ab\u200b\u4fee\u6539\u200b\u7684\u200b\u6587\u4ef6\u200b\uff1a</p> <p>\u200b\u9f20\u6807\u200b\u79fb\u81f3\u200bChanges\u200b\u6216\u200b\u4e0b\u9762\u200b\u6240\u200b\u5217\u200b\u6587\u4ef6\u200b\u5904\u200b\uff0c\u200b\u70b9\u51fb\u200b\u53f3\u4fa7\u200b\u7684\u200b\u52a0\u53f7\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u6587\u4ef6\u200b\u52a0\u5165\u200b\u5230\u200bStaged\u200b\u533a\u4e2d\u200b\uff1a</p> <p>\u200b\u6b64\u65f6\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u6587\u4ef6\u200b\u5df2\u7ecf\u200b\u51c6\u5907\u200b\u597d\u200b\u88ab\u200bCommit\u3002\u200b\u5728\u200b\u4e0a\u200b\u65b9\u6846\u200b\u5185\u200b\u8f93\u5165\u200bCommit\u200b\u4fe1\u606f\u200b\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b \u221a \u200b\u6309\u94ae\u200b\u4ee5\u200b\u63d0\u4ea4\u200b\uff1a</p> <p>\u200b\u5728\u200b\u4e0b\u65b9\u200b\u7684\u200b\u540c\u6b65\u200b\u6309\u94ae\u200b\u5904\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u53d1\u73b0\u200b\u6709\u200b0\u200b\u4e2a\u200b\u63d0\u4ea4\u200b\u9700\u8981\u200b\u62c9\u53d6\u200b\u30011\u200b\u4e2a\u200b\u63d0\u4ea4\u200b\u9700\u8981\u200b\u63a8\u9001\u200b\u3002\u200b\u70b9\u51fb\u200b\u8fd9\u4e2a\u200b\u6309\u94ae\u200b\u4ee5\u200b\u540c\u6b65\u200b\uff0c\u200b\u6216\u8005\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u65b9\u200b\u90a3\u4e2a\u200b\u5de8\u5927\u200b\u7684\u200b\u84dd\u8272\u200b\u7684\u200bSync Changes\uff08\u200b\u540c\u6b65\u200b\u66f4\u6539\u200b\uff09\uff1a</p> <p>\u200b\u8fd9\u6837\u200b\uff0c\u200b\u4f60\u200b\u7684\u200b\u4ee3\u7801\u200b\u5c31\u200b\u4fdd\u5b58\u200b\u5230\u200b\u4e91\u7aef\u200b\u4e86\u200b\u3002</p> <p>\u200b\u4ed3\u5e93\u200b\u6743\u9650\u200b</p> <p>\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u516c\u5171\u200b\u4ed3\u5e93\u200b\u62c9\u53d6\u200b\uff0c\u200b\u4f46\u200b\u4f60\u200b\u53ea\u80fd\u200b\u63a8\u9001\u200b\u5230\u200b\u4f60\u200b\u62e5\u6709\u200b\u6743\u9650\u200b\u7684\u200b\u4ed3\u5e93\u200b\u3002\u200b\u4e3a\u4e86\u200b\u9a8c\u8bc1\u200b\u4f60\u200b\u7684\u200b\u8eab\u4efd\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u8bbe\u7f6e\u200b\u81ea\u5df1\u200b\u7684\u200bssh\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\u3002\u200b\u8bf7\u200b\u53c2\u7167\u200b3.4\u200b\u8282\u200b ssh\u200b\u5bc6\u94a5\u200b\u8bbe\u7f6e\u200b\u5b8c\u6210\u200b\u8bbe\u7f6e\u200b\u3002</p>"},{"location":"tools/#333","title":"3.3.3 \u200b\u5408\u5e76\u200b\u51b2\u7a81\u200b\u66f4\u6539","text":"<p>\u200b\u5982\u679c\u200b\u6709\u200b\u4e24\u4e2a\u200bCommit\u200b\u7684\u200b\u5185\u5bb9\u200b\u51fa\u73b0\u200b\u51b2\u7a81\u200b\uff0cmerge\u200b\u7684\u200b\u65f6\u5019\u200b\u5c31\u200b\u6709\u200b\u53ef\u80fd\u200b\u9700\u8981\u200b\u5408\u5e76\u200b\u51b2\u7a81\u200b\u66f4\u6539\u200b\u3002\u200b\u5efa\u8bae\u200b\u5728\u200bVSCode\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u51b2\u7a81\u200b\u4fee\u6539\u200b\u3002\u200b\u4f8b\u5982\u200b\u6b64\u5904\u200b\uff0c\u200b\u6211\u200b\u5728\u200b\u5bf9\u200b\u672c\u5730\u200b<code>syscall</code>\u200b\u505a\u200b\u4fee\u6539\u200b\u4e4b\u540e\u200b\uff0c\u200b\u5c06\u200b\u5176\u200b\u4e0e\u200b\u8fdc\u7a0b\u200b<code>upstream/origin</code>\u200b\u505a\u200b\u4fee\u6539\u200b\uff0c\u200b\u5e76\u200b\u89e6\u53d1\u200b\u4e86\u200b\u51b2\u7a81\u200b\uff1a</p> <p>\u200b\u4ece\u200b\u5de6\u4fa7\u200b\u7ea2\u6846\u200b\u4e2d\u200b\u201cMerge Changes\u201d\u200b\u680f\u4e2d\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u51fa\u73b0\u200b\u51b2\u7a81\u200b\u7684\u200b\u6587\u4ef6\u200b\u3002\u200b\u70b9\u5f00\u200b\u6587\u4ef6\u200b\uff0c\u200b\u53f3\u4fa7\u200b\u4f1a\u200b\u51fa\u73b0\u200b\u51b2\u7a81\u200b\u89c6\u56fe\u200b\u3002\u200b\u4e0a\u65b9\u200b\u9752\u8272\u200b\u90e8\u5206\u200b\u6307\u200b\u7684\u200b\u662f\u200b\u5f53\u524d\u200b\uff08\u200b\u672c\u5730\u200b\uff09\u200b\u7684\u200b\u4fee\u6539\u200b\uff0c\u200b\u800c\u200b\u4e0b\u65b9\u200b\u84dd\u8272\u200b\u90e8\u5206\u200b\u5219\u200b\u662f\u200b\u8fdc\u7a0b\u200b(<code>upstream/origin</code>)\u200b\u7684\u200b\u4fee\u6539\u200b\u3002\u200b\u6839\u636e\u200b\u5b9e\u9645\u200b\u60c5\u51b5\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u4e0a\u65b9\u200b\u51e0\u4e2a\u200b\u6309\u94ae\u200b\u4e2d\u200b\u9009\u62e9\u200b\u5408\u9002\u200b\u7684\u200b\u90a3\u4e2a\u200b\u3002\u200b\u8fd9\u6b21\u200b\uff0c\u200b\u6211\u200b\u60f3\u8981\u200b\u4fdd\u5b58\u200b\u6211\u200b\u81ea\u5df1\u200b\u7684\u200b\u4fee\u6539\u200b\u3001\u200b\u800c\u200b\u4e22\u5f03\u200b\u8fdc\u7a0b\u200b\u7684\u200b\u4fee\u6539\u200b\uff0c\u200b\u6545\u200b\u9009\u62e9\u200b<code>Accept Current Change</code>\u3002\u200b\u968f\u540e\u200b\uff0c\u200b\u548c\u200bCommit\u200b\u524d\u200b\u4e00\u6837\u200b\uff0c\u200b\u5c06\u200b\u521a\u624d\u200b\u7684\u200b\u4fee\u6539\u200bStage\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u4e0a\u65b9\u200b \u221a \u200b\u53f7\u200b\u63d0\u4ea4\u200bCommit\uff0c\u200b\u5e76\u200b\u63a8\u9001\u200b\u3002\u200b\u8fd9\u6837\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c31\u200b\u5b8c\u6210\u200b\u4e86\u200b\u51b2\u7a81\u200b\u66f4\u6539\u200b\u7684\u200b\u5408\u5e76\u200b\u3002</p>"},{"location":"tools/#34-ssh","title":"3.4 ssh\u200b\u5bc6\u94a5\u200b\u8bbe\u7f6e","text":"<p>\u200b\u901a\u8fc7\u200bssh\u200b\u5bc6\u94a5\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u7b80\u5355\u200b\u7684\u200b\u5b8c\u6210\u200b\u4ece\u200b\u672c\u5730\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u7684\u200b\u8ba4\u8bc1\u200b\u3002\u200b\u8ddf\u968f\u200b\u4ee5\u4e0b\u200b\u6b65\u9aa4\u200b\uff0c\u200b\u4ee5\u200b\u5b8c\u6210\u200bssh\u200b\u5bc6\u94a5\u200b\u521b\u5efa\u200b\uff0c\u200b\u5e76\u200b\u90e8\u7f72\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff1a</p>"},{"location":"tools/#341-ssh","title":"3.4.1 \u200b\u751f\u6210\u200bssh\u200b\u5bc6\u94a5\u200b\u5bf9","text":"<p>\u200b\u5728\u200b\u7ec8\u7aef\u200b\u4e2d\u200b\uff0c\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u6307\u4ee4\u200b\u4ee5\u200b\u751f\u6210\u200bssh\u200b\u5bc6\u94a5\u200b\u5bf9\u200b:</p> <pre><code>ssh-keygen -t ed25519 -C \"name_of_ssh_keypair\"  </code></pre> <p>\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\u7684\u200b\u540d\u5b57\u200b</p> <p>\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\u7684\u200b\u540d\u5b57\u200b\u5728\u200b\u6559\u7a0b\u200b\u4e2d\u200b\u5e38\u7528\u200b\u90ae\u7bb1\u5730\u5740\u200b\u4ee3\u66ff\u200b\uff0c\u200b\u8fd9\u662f\u200b\u4e00\u4e2a\u200b\u67d0\u79cd\u610f\u4e49\u200b\u4e0a\u200b\u7684\u200b\u4f20\u7edf\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u517c\u5bb9\u6027\u200b\u8003\u8651\u200b\uff0c\u200b\u4e0d\u200b\u5efa\u8bae\u200b\u5728\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\u540d\u5b57\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u9664\u4e86\u200bASCII\u200b\u4e4b\u5916\u200b\u7684\u200b\u4efb\u4f55\u200b\u5b57\u7b26\u200b\u3002</p> <p>\u200b\u8f93\u5165\u200b\u540e\u200b\uff0c\u200b\u6839\u636e\u200b\u7ec8\u7aef\u200b\u7684\u200b\u63d0\u793a\u200b\uff0c\u200b\u6309\u4e0b\u200b\u4e09\u6b21\u200b\u56de\u8f66\u200b\u5373\u53ef\u200b\u5b8c\u6210\u200bssh\u200b\u5bc6\u94a5\u200b\u751f\u6210\u200b\uff0c\u200b\u6216\u8005\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u81ea\u5b9a\u4e49\u200b\u8fd9\u4e9b\u200b\u9700\u8981\u200b\u8f93\u5165\u200b\u7684\u200b\u5185\u5bb9\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/.ssh$ ssh-keygen -t ed25519 -C \"willson0v0@willson0v0.com\"\nGenerating public/private ed25519 key pair.\nEnter file in which to save the key (/home/lgz_admin/.ssh/id_ed25519): # \u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\u4ee5\u200b\u4f7f\u7528\u200b\u9ed8\u8ba4\u200b\u8def\u5f84\u200b\uff08~/.ssh/id_ed25519\uff09\nEnter passphrase (empty for no passphrase):        # \u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\u4ee5\u200b\u4f7f\u7528\u200b\u7a7a\u200b\u5bc6\u7801\u200b\uff0c\u200b\u6216\u8005\u200b\u81ea\u5b9a\u4e49\u200b\u5bc6\u7801\u200b\u518d\u200b\u56de\u8f66\u200b\u3002\u200b\u901a\u5e38\u200b\u53ef\u4ee5\u200b\u4e0d\u8bbe\u200b\u5bc6\u7801\u200b\u3002\nEnter same passphrase again:           # \u200b\u6309\u4e0b\u200b\u56de\u8f66\u200b\u786e\u8ba4\u200b\u7a7a\u200b\u5bc6\u7801\u200b\uff0c\u200b\u6216\u8005\u200b\u91cd\u65b0\u200b\u8f93\u5165\u200b\u4e0a\u200b\u4e00\u884c\u200b\u4e2d\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u5bc6\u7801\u200b\u3002\nYour identification has been saved in /home/lgz_admin/.ssh/id_ed25519\nYour public key has been saved in /home/lgz_admin/.ssh/id_ed25519.pub\nThe key fingerprint is:\nSHA256:1oDtnF8c1FXpDc+6U1Gogf8Swur0N/Dh6uFJFIlVJ9o willson0v0@willson0v0.com\nThe key's randomart image is:\n+--[ED25519 256]--+\n|          .o+..o=|\n|       o o.=.o+..|\n|      . +.+.Eo.+o|\n|       o +oo+. o+|\n|        S.o.oo ..|\n|       .oo..o o .|\n|       o .++ o o |\n|        .o.o= o  |\n|         .=o . . |\n+----[SHA256]-----+\n</code></pre> <p>\u200b\u73b0\u5728\u200b\uff0c\u200b\u4f60\u200b\u7684\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\u5df2\u7ecf\u200b\u751f\u6210\u200b\u5b8c\u6210\u200b\u3002\u200b\u5982\u679c\u200b\u9075\u5faa\u200b\u9ed8\u8ba4\u8bbe\u7f6e\u200b\uff0c\u200b\u90a3\u4e48\u200b<code>~/.ssh/id_ed25519</code>\u200b\u662f\u200b\u4f60\u200b\u7684\u200b\u79c1\u94a5\u200b\u6587\u4ef6\u200b\uff0c<code>~/.ssh/id_ed25519.pub</code>\u200b\u5219\u200b\u662f\u200b\u4f60\u200b\u7684\u200b\u516c\u94a5\u200b\u6587\u4ef6\u200b\u3002\u200b\u901a\u8fc7\u200b<code>cat</code>\u200b\u53ef\u4ee5\u200b\u5c55\u793a\u200b\u5176\u4e2d\u200b\u7684\u200b\u5185\u5bb9\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/.ssh$ cat ~/.ssh/id_ed25519 # \u200b\u8fd9\u662f\u200b\u5c55\u793a\u200b\u7528\u200b\u7684\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\u3002\u200b\u8bf7\u200b\u4e0d\u8981\u200b\u4f7f\u7528\u200b\u8be5\u200b\u5bc6\u94a5\u200b\u5bf9\u200b\uff0c\u200b\u4e5f\u200b\u4e0d\u8981\u200b\u8bb2\u200b\u81ea\u5df1\u200b\u7684\u200b\u79c1\u94a5\u200b\u5c55\u793a\u200b\u7ed9\u200b\u4efb\u4f55\u4eba\u200b\u3002\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACB07KkIxYhV60DnPqKY1E0AFoRgqnKRUy1qoh5M9EYJeAAAAKDKf/BCyn/w\nQgAAAAtzc2gtZWQyNTUxOQAAACB07KkIxYhV60DnPqKY1E0AFoRgqnKRUy1qoh5M9EYJeA\nAAAEBixqKUUTawYfl+mnEcqtxWT5up8xfbyaN438Iqjs3Gu3TsqQjFiFXrQOc+opjUTQAW\nhGCqcpFTLWqiHkz0Rgl4AAAAGXdpbGxzb24wdjBAd2lsbHNvbjB2MC5jb20BAgME\n-----END OPENSSH PRIVATE KEY-----\nlgz_admin@OSLabExecNode0:~/.ssh$ cat ~/.ssh/id_ed25519.pub\nssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHTsqQjFiFXrQOc+opjUTQAWhGCqcpFTLWqiHkz0Rgl4 willson0v0@willson0v0.com\n</code></pre> <p>\u200b\u5b58\u50a8\u200b\u4f4d\u7f6e\u200b</p> <p>ssh agent\u200b\u4f1a\u200b\u81ea\u52a8\u200b\u88c5\u8f7d\u200b<sub>/.ssh/id_rsa\u200b\u6216\u8005\u200b</sub>/.ssh/id_ed25519\u200b\u7b49\u200b\u5bc6\u94a5\u200b\u6587\u4ef6\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u66f4\u6539\u200b\u4e86\u200b\u5bc6\u94a5\u200b\u6587\u4ef6\u200b\u7684\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u53ef\u80fd\u200b\u9700\u8981\u200bssh-agent\u200b\u989d\u5916\u200b\u6dfb\u52a0\u200b\u5bc6\u94a5\u200b\u5230\u200b\u8eab\u4efd\u200b\u3002</p> <p>\u200b\u4fdd\u62a4\u200b\u597d\u200b\u4f60\u200b\u7684\u200b\u79c1\u94a5\u200b\uff01</p> <p>\u200b\u79c1\u94a5\u200b\uff08<code>~/.ssh/id_ed25519</code>\uff09\u200b\u987e\u540d\u601d\u4e49\u200b\uff0c\u200b\u662f\u200b\u53ea\u6709\u200b\u4f60\u200b\u624d\u200b\u77e5\u9053\u200b\u7684\u200b\u5bc6\u94a5\u200b\u3002\u200b\u8bf7\u200b\u7edd\u5bf9\u200b\u4e0d\u8981\u200b\u5c06\u200b\u79c1\u94a5\u200b\u6cc4\u9732\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u4efb\u4f55\u200b\u6301\u6709\u200b\u8fd9\u4e2a\u200b\u79c1\u94a5\u200b\u7684\u200b\u4eba\u200b\u90fd\u200b\u53ef\u4ee5\u200b\u4f2a\u88c5\u6210\u200b\u662f\u200b\u4f60\u200b\u3002</p> <p>\u200b\u5173\u4e8e\u200b\u5bc6\u7801\u200b</p> <p>\u200b\u53ef\u4ee5\u200b\u4e3a\u200bssh\u200b\u5bc6\u94a5\u200b\u8bbe\u7f6e\u200b\u5bc6\u7801\u200b\uff0c\u200b\u4ee5\u200b\u4fdd\u8bc1\u200b\u5bc6\u94a5\u200b\u7684\u200b\u5b89\u5168\u200b\u3002\u200b\u4e0d\u8fc7\u200b\uff0c\u200b\u901a\u5e38\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u8fd9\u200b\u5e76\u200b\u6ca1\u6709\u200b\u5fc5\u8981\u200b\uff0c\u200b\u800c\u4e14\u200b\u8fd9\u4f1a\u200b\u8ba9\u200b\u5404\u79cd\u200bssh\u200b\u53d8\u5f97\u200b\u5f88\u200b\u9ebb\u70e6\u200b\uff1a\u200b\u6bcf\u6b21\u200bpush\u200b\u6216\u8005\u200bpull\u200b\u90fd\u200b\u8981\u200b\u8f93\u200b\u4e00\u6b21\u200b\u5bc6\u7801\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e0d\u200b\u5efa\u8bae\u200b\u4f60\u200b\u4e3a\u200bssh\u200b\u5bc6\u94a5\u200b\u8bbe\u7f6e\u200b\u5bc6\u7801\u200b\u3002</p>"},{"location":"tools/#342-gitee","title":"3.4.2 \u200b\u5c06\u200b\u5bc6\u94a5\u200b\u90e8\u7f72\u200b\u5230\u200bGitee","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u8981\u200b\u8bbf\u95ee\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u4f4d\u4e8e\u200bGitee\uff0c\u200b\u90a3\u4e48\u200b\u4f60\u200b\u9700\u8981\u200b\u5c06\u200b\u4f60\u200b\u7684\u200b ssh\u200b\u516c\u94a5\u200b \u200b\u90e8\u7f72\u200b\u5230\u200bGitee\u3002\u200b\u9996\u5148\u200b\uff0c\u200b\u6253\u5f00\u200bGitee\u200b\u9875\u9762\u200b\uff0c\u200b\u767b\u5f55\u200b\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u89d2\u200b\u4e2a\u4eba\u5934\u50cf\u200b-\u200b\u8bbe\u7f6e\u200b\uff1a</p> <p>\u200b\u968f\u540e\u200b\uff0c\u200b\u70b9\u51fb\u200b\u5de6\u4fa7\u200b\u7684\u200bssh\u200b\u516c\u94a5\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u6b64\u524d\u200b\u751f\u6210\u200b\u7684\u200b ssh\u200b\u516c\u94a5\u200b \u200b\u5185\u5bb9\u200b\u62f7\u8d1d\u200b\u8fdb\u516c\u200b\u94a5\u533a\u200b\u3002\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b<code>cat ~/.ssh/id_ed25519.pub</code>\u200b\u4ece\u200b\u7ec8\u7aef\u200b\u83b7\u5f97\u200b\u8fd9\u4e2a\u200b\u6587\u4ef6\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002\u200b\u968f\u540e\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u7f16\u8f91\u200b\u8fd9\u4e2a\u200b\u516c\u94a5\u200b\u7684\u200b\u6807\u9898\u200b\u3002\u200b\u6700\u540e\u200b\uff0c\u200b\u70b9\u51fb\u200b\u6700\u200b\u4e0b\u65b9\u200b\u6a59\u8272\u200b\u7684\u200b\u201c\u200b\u786e\u5b9a\u200b\u201d\uff0c\u200b\u5373\u53ef\u200b\u5b8c\u6210\u200b\u516c\u94a5\u200b\u7684\u200b\u6dfb\u52a0\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u6307\u4ee4\u200b\uff0c\u200b\u5c1d\u8bd5\u200b\u8fde\u63a5\u200b\u5230\u200bGitee\uff0c\u200b\u4ee5\u200b\u9a8c\u8bc1\u200b\u516c\u94a5\u200b\u662f\u5426\u200b\u6dfb\u52a0\u200b\u6210\u529f\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~$ ssh -T git@gitee.com\nHi \u200b\u7528\u6237\u540d\u200b! You've successfully authenticated, but GITEE.COM does not provide shell access.\n</code></pre>"},{"location":"tools/#343-github","title":"3.4.3 \u200b\u5c06\u200b\u5bc6\u94a5\u200b\u90e8\u7f72\u200b\u5230\u200bGithub","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u8981\u200b\u8bbf\u95ee\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u4f4d\u4e8e\u200bGithub\uff0c\u200b\u90a3\u4e48\u200b\u4f60\u200b\u9700\u8981\u200b\u5c06\u200b\u4f60\u200b\u7684\u200b ssh\u200b\u516c\u94a5\u200b \u200b\u90e8\u7f72\u200b\u5230\u200bGitee\u3002\u200b\u9996\u5148\u200b\uff0c\u200b\u6253\u5f00\u200bGithub\u200b\u9875\u9762\u200b\uff0c\u200b\u767b\u5f55\u200b\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u89d2\u200b\u4e2a\u4eba\u5934\u50cf\u200b-Settings\uff1a</p> <p>\u200b\u968f\u540e\u200b\uff0c\u200b\u70b9\u51fb\u200b\u5de6\u4fa7\u200bSSH and GPG keys\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u53f3\u4e0a\u89d2\u200b\u7684\u200bNew SSH key\uff1a</p> <p>\u200b\u6700\u540e\u200b\uff0c\u200b\u8f93\u5165\u200bSSH key\u200b\u7684\u200b\u6807\u9898\u200b\uff0c\u200b\u5c06\u200b\u6b64\u524d\u200b\u751f\u6210\u200b\u7684\u200b ssh\u200b\u516c\u94a5\u200b \u200b\u5185\u5bb9\u200b\u62f7\u8d1d\u200b\u8fdb\u516c\u200b\u94a5\u533a\u200b\uff0c\u200b\u5e76\u200b\u70b9\u51fb\u200b\u4e0b\u65b9\u200b\u7eff\u8272\u200b<code>Add SSH key</code>\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u6307\u4ee4\u200b\uff0c\u200b\u5c1d\u8bd5\u200b\u8fde\u63a5\u200b\u5230\u200bGithub\uff0c\u200b\u4ee5\u200b\u9a8c\u8bc1\u200b\u516c\u94a5\u200b\u662f\u5426\u200b\u6dfb\u52a0\u200b\u6210\u529f\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~$ ssh -T git@github.com\nHi \u200b\u7528\u6237\u540d\u200b! You've successfully authenticated, but GitHub does not provide shell access.\n</code></pre>"},{"location":"tools/#35","title":"3.5 \u200b\u5e38\u89c1\u95ee\u9898","text":""},{"location":"tools/#351","title":"3.5.1 \u200b\u65e0\u6cd5\u200b\u63a8\u9001\u200b\u600e\u4e48\u529e\u200b\uff1f","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u5c1d\u8bd5\u200b\u63a8\u9001\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u6216\u8005\u200b\u4ece\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u62c9\u53d6\u200b\uff0c\u200b\u4f46\u662f\u200bgit\u200b\u5374\u200b\u663e\u793a\u200b\u51fa\u200b\u8fd9\u6837\u200b\u7684\u200b\u9519\u8bef\u200b\uff1a</p> <pre><code>git@gitee.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights \nand the repository exists\n</code></pre> <p>\u200b\u8fd9\u200b\u8868\u660e\u200b\u4f60\u200b\u6ca1\u6709\u200b\u6743\u9650\u200b\u63a8\u9001\u200b\u5230\u200b\u8fd9\u4e2a\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002\u200b\u4e00\u822c\u800c\u8a00\u200b\uff0c\u200b\u8fd9\u662f\u200b\u7531\u4e8e\u200b\u4f60\u200b\u6ca1\u6709\u200b\u8bbe\u7f6e\u200b\u597d\u200b\u81ea\u5df1\u200b\u7684\u200bssh\u200b\u5bc6\u94a5\u200b\u9020\u6210\u200b\u7684\u200b\u3002\u200b\u8bf7\u200b\u53c2\u7167\u200b3.4\u200b\u8282\u200b ssh\u200b\u5bc6\u94a5\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u8bbe\u7f6e\u200b\u81ea\u5df1\u200b\u7684\u200bssh\u200b\u5bc6\u94a5\u200b\u3002</p>"},{"location":"tools/#352","title":"3.5.2 \u200b\u6211\u200b\u600e\u4e48\u200b\u77e5\u9053\u200b\u6211\u200b\u4fee\u6539\u200b\u4e86\u200b\u54ea\u4e9b\u200b\u6587\u4ef6\u200b\uff1f","text":"<p>\u200b\u901a\u5e38\u200b\u800c\u8a00\u200b\uff0c\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u540c\u5b66\u200b\u4eec\u200b\u63d0\u4ea4\u200b \u200b\u6240\u6709\u200b \u200b\u88ab\u200b\u4fee\u6539\u200b\u8fc7\u200b\u7684\u200b\u6587\u4ef6\u200b\u3002\u200b\u901a\u8fc7\u200b\u5c06\u200b\u5f53\u524d\u5de5\u4f5c\u200b\u8def\u5f84\u200b\u4e0e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff08\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u7684\u200b\u4ed3\u5e93\u200b\uff09\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\u7684\u200b\u5185\u5bb9\u200b\u76f8\u200b\u6bd4\u8f83\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u65b9\u4fbf\u200b\u5730\u200b\u77e5\u9053\u200b\u81ea\u5df1\u200b\u66fe\u7ecf\u200b\u4fee\u6539\u200b\u8fc7\u200b\u54ea\u4e9b\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u6253\u5305\u200b\u63d0\u4ea4\u200b\u3002\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5f53\u524d\u200b\u5206\u652f\u200b\u4e0e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u7684\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u76f8\u200b\u6bd4\u8f83\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git fetch --all\nFetching origin\nFetching upstream\nlgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git diff --stat upstream/syscall *\n kernel/kalloc.c  | 2 ++\n kernel/syscall.c | 1 +\n kernel/syscall.h | 1 +\n kernel/sysinfo.h | 1 +\n 4 files changed, 5 insertions(+)\n</code></pre> <p>\u200b\u8981\u200b\u6bd4\u8f83\u200b\u5176\u4ed6\u200b\u5206\u652f\u200b\uff0c\u200b\u5c06\u200b\u7b2c\u4e8c\u6761\u200b\u6307\u4ee4\u200b\u4e2d\u200b\u7684\u200b<code>syscall</code>\u200b\u6539\u4e3a\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\u540d\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u8bf7\u200b\u5148\u200b\u5728\u200b\u672c\u5730\u200b\u5207\u6362\u200b\u5230\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\uff01</p> <p>\u200b\u5728\u200b\u6bd4\u8f83\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5c06\u200b\u672c\u5730\u200b\u5206\u652f\u200b\u4e0e\u200b\u4e0a\u6e38\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\u8fdb\u884c\u200b\u6bd4\u8f83\u200b\u3002\u200b\u4e3e\u4f8b\u200b\u800c\u8a00\u200b\uff0c\u200b\u4f60\u200b\u4e0d\u4f1a\u200b\u60f3\u200b\u6bd4\u8f83\u200b\u672c\u5730\u200b\u7684\u200b<code>util</code>\u200b\u5206\u652f\u200b\u548c\u200b\u8fdc\u7a0b\u200b\u7684\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u4e0d\u662f\u200b\u4e00\u4e2a\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u3002\u200b\u8bf7\u200b\u5148\u200b\u4f7f\u7528\u200b<code>git checkout \u200b\u5206\u652f\u200b\u540d\u200b</code>\u200b\u4ee5\u200b\u5207\u6362\u200b\u5230\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u4f7f\u7528\u200b<code>git diff --stat upstream/\u200b\u5206\u652f\u200b\u540d\u200b *</code>\u200b\u65f6\u200b\u6307\u5b9a\u200b \u200b\u540c\u4e00\u4e2a\u200b \u200b\u4e0a\u6e38\u200b\u5206\u652f\u200b\u3002</p> <p>\u200b\u672a\u200b\u8bbe\u7f6e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff1f</p> <p>\u200b\u5982\u679c\u200bgit\u200b\u62a5\u544a\u200b\u201c<code>fatal: ambiguous argument 'upstream/\u200b\u5206\u652f\u200b\u540d\u200b': unknown revision or path not in the working tree.</code>\u201d\uff0c\u200b\u8bf4\u660e\u200b\u4f60\u200b\u5c1a\u672a\u200b\u8bbe\u7f6e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u3002\u200b\u8bf7\u5148\u200b\u6309\u672c\u200b\u6307\u5357\u200b\u4e2d\u200b\u7684\u200b3.1-\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u4e00\u8282\u200b\u5b8c\u6210\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u7684\u200b\u8bbe\u7f6e\u200b\u4e0e\u200b\u540c\u6b65\u200b\uff0c\u200b\u518d\u200b\u8fdb\u884c\u200b\u6bd4\u8f83\u200b\u3002</p>"},{"location":"tools/#353-checkout","title":"3.5.3 \u200b\u4e3a\u4ec0\u4e48\u200b\u6211\u200b\u4e0d\u80fd\u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff08checkout\uff09\uff1f","text":"<p>\u200b\u901a\u5e38\u200b\u800c\u8a00\u200b\uff0c\u200b\u4e0d\u80fd\u200b\u5207\u6362\u200b\u5206\u652f\u200b\u7684\u200b\u4e3b\u8981\u200b\u539f\u56e0\u200b\u662f\u200b\u4f60\u200b\u5f53\u524d\u200b\u6709\u200b\u5c1a\u672a\u200b\u4fdd\u5b58\u200b\u7684\u200b\u4fee\u6539\u200b\uff0c\u200b\u6b64\u65f6\u200bcheckout\u200b\u7684\u8bdd\u200b\u4f1a\u200b\u89e6\u53d1\u200b\u4ee5\u4e0b\u200b\u9519\u8bef\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0: ~/git_demo/xv6-oslab23-hitsz$ git checkout util                                                                                                \u2500\u256f\nerror: Your local changes to the following files would be overwritten by checkout:\n        Makefile\nPlease commit your changes or stash them before you switch branches.\nAborting\n</code></pre> <p>\u200b\u901a\u8fc7\u200b<code>git status</code>\u200b\u6307\u4ee4\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u68c0\u67e5\u200b\u5f53\u524d\u200bgit\u200b\u7684\u200b\u72b6\u6001\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b\u8f93\u51fa\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0: ~/git_demo/xv6-oslab23-hitsz$ git status\nOn branch syscall\nYour branch is up to date with 'origin/syscall'.\n\nChanges not staged for commit:\n  (use \"git add &lt;file&gt;...\" to update what will be committed)\n  (use \"git restore &lt;file&gt;...\" to discard changes in working directory)\n        modified:   Makefile\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\n</code></pre> <p>\u200b\u8fd9\u200b\u8bf4\u660e\u200b\u5f53\u524d\u200b\u4f60\u200b\u7684\u200b\u5de5\u4f5c\u200b\u533a\u6709\u200b\u5c1a\u672a\u200b\u4fdd\u5b58\u200b\u7684\u200b\u66f4\u6539\u200b\u3002\u200b\u8bf7\u200b\u53c2\u8003\u200b3.3.1 \u200b\u4f7f\u7528\u200b\u547d\u4ee4\u884c\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u6216\u8005\u200b3.3.2 \u200b\u4f7f\u7528\u200bVSCode\u200b\u5185\u5efa\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u8282\u200b\uff0c\u200b\u5b8c\u6210\u200bcommit\u200b\u64cd\u4f5c\u200b\u3002 \u200b\u6216\u8005\u200b\uff0c\u200b\u5982\u679c\u200b\u4f60\u200b\u5e0c\u671b\u200b\u76f4\u63a5\u200b\u653e\u5f03\u200b\u6389\u200b\u4e0a\u200b\u4e00\u6b21\u200bcommit\u200b\u540e\u200b\u7684\u200b \u200b\u6240\u6709\u200b\u66f4\u6539\u200b \uff0c\u200b\u90a3\u4e48\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b<code>-f</code>\u200b\u9009\u9879\u200b\u5f3a\u5236\u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff0c\u200b\u4f8b\u5982\u200b<code>git checkout -f syscall</code>\u3002</p>"},{"location":"tools/#4-gcc","title":"4 gcc","text":"<p>question 4</p> <p>\u200b\u5bf9\u4e8e\u200b\u4e60\u60ef\u200b\u4f7f\u7528\u200bWindows\u200b\u73b0\u6709\u200b\u7684\u200bIDE\u200b\u6765\u200b\u7f16\u8bd1\u7a0b\u5e8f\u200b\u7684\u200b\u6211\u4eec\u200b\uff0c\u200b\u9762\u5bf9\u200bLinux\u200b\u7684\u200b\u547d\u4ee4\u884c\u200b\uff0c\u200b\u5e94\u8be5\u200b\u5982\u4f55\u200b\u7f16\u8bd1\u200b\u81ea\u5df1\u200b\u5199\u200b\u597d\u200b\u7684\u200b\u4ee3\u7801\u200b\uff1a\uff1f</p> <p>\u200b\u901a\u5e38\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0cLinux\u200b\u7528\u6237\u200b\u66f4\u200b\u559c\u6b22\u200b\u76f4\u63a5\u200b\u7f16\u5199\u200b\u76f8\u5e94\u200b\u7684\u200bGCC\u200b\u547d\u4ee4\u200b\u6765\u200b\u7f16\u8bd1\u7a0b\u5e8f\u200b\u3002\u200b\u5927\u90e8\u5206\u200bLinux\u200b\u53d1\u884c\u7248\u200b\u4e2d\u200b\u90fd\u200b\u4f1a\u200b\u9ed8\u8ba4\u200b\u5b89\u88c5\u200bGCC\u200b\u7f16\u8bd1\u5668\u200b\u3002</p>"},{"location":"tools/#41-gcc","title":"4.1 GCC\u200b\u5e38\u7528\u200b\u7f16\u8bd1\u200b\u9009\u9879","text":"<p>\u200b\u547d\u4ee4\u200b\u683c\u5f0f\u200b\uff1agcc [\u200b\u9009\u9879\u200b] [\u200b\u6587\u4ef6\u540d\u200b]</p> <p>-E: \u200b\u4ec5\u200b\u6267\u884c\u200b\u7f16\u8bd1\u200b\u9884\u5904\u7406\u200b</p> <p>-S\uff1a\u200b\u5c06\u200bC\u200b\u4ee3\u7801\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u6c47\u7f16\u200b\u4ee3\u7801\u200b</p> <p>-c\uff1a\u200b\u4ec5\u200b\u6267\u884c\u200b\u7f16\u8bd1\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4e0d\u200b\u8fdb\u884c\u200b\u94fe\u63a5\u200b\u64cd\u4f5c\u200b</p> <p>-o: \u200b\u6307\u5b9a\u200b\u751f\u6210\u200b\u7684\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200b</p>"},{"location":"tools/#42-gcc","title":"4.2 GCC\u200b\u7f16\u8bd1\u200b\u7684\u200b\u56db\u4e2a\u200b\u9636\u6bb5","text":"<p>1\u3001\u200b\u5c06\u200bhello.c\u200b\u9884\u5904\u7406\u200b\u8f93\u51fa\u200bhello.i\u200b\u6587\u4ef6\u200b</p> <pre><code>gcc -E hello.c -o hello.i\n</code></pre> <p>2\u3001\u200b\u5c06\u200b\u9884\u5904\u7406\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200bhello.i\u200b\u6c47\u7f16\u200b\u6210\u200bhello.s\u200b\u6587\u4ef6\u200b\u3002</p> <pre><code>gcc -S hello.i -o hello.s\n</code></pre> <p>3\u3001\u200b\u5c06\u200b\u6c47\u7f16\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200bhello.s\u200b\u7f16\u8bd1\u200b\u8f93\u51fa\u200bhello.o\u200b\u6587\u4ef6\u200b</p> <pre><code>gcc -c hello.s -o hello.o\n</code></pre> <p>4\u3001\u200b\u5c06\u200b\u7f16\u8bd1\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200bhello.o\u200b\u94fe\u63a5\u200b\u6210\u200b\u6700\u7ec8\u200b\u53ef\u6267\u884c\u6587\u4ef6\u200bhello\u3002</p> <pre><code>gcc hello.o -o hello\n</code></pre> <p>\u200b\u6216\u200b\u76f4\u63a5\u200b\u8f93\u5165\u200b\u4e0b\u9762\u200b\u4ee3\u7801\u200b\u4e00\u6b65\u5230\u4f4d\u200b</p> <pre><code>gcc hello.c -o hello\n</code></pre> <p>\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u6709\u200b\u591a\u4e2a\u200b\u6a21\u5757\u200b\u3001\u200b\u591a\u4e2a\u200b\u6587\u4ef6\u200b\u4e00\u8d77\u200b\u7f16\u8bd1\u200b\uff0c\u200b\u8bf7\u200b\u81ea\u884c\u200b\u767e\u5ea6\u200b\u3002</p>"},{"location":"tools/#5-makefile","title":"5 Makefile","text":"<p>question 5</p> <p>\u200b\u4ec0\u4e48\u200b\u662f\u200bmakefile\uff1f\u200b\u4f5c\u4e3a\u200b\u4e00\u4e2a\u200b\u4e13\u4e1a\u200b\u7684\u200b\u7a0b\u5e8f\u5458\u200b\uff0c\u200b\u7279\u522b\u200b\u662f\u200b\u5728\u200bUnix\uff08Linux\uff09\u200b\u73af\u5883\u200b\u4e0b\u200b\u5f00\u53d1\u200b\u7684\u200b\u7a0b\u5e8f\u5458\u200b\uff0c\u200b\u5982\u679c\u200b\u4e0d\u4f1a\u200b\u4f7f\u7528\u200bGNU make\u200b\u6765\u200b\u6784\u5efa\u200b\u548c\u200b\u7ba1\u7406\u200b\u81ea\u5df1\u200b\u7684\u200b\u5de5\u7a0b\u200b\uff0c\u200b\u5e94\u8be5\u200b\u4e0d\u80fd\u200b\u7b97\u662f\u200b\u4e00\u4e2a\u200b\u5408\u683c\u200b\u7684\u200b\u4e13\u4e1a\u200b\u7a0b\u5e8f\u5458\u200b\u3002\u200b\u4f1a\u200b\u4e0d\u4f1a\u200b\u5199\u200bMakefile\uff0c\u200b\u4ece\u200b\u4e00\u4e2a\u200b\u4fa7\u9762\u200b\u8bf4\u660e\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u4eba\u200b\u662f\u5426\u200b\u5177\u5907\u200b\u5b8c\u6210\u200b\u5927\u578b\u200b\u5de5\u7a0b\u200b\u7684\u200b\u80fd\u529b\u200b\u3002\u200b\u56e0\u4e3a\u200b\uff0cMakefile\u200b\u5173\u7cfb\u200b\u5230\u200b\u4e86\u200b\u6574\u4e2a\u200b\u5de5\u7a0b\u200b\u7684\u200b\u7f16\u8bd1\u200b\u3001\u200b\u8fde\u63a5\u200b\u7b49\u200b\u89c4\u5219\u200b\u3002\u200b\u4e3a\u200b\u5de5\u7a0b\u200b\u7f16\u5199\u200bMakefile\u200b\u7684\u200b\u597d\u5904\u200b\u662f\u200b\u80fd\u591f\u200b\u7528\u200b\u4e00\u4e2a\u200bmake\u200b\u547d\u4ee4\u200b\u6765\u200b\u5b8c\u6210\u200b\u201c\u200b\u81ea\u52a8\u5316\u200b\u7f16\u8bd1\u200b\"\uff0c\u200b\u6781\u5927\u5730\u63d0\u9ad8\u200b\u4e86\u200b\u8f6f\u4ef6\u5f00\u53d1\u200b\u7684\u200b\u6548\u7387\u200b\u3002make\u200b\u662f\u200b\u4e00\u4e2a\u200b\u547d\u4ee4\u200b\u5de5\u5177\u200b\uff0c\u200b\u5b83\u200b\u7528\u4e8e\u200b\u89e3\u91ca\u200bmakefile\u200b\u4e2d\u200b\u7684\u200b\u6307\u4ee4\u200b\u3002</p> <p>\u200b\u7f16\u5199\u200b\u89c4\u5219\u200b\uff1a</p> <pre><code>&lt;target&gt; : &lt;prerequisites&gt; \n[tab]  &lt;commands&gt;\n</code></pre> <p>\u200b\u4e3a\u4e86\u200b\u5927\u5bb6\u200b\u80fd\u200b\u66f4\u4e3a\u200b\u6e05\u6670\u200b\u5730\u200b\u4e86\u89e3\u200bMakefile\u200b\u7684\u200b\u57fa\u672c\u6982\u5ff5\u200b\uff0c\u200b\u6211\u4eec\u200b\u6765\u200b\u5199\u200b\u4e00\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200bMakefile\u3002</p> <p>\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200bgcc\u200b\u7f16\u8bd1\u200bhello.c</p> <pre><code>gcc -o hello hello.c\n</code></pre> <p>\u200b\u90a3\u4e48\u200b\uff0c\u200b\u7b80\u6613\u200b\u7684\u200bMakefile\u200b\u53ef\u4ee5\u200b\u5199\u6210\u200b\u5982\u4e0b\u200b\u7684\u200b\u6837\u5b50\u200b\uff0c\u200b\u4e4b\u540e\u200b\u6267\u884c\u200bmake\u200b\u5373\u53ef\u200b\u4ea7\u751f\u200bhello\u200b\u53ef\u6267\u884c\u6587\u4ef6\u200b</p> <pre><code>all: hello.c\ngcc -o hello hello.c\n</code></pre> <p>\u200b\u5efa\u8bae\u200b\u540c\u5b66\u200b\u4eec\u200b\u81ea\u5df1\u200b\u5c1d\u8bd5\u200b\u5199\u200b\u4e00\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200bMakefile\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u4e3a\u200b\u540c\u5b66\u200b\u4eec\u200b\u63d0\u4f9b\u200b\u4e24\u4e2a\u200b\u7f51\u5740\u200b\u4f9b\u200b\u5927\u5bb6\u200b\u5b66\u4e60\u200b\u53c2\u8003\u200b\uff1a</p> <p>\u200b\u8ddf\u200b\u6211\u200b\u4e00\u8d77\u200b\u5199\u200bMakefile:MakeFile</p> <p>Reading-Makefiles</p>"},{"location":"faq/faq-env/","title":"\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u95ee\u9898","text":"<p>\u200b\u6e29\u99a8\u200b\u63d0\u793a\u200b</p> <p>\u200b\u672c\u200b\u6587\u6863\u200b\u4f1a\u200b\u4e0d\u200b\u5b9a\u65f6\u200b\u66f4\u65b0\u200b\u540c\u5b66\u200b\u4eec\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u51fa\u73b0\u200b\u7684\u200b\u95ee\u9898\u200b\u4ee5\u53ca\u200b\u5bf9\u5e94\u200b\u7684\u200b\u89e3\u51b3\u529e\u6cd5\u200b\uff0c\u200b\u4f9b\u200b\u540c\u5b66\u200b\u4eec\u200b\u53c2\u8003\u200b\u3002\u200b\u7279\u522b\u611f\u8c22\u200b\u7ed9\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u53cd\u9988\u200b\u95ee\u9898\u200b\u3001\u200b\u5efa\u8bae\u200b\u4ee5\u53ca\u200b\u610f\u89c1\u200b\u7684\u200b\u540c\u5b66\u200b\u3002</p>"},{"location":"faq/faq-env/#_1","title":"\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u95ee\u9898","text":""},{"location":"faq/faq-env/#1","title":"1. \u200b\u9ad8\u200b\u7248\u672c\u200b\u5de5\u5177\u200b\u517c\u5bb9\u95ee\u9898","text":""},{"location":"faq/faq-env/#11-xv6qemu600","title":"1.1 xv6\u200b\u5982\u4f55\u200b\u5728\u200bQEMU&gt;=6.0.0\u200b\u4e0a\u200b\u542f\u52a8\u200b\uff1f","text":"<p>\u200b\u5177\u4f53\u200b\u89e3\u51b3\u65b9\u6848\u200b\u8be6\u89c1\u200bpiazza \uff08Fall 2022\uff09 \uff1ahttps://piazza.com/class/l7fs47nofoc4pm/post/8</p> <p></p> <p>Patch\u200b\u6587\u4ef6\u200b\uff1apmp.patch</p> <p>\u200b\u8be5\u200b\u95ee\u9898\u200b\u7684\u200b\u89e3\u51b3\u65b9\u6848\u200b\u6765\u81ea\u200b20\u200b\u7ea7\u200b\u67d0\u4f4d\u200b\u5927\u4f6c\u200b\u7684\u200b\u5206\u4eab\u200b\uff0c\u200b\u975e\u5e38\u611f\u8c22\u200b\u8fd9\u4f4d\u200b\u5927\u4f6c\u200b\u7684\u200b\u8d21\u732e\u200b~~</p>"},{"location":"faq/faq-env/#12-gcc-12","title":"1.2 \u200b\u4f7f\u7528\u200b\u9ad8\u200b\u7248\u672c\u200bgcc (\u226512)\u200b\u51fa\u73b0\u200b\u62a5\u9519","text":"<p>\u200b\u5177\u4f53\u200b\u89e3\u51b3\u65b9\u6848\u200b\u8be6\u89c1\u200bpiazza \uff08Fall 2022\uff09  \uff1ahttps://piazza.com/class/l7fs47nofoc4pm/post/22 </p> <p></p>"},{"location":"faq/faq-env/#2-vscode","title":"2. VSCode\u200b\u65e0\u6cd5\u200b\u8fde\u63a5\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0","text":""},{"location":"faq/faq-env/#21-vscodessh-connect-to-host-102491298-port-22-connection-timed-out","title":"2.1  VSCode\u200b\u8fde\u63a5\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u65f6\u200b\u63d0\u793a\u200b<code>ssh: connect to host 10.249.12.98 port 22: Connection timed out</code>\uff1f","text":"<p>\u200b\u7aef\u53e3\u53f7\u200b\u5199\u9519\u200b\u4e86\u200b\uff0c\u200b\u8bf7\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u4e66\u200b\u8981\u6c42\u200b\u6765\u200b\u8fde\u63a5\u200b\u3002</p> <p>https://hitsz-cslab.gitee.io/os-labs/remote_env/</p> <p>\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200bIP\u200b\u5730\u5740\u200b\uff1a <code>10.249.12.98</code> \uff0c\u200b\u7aef\u53e3\u53f7\u200b\uff1a <code>6666</code></p>"},{"location":"faq/faq-env/#22-vscodebad-owner-or-permission","title":"2.2 VSCode\u200b\u8fde\u63a5\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u65f6\u200b\u51fa\u73b0\u200b<code>bad owner or permission</code>\u200b\u62a5\u9519\u200b\uff1f","text":"<p>\u200b\u89e3\u51b3\u200b\u65b9\u6cd5\u200b\uff1a\u200b\u8fdb\u5165\u200b\u8def\u5f84\u200b<code>C:\\Users\\\u200b\u7528\u6237\u540d\u200b\\.ssh</code>\uff0c\u200b\u53f3\u51fb\u200bconfig\u200b\u6587\u4ef6\u200b\u8fdb\u5165\u200b\u5c5e\u6027\u200b\u4e2d\u9ad8\u7ea7\u200b\u5b89\u5168\u200b\u7ba1\u7406\u200b\uff0c\u200b\u9009\u62e9\u200b\u7981\u6b62\u200b\u7ee7\u627f\u200b\uff0c\u200b\u5e76\u4e14\u200b\u5220\u9664\u200b\u6240\u6709\u200b\u6b64\u200b\u5bf9\u8c61\u200b\u4e2d\u200b\u7ee7\u627f\u200b\u7684\u200b\u6743\u9650\u200b\u3002</p> <p>\u200b\u5177\u4f53\u200b\u53ef\u4ee5\u200b\u67e5\u770b\u200b\uff1ahttps://www.cnblogs.com/Akkuman/p/11187776.html</p>"},{"location":"faq/faq-env/#23-clone-xv6-oslab23-hitsz","title":"2.3 \u200b\u5728\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u4e0a\u200bclone xv6-oslab23-hitsz\u200b\u5931\u8d25\u200b\uff1f","text":"<p>\u200b\u5982\u56fe\u200b\uff1a</p> <p></p> <p>\u200b\u539f\u56e0\u200b\uff1a</p> <p>\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u7ed9\u200b\u6bcf\u4f4d\u200b\u540c\u5b66\u200b\u505a\u200b\u4e86\u200b\u8d44\u6e90\u200b\u9650\u989d\u200b\u7ba1\u7406\u200b\uff0c\u200b\u51fa\u73b0\u200b\u8fd9\u4e2a\u200b\u95ee\u9898\u200b\u7684\u200b\u540c\u5b66\u200b\uff0c\u200b\u6709\u200b\u53ef\u80fd\u200b\u662f\u200b\u4e4b\u524d\u200b\u7684\u200b\u300a\u200b\u8ba1\u7b97\u673a\u200b\u8bbe\u8ba1\u200b\u4e0e\u200b\u5b9e\u8df5\u200b\u300b\u200b\u5b9e\u9a8c\u200b\u5305\u200b<code>cdp-tests</code>\u200b\u5360\u7528\u200b\u4e86\u200b\u592a\u200b\u591a\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5220\u9664\u200b<code>cdp-tests/waveform</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b\u6240\u6709\u200b\u6ce2\u5f62\u56fe\u200b\u6587\u4ef6\u200b\uff08\u200b\u4e3b\u8981\u200b\u662f\u200b\u6ce2\u5f62\u56fe\u200b\u6587\u4ef6\u200b\u592a\u5927\u200b\u4e86\u200b\uff09\u3002</p> <p>\u200b\u4f7f\u7528\u200bmobaxterm\u200b\u767b\u5f55\u200b\uff0c\u200b\u8f93\u5165\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\uff1a</p> <p></p> <p>\u200b\u4f7f\u7528\u200b<code>rm -rf *</code>\u200b\u5220\u9664\u200b\u540e\u200b\uff0c\u200b\u5e94\u8be5\u200b\u5c31\u200b\u80fd\u200bclone xv6-oslab23-hitsz\u3002</p>"},{"location":"faq/faq-env/#24-vscodemkdir-cannot-create-directory-homestudentsxxx","title":"2.4 VSCode\u200b\u8fde\u63a5\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u65f6\u200b\u63d0\u793a\u200b<code>mkdir: cannot create directory '/home/students/XXX'</code>","text":"<p>\u200b\u5982\u56fe\u200b\uff1a</p> <p></p> <p></p> <p>\u200b\u539f\u56e0\u200b\uff1a</p> <p>\u200b\u4e0e\u200b\u4e0a\u8ff0\u200b\u95ee\u9898\u200b\u4e00\u6837\u200b\uff0c\u200b\u4e5f\u200b\u662f\u56e0\u4e3a\u200b\u8d44\u6e90\u200b\u9650\u989d\u200b\u7684\u200b\u95ee\u9898\u200b\u3002\u200b\u4e4b\u524d\u200b\u7684\u200b\u300a\u200b\u8ba1\u7b97\u673a\u200b\u8bbe\u8ba1\u200b\u4e0e\u200b\u5b9e\u8df5\u200b\u300b\u200b\u5b9e\u9a8c\u200b\u5305\u200b<code>cdp-tests</code>\u200b\u5360\u7528\u200b\u4e86\u200b\u592a\u200b\u591a\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5220\u9664\u200b<code>cdp-tests/waveform</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b\u6240\u6709\u200b\u6ce2\u5f62\u56fe\u200b\u6587\u4ef6\u200b\uff08\u200b\u4e3b\u8981\u200b\u662f\u200b\u6ce2\u5f62\u56fe\u200b\u6587\u4ef6\u200b\u592a\u5927\u200b\u4e86\u200b\uff09\u3002</p> <p>\u200b\u4f7f\u7528\u200bmobaxterm\u200b\u767b\u5f55\u200b\uff0c\u200b\u8f93\u5165\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\uff1a</p> <p></p>"},{"location":"faq/faq-env/#3-vscodegdb","title":"3. VSCode\u200b\u65e0\u6cd5\u200b\u7528\u200bGDB\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5","text":""},{"location":"faq/faq-env/#31-failed-to-attach-remote-communication-error","title":"3.1 \u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u56fe\u5f62\u5316\u200b\u65e0\u6cd5\u200b\u8c03\u8bd5\u200b<code>Failed to attach: Remote communication error</code>\uff1f","text":"<p>VSCode\u200b\u8fdc\u7a0b\u200b\u8c03\u8bd5\u200b\u65f6\u200b\uff0c\u200b\u63d0\u793a\u200b\u5982\u4e0b\u200b\u9519\u8bef\u200b\uff1a</p> <p></p> <p>\u200b\u5177\u4f53\u200b\u89e3\u51b3\u65b9\u6848\u200b\u8be6\u89c1\u200bpiazza \uff08Fall 2022\uff09  \uff1ahttps://piazza.com/class/l7fs47nofoc4pm/post/20</p> <p>\u200b\u6253\u5f00\u200bxv6\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b.gdbint\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5c06\u200b\u7b2c\u4e09\u884c\u200b<code>target remote 127.0.0.1:***</code>\u200b\u7528\u200b<code>#</code>\u200b\u6ce8\u91ca\u200b\u6389\u200b\u3002</p> <p></p>"},{"location":"faq/faq-env/#32-vscodefailed-to-attach-127001xxx-connection-timed-out-from-target-select-remote-1270011xxx","title":"3.2 \u200b\u8fdc\u7a0b\u200b\u5e73\u53f0\u200b\u8c03\u8bd5\u200b\u65f6\u200bVSCode\u200b\u62a5\u9519\u200b<code>Failed to attach: 127.0.0.1:XXX: Connection timed out. (from target-select remote 127.0.0.11:XXX)</code>?","text":"<p>\u200b\u5982\u56fe\u200b\uff1a</p> <p></p> <p>\u200b\u539f\u56e0\u200b\uff1a</p> <p>\u200b\u6ca1\u6709\u200b\u5728\u200b\u7ec8\u7aef\u200b\u8f93\u5165\u200bmake qemu-gdb\uff0c\u200b\u76f4\u63a5\u200b\u70b9\u200b\u4e86\u200bVSCode\u200b\u7684\u200bdebug\u200b\u7684\u200b\u4e09\u89d2\u5f62\u200b\u7b26\u53f7\u200b\u8fdb\u884c\u200b\u8c03\u8bd5\u200b\u3002</p> <p>\u200b\u6216\u8005\u200b\uff0c\u200b\u8bf7\u200b\u68c0\u67e5\u200blaunch.json\u200b\u7684\u200bGDB\u200b\u7aef\u53e3\u53f7\u200b\u662f\u5426\u200b\u5199\u200b\u5bf9\u200b\uff1f</p>"},{"location":"faq/faq-env/#33-vscodefailed-to-attach-truncated-register-37-in-remote-g-packet","title":"3.3 \u200b\u8fdc\u7a0b\u200b\u5e73\u53f0\u200b\u8c03\u8bd5\u200b\u65f6\u200bVSCode\u200b\u62a5\u9519\u200b<code>Failed to attach: Truncated register 37 in remote 'g' packet</code>?","text":"<p>\u200b\u5982\u56fe\u200b\uff1a</p> <p></p> <p>\u200b\u539f\u56e0\u200b\uff1a</p> <p>VSCode\u200b\u5de5\u4f5c\u200b\u533a\u200b\u8def\u5f84\u200b\u4e0d\u662f\u200bXV6\u200b\u8def\u5f84\u200b\uff0c\u200b\u5d4c\u5957\u200b\u4e86\u200b\u5916\u9762\u200b\u4e00\u5c42\u200b\u6587\u4ef6\u5939\u200b\u3002</p> <p></p> <p>\u200b\u89e3\u51b3\u200b\u65b9\u6cd5\u200b\uff1a</p> <p>\u200b\u9996\u5148\u200b \u200b\u786e\u8ba4\u200b\u4f60\u200b\u7684\u200bVSCode\u200b\u5de5\u4f5c\u200b\u533a\u200b\u8def\u5f84\u200b\u662f\u5426\u662f\u200b\u4f60\u200b\u7684\u200bxv6\u200b\u8def\u5f84\u200b\uff0c\u200b\u6ca1\u6709\u200b\u989d\u5916\u200b\u5d4c\u5957\u200b\u4e00\u5c42\u200b\u6587\u4ef6\u5939\u200b \u3002\u200b\u6309\u4e0b\u200b<code>Ctrl+`</code>\uff0c\u200b\u547c\u200b\u51fa\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u8f93\u5165\u200b<code>ls</code>\u3002\u200b\u4f60\u200b\u5e94\u8be5\u200b\u4f1a\u200b\u770b\u5230\u200b\u5982\u4e0b\u200b\u60c5\u666f\u200b\uff1a</p> <pre><code>ldap_example@OSLabExecNode0:~/xv6-oslab23-hitsz$ ls\nconf  fs.img  grade-lab-util  gradelib.py  gradelib.pyc  kernel  LICENSE  Makefile  mkfs  README  user\n</code></pre> <p>\u200b\u5982\u679c\u200b\u4e0d\u662f\u200b\uff0c\u200b\u6253\u5f00\u200b\u65b0\u200b\u7684\u200b\u5de5\u4f5c\u200b\u533a\u200b\uff0c\u200b\u9009\u62e9\u200bxv6\u200b\u6240\u5728\u200b\u7684\u200b\u6587\u4ef6\u5939\u200b\u6253\u5f00\u200b\u5373\u53ef\u200b\u3002\u200b\u6b63\u786e\u200b\u7684\u200b\u5de5\u4f5c\u200b\u533a\u200b\u5e94\u8be5\u200b\u5982\u4e0b\u200b\u663e\u793a\u200b\uff1a</p> <p></p>"},{"location":"faq/faq-env/#4-xv6","title":"4 xv6\u200b\u8fd0\u884c\u200b\u62a5\u9519","text":""},{"location":"faq/faq-env/#41-make-qemuis-another-process-using-the-image-fsimg","title":"4.1 \u200b\u8fdc\u7a0b\u200b\u5e73\u53f0\u200bmake qemu\u200b\u62a5\u9519\u200b<code>Is another process using the image [fs.img]</code>?","text":"<p>\u200b\u5982\u56fe\u200b\uff1a</p> <p></p> <p>\u200b\u7528\u200bps\u200b\u6216\u200btop\u200b\u547d\u4ee4\u200b\u67e5\u770b\u200b\u4e00\u4e0b\u200b\u662f\u4e0d\u662f\u200b\u5df2\u7ecf\u200b\u5f00\u542f\u200b\u4e86\u200bqemu\uff1f\u200b\u5982\u679c\u200bqemu\u200b\u5df2\u7ecf\u200b\u5728\u200b\u8fd0\u884c\u200b\uff0c\u200b\u8bf7\u200b\u5148\u200b\u7ed3\u675f\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u3002</p> <p>\u200b\u5177\u4f53\u200b\u89e3\u51b3\u65b9\u6848\u200b\u8be6\u89c1\u200bpiazza \uff08Fall 2022\uff09  \uff1ahttps://piazza.com/class/l7fs47nofoc4pm/post/23 </p> <p>\u200b\u53e6\u5916\u200b\u4e00\u79cd\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a\u200b\u8f93\u5165\u200b\u5728\u200bxv6-oslab23-hitsz\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8f93\u5165\u200b<code>make clean</code>\u200b\u6e05\u9664\u200bfs.img\uff0c\u200b\u7136\u540e\u200b\u518d\u200b\u8fd0\u884c\u200b<code>make qemu</code></p> <p></p>"},{"location":"faq/faq-env/#5-git","title":"5 git\u200b\u5e38\u89c1\u95ee\u9898","text":""},{"location":"faq/faq-env/#51","title":"5.1 \u200b\u65e0\u6cd5\u200b\u63a8\u9001\u200b\u600e\u4e48\u529e\u200b\uff1f","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u5c1d\u8bd5\u200b\u63a8\u9001\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u6216\u8005\u200b\u4ece\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u62c9\u53d6\u200b\uff0c\u200b\u4f46\u662f\u200bgit\u200b\u5374\u200b\u663e\u793a\u200b\u51fa\u200b\u8fd9\u6837\u200b\u7684\u200b\u9519\u8bef\u200b\uff1a</p> <pre><code>git@gitee.com: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights \nand the repository exists\n</code></pre> <p>\u200b\u8fd9\u200b\u8868\u660e\u200b\u4f60\u200b\u6ca1\u6709\u200b\u6743\u9650\u200b\u63a8\u9001\u200b\u5230\u200b\u8fd9\u4e2a\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002\u200b\u4e00\u822c\u800c\u8a00\u200b\uff0c\u200b\u8fd9\u662f\u200b\u7531\u4e8e\u200b\u4f60\u200b\u6ca1\u6709\u200b\u8bbe\u7f6e\u200b\u597d\u200b\u81ea\u5df1\u200b\u7684\u200bssh\u200b\u5bc6\u94a5\u200b\u9020\u6210\u200b\u7684\u200b\u3002\u200b\u8bf7\u200b\u53c2\u7167\u200b3.4\u200b\u8282\u200b ssh\u200b\u5bc6\u94a5\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u8bbe\u7f6e\u200b\u81ea\u5df1\u200b\u7684\u200bssh\u200b\u5bc6\u94a5\u200b\u3002</p>"},{"location":"faq/faq-env/#52","title":"5.2 \u200b\u6211\u200b\u600e\u4e48\u200b\u77e5\u9053\u200b\u6211\u200b\u4fee\u6539\u200b\u4e86\u200b\u54ea\u4e9b\u200b\u6587\u4ef6\u200b\uff1f","text":"<p>\u200b\u901a\u5e38\u200b\u800c\u8a00\u200b\uff0c\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u540c\u5b66\u200b\u4eec\u200b\u63d0\u4ea4\u200b \u200b\u6240\u6709\u200b \u200b\u88ab\u200b\u4fee\u6539\u200b\u8fc7\u200b\u7684\u200b\u6587\u4ef6\u200b\u3002\u200b\u901a\u8fc7\u200b\u5c06\u200b\u5f53\u524d\u5de5\u4f5c\u200b\u8def\u5f84\u200b\u4e0e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff08\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u7684\u200b\u4ed3\u5e93\u200b\uff09\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\u7684\u200b\u5185\u5bb9\u200b\u76f8\u200b\u6bd4\u8f83\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u65b9\u4fbf\u200b\u5730\u200b\u77e5\u9053\u200b\u81ea\u5df1\u200b\u66fe\u7ecf\u200b\u4fee\u6539\u200b\u8fc7\u200b\u54ea\u4e9b\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u6253\u5305\u200b\u63d0\u4ea4\u200b\u3002\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5f53\u524d\u200b\u5206\u652f\u200b\u4e0e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u7684\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u76f8\u200b\u6bd4\u8f83\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git fetch --all\nFetching origin\nFetching upstream\nlgz_admin@OSLabExecNode0:~/git_demo/xv6-oslab23-hitsz$ git diff --stat upstream/syscall *\n kernel/kalloc.c  | 2 ++\n kernel/syscall.c | 1 +\n kernel/syscall.h | 1 +\n kernel/sysinfo.h | 1 +\n 4 files changed, 5 insertions(+)\n</code></pre> <p>\u200b\u8981\u200b\u6bd4\u8f83\u200b\u5176\u4ed6\u200b\u5206\u652f\u200b\uff0c\u200b\u5c06\u200b\u7b2c\u4e8c\u6761\u200b\u6307\u4ee4\u200b\u4e2d\u200b\u7684\u200b<code>syscall</code>\u200b\u6539\u4e3a\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\u540d\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u8bf7\u200b\u5148\u200b\u5728\u200b\u672c\u5730\u200b\u5207\u6362\u200b\u5230\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\uff01</p> <p>\u200b\u5728\u200b\u6bd4\u8f83\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5c06\u200b\u672c\u5730\u200b\u5206\u652f\u200b\u4e0e\u200b\u4e0a\u6e38\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\u8fdb\u884c\u200b\u6bd4\u8f83\u200b\u3002\u200b\u4e3e\u4f8b\u200b\u800c\u8a00\u200b\uff0c\u200b\u4f60\u200b\u4e0d\u4f1a\u200b\u60f3\u200b\u6bd4\u8f83\u200b\u672c\u5730\u200b\u7684\u200b<code>util</code>\u200b\u5206\u652f\u200b\u548c\u200b\u8fdc\u7a0b\u200b\u7684\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u4e0d\u662f\u200b\u4e00\u4e2a\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u3002\u200b\u8bf7\u200b\u5148\u200b\u4f7f\u7528\u200b<code>git checkout \u200b\u5206\u652f\u200b\u540d\u200b</code>\u200b\u4ee5\u200b\u5207\u6362\u200b\u5230\u200b\u5bf9\u5e94\u200b\u5206\u652f\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u4f7f\u7528\u200b<code>git diff --stat upstream/\u200b\u5206\u652f\u200b\u540d\u200b *</code>\u200b\u65f6\u200b\u6307\u5b9a\u200b \u200b\u540c\u4e00\u4e2a\u200b \u200b\u4e0a\u6e38\u200b\u5206\u652f\u200b\u3002</p> <p>\u200b\u672a\u200b\u8bbe\u7f6e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff1f</p> <p>\u200b\u5982\u679c\u200bgit\u200b\u62a5\u544a\u200b\u201c<code>fatal: ambiguous argument 'upstream/\u200b\u5206\u652f\u200b\u540d\u200b': unknown revision or path not in the working tree.</code>\u201d\uff0c\u200b\u8bf4\u660e\u200b\u4f60\u200b\u5c1a\u672a\u200b\u8bbe\u7f6e\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u3002\u200b\u8bf7\u5148\u200b\u6309\u672c\u200b\u6307\u5357\u200b\u4e2d\u200b\u7684\u200b3.1-\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u4e00\u8282\u200b\u5b8c\u6210\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\u7684\u200b\u8bbe\u7f6e\u200b\u4e0e\u200b\u540c\u6b65\u200b\uff0c\u200b\u518d\u200b\u8fdb\u884c\u200b\u6bd4\u8f83\u200b\u3002</p>"},{"location":"faq/faq-env/#53-checkout","title":"5.3 \u200b\u4e3a\u4ec0\u4e48\u200b\u6211\u200b\u4e0d\u80fd\u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff08checkout\uff09\uff1f","text":"<p>\u200b\u901a\u5e38\u200b\u800c\u8a00\u200b\uff0c\u200b\u4e0d\u80fd\u200b\u5207\u6362\u200b\u5206\u652f\u200b\u7684\u200b\u4e3b\u8981\u200b\u539f\u56e0\u200b\u662f\u200b\u4f60\u200b\u5f53\u524d\u200b\u6709\u200b\u5c1a\u672a\u200b\u4fdd\u5b58\u200b\u7684\u200b\u4fee\u6539\u200b\uff0c\u200b\u6b64\u65f6\u200bcheckout\u200b\u7684\u8bdd\u200b\u4f1a\u200b\u89e6\u53d1\u200b\u4ee5\u4e0b\u200b\u9519\u8bef\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0: ~/git_demo/xv6-oslab23-hitsz$ git checkout util                                                                                                \u2500\u256f\nerror: Your local changes to the following files would be overwritten by checkout:\n        Makefile\nPlease commit your changes or stash them before you switch branches.\nAborting\n</code></pre> <p>\u200b\u901a\u8fc7\u200b<code>git status</code>\u200b\u6307\u4ee4\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u68c0\u67e5\u200b\u5f53\u524d\u200bgit\u200b\u7684\u200b\u72b6\u6001\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b\u8f93\u51fa\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a</p> <pre><code>lgz_admin@OSLabExecNode0: ~/git_demo/xv6-oslab23-hitsz$ git status\nOn branch syscall\nYour branch is up to date with 'origin/syscall'.\n\nChanges not staged for commit:\n  (use \"git add &lt;file&gt;...\" to update what will be committed)\n  (use \"git restore &lt;file&gt;...\" to discard changes in working directory)\n        modified:   Makefile\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\n</code></pre> <p>\u200b\u8fd9\u200b\u8bf4\u660e\u200b\u5f53\u524d\u200b\u4f60\u200b\u7684\u200b\u5de5\u4f5c\u200b\u533a\u6709\u200b\u5c1a\u672a\u200b\u4fdd\u5b58\u200b\u7684\u200b\u66f4\u6539\u200b\u3002\u200b\u8bf7\u200b\u53c2\u8003\u200b3.3.1 \u200b\u4f7f\u7528\u200b\u547d\u4ee4\u884c\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u6216\u8005\u200b3.3.2 \u200b\u4f7f\u7528\u200bVSCode\u200b\u5185\u5efa\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u8282\u200b\uff0c\u200b\u5b8c\u6210\u200bcommit\u200b\u64cd\u4f5c\u200b\u3002 \u200b\u6216\u8005\u200b\uff0c\u200b\u5982\u679c\u200b\u4f60\u200b\u5e0c\u671b\u200b\u76f4\u63a5\u200b\u653e\u5f03\u200b\u6389\u200b\u4e0a\u200b\u4e00\u6b21\u200bcommit\u200b\u540e\u200b\u7684\u200b \u200b\u6240\u6709\u200b\u66f4\u6539\u200b \uff0c\u200b\u90a3\u4e48\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b<code>-f</code>\u200b\u9009\u9879\u200b\u5f3a\u5236\u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff0c\u200b\u4f8b\u5982\u200b<code>git checkout -f syscall</code>\u3002</p>"},{"location":"faq/lab1/","title":"Lab1\u200b\u5e38\u89c1\u95ee\u9898","text":""},{"location":"faq/lab1/#1-sleep","title":"1. sleep","text":""},{"location":"faq/lab1/#11-sleep","title":"1.1 \u200b\u6267\u884c\u200bsleep\u200b\u62a5\u9519","text":"<p>\u200b\u68c0\u67e5\u4e00\u4e0b\u200b\u662f\u5426\u200b\u4fee\u6539\u200bMakefile</p>"},{"location":"faq/lab1/#2-pingpong","title":"2. pingpong","text":""},{"location":"faq/lab1/#21-pingpong","title":"2.1 \u200b\u68c0\u9a8c\u200bpingpong\u200b\u65f6\u200b\u51fa\u73b0\u200b\u5982\u4e0b\u200b\u62a5\u9519","text":"<p>\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a</p> <p></p>"},{"location":"faq/lab1/#22-pingpongusertrap","title":"2.2 pingpong\u200b\u51fa\u73b0\u200busertrap()\u200b\u62a5\u9519","text":"<ol> <li>\u200b\u6570\u7ec4\u200b\u8d8a\u754c\u200b\u3001\u200b\u5185\u5b58\u200b\u6ea2\u51fa\u200b\uff08scause=13\uff09  \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a </li> <li>\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u9000\u51fa\u200b\u65f6\u200b\u4f7f\u7528\u200breturn\uff08scause=2\uff09  \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u9000\u51fa\u200b\u65f6\u200b\u4f7f\u7528\u200b <code>exit()</code> \u200b\u51fd\u6570\u200b\u9000\u51fa\u200b\uff0c\u200b\u4e0d\u8981\u200b\u4f7f\u7528\u200b <code>return</code> \u200b\u8fd4\u56de\u200b\u3002</li> </ol>"},{"location":"faq/lab1/#3-primes","title":"3. primes","text":""},{"location":"faq/lab1/#31-primes","title":"3.1 primes\u200b\u8f93\u51fa\u200b\u53d1\u751f\u200b\u5947\u602a\u200b\u7684\u200b\u9519\u8bef","text":"<p>\u200b\u4e0d\u200b\u77e5\u9053\u200b\u4e3a\u4ec0\u4e48\u200b\u7b2c\u4e8c\u4e2a\u200b\u8f93\u51fa\u200b\u5e26\u200b\u7740\u200b\u5947\u602a\u200b\u7684\u200b$\u200b\u7b26\u53f7\u200b</p> <p></p> <p>\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a</p> <p></p>"},{"location":"faq/lab1/#32-prime","title":"3.2 prime \u200b\u5185\u6838\u200b\u4e2d\u200b\u8f93\u51fa\u200b\u6b63\u786e\u200b\uff0c\u200b\u4f46\u662f\u200b\u6d4b\u8bd5\u200b\u65f6\u200b\u4e0d\u200b\u901a\u8fc7\u200b\uff1f","text":"<p>\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a</p> <p></p>"},{"location":"faq/lab2/","title":"Lab2\u200b\u5e38\u89c1\u95ee\u9898","text":"<p>\u200b\u672c\u200b\u8282\u200b\u603b\u7ed3\u200b\u4e86\u200b\u4e00\u4e9b\u200b\u76ee\u524d\u200b\u9047\u5230\u200b\u7684\u200b\u95ee\u9898\u200b\u4f9b\u200b\u5927\u5bb6\u200b\u53c2\u8003\u200b\uff1a</p>"},{"location":"faq/lab2/#1-exit_infoinfo","title":"1. \u200b\u95ee\u9898\u200b\uff1aexit_info\u200b\u6253\u5370\u200b\u6ca1\u6709\u200b\u53d8\u84dd\u200b\uff0c\u200b\u4e5f\u200b\u6ca1\u6709\u200b\u663e\u793a\u200b[INFO]?","text":"<p>\u200b\u53ef\u80fd\u200b\u662f\u200b\u4f60\u200b\u4e4b\u524d\u200b\u8fd0\u884c\u200b\u8fc7\u200b\u4e00\u6b21\u200b<code>make grade</code>, \u200b\u76f4\u63a5\u200b<code>make clean</code>\u200b\u5373\u53ef\u200b</p>"},{"location":"faq/lab2/#2-yield","title":"2. \u200b\u6d4b\u8bd5\u200byield\u200b\u65f6\u200b\u51fa\u73b0\u200b\u5982\u4e0b\u200b\u62a5\u9519\u200b\uff1a","text":"<p>\u200b\u8fd9\u200b\u8bf4\u660e\u200b\u4f60\u200b\u6253\u5370\u200b\u7684\u200bpc\u200b\u503c\u200b\u4e0d\u200b\u5bf9\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u518d\u200b\u4ed4\u7ec6\u200b\u8bfb\u8bfb\u200b\u6307\u5bfc\u4e66\u200b\u7684\u200b\u8981\u6c42\u200b\u548c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\uff1a\uff09</p>"},{"location":"faq/lab3/","title":"Lab3\u200b\u5e38\u89c1\u95ee\u9898","text":"<p>\u200b\u672c\u200b\u8282\u200b\u603b\u7ed3\u200b\u4e86\u200b\u4e00\u4e9b\u200b\u76ee\u524d\u200b\u9047\u5230\u200b\u7684\u200b\u95ee\u9898\u200b\u4f9b\u200b\u5927\u5bb6\u200b\u53c2\u8003\u200b\uff1a</p>"},{"location":"faq/lab3/#1-panic-init-exiting","title":"1. \u200b\u95ee\u9898\u200b\uff1apanic init exiting","text":"<p>\u200b\u5185\u5b58\u200b\u5206\u914d\u200b\u51fa\u200b\u95ee\u9898\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u7b2c\u4e00\u4e2a\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u5d29\u6e83\u200b</p> <p>(1)\u200b\u53ef\u80fd\u200b\u662f\u200bkinit\u200b\u4fee\u6539\u200b\u9519\u8bef\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u540c\u4e00\u4e2a\u200b\u7a7a\u95f2\u200b\u7269\u7406\u200b\u9875\u200b\u91cd\u590d\u200b\u51fa\u73b0\u200b\u5728\u200bfreelist\uff1b</p> <p>(2)\u200b\u4e5f\u200b\u53ef\u80fd\u200b\u662f\u200b\u6ca1\u80fd\u200b\u7406\u89e3\u200bkalloc\u200b\u7684\u200b\u542b\u4e49\u200b\uff0c\u200b\u8fd4\u56de\u503c\u200b\u9519\u8bef\u200b\u6216\u8005\u200b\u94fe\u8868\u200b\u64cd\u4f5c\u200b\u9519\u8bef\u200b\u3002</p>"},{"location":"faq/lab3/#2-panic-freeing-free-block","title":"2. \u200b\u95ee\u9898\u200b\uff1apanic freeing free block\"","text":"<p>\u200b\u5f88\u200b\u53ef\u80fd\u200b\u662f\u200bbget\u200b\u51fd\u6570\u200b\u9501\u200b\u7684\u200b\u4f7f\u7528\u200b\u4e0d\u200b\u6b63\u786e\u200b\uff0c\u200b\u4e00\u5b9a\u200b\u9700\u8981\u200b\u4fdd\u8bc1\u200bbget\u200b\u51fd\u6570\u200b\u7684\u200b\u539f\u5b50\u200b\u6027\u200b(\u200b\u6307\u5bfc\u4e66\u200b\u6709\u200b\u63d0\u53ca\u200b)\uff0c\u200b\u5426\u5219\u200b\u540c\u4e00\u200b\u78c1\u76d8\u200b\u5757\u200b\u53ef\u80fd\u200b\u5728\u200b\u7f13\u5b58\u200b\u91cd\u590d\u200b\u51fa\u73b0\u200b\uff0c\u200b\u9020\u6210\u200b\u4e8c\u6b21\u200b\u91ca\u653e\u200b\u3002</p>"},{"location":"lab1/part1/","title":"\u5b9e\u9a8c\u200b\u6982\u8ff0","text":"<p>\u200b\u5173\u4e8e\u200bAcademic Intergrity</p> <p>\u200b\u6240\u6709\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u90fd\u200b\u9700\u8981\u200b \u200b\u72ec\u7acb\u200b\u5b8c\u6210\u200b \u3002\u200b\u4f60\u200b\u5e94\u5f53\u200b \u200b\u4e3b\u52a8\u200b\u907f\u514d\u200b\u9605\u8bfb\u200b\u3001\u200b\u4f7f\u7528\u200b\u4efb\u4f55\u4eba\u200b/\u200b\u4e92\u8054\u7f51\u200b\u4e0a\u200b\u7684\u200bXV6\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b \u3002\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u78b0\u5230\u95ee\u9898\u200b\u5f88\u200b\u6b63\u5e38\u200b\uff0c\u200b\u53d1\u73b0\u200b\u95ee\u9898\u200b\u65f6\u9700\u200b\u6c89\u7740\u200b\u51b7\u9759\u200b\uff0c\u200b\u8ba4\u771f\u200b\u9605\u8bfb\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u4e66\u200b\uff0c\u200b\u67e5\u9605\u200bMIT 6.S081\u200b\u7684\u200b\u5b98\u65b9\u7f51\u7ad9\u200b\u4ee5\u53ca\u200bXV6 book\uff0c\u200b\u5c1d\u8bd5\u200b\u81ea\u5df1\u200b\u8c03\u8bd5\u200b\u89e3\u51b3\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5411\u200b\u540c\u5b66\u200b/\u200b\u52a9\u6559\u200b/\u200b\u8001\u5e08\u200b\u8bf7\u6559\u200b\u8c03\u8bd5\u200b\u7684\u200b\u6280\u5de7\u200b\u3002\u200b\u53ea\u6709\u200b\u8fd9\u6837\u200b\uff0c\u200b\u4f60\u200b\u624d\u200b\u80fd\u591f\u200b\u5f97\u5230\u200b\u771f\u6b63\u200b\u7684\u200b\u8bad\u7ec3\u200b\u4e0e\u200b\u6536\u83b7\u200b\uff01</p> <p>\u200b\u5173\u4e8e\u200b\u7b2c\u4e00\u6b21\u200b\u5b9e\u9a8c\u8bfe\u200b\u8003\u6838\u200b</p> <p>\u200b\u6211\u4eec\u200b\u9009\u62e9\u200b\u57fa\u4e8e\u200bLinux\u200b\u7cfb\u7edf\u200b\u7684\u200bXV6\u200b\u4f5c\u4e3a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u6559\u5b66\u200b\u5e73\u53f0\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u5f00\u6e90\u200b\u3001\u200b\u81ea\u7531\u200b\uff0c\u200b\u4e5f\u200b\u6709\u200b\u4e30\u5bcc\u200b\u7684\u200b\u6587\u6863\u200b/\u200b\u8bfe\u7a0b\u200b\u8d44\u6e90\u200b\uff08\u200b\u80fd\u200b\u8ba9\u200b\u6211\u4eec\u200b\u4e86\u89e3\u200b\u5b83\u200b\u5185\u90e8\u200b\u7684\u200b\u5b9e\u73b0\u200b\uff09\u3002\u200b\u5728\u200b\u505a\u200b\u5b9e\u9a8c\u200b\u4e4b\u524d\u200b\uff0c\u200b\u9996\u5148\u200b\u5fc5\u4e0d\u53ef\u5c11\u200b\u5730\u662f\u200b\u5b9e\u9645\u200b\u52a8\u624b\u200b\u64cd\u4f5c\u200bLinux\u200b\u7cfb\u7edf\u200b\u3002\u200b\u4e3a\u4e86\u200b\u6fc0\u53d1\u200b\u540c\u5b66\u200b\u4eec\u200b\u7684\u200b\u5b66\u4e60\u70ed\u200b\uff08\u200b\u538b\u200b\uff09\u200b\u60c5\u200b\uff08\u200b\u529b\u200b\uff09\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b \u200b\u5728\u200b\u7b2c\u4e00\u6b21\u200b\u5b9e\u9a8c\u8bfe\u200b\u4e0a\u200b\u8fdb\u884c\u200bLinux\u200b\u7cfb\u7edf\u200b\u57fa\u7840\u77e5\u8bc6\u200b\u7684\u200b\u8003\u6838\u200b \uff08\u200b\u52a9\u6559\u200b\u4f1a\u200b\u4e00\u5bf9\u4e00\u200b\u5730\u95ee\u200b\u4e00\u4e9b\u200b\u7b80\u5355\u200b\u7684\u200b\u95ee\u9898\u200b\u6765\u200b\u786e\u4fdd\u200b\u540c\u5b66\u200b\u4eec\u200b\u771f\u6b63\u200b\u4e86\u89e3\u200b\u4e86\u200b\uff0c\u200b\u867d\u7136\u200b\u8003\u6838\u200b\u5206\u6570\u200b\u4e0d\u200b\u591a\u200b\uff0c\u200b\u4e5f\u200b\u8bf7\u200b\u5927\u5bb6\u200b\u8ba4\u771f\u5bf9\u5f85\u200b\uff09\uff0c\u200b\u8981\u6c42\u200b\u540c\u5b66\u200b\u4eec\u200b\u80fd\u200b\u63d0\u524d\u200b\u5b66\u4e60\u200b\u5982\u4e0b\u200b\u5185\u5bb9\u200b\uff1a</p> <p>\uff081\uff09 \u200b\u8bf7\u200b\u8ba4\u771f\u200b\u9605\u8bfb\u200b\u5b9e\u9a8c\u200b\u6982\u8ff0\u200b\u4e2d\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u638c\u63e1\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b/\u200b\u5de5\u5177\u200b\u7684\u200b\u4f7f\u7528\u200b\u3001Linux\u200b\u5f00\u53d1\u200b\u73af\u5883\u200b\u57fa\u7840\u77e5\u8bc6\u200b\uff1b</p> <p>\uff082\uff09 \u200b\u8bf7\u200b\u8ba4\u771f\u200b\u9605\u8bfb\u200b\u5b9e\u9a8c\u200b\u4e00\u4e2d\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u4e86\u89e3\u200bxv6\u200b\u6e90\u7801\u200b\u7684\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\uff0c\u200b\u505a\u597d\u200b\u5b9e\u9a8c\u200b\u524d\u200b\u7684\u200b\u51c6\u5907\u200b\u5de5\u4f5c\u200b\u3002</p> <p>\u200b\u9047\u5230\u200b\u51e1\u200b\uff08\u200b\u8003\u200b\uff09\u200b\u4e8b\u200b\uff08\u200b\u6838\u200b\uff09\u200b\u4e0d\u8981\u200b\u614c\u200b\uff0c\u200b\u5f53\u200b\u4f60\u200b\u80fd\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u8981\u6c42\u200b\u65f6\u200b\uff0c\u200b\u76f8\u4fe1\u200b\u4e00\u5b9a\u200b\u80fd\u200b\u901a\u8fc7\u200b\u672c\u6b21\u200b\u8003\u6838\u200b! </p> <p>\u200b\u5b9e\u9a8c\u200b\u8bf4\u660e\u200b</p> <p>\u200b\u8be5\u200b\u90e8\u5206\u200b\u8bf4\u660e\u200b\u4e86\u200b\u8be5\u200b\u5b9e\u9a8c\u200b\u9700\u8981\u200b\u5b8c\u6210\u200b\u7684\u200b\u4efb\u52a1\u200b\uff0c\u200b\u4ee5\u53ca\u200b\u8981\u6c42\u200b\u8fbe\u5230\u200b\u600e\u6837\u200b\u7684\u200b\u76ee\u6807\u200b\u3002\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\uff0c\u200b\u672c\u7ae0\u200b\u5b9e\u9a8c\u200b\u4e0a\u624b\u200b\u5f88\u200b\u96be\u200b\uff0c\u200b\u4f46\u662f\u200b\u5185\u5bb9\u200b\u7b80\u5355\u200b\uff0c\u200b\u5927\u5bb6\u200b\u9700\u8981\u200b \u200b\u8010\u200b\u5fc3\u7406\u200b\u6e05\u695a\u200b \u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u4e66\u200b\u7684\u200b\u8109\u7edc\u200b\u3002</p> <p>\u200b\u7279\u522b\u200b\u63a8\u8350\u200b\u540c\u5b66\u200b\u4eec\u200b\u89c2\u770b\u200b\u7531\u200b\u6211\u6821\u200bOS\u200b\u8bfe\u9898\u7ec4\u200b\u3001\u200b\u5404\u7ea7\u200b\u5b66\u957f\u200b\u52a9\u6559\u200b\u4eec\u200b\u5408\u529b\u200b\u4e3a\u200b\u5927\u5bb6\u200b\u5f55\u5236\u200b\u7684\u200bXV6\u200b\u8bb2\u89e3\u200b\u89c6\u9891\u200b\uff0c\u200b\u5e0c\u671b\u200b\u80fd\u591f\u200b\u8ba9\u200b\u5927\u5bb6\u200b\u5bf9\u200b\u6574\u4e2a\u200bXV6\u200b\u7cfb\u7edf\u200b\u6709\u200b\u4e00\u4e2a\u200b\u66f4\u4e3a\u200b\u76f4\u89c2\u200b\u7684\u200b\u8ba4\u8bc6\u200b\uff0c\u200b\u63a8\u8350\u200b\u5927\u5bb6\u200b\u6309\u200b\u9700\u200b\u89c2\u770b\u200b\uff1a</p> <ol> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e00\u200b\uff09\u200b\u542f\u52a8\u200b\u8fc7\u7a0b\u200b\u3011            </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1mK411S7N9?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e8c\u200b\uff09\u200b\u8fdb\u7a0b\u200b\u7ba1\u7406\u200b\u3011 </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1ge4y1J7Je?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e09\u200b\uff09\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u3011 </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1Te4y1i77z?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> </ol> <p>\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u89c2\u770b\u200bB\u200b\u7ad9\u4e0a\u200b\u7684\u200bMIT 6.S081/Fall 2020\u200b\u8bfe\u7a0b\u200b\u89c6\u9891\u200b\uff0c\u200b\u901a\u8fc7\u200b\u5b66\u4e60\u200b\u8fd9\u95e8\u200b\u8bfe\u7a0b\u200b\u53ef\u4ee5\u200b\u8ba9\u200b\u4f60\u200b\u5bf9\u200bxv6\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u6709\u200b\u4e00\u4e2a\u200b\u5168\u9762\u200b\u7684\u200b\u8ba4\u8bc6\u200b\u3002</p>"},{"location":"lab1/part1/#1","title":"1.  \u200b\u5b9e\u9a8c\u200b\u76ee\u7684","text":"<ul> <li>\u200b\u8ba4\u8bc6\u200bxv6\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u5e76\u200b\u719f\u6089\u200b\u5176\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\u3002</li> <li>\u200b\u590d\u4e60\u200b\u5e76\u200b\u5de9\u56fa\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u3001\u200b\u8fdb\u7a0b\u200b\u7b49\u200b\u7406\u8bba\u77e5\u8bc6\u200b\uff0c\u200b\u638c\u63e1\u200b\u5728\u200bxv6\u200b\u4e0a\u200b\u7f16\u5199\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u8981\u6c42\u200b\u5b9e\u73b0\u200bsleep\u3001pingpong\u200b\u548c\u200bfind\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u3002</li> <li>\u200b\u7406\u89e3\u200b\u548c\u200b\u638c\u63e1\u200bxv6\u200b\u7684\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\uff0c\u200b\u5305\u62ec\u200b\u8d44\u6e90\u200b\u521d\u59cb\u5316\u200b\u3001\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8bde\u751f\u200b\u7b49\u200b\uff0c\u200b\u8981\u6c42\u200b\u5728\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u6d89\u53ca\u200b\u5230\u200b\u7684\u200bstart\u3001main\u200b\u7b49\u200b\u51fd\u6570\u200b\u4e2d\u200b\u589e\u52a0\u200b\u6253\u5370\u8f93\u51fa\u200b\u4f60\u200b\u7684\u200b\u5b66\u53f7\u200b\u4ee5\u53ca\u200b\u8be5\u200b\u51fd\u6570\u200b\u7684\u200b\u4f5c\u200b\u2f64\u200b\u3002</li> </ul>"},{"location":"lab1/part1/#2","title":"2.  \u200b\u5b9e\u9a8c\u200b\u5b66\u65f6","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e3a\u200b4\u200b\u5b66\u65f6\u200b\u3002</p>"},{"location":"lab1/part1/#3","title":"3.  \u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u53ca\u200b\u8981\u6c42","text":"<p>\u200b\u4e0e\u200bxv6\u200b\u539f\u6709\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u4e0d\u200b\u4e00\u6837\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b3\u200b\u4e2a\u200bUnix\u200b\u5b9e\u7528\u7a0b\u5e8f\u200b\u548c\u200bxv6\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u5b9e\u9a8c\u200b \u3002\u200b\u8fd9\u91cc\u200b\u5c55\u793a\u200b\u7684\u200b\u662f\u200b\u7a0b\u5e8f\u200b\u529f\u80fd\u200b\u548c\u200b\u5b9e\u9a8c\u200b\u6d4b\u8bd5\u200b\u7684\u200b\u6700\u7ec8\u200b\u6548\u679c\u200b\uff0c\u200b\u66f4\u200b\u591a\u200b\u8be6\u7ec6\u200b\u7684\u200b\u4ecb\u7ecd\u200b\u53ef\u200b\u5728\u200b\u540e\u7eed\u200b\u7ae0\u8282\u200b\u4e2d\u200b\u9605\u8bfb\u200b\u3002</p>"},{"location":"lab1/part1/#31-sleep","title":"3.1 sleep","text":"<p>\u200b\u4e86\u89e3\u200bxv6\u200b\u4e0a\u200b\u7528\u6237\u7a0b\u5e8f\u200bsleep\u200b\u7684\u200b\u5b9e\u73b0\u200b\u3002sleep\u200b\u7a0b\u5e8f\u200b\u4f1a\u200b\u7b49\u5f85\u200b\u7528\u6237\u200b\u6307\u5b9a\u200b\u7684\u200b\u65f6\u95f4\u200b\u3002\u200b\u8bf7\u200b\u5c06\u200b\u4ee3\u7801\u200b\u5199\u200b\u5728\u200buser/sleep.c\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u3002\u200b\u8fd0\u884c\u200b\u6548\u679c\u200b\u5e94\u8be5\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p> <p>\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\u540e\u200b\uff0c\u200b\u547d\u4ee4\u200b\u884c\u4f1a\u200b \u201d\u200b\u6682\u505c\u200b\u201c \u200b\u4e00\u6bb5\u65f6\u95f4\u200b (10\u200b\u4e2a\u200bticks\uff0cticks\u200b\u7531\u200b\u5185\u6838\u200b\u5b9a\u4e49\u200b)\uff0c\u200b\u7136\u540e\u200b\u8f93\u51fa\u200b\"(nothing happens for a little while)\"\u3002</p> <p>\u200b\u5728\u200bxv6-oslab23-hitsz\u200b\u4e2d\u200b\uff0c\u200b\u6267\u884c\u200b\u4e0b\u9762\u200b\u6307\u4ee4\u200b<code>./grade-lab-util sleep</code>\uff0c\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b</p> <p></p>"},{"location":"lab1/part1/#32-pingpong","title":"3.2 pingpong","text":"<p>\u200b\u5728\u200bxv6\u200b\u4e0a\u200b\u5b9e\u73b0\u200bpingpong\u200b\u7a0b\u5e8f\u200b\uff0c\u200b\u5373\u200b\u4e24\u4e2a\u200b\u8fdb\u7a0b\u200b\u5728\u200b\u7ba1\u9053\u200b\u4e24\u4fa7\u200b\u6765\u56de\u200b\u901a\u4fe1\u200b\u3002\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u5c06\u200b\u201dping\u201d\u200b\u5199\u5165\u200b\u7ba1\u9053\u200b\uff0c\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u4ece\u200b\u7ba1\u9053\u200b\u5c06\u200b\u5176\u200b\u8bfb\u51fa\u200b\u5e76\u6253\u5370\u200b<code>&lt;pid&gt;: received ping</code> \uff0c\u200b\u5176\u4e2d\u200b<code>&lt;pid&gt;</code>\u200b\u662f\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8fdb\u7a0b\u200bID\u3002\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u4ece\u7236\u200b\u8fdb\u7a0b\u200b\u6536\u5230\u200b\u5b57\u7b26\u4e32\u200b\u540e\u200b\uff0c\u200b\u5c06\u200b\u201dpong\u201c\u200b\u5199\u5165\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u7ba1\u9053\u200b\uff0c\u200b\u7136\u540e\u200b\u7531\u7236\u200b\u8fdb\u7a0b\u200b\u4ece\u200b\u8be5\u200b\u7ba1\u9053\u200b\u8bfb\u53d6\u200b\u5e76\u6253\u5370\u200b<code>&lt;pid&gt;: received pong</code>\uff0c\u200b\u5176\u4e2d\u200b<code>&lt;pid&gt;</code>\u200b\u662f\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8fdb\u7a0b\u200bID\u3002\u200b\u8bf7\u200b\u5c06\u200b\u4ee3\u7801\u200b\u5199\u200b\u5728\u200buser/pingpong.c\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u3002\u200b\u8fd0\u884c\u200b\u6548\u679c\u200b\u5e94\u8be5\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p> <p>\u200b\u5728\u200bxv6-oslab23-hitsz\u200b\u4e2d\u200b\uff0c\u200b\u6267\u884c\u200b\u4e0b\u9762\u200b\u6307\u4ee4\u200b<code>./grade-lab-util pingpong</code>\uff0c\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b</p> <p></p>"},{"location":"lab1/part1/#33-find","title":"3.3 find","text":"<p>\u200b\u5728\u200bxv6\u200b\u4e0a\u200b\u5b9e\u73b0\u200b\u7528\u6237\u7a0b\u5e8f\u200bfind\uff0c\u200b\u5373\u200b\u5728\u200b\u76ee\u5f55\u200b\u6811\u4e2d\u200b\u67e5\u627e\u200b\u540d\u79f0\u200b\u4e0e\u200b\u5b57\u7b26\u4e32\u200b\u5339\u914d\u200b\u7684\u200b\u6240\u6709\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200b\u7684\u200b\u76f8\u5bf9\u8def\u5f84\u200b\u3002\u200b\u8be5\u200b\u7a0b\u5e8f\u200b\u7684\u200b \u200b\u547d\u4ee4\u200b\u683c\u5f0f\u200b\u4e3a\u200b\u201cfind path file_name\u201d \u3002\u200b\u8bf7\u200b\u5c06\u200b\u4ee3\u7801\u200b\u5199\u200b\u5728\u200buser/find.c\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u3002\u200b\u5f53\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5305\u542b\u200b\u6587\u4ef6\u200bb\u200b\u548c\u200ba/b\u200b\u65f6\u200b\uff0c\u200b\u8f93\u51fa\u200b\u6548\u679c\u200b\u5e94\u8be5\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p> <p>\u200b\u5728\u200bxv6-oslab23-hitsz\u200b\u4e2d\u200b\uff0c\u200b\u6267\u884c\u200b\u4e0b\u9762\u200b\u6307\u4ee4\u200b<code>./grade-lab-util find</code>\uff0c\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b</p> <p></p> <p>\u200b\u5982\u679c\u200b\u4e0a\u8ff0\u200b3\u200b\u4e2a\u200b\u7a0b\u5e8f\u200b\u90fd\u200b\u80fd\u200b\u6b63\u5e38\u200b\u8fd0\u884c\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u7528\u200b\u5982\u4e0b\u200b\u6307\u4ee4\u200b\u6d4b\u8bd5\u200b\uff1a</p> <p></p>"},{"location":"lab1/part1/#34-xv6","title":"3.4 xv6\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u5b9e\u9a8c","text":"<p>\u200b\u5728\u200bxv6\u200b\u4ece\u200b\u6267\u200b\u2f8f\u200bentry.S\u200b\u4e4b\u540e\u200b\u5230\u200b\u7b2c\u200b\u2f00\u200b\u4e2a\u200bshell\u200b\u7a0b\u5e8f\u200b\u542f\u52a8\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u7684\u200b\u6bcf\u200b\u2f00\u200b\u4e2a\u200b\u51fd\u6570\u200b\u4e2d\u200b\u8f93\u51fa\u200b\u8be5\u200b\u51fd\u6570\u200b\u7684\u200b\u4f5c\u200b\u2f64\u200b\u4ee5\u53ca\u200b\u4f60\u200b\u7684\u200b\u5b66\u53f7\u200b\u3002\u200b\u5728\u200bxv6-oslab23-hitsz\u200b\u4e2d\u200b\uff0c\u200b\u6267\u884c\u200b\u4e0b\u9762\u200b\u6307\u4ee4\u200b<code>make qemu</code>\uff0c\u200b\u8fd0\u200b\u2f8f\u200b\u7684\u200b\u6548\u679c\u200b\u5e94\u8be5\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p> <p>\u200b\u4e0a\u200b\u56fe\u200b\u7ea2\u8272\u200b\u6846\u6846\u200b\u5185\u200b\u7684\u200b\u4fe1\u606f\u200b\u662f\u200b\u4f60\u200b\u8981\u200b\u6253\u5370\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u683c\u5f0f\u200b\u4e3a\u200b\uff1a<code>[\u200b\u4f60\u200b\u7684\u200b\u5b66\u53f7\u200b] \u200b\u8be5\u200b\u51fd\u6570\u200b\u7684\u200b\u4f5c\u7528\u200b</code>\uff0c\u200b\u603b\u5171\u200b\u662f\u200b5\u200b\u6761\u200b\u6253\u5370\u4fe1\u606f\u200b\u3002\u200b\u524d\u200b4\u200b\u6761\u662f\u200b\u5728\u200b\u5185\u6838\u200b\u6001\u4e0b\u200b\u6253\u5370\u200b\uff0c\u200b\u4e0a\u56fe\u200b\u4e2d\u200b\u5df2\u7ecf\u200b\u7ed9\u51fa\u200b\u4e86\u200b\u5177\u4f53\u200b\u7684\u200b\u6587\u4ef6\u540d\u200b\u4ee5\u53ca\u200b\u6253\u5370\u200b\u8bed\u53e5\u200b\u6240\u5728\u200b\u7684\u200b\u4ee3\u7801\u200b\u884c\u200b\u6570\u200b\u3002\u200b\u6700\u540e\u200b1\u200b\u6761\u8981\u200b\u5728\u200b\u7528\u6237\u200b\u6001\u4e0b\u200b\u6267\u884c\u200b<code>sh</code>\u200b\u8fdb\u7a0b\u200b\u4e4b\u524d\u200b\u6253\u5370\u200b\u3002</p> <p>\u200b\u5efa\u8bae\u200b\u4f60\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u524d\u200b\u89c2\u770b\u200b\u7531\u200b\u6211\u6821\u200b\u5f55\u5236\u200b\u7684\u200bXV6\u200b\u8bb2\u89e3\u200b\u89c6\u9891\u200bHITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u2f00\u200b\uff09\u200b\u542f\u52a8\u200b\u8fc7\u7a0b\u200b\u89c6\u9891\u200b\uff0c\u200b\u8fd9\u4f1a\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u66f4\u597d\u200b\u7684\u200b\u7406\u89e3\u200bxv6\u200b\u7684\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u3002</p>"},{"location":"lab1/part2/","title":"\u5b9e\u9a8c\u200b\u539f\u7406","text":"<p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u672c\u200b\u90e8\u5206\u200b\u6211\u4eec\u200b\u5c06\u200b\u7406\u89e3\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200bxv6\u200b\u7684\u200b\u76f8\u5173\u200b\u6a21\u578b\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u6a21\u578b\u200b\u770b\u8d77\u6765\u200b\u975e\u5e38\u200b\u62bd\u8c61\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5728\u200b\u4ecb\u7ecd\u200b\u5b8c\u200b\u4e4b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u52a0\u5165\u200b\u4e00\u7ae0\u200b\u201d \u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b \u201c\uff0c\u200b\u6765\u200b\u5c06\u200b\u5176\u200b\u4e32\u901a\u200b\u3002</p>"},{"location":"lab1/part2/#1-mit-6s0812020","title":"1. MIT 6.S081/2020","text":""},{"location":"lab1/part2/#11","title":"1.1 \u200b\u53c2\u8003\u8d44\u6599","text":"<p>XV6\u200b\u662f\u200b\u7531\u200b\u9ebb\u7701\u7406\u5de5\u5b66\u9662\u200b(MIT)\u200b\u5f00\u53d1\u200b\u7684\u200b\u4e00\u4e2a\u200b\u6559\u5b66\u200b\u76ee\u7684\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u5b83\u200b\u662f\u200b\u5728\u200bx86\u200b\u5904\u7406\u5668\u200b\u4e0a\u7528\u200bANSI\u200b\u6807\u51c6\u200bC\u200b\u91cd\u65b0\u200b\u5b9e\u73b0\u200b\u7684\u200bUnix\u200b\u7b2c\u516d\u7248\u200b(\u200b\u5373\u200bv6)\uff0c\u200b\u8bfe\u7a0b\u200b\u7f16\u53f7\u200b\u4e3a\u200b6.828\u30022019\u200b\u5e74\u200b\u88ab\u200b\u79fb\u690d\u200b\u5230\u200bRISC-V\u200b\u4e4b\u4e0a\u200b\uff0c\u200b\u5e76\u200b\u8bbe\u7f6e\u200b\u4e86\u200b6.S081\u3002</p> <p>XV6\u200b\u7684\u200b\u4e3b\u8981\u200b\u7279\u5f81\u200b\uff1a</p> <ul> <li>\u200b\u5f00\u6e90\u200b\uff0c\u200b\u7cbe\u7b80\u200b\uff0c\u200b\u4ee3\u7801\u200b\u4ec5\u200b\u4e24\u4e07\u200b\u884c\u200b\u5de6\u53f3\u200b\uff1b</li> <li>\u200b\u529f\u80fd\u5b8c\u5584\u200b\uff0c\u200b\u53ef\u200b\u5168\u9762\u200b\u7406\u89e3\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u539f\u7406\u200b\u53ca\u200b\u5b9e\u73b0\u200b\uff1b</li> <li>\u200b\u57fa\u4e8e\u200bRISC-V\u3001X86\u200b\u7b49\u200b\u67b6\u6784\u200b\uff0c\u200b\u6709\u5229\u4e8e\u200b\u6df1\u5165\u200b\u7406\u89e3\u200b\u4f53\u7cfb\u7ed3\u6784\u200b\uff1b</li> <li>\u200b\u7c7b\u200bUnix\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u53ef\u200b\u5ef6\u4f38\u200b\u5b66\u4e60\u200b\u5176\u4ed6\u200b\u5e38\u89c1\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u4f8b\u5982\u200bLinux\u3001MacOS\u200b\u7b49\u200b\u3002</li> </ul> <p>1) \u200b\u5b98\u65b9\u7f51\u7ad9\u200b\uff1ahttps://pdos.csail.mit.edu/6.828/2020/index.html</p> <p>2) xv6 book\uff1ahttps://pdos.csail.mit.edu/6.828/2020/xv6/book-riscv-rev1.pdf</p> <p>\u200b\u8fd9\u4efd\u200b\u5b98\u65b9\u200b\u6587\u6863\u200b\uff0c\u200b\u662f\u200b\u9605\u8bfb\u200bxv6\u200b\u6e90\u7801\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u6700\u597d\u200b\u7684\u200b\u53c2\u8003\u8d44\u6599\u200b\uff0c\u200b\u5728\u200b\u5b8c\u6210\u200b\u6240\u6709\u200bxv6\u200b\u76f8\u5173\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u82e5\u200b\u5bf9\u200b\u6e90\u7801\u200b\u6709\u200b\u4efb\u4f55\u200b\u7684\u200b\u7591\u95ee\u200b\uff0c\u200b\u53ef\u200b\u968f\u65f6\u200b\u67e5\u770b\u200b\u8fd9\u4efd\u200b\u6587\u6863\u200b\u8fdb\u884c\u200b\u5b66\u4e60\u200b\u3002</p> <p>1) 6.S081\u200b\u6240\u6709\u200b\u5b9e\u9a8c\u200b\u9879\u76ee\u200b\uff08\u200b\u9488\u5bf9\u200b\u6bcf\u4e2a\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u90fd\u200b\u6709\u200b\u8be6\u7ec6\u200b\u7684\u200b\u6307\u5bfc\u200b\u548c\u200b\u63d0\u793a\u200b\uff09\uff1a</p> <p></p>"},{"location":"lab1/part2/#12-xv6","title":"1.2 XV6\u200b\u603b\u7edf\u200b\u67b6\u6784\u200b\u7b80\u4ecb","text":"<p>\u200b\u4e0e\u200b\u5927\u591a\u6570\u200bUnix\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e00\u6837\u200b\uff0cXV6\u200b\u91c7\u7528\u200b\u5b8f\u200b\u5185\u6838\u200b\u7ed3\u6784\u200b\uff0c\u200b\u5b83\u200b\u5305\u542b\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e00\u4e9b\u200b\u6700\u200b\u57fa\u672c\u200b\u7684\u200b\u8981\u7d20\u200b\uff0c\u200b\u5305\u62ec\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u3001\u200b\u8fdb\u7a0b\u200b\u8c03\u5ea6\u200b\u3001\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u3001\u200b\u4e2d\u65ad\u200b\u5904\u7406\u200b\u548c\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7b49\u200b\u3002XV6\u200b\u533a\u5206\u200b\u5185\u6838\u200b\u6001\u200b\u548c\u200b\u7528\u6237\u200b\u6001\u200b\uff0c\u200b\u4ee3\u8868\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u7684\u200b\u7528\u6237\u200b\u6001\u200b\u8fdb\u7a0b\u200b\u8fd0\u884c\u200b\u5728\u200bCPU\u200b\u7684\u200b\u7528\u6237\u200b\u6001\u200b\uff08\u200b\u53c8\u79f0\u200b\u975e\u200b\u7279\u6743\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u7528\u6237\u200b\u6a21\u5f0f\u200b\uff09\uff0c\u200b\u65e0\u6cd5\u200b\u76f4\u63a5\u200b\u8bbf\u95ee\u200b\u7cfb\u7edf\u200b\u786c\u4ef6\u200b\u548c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b\u7cfb\u7edf\u200b\u6570\u636e\u200b\uff0c\u200b\u800c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8fd0\u884c\u200b\u5728\u200bCPU\u200b\u7684\u200b\u6838\u5fc3\u200b\u6001\u200b\uff08\u200b\u53c8\u79f0\u200b\u7279\u6743\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u5185\u6838\u200b\u6a21\u5f0f\u200b\uff09\uff0c\u200b\u53ef\u4ee5\u200b\u8bbf\u95ee\u200b\u7cfb\u7edf\u200b\u786c\u4ef6\u200b\u548c\u200b\u6838\u5fc3\u200b\u6570\u636e\u200b\u3002</p>"},{"location":"lab1/part2/#2","title":"2. \u200b\u7528\u6237\u7a0b\u5e8f","text":""},{"location":"lab1/part2/#21","title":"2.1 \u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u4f7f\u7528","text":"<p>\u200b\u6211\u4eec\u200b\u4e00\u822c\u200b\u901a\u8fc7\u200b \u200b\u547d\u4ee4\u884c\u200b \uff08shell\uff09\u200b\u6765\u200b\u4f7f\u7528\u200b\u6ca1\u6709\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff08\u200b\u5982\u200bLinux\uff09\u3002\u200b\u5f53\u200b\u6211\u4eec\u200b\u5411\u200bshell\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\u65f6\u200b\uff0cshell\u200b\u4f1a\u200b\u89e3\u91ca\u200b\u547d\u4ee4\u200b\u5e76\u200b\u6267\u884c\u200b\u5bf9\u5e94\u200b\u7684\u200b \u200b\u7528\u6237\u7a0b\u5e8f\u200b \u3002\u200b\u5b9e\u9645\u4e0a\u200b\uff0c\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\u4e2d\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u5b57\u7b26\u4e32\u200b\u7528\u4e8e\u200b\u6307\u793a\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u6267\u884c\u200b\u7684\u200b\u7528\u6237\u7a0b\u5e8f\u200b\uff0c\u200b\u800c\u200b\u540e\u7eed\u200b\u7684\u200b\u5b57\u7b26\u200b\u5219\u200b\u4e3a\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u4f20\u9012\u200b\u7ed9\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u53c2\u6570\u200b\u3002\u200b\u4f8b\u5982\u200b\u5728\u200bLinux\u200b\u7684\u200bshell\u200b\u4e2d\u200b\u8f93\u5165\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\uff1a</p> <pre><code>$ cp file_a file_b\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\"cp\"\u200b\u8868\u793a\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u6267\u884c\u200b\u76ee\u5f55\u200b/usr/bin\u200b\u4e0b\u200b\u7684\u200b\u7528\u6237\u7a0b\u5e8f\u200bcp\uff0c\u200b\u8be5\u200b\u7a0b\u5e8f\u200b\u7528\u4e8e\u200b\u590d\u5236\u200b\u6587\u4ef6\u200b\u3002\u200b\u800c\u200b\"file_a\"\u200b\u548c\u200b\"file_b\"\u200b\u5c06\u200b\u4f5c\u4e3a\u200b\u53c2\u6570\u4f20\u9012\u200b\u7ed9\u200b\u7a0b\u5e8f\u200bcp\uff0c\u200b\u7528\u4ee5\u200b\u544a\u77e5\u200b\u590d\u5236\u200b\u7684\u200b\u6e90\u6587\u4ef6\u200b\u548c\u200b\u76ee\u7684\u200b\u6587\u4ef6\u200b\u3002\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u7b2c\u4e00\u4e2a\u200b\u5b57\u7b26\u4e32\u200b\u5b9e\u9645\u4e0a\u200b\u4ee3\u8868\u200b\u53ef\u6267\u884c\u6587\u4ef6\u200b\u6240\u5728\u200b\u7684\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u5373\u8be5\u200b\u547d\u4ee4\u200b\u548c\u200b\u547d\u4ee4\u200b\"/usr/bin/cp file_a file_b\"\u200b\u662f\u200b\u5b8c\u5168\u200b\u7b49\u4ef7\u200b\u7684\u200b\u3002\u200b\u56e0\u4e3a\u200b\u76ee\u5f55\u200b\"/usr/bin\"\u200b\u5728\u200b \u200b\u73af\u5883\u53d8\u91cf\u200b PATH\u200b\u4e2d\u200b\uff0c\u200b\u6240\u4ee5\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u7b80\u5199\u200b\u4e3a\u200b\"cp\"\uff0c\u200b\u4ea4\u7531\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u901a\u8fc7\u200b\u73af\u5883\u53d8\u91cf\u200b\u5bfb\u627e\u200b\u53ef\u6267\u884c\u6587\u4ef6\u200b\u3002</p>"},{"location":"lab1/part2/#22","title":"2.2 \u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u5b9e\u73b0","text":"<p>\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u76f8\u5f53\u4e8e\u200b\u7528\u6237\u200b\u4f7f\u7528\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u6865\u6881\u200b\uff0c\u200b\u7528\u6237\u200b\u901a\u8fc7\u200b\u547d\u4ee4\u884c\u200b\u6267\u884c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u5219\u200b\u4f7f\u7528\u200b\u7cfb\u7edf\u200b\u63d0\u4f9b\u200b\u7684\u200b\u4e00\u7cfb\u5217\u200b\u670d\u52a1\u200b\u5b8c\u6210\u200b\u6211\u4eec\u200b\u60f3\u8981\u200b\u7684\u200b\u529f\u80fd\u200b\u3002\u200b\u8fd9\u91cc\u200b\u201d\u200b\u7cfb\u7edf\u200b\u63d0\u4f9b\u200b\u7684\u200b\u670d\u52a1\u200b\u201c\u200b\u5373\u200b\u6240\u8c13\u200b\u7684\u200b \u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b \uff08syscall\uff09\u3002\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u5c31\u200b\u9700\u8981\u200b\u5229\u7528\u200bxv6\u200b\u63d0\u4f9b\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5b9e\u73b0\u200b\u4e00\u4e9b\u200b\u5b9e\u7528\u200b\u7684\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u3002</p> <p>\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u5728\u200b\u6267\u884c\u200b\u524d\u200b\u901a\u5e38\u200b\u9700\u8981\u200b\u63a5\u6536\u200b\u4e00\u4e9b\u200b\u53c2\u6570\u200b\uff0c\u200b\u5982\u4e0a\u200b\u6587\u200b\u63d0\u53ca\u200b\u7684\u200b\u201cfile_a\u201d\u200b\u548c\u200b\u201cfile_b\u201d\u3002\u200b\u6b63\u5e38\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0cC\u200b\u8bed\u8a00\u200b\u4e2d\u200bmain\u200b\u51fd\u6570\u200b\u7684\u200b\u5b9a\u4e49\u200b\u4e3a\u200b\uff1a</p> <pre><code>int main(int argc, char* argv[]);\n</code></pre> <p>\u200b\u5176\u4e2d\u200bargc\u200b\u5c31\u200b\u8868\u793a\u200b\u53c2\u6570\u200b\u7684\u200b\u6570\u91cf\u200b\uff0cargv\u200b\u5219\u200b\u4e3a\u200b\u5b58\u50a8\u200b\u53c2\u6570\u200b\u6240\u5728\u200b\u5730\u5740\u200b\u7684\u200b\u6570\u7ec4\u200b\u3002\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u4e2d\u200b\u8f93\u5165\u200b\u7684\u200b\u53c2\u6570\u200b\u5c06\u200b\u4f5c\u4e3a\u200b \u200b\u5b57\u7b26\u4e32\u200b \u200b\u5b58\u50a8\u200b\u4e8e\u200b\u7528\u6237\u200b\u6808\u200b\uff0c\u200b\u800c\u200bargv\u200b\u5b58\u50a8\u200b\u7684\u200b\u5b57\u7b26\u4e32\u200b\u6307\u9488\u200b\u5219\u200b\u5206\u522b\u200b\u6307\u5411\u200b\u8fd9\u4e9b\u200b\u53c2\u6570\u200b\u3002</p> <p>\u200b\u4f8b\u5982\u200b\u5728\u200b\u6267\u884c\u547d\u4ee4\u200b\u201ccp file_a file_b\u201d\u200b\u65f6\u200b\uff0c\u200b\u7a0b\u5e8f\u200bcp\u200b\u7684\u200bmain\u200b\u51fd\u6570\u200b\u63a5\u6536\u200b\u5230\u200b\u7684\u200b\u53c2\u6570\u200b\u4e3a\u200b\uff1aargc=3\uff0cargv=[\"cp\", \"file_a\", \"file_b\"\uff0cnull]\u3002</p> <p>argv\u200b\u7684\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u5143\u7d20\u200b\u5fc5\u987b\u200b\u4e3a\u7a7a\u200b\u6307\u9488\u200b\uff08\u200b\u5373\u200b\u6570\u503c\u200b0\uff09\uff0c\u200b\u7528\u4ee5\u200b\u6807\u5fd7\u200b\u53c2\u6570\u200b\u7684\u200b\u7ed3\u675f\u200b\u3002argv\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u5143\u7d20\u200b\u5219\u200b\u4e3a\u200b\u9700\u8981\u200b\u6267\u884c\u200b\u7684\u200b\u7a0b\u5e8f\u200b\u3002</p>"},{"location":"lab1/part2/#3-xv6","title":"3. xv6\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3","text":"<p>\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u88ab\u200b\u5c01\u88c5\u200b\u4e3a\u200b\u51fd\u6570\u200b\u4ee5\u5411\u200b\u7528\u6237\u200b\u63d0\u4f9b\u200b\u63a5\u53e3\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u51fd\u6570\u8c03\u7528\u200b\u7684\u200b\u65b9\u5f0f\u200b\u8bf7\u6c42\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u670d\u52a1\u200b\uff0c\u200b\u5e38\u89c1\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u5b9a\u4e49\u200b\u5982\u4e0b\u200b\uff1a\uff08\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\u5934\u6587\u4ef6\u200buser/user.h\uff09</p> \u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\u540d\u200b \u200b\u63cf\u8ff0\u200b int fork(void) Create a process, return child\u2019s PID. int exit(int status) Terminate the current process; status reported to wait(). No return. int wait(int *status) Wait for a child to exit; exit status in *status; returns child PID. int kill(int pid) Terminate process PID. Returns 0, or -1 for error. int getpid(void) Return the current process\u2019s PID. int sleep(int n) Pause for n clock ticks. int exec(char *filename,char *argv[]) Load a file and execute it with arguments; only returns if error. char* sbrk(int n) Grow process\u2019s memory by n bytes. Returns start of new memory. int open(char* filename, int flags) Open a file; flags indicate read/write; returns an fd (file descriptor). int read(int fd, void* buf, int n) Read n bytes into buf; returns number read; or 0 if end of file. int write(int fd, void* buf, int n) Write n bytes from buf to file descriptor fd; returns n. int close(int fd) Release open file fd. int dup(int fd) Return a new file descriptor referring to the same file as fd. int pipe(int p[]) Create a pipe, put read/write file descriptors in p[0] and p[1]. int chdir(char *dirname) Change the current directory. int mkdir(char *dirname) Create a new directory. int mknod(char *name, short major, short minor) Create a device file. int fstat(int fd, struct stat *st) Place info about an open file into *st. int link(char *f1, char*f2) Create another name (file2) for the file file1. int unlink(char* filename) Remove a file. <p>\u200b\u56fe\u8868\u200b\u6458\u81ea\u200b\u300axv6 book\u300bP11\uff0c\u200b\u5177\u4f53\u200b\u4fe1\u606f\u200b\u53ef\u4ee5\u200b\u53c2\u9605\u200b\u3002</p>"},{"location":"lab1/part2/#4","title":"4.\u200b\u7ba1\u9053","text":"<p>\u200b\u7ba1\u9053\u200b\u673a\u5236\u200b\u7b80\u4ecb\u200b</p> <p>\u200b\u7ba1\u9053\u200b\u662f\u200b\u4e00\u79cd\u200b\u7236\u5b50\u200b\u8fdb\u7a0b\u200b\u95f4\u6216\u200b\u5b50\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u95f4\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u95f4\u901a\u4fe1\u200b\u673a\u5236\u200b\uff0c\u200b\u5b83\u200b\u7531\u200bxv6\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u63d0\u4f9b\u200b\uff0c\u200b\u5e76\u200b\u53ef\u200b\u901a\u8fc7\u200b\u76f4\u63a5\u200b\u7f16\u7a0b\u200b\u6216\u200b\u5728\u200bshell\u200b\u7a0b\u5e8f\u200b\u4e0b\u200b\u8f7b\u677e\u200b\u628a\u200b\u4e0d\u540c\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8f93\u5165\u200b\u548c\u200b\u8f93\u51fa\u200b\u8fde\u63a5\u8d77\u6765\u200b\u3002</p> <p>\u200b\u76f4\u63a5\u200b\u7f16\u7a0b\u200b\u65b9\u5f0f\u200b\uff1axv6\u200b\u63d0\u4f9b\u200b\u4e86\u200bpipe\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b\u672c\u8282\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b\u3002</p> <p>shell\u200b\u547d\u4ee4\u200b\u65b9\u5f0f\u200b\uff1a\u201c|\u201d\u200b\u662f\u200b\u7ba1\u9053\u200b\u7b26\u53f7\u200b\uff0c\u200b\u5373\u200b\u4e24\u4e2a\u200b\u547d\u4ee4\u200b\u4e4b\u95f4\u200b\u7684\u200b\u4e00\u9053\u200b\u7ad6\u6760\u200b\u3002\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u7ba1\u9053\u200b\u7b26\u53f7\u200b\u7ec4\u5408\u200b\u7684\u200b\u547d\u4ee4\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u4e0d\u540c\u200b\u8fdb\u7a0b\u200b\uff08\u200b\u7236\u5b50\u200b\u8fdb\u7a0b\u200b\u95f4\u6216\u200b\u5b50\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u95f4\u200b\uff09\u200b\u7684\u200b\u901a\u4fe1\u200b\uff0c\u200b\u4ece\u800c\u200b\u5728\u200b\u4e0d\u200b\u6539\u53d8\u200b\u5e94\u7528\u200b\u7a0b\u5e8f\u4ee3\u7801\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u8ba9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5177\u6709\u200b\u8fdb\u7a0b\u200b\u95f4\u200b\u4fe1\u606f\u200b\u4ea4\u4e92\u200b\u548c\u200b\u529f\u80fd\u200b\u7ec4\u5408\u200b\u7684\u200b\u80fd\u529b\u200b\u3002\u200b\u8be6\u89c1\u200b\u7ba1\u9053\u200b</p> <p>\u200b\u7ba1\u9053\u200b\uff08pipe\uff09\u200b\u662f\u200b\u4e00\u79cd\u200b\u6700\u200b\u57fa\u672c\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u95f4\u901a\u4fe1\u200b\u673a\u5236\u200b\u3002\u200b\u7ba1\u9053\u200b\u5206\u4e3a\u200b \u200b\u8bfb\u51fa\u200b\u7aef\u200b \u200b\u548c\u200b \u200b\u5199\u5165\u200b\u7aef\u200b \u200b\u4e24\u4e2a\u200b\u90e8\u5206\u200b\uff0c\u200b\u8fdb\u7a0b\u200b\u53ef\u4ee5\u200b\u5411\u200b\u5199\u200b\u7aef\u200b\u5199\u5165\u200b\u6570\u636e\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u8bfb\u7aef\u200b\u8bfb\u51fa\u200b\u6570\u636e\u200b\u3002\u200b\u901a\u8fc7\u200bpipe\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u5185\u6838\u200b\u4f1a\u4e3a\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u521b\u5efa\u200b\u7ba1\u9053\u200b\uff0c\u200b\u540c\u65f6\u200b\u8fd4\u56de\u200b\u4e24\u4e2a\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\uff0c\u200b\u7528\u4ee5\u200b\u63cf\u8ff0\u200b\u7ba1\u9053\u200b\u7684\u200b\u8bfb\u5199\u200b\u7aef\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> <pre><code>int p[2];\nint ret;\nret = pipe(p); /*\u200b\u6b63\u5e38\u200b\u521b\u5efa\u200b\u540e\u200b\uff0cp[1]\u200b\u4e3a\u200b\u7ba1\u9053\u200b\u5199\u5165\u200b\u7aef\u200b\uff0cp[0]\u200b\u4e3a\u200b\u7ba1\u9053\u200b\u8bfb\u51fa\u200b\u7aef\u200b*/ </code></pre> <p>\u200b\u901a\u8fc7\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\uff0c\u200b\u7a0b\u5e8f\u200b\u53ef\u4ee5\u200b\u6309\u200b\u8bfb\u5199\u200b\u6587\u4ef6\u200b\u7684\u200b\u5f62\u5f0f\u200b\u8bfb\u5199\u200b\u7ba1\u9053\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> <pre><code>int w_len = write(p[1], buffer, n);\nint r_len = read(p[0], buffer, n);\n</code></pre> <p>\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b</p> <p>Unix/Linux\u200b\u4e2d\u200b\u4e00\u5207\u200b\u7686\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5305\u62ec\u200b\u6807\u51c6\u200b\u8f93\u5165\u200b\u8bbe\u5907\u200b\uff08\u200b\u952e\u76d8\u200b\uff09\u200b\u548c\u200b\u6807\u51c6\u200b\u8f93\u51fa\u8bbe\u5907\u200b\uff08\u200b\u663e\u793a\u5668\u200b\uff09\u200b\u5728\u5185\u200b\u7684\u200b\u6240\u6709\u200b\u8ba1\u7b97\u673a\u786c\u4ef6\u200b\u90fd\u200b\u662f\u200b\u6587\u4ef6\u200b\u3002\u200b\u540c\u6837\u200b\u5730\u200b\uff0cxv6\u200b\u4e5f\u200b\u4f1a\u200b\u7ed9\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u200b\u5206\u914d\u200b\u4e00\u4e2a\u200b\u6574\u6570\u200b\u7684\u200bID\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\uff08File Descriptor\uff09\uff0c\u200b\u5b83\u200b\u4ee3\u8868\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5185\u6838\u200b\u7ba1\u7406\u200b\u7684\u200b\u5bf9\u8c61\u200b\uff0c\u200b\u8fdb\u7a0b\u200b\u53ef\u200b\u5bf9\u200b\u8fd9\u4e2a\u200b\u5bf9\u8c61\u200b\u8fdb\u884c\u200b\u8bfb\u5199\u64cd\u4f5c\u200b\u3002\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u90fd\u200b\u662f\u4ece\u200b0\u200b\u5f00\u59cb\u200b\u8ba1\u6570\u200b\uff0c\u200b\u6309\u7167\u200b\u7ea6\u5b9a\u200b\uff0c\u200b\u5176\u4e2d\u200b0\u200b\u662f\u200b\u6807\u51c6\u200b\u8f93\u5165\u200b\uff0c1\u200b\u662f\u200b\u6807\u51c6\u200b\u8f93\u51fa\u200b\uff0c2\u200b\u662f\u200b\u6807\u51c6\u200b\u9519\u8bef\u200b\u8f93\u51fa\u200b\u3002shell\u200b\u7a0b\u5e8f\u200b\u4e2d\u200b\u59cb\u7ec8\u200b\u6253\u5f00\u200b\u4e86\u200b\u8fd9\u200b\u4e09\u4e2a\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\uff0c\u200b\u4f5c\u4e3a\u200b\u63a7\u5236\u53f0\u200b\u7684\u200b\u9ed8\u8ba4\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u3002</p> \u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b \u200b\u6587\u4ef6\u540d\u200b \u200b\u7c7b\u578b\u200b \u200b\u786c\u4ef6\u200b 0 stdin \u200b\u6807\u51c6\u200b\u8f93\u5165\u200b\u6587\u4ef6\u200b \u200b\u952e\u76d8\u200b 1 stdout \u200b\u6807\u51c6\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200b \u200b\u663e\u793a\u5668\u200b 2 stderr \u200b\u6807\u51c6\u200b\u9519\u8bef\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200b \u200b\u663e\u793a\u5668\u200b <p>\u200b\u7ba1\u9053\u200b\u5b9e\u9645\u4e0a\u200b\u662f\u200b\u5185\u6838\u200b\u5f00\u8f9f\u200b\u7684\u200b\u4e00\u6bb5\u200b\u957f\u5ea6\u200b\u6709\u9650\u200b\u7684\u200b\u7f13\u51b2\u533a\u200b\uff0c\u200b\u7ba1\u9053\u200b\u7684\u200b\u8bfb\u5199\u200b\u5c31\u662f\u200b\u5bf9\u200b\u7f13\u51b2\u533a\u200b\u7684\u200b\u8bfb\u5199\u200b\u3002\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u7ba1\u9053\u200b\u7684\u200b\u8bfb\u53d6\u200b\u662f\u200b\u963b\u585e\u200b\u7684\u200b\uff1a\u200b\u5982\u679c\u200b\u7ba1\u9053\u200b\u7684\u200b\u5199\u5165\u200b\u7aef\u200b\u4e00\u76f4\u200b\u672a\u200b\u5199\u5165\u200b\u6570\u636e\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8c03\u7528\u200bread\u200b\u65f6\u200b\u8fdb\u7a0b\u200b\u4f1a\u200b\u4e00\u76f4\u200b\u7b49\u5f85\u200b\uff0c\u200b\u76f4\u81f3\u200b\u7ba1\u9053\u200b\u5185\u6709\u200b\u6570\u636e\u200b\u53ef\u8bfb\u200b\u65f6\u200b\u624d\u200b\u4f1a\u200b\u5b8c\u6210\u200b\u8bfb\u53d6\u200b\u5e76\u200b\u8fd4\u56de\u200b\u8bfb\u53d6\u200b\u7684\u200b\u957f\u5ea6\u200b\u3002\u200b\u540c\u6837\u200b\uff0c\u200b\u7ba1\u9053\u200b\u7684\u200b\u5199\u5165\u200b\u4e5f\u200b\u662f\u200b\u963b\u585e\u200b\u7684\u200b\uff1a\u200b\u5982\u679c\u200b\u7ba1\u9053\u200b\u88ab\u200b\u5199\u200b\u6ee1\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8c03\u7528\u200bwrite\u200b\u65f6\u200b\u8fdb\u7a0b\u200b\u4e5f\u200b\u4f1a\u200b\u9677\u5165\u200b\u7b49\u5f85\u200b\uff0c\u200b\u76f4\u81f3\u200b\u6570\u636e\u200b\u88ab\u200b\u8bfb\u51fa\u200b\u7aef\u200b\u8bfb\u51fa\u200b\u3002\u200b\u5f53\u7136\u200b\uff0c\u200b\u8bfb\u5199\u200b\u7ba1\u9053\u200b\u4e0d\u4f1a\u200b\u6c38\u8fdc\u200b\u5730\u200b\u963b\u585e\u200b\uff0c\u200b\u5982\u679c\u200b\u8bfb\u200b\u7ba1\u9053\u200b\u65f6\u200b\u53d1\u73b0\u200b \u200b\u6240\u6709\u200b \u200b\u5199\u5165\u200b\u7aef\u200b\u5df2\u7ecf\u200b\u5173\u95ed\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8bfb\u200b\u51fd\u6570\u200b\u5c06\u200b\u4e0d\u4f1a\u200b\u7b49\u5f85\u200b\uff0c\u200b\u800c\u662f\u200b\u76f4\u63a5\u200b\u8fd4\u56de\u200b\u3002\u200b\u5199\u200b\u7ba1\u9053\u200b\u65f6\u200b\u4e5f\u200b\u5177\u5907\u200b\u7c7b\u4f3c\u200b\u7684\u200b\u6027\u8d28\u200b\u3002</p> <p>\u200b\u8fdb\u7a0b\u200b\u901a\u5e38\u200b\u53ea\u200b\u6301\u6709\u200b\u67d0\u4e2a\u200b\u7ba1\u9053\u200b\u7684\u200b\u8bfb\u51fa\u200b\u7aef\u200b\u6216\u8005\u200b\u5199\u5165\u200b\u7aef\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4f7f\u7528\u200b\u7684\u200b\u65f6\u5019\u200b\u9700\u8981\u200b\u5c06\u200b\u53e6\u4e00\u7aef\u200b\u5173\u95ed\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> <pre><code>/* \u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u8bfb\u200b\u7ba1\u9053\u200b\uff0c\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u5199\u200b\u7ba1\u9053\u200b */\nint ret = fork();\nif (ret == 0) { /* \u200b\u5b50\u200b\u8fdb\u7a0b\u200b */\nclose(p[1]); // \u200b\u5173\u95ed\u200b\u5199\u7aef\u200b\n...\nread(...);\n...\nclose(p[0]); // \u200b\u8bfb\u53d6\u200b\u5b8c\u6210\u200b\uff0c\u200b\u5173\u95ed\u200b\u8bfb\u7aef\u200b\n} else if (ret&gt;0) { /* \u200b\u7236\u200b\u8fdb\u7a0b\u200b */\nclose(p[0]); // \u200b\u5173\u95ed\u200b\u8bfb\u7aef\u200b\n...\nwrite(...);\n...\nclose(p[1]); // \u200b\u5199\u5165\u200b\u5b8c\u6210\u200b\uff0c\u200b\u5173\u95ed\u200b\u5199\u7aef\u200b\n}\n</code></pre> <p>\u200b\u7ba1\u9053\u200b\u8be6\u7ec6\u4fe1\u606f\u200b\u53ef\u4ee5\u200b\u53c2\u9605\u200b\u300axv6 book\u300bP15~P17\u3002</p>"},{"location":"lab1/part2/#5xv6","title":"5.\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\uff1axv6\u200b\u5165\u95e8\u200b\u6307\u5357\u200b\u7684\u200b\u5165\u95e8\u200b\u6307\u5357","text":"<p>\u200b\u524d\u200b\u56db\u4e2a\u200b\u90e8\u5206\u200b\u7684\u200b\u53d9\u8ff0\u200b\u975e\u5e38\u200b\u62bd\u8c61\u200b\uff0c\u200b\u6211\u4eec\u200b\u5728\u200b\u8fd9\u200b\u4e00\u90e8\u5206\u200b\u5c06\u200b\u5176\u200b \u200b\u878d\u4f1a\u8d2f\u901a\u200b \u200b\u8d77\u6765\u200b\uff0c\u200b\u770b\u770b\u200b\u5176\u95f4\u200b\u7684\u200b\u5173\u7cfb\u200b\u3002</p> <p>xv6\u200b\u662f\u200b\u4e00\u4e2a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u4f46\u662f\u200b\u5728\u200b\u8fd9\u200b\u4e00\u7ae0\u200b\u6211\u4eec\u200b \u200b\u4e0d\u200b\u6253\u7b97\u200b\u4fee\u6539\u200b \u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u800c\u662f\u200b\u7f16\u5199\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\uff0c\u200b\u53bb\u200b \u200b\u4f7f\u7528\u200b \u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u3002\u200b\u6211\u4eec\u200b\u7f16\u5199\u200b\u7684\u200b\u6700\u200b\u7b80\u5355\u200b\u7684\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>int main(){\nprintf(\"Hello world\");\nreturn 0;\n}\n</code></pre> <p>\u200b\u8fd9\u200b\u6bb5\u200b\u4ee3\u7801\u200b\u5bf9\u200b\u6211\u4eec\u200b\u6765\u8bf4\u200b\u592a\u8fc7\u200b\u719f\u6089\u200b\uff0c\u200b\u4ee5\u81f3\u4e8e\u200b\u6211\u4eec\u200b\u4f1a\u200b\u4ee5\u4e3a\u200b\u8fd9\u200b\u4e0e\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u6beb\u65e0\u5173\u7cfb\u200b\u3002\u200b\u5b9e\u9645\u4e0a\u200b\uff0c printf \u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u8c03\u7528\u200b\u4e86\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u670d\u52a1\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u5c31\u662f\u200b\u7b2c\u4e09\u200b\u90e8\u5206\u200b\u63d0\u5230\u200b\u7684\u200b\u201d\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\u201c\uff0c\u200b\u957f\u5f97\u200b\u548c\u200b\u51fd\u6570\u200b\u4e00\u6837\u200b\uff0c\u200b\u7528\u200b\u8d77\u6765\u200b\u4e5f\u200b\u548c\u200b\u51fd\u6570\u200b\u4e00\u6837\u200b\u3002</p> <p>\u200b\u73b0\u5728\u200b\u6211\u4eec\u200b\u6765\u200b\u770b\u770b\u200bxv6\u200b\u91cc\u9762\u200b\u7684\u200b\u7b80\u5355\u200b\u7a0b\u5e8f\u200b\u957f\u200b\u5565\u200b\u6837\u200b\uff1a</p> <pre><code>#include \"user.h\"\nint main(int argc, char* argv[]){\nprintf(\"Hello world\");\nexit(0);\n}\n</code></pre> <p>\u200b\u8fd9\u200b\u5c31\u662f\u200b\u6700\u200b\u7b80\u5355\u200b\u7684\u200bxv6\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u5566\u200b\uff0c\u200b\u4e0b\u9762\u200b\u6211\u4eec\u200b\u6765\u200b\u4e00\u4e00\u200b\u4ecb\u7ecd\u200b\u6bcf\u200b\u4e00\u884c\u200b\u7684\u200b\u610f\u4e49\u200b\uff1a</p> <ul> <li>\u200b\u7b2c\u4e00\u884c\u200binclude\u200b\u4e86\u200bxv6\u200b\u81ea\u5e26\u200b\u7684\u200b\u5e93\u51fd\u6570\u200b\uff0c\u200b\u6253\u5f00\u200b\u5b83\u200b\u4f60\u200b\u4f1a\u200b\u770b\u5230\u200b\u91cc\u9762\u200b\u6709\u200b\u4e24\u79cd\u200b\u51fd\u6570\u200b\uff0c\u200b\u4e00\u79cd\u200b\u662f\u200bsystem call\uff0c\u200b\u5373\u200b\u7b2c\u4e09\u200b\u90e8\u5206\u200b\u63d0\u5230\u200b\u7684\u200b\u201d\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\u201c\uff0c\u200b\u53e6\u200b\u4e00\u79cd\u200b\u5c31\u662f\u200b\u6211\u4eec\u200b\u5e73\u5e38\u200b\u7528\u5230\u200b\u7684\u200b\u8f85\u52a9\u200b\u51fd\u6570\u200b\uff0cxv6\u200b\u5e2e\u200b\u4f60\u200b\u5199\u200b\u597d\u200b\u7684\u200b\u90a3\u79cd\u200b\uff0c\u200b\u6bd4\u5982\u200b strlen \u3002\u200b\u4eca\u540e\u200b\u6211\u4eec\u200b\u53ef\u80fd\u200b\u4e5f\u200b\u4f1a\u200b\u7528\u5230\u200b\u522b\u7684\u200b\u5e93\u200b\uff0c\u200b\u81ea\u5df1\u200b\u5f15\u7528\u200b\u8fdb\u6765\u200b\u5c31\u200b\u597d\u200b\u3002</li> <li>\u200b\u7b2c\u4e8c\u884c\u200b\uff0c\u200b\u53d1\u73b0\u200b\u600e\u4e48\u200b\u6709\u200b\u4e24\u4e2a\u200b\u53c2\u6570\u200b\u554a\u200b\uff1f\u200b\u8fd9\u200b\u5176\u5b9e\u200b\u5c31\u662f\u200b\u7b2c\u4e8c\u200b\u90e8\u5206\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u5b9e\u73b0\u200b\u6240\u8bf4\u200b\u7684\u200b\u3002\u200b\u5f53\u200b\u6211\u4eec\u200b\u542f\u52a8\u200b\u4e00\u4e2a\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u9700\u8981\u200b\u7ed9\u200b\u5b83\u200b\u4e00\u4e9b\u200b\u4fe1\u606f\u200b\uff0c\u200b\u8fd9\u6837\u200b\u7a0b\u5e8f\u200b\u5c31\u200b\u77e5\u9053\u200b\u5b83\u200b\u88ab\u200b\u542f\u52a8\u200b\u7684\u200b\u76ee\u7684\u200b\u662f\u200b\u4ec0\u4e48\u200b\u4e86\u200b\u3002</li> <li>\u200b\u7b2c\u4e09\u884c\u200b\uff0c\u200b\u8c03\u7528\u200b\u7684\u200b\u5c31\u662f\u200b\u4e00\u4e2a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u4e86\u200b\u3002\u200b\u5728\u200b\u4e4b\u540e\u200b\u7684\u200b\u7a0b\u5e8f\u200b\u7f16\u5199\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5e2e\u5fd9\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c31\u8981\u200b \u200b\u4f7f\u7528\u200b\u7b2c\u4e09\u200b\u90e8\u5206\u200b\u4e2d\u200b\u7f57\u5217\u200b\u7684\u200b\u5404\u79cd\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u4ee5\u200b\u51fd\u6570\u200b\u7684\u200b\u5f62\u5f0f\u200b\u4f7f\u7528\u200b\u5b83\u200b \u3002</li> <li>\u200b\u7b2c\u56db\u884c\u200b\u7684\u200bexit\u200b\u4e00\u5b9a\u200b\u4e0d\u8981\u200b\u6f0f\u200b\u4e86\u200b\uff0c\u200b\u73b0\u4ee3\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e2d\u200blinux\u200b\u548c\u200bwindows\u200b\u90fd\u200b\u53ef\u4ee5\u200b\u7528\u200breturn 0\u200b\u9000\u51fa\u200b\u7a0b\u5e8f\u200b\uff0c\u200b\u8fd9\u200b\u662f\u200b\u5b83\u200b\u8bbe\u8ba1\u200b\u7684\u200b\u597d\u200b\u7684\u200b\u7f18\u6545\u200b\uff0c\u200b\u4f46\u662f\u200bxv6\u200b\u5219\u200b \u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200bexit\u200b\u663e\u5f0f\u200b\u7684\u200b\u9000\u51fa\u200b\u7a0b\u5e8f\u200b \uff0c\u200b\u8981\u4e0d\u7136\u200b\u8fd9\u4e2a\u200b\u7a0b\u5e8f\u200b\u5c31\u200b\u6ca1\u5b8c\u200b\u4e86\u200b\u3002</li> </ul> <p>\u200b\u77e5\u9053\u200b\u4e86\u200b\u57fa\u672c\u200b\u7a0b\u5e8f\u200b\u8be5\u200b\u5982\u4f55\u200b\u7f16\u5199\u200b\u540e\u200b\uff0c\u200b\u5404\u79cd\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u4e5f\u200b\u5c31\u200b\u53ea\u662f\u200b\u903b\u8f91\u200b\u7684\u200b\u95ee\u9898\u200b\u4e86\u200b\uff0c\u200b\u5982\u679c\u200b\u4e0d\u200b\u653e\u5fc3\u200b\uff0c\u200b\u81ea\u5df1\u200b\u7f16\u4e2a\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u8bd5\u8bd5\u770b\u200b\u5148\u200b\uff0c\u200b\u4e5f\u200b\u4e0d\u9519\u200b\u3002</p> <p>\u200b\u4e0b\u9762\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c31\u200b\u6b63\u5f0f\u200b\u8fdb\u5165\u200b\u5230\u200b\u5404\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u7ec6\u8282\u200b\u4e2d\u200b\u3002</p>"},{"location":"lab1/part3/","title":"\u5b9e\u9a8c\u200b\u6b65\u9aa4","text":"<p>\u200b\u4e0b\u9762\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c31\u200b\u6b63\u5f0f\u200b\u8fdb\u5165\u200b\u5230\u200b\u5404\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u7ec6\u8282\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u200b\u7ed9\u51fa\u200b\u5b9e\u9a8c\u200b\u5b9e\u73b0\u200b\u7684\u200b\u4e00\u4e9b\u200b\u63d0\u793a\u200b\u3002\u200b\u5927\u5bb6\u200b\u9700\u8981\u200b\u4f9d\u7167\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u4e66\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u6982\u8ff0\u200b\u4e2d\u200b\u63d0\u5230\u200b\u7684\u200b\u8981\u6c42\u200b\u8fdb\u884c\u200b\u5b9e\u73b0\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u8fd8\u200b\u9700\u8981\u200b\u56de\u7b54\u200b\u6307\u5bfc\u4e66\u200b\u7ed9\u51fa\u200b\u7684\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"lab1/part3/#1","title":"1. \u200b\u90e8\u7f72\u200b\u5b9e\u9a8c\u200b\u73af\u5883","text":"<p>\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u4e3b\u8981\u200b\u5206\u4e3a\u200b\u4e09\u200b\u90e8\u5206\u200b\uff1axv6\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\u3001xv6\u200b\u6e90\u7801\u200b\u3001xv6\u200b\u7684\u200b\u7f16\u8bd1\u200b\u4e0e\u200b\u8fd0\u884c\u200b\u3002</p>"},{"location":"lab1/part3/#11-xv6","title":"1.1  xv6\u200b\u8fd0\u884c\u200b\u73af\u5883","text":"<p>xv6\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\u8be6\u89c1\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u53ca\u200b\u73af\u5883\u200b\u914d\u7f6e\u200b\u3002</p>"},{"location":"lab1/part3/#12-xv6","title":"1.2  xv6\u200b\u6e90\u7801","text":"<p>\u200b\u8bf7\u200bclone\u200b\u6700\u65b0\u200b\u4ee3\u7801\u200b\u5230\u200b\u672c\u5730\u200b\u8fdb\u884c\u200b\u5b9e\u9a8c\u200b\uff1a   </p> <pre><code>$ git clone https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git\n</code></pre> <p>\u200b\u6bcf\u4e2a\u200b\u5b9e\u9a8c\u200b\u9879\u76ee\u200b\u90fd\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200b\u5206\u652f\u200b\u4e0a\u200b\u5b8c\u6210\u200b\uff0c\u200b\u8bf7\u200b \u200b\u6ce8\u610f\u200b\u5207\u6362\u200b\u5206\u652f\u200b \uff0c\u200b\u4f8b\u5982\u200b\uff0c\u200b\u5b9e\u9a8c\u200b\u4e00\u9700\u200b\u5207\u6362\u200b\u5230\u200butil\u200b\u5206\u652f\u200b\u540e\u200b\u8fdb\u884c\u200b\u5f00\u53d1\u200b\u3002</p> <pre><code>$ git branch -a\n$ git checkout util\n</code></pre> <p>\u200b\u53e6\u5916\u200b\uff0c\u200b\u7531\u4e8e\u200b\u6211\u4eec\u200b\u7684\u200b\u5b98\u65b9\u200b\u4ed3\u5e93\u200b \u200b\u968f\u65f6\u200b\u53ef\u80fd\u200b\u66f4\u65b0\u200b\uff0c\u200b\u6240\u4ee5\u200b\u505a\u200b\u5b9e\u9a8c\u200b\u524d\u200b\u9700\u8981\u200b\u5148\u62c9\u53d6\u200b\u6700\u65b0\u200b\u7684\u200b\u4ee3\u7801\u200b\uff1a\u200b\u5148\u5207\u200b\u5230\u200b\u5bf9\u5e94\u200b\u7684\u200b\u5206\u652f\u200b\uff08util\uff09\uff0c\u200b\u7136\u540e\u200b\uff1a</p> <pre><code>$ git pull\n</code></pre> <p>xv6\u200b\u7684\u200b\u4ee3\u7801\u200b\u7ed3\u6784\u200b\uff1a</p>"},{"location":"lab1/part3/#13-xv6","title":"1.3  \u200b\u7f16\u8bd1\u200b\u5e76\u200b\u8fd0\u884c\u200bxv6","text":"<p>Step1 \u200b\u5728\u200b\u4ee3\u7801\u200b\u603b\u76ee\u5f55\u200bxv6-oslab23-hitsz\u200b\u4e0b\u200b\u8f93\u5165\u200b<code>make qemu</code>\uff0c \u200b\u7f16\u8bd1\u200b\u5e76\u200b\u8fd0\u884c\u200bxv6;</p> <p>Step2 \u200b\u5f53\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u201cinit: starting sh\u201d\u200b\u7684\u200b\u5b57\u6837\u200b\u8868\u793a\u200bxv6\u200b\u5df2\u7ecf\u200b\u6b63\u5e38\u200b\u542f\u52a8\u200b\uff0c\u200b\u6b64\u65f6\u200b\u5728\u200b\u201c$\u201d\u200b\u63d0\u793a\u7b26\u200b\u540e\u200b\u53ef\u200b\u8f93\u5165\u200bxv6\u200b\u652f\u6301\u200b\u7684\u200bshell\u200b\u547d\u4ee4\u200b\u3002</p> <p>qemu\u200b\u9000\u51fa\u200b\u65b9\u6cd5\u200b</p> <p>\u200b\u5148\u200b\u6309\u200b<code>ctrl+a</code>\u200b\u7ec4\u5408\u952e\u200b\uff0c\u200b\u63a5\u7740\u200b\u5b8c\u5168\u200b\u677e\u5f00\u200b, \u200b\u518d\u200b\u6309\u200b<code>x</code></p>"},{"location":"lab1/part3/#2","title":"2.  \u200b\u51c6\u5907\u200b\u5de5\u4f5c","text":"<p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u9700\u8981\u200b\u7f16\u5199\u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u4e2d\u200b\u4ecb\u7ecd\u200b\u7684\u200b3\u200b\u4e2a\u200bUnix\u200b\u5b9e\u7528\u7a0b\u5e8f\u200b\u3002\u200b\u521d\u6b21\u200b\u63a5\u89e6\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u4f60\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u611f\u5230\u200b\u4e0d\u77e5\u6240\u63aa\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4e0d\u59a8\u200b\u5148\u200b\u4f53\u9a8c\u200b\u4e00\u4e0b\u200b\u8fd9\u4e9b\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u8fd0\u884c\u200b\u6548\u679c\u200b\u3002\u200b\u5b9e\u9645\u4e0a\u200b\uff0cLinux\u200b\u4e2d\u200b\u5177\u5907\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u8981\u200b\u5b9e\u73b0\u200b\u7684\u200b\u4e00\u4e9b\u200b\u7a0b\u5e8f\u200b\uff0c\u200b\u4f8b\u5982\u200bsleep\u3001find\u3001xargs\u3002\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5148\u200b\u5c1d\u8bd5\u200b\u5728\u200bLinux\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u8fd9\u4e9b\u200b\u547d\u4ee4\u200b\uff0c\u200b\u5145\u5206\u200b\u4f53\u4f1a\u200b\u529f\u80fd\u200b\u540e\u200b\u518d\u200b\u5f00\u59cb\u200b\u7f16\u7a0b\u200b\u3002\u200b\u5f53\u7136\u200b\uff0cLinux\u200b\u4e2d\u200b\u547d\u4ee4\u200b\u7684\u200b\u529f\u80fd\u200b\u8f83\u4e3a\u200b\u590d\u6742\u200b\uff0c\u200b\u6211\u4eec\u200b\u4ec5\u200b\u8981\u6c42\u200b\u5b9e\u73b0\u200b\u7b80\u5316\u7248\u200b\u3002</p> <p>\u200b\u5b9e\u9a8c\u200b\u5f00\u59cb\u200b\u4e4b\u524d\u200b\uff0c\u200b\u6211\u4eec\u200b \u200b\u5f3a\u70c8\u5efa\u8bae\u200b \u200b\u4f60\u200b\u5148\u200b\u5b8c\u6210\u200b\u4ee5\u4e0b\u200b\u5de5\u4f5c\u200b\uff1a</p> <ol> <li>\u200b\u719f\u6089\u200b\u5e38\u89c1\u200b\u547d\u4ee4\u200b\u7684\u200b\u4f7f\u7528\u200b\uff0c\u200b\u5982\u200b <code>echo</code>\u3001<code>xargs</code>\u3001<code>find</code>\u3002</li> <li>\u200b\u4e86\u89e3\u200b\u76ee\u5f55\u200b\u7684\u200b\u4f7f\u7528\u200b\u3002\u200b\u4e86\u89e3\u200b <code>.</code>\u3001<code>..</code>\u3001<code>/</code>\u200b\u5206\u522b\u200b\u8868\u793a\u200b\u4ec0\u4e48\u200b\uff0c\u200b\u719f\u6089\u200b\u5e38\u89c1\u200b\u7684\u200b\u76ee\u5f55\u200b\u64cd\u4f5c\u547d\u4ee4\u200b\uff0c\u200b\u5982\u200b<code>mkdir</code>\u3001<code>cd</code>\u3002</li> <li>\u200b\u4e86\u89e3\u200b\u91cd\u5b9a\u5411\u200b\u7684\u200b\u4f7f\u7528\u200b\uff0c\u200b\u91cd\u5b9a\u5411\u200b\u5373\u200b\u547d\u4ee4\u200b\u4e2d\u200b\u7684\u200b<code>&lt;</code>\u200b\u548c\u200b<code>&gt;</code>\uff0c\u200b\u7528\u4e8e\u200b\u4fee\u6539\u200b\u53f3\u4fa7\u200b\u547d\u4ee4\u200b\u7684\u200b\u6807\u51c6\u200b\u8f93\u5165\u200b/\u200b\u8f93\u51fa\u200b\u3002\u200b\u4f8b\u5982\u200b<code>echo Hello world &gt; file_a</code>\u200b\u4f1a\u200b\u5c06\u200b\u5b57\u7b26\u4e32\u200b<code>Hello world</code>\u200b\u8f93\u51fa\u200b\u81f3\u200b\u6587\u4ef6\u200b<code>file_a</code>\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u6253\u5370\u200b\u5728\u200b\u7ec8\u7aef\u200b\u3002</li> <li>\u200b\u4e86\u89e3\u200b\u7ba1\u9053\u200b\u7684\u200b\u4f7f\u7528\u200b\u3002\u200b\u7ba1\u9053\u200b\u5373\u200b\u547d\u4ee4\u200b\u4e2d\u200b\u7684\u200b<code>|</code>\uff0c\u200b\u7528\u4e8e\u200b\u5c06\u200b\u5de6\u4fa7\u200b\u547d\u4ee4\u200b\u7684\u200b\u6807\u51c6\u200b\u8f93\u51fa\u200b\u4f20\u9012\u200b\u7ed9\u200b\u53f3\u4fa7\u200b\u547d\u4ee4\u200b\u7684\u200b\u6807\u51c6\u200b\u8f93\u5165\u200b\u3002</li> <li>\u200b\u4e86\u89e3\u200b\u5e38\u89c1\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u4f7f\u7528\u200b\u3002\u200b\u5982\u200b <code>fork</code>\u3001<code>exit</code>\u3001<code>wait</code>\u3001<code>open</code>\u3001<code>close</code>\u3001<code>read</code>/<code>write</code>\u3001<code>pipe</code>\u3001<code>dup</code>\u3002</li> </ol>"},{"location":"lab1/part3/#3","title":"3.  \u200b\u7f16\u5199\u200b\u7528\u6237\u7a0b\u5e8f","text":""},{"location":"lab1/part3/#31-sleep","title":"3.1  \u200b\u4ee3\u7801\u200b\u793a\u4f8b\u200bsleep","text":"<p>\u200b\u4e3a\u200b\u5e2e\u52a9\u200b\u540c\u5b66\u200b\u4eec\u200b\u7406\u89e3\u200bxv6\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u7f16\u5199\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u6211\u4eec\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u4e2a\u200bsleep\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u793a\u4f8b\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u7406\u89e3\u200b\u5176\u200b\u4ee3\u7801\u200b\u5e76\u200b\u6210\u529f\u200b\u5c06\u200b\u5176\u200b\u8fd0\u884c\u200b\uff1a</p> <p>Step1. \u200b\u65b0\u5efa\u200buser/sleep.c\u200b\u6587\u4ef6\u200b\uff0c\u200b\u7f16\u5199\u200b\u5982\u4e0b\u200b\u4ee3\u7801\u200b\uff0c\u200b\u7406\u89e3\u200b\u4ee3\u7801\u200b\u548c\u200b\u6ce8\u91ca\u200b\uff1b</p> <p>Step2. \u200b\u7531\u4e8e\u200bsleep.c\u200b\u4e3a\u200b\u65b0\u589e\u200b\u7684\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8bf7\u200b\u5728\u200bMakefile\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u627e\u5230\u200bUPROGS\uff0c\u200b\u5728\u200bUPROGS\u200b\u4e0a\u200b\u589e\u52a0\u200b\u4e00\u884c\u200b<code>$U/_sleep</code>\uff1a</p> <p>Step3. \u200b\u7f16\u8bd1\u200bxv6\u200b\u5e76\u200b\u8fd0\u884c\u200bsleep\u3002</p> <p>Step4.\u200b\u56de\u7b54\u200b3.3\u200b\u4e2d\u200b\u7684\u200b\u76f8\u5173\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"lab1/part3/#32","title":"3.2  \u200b\u5b9e\u9a8c\u200b\u63d0\u793a","text":"<p>\u200b\u5728\u200b\u505a\u200b\u5b8c\u200b\u4e0a\u8ff0\u200b\u5b9e\u9a8c\u200b\u540e\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u6839\u636e\u200b\u4ee5\u4e0b\u200b\u63d0\u793a\u200b\uff0c\u200b\u7f16\u5199\u200bpingpong\u200b\u548c\u200bfind\u200b\u4e24\u4e2a\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u3002</p>"},{"location":"lab1/part3/#321-pingpong","title":"3.2.1   pingpong","text":"<p>a)   \u200b\u4f7f\u7528\u200b<code>pipe()</code>\u200b\u521b\u5efa\u200b\u7ba1\u9053\u200b\uff0c\u200b\u8be6\u89c1\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\uff1b</p> <p>b)   \u200b\u4f7f\u7528\u200b<code>fork()</code>\u200b\u521b\u5efa\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u6ce8\u610f\u200b\u6839\u636e\u200b\u8fd4\u56de\u503c\u200b\uff0c\u200b\u5224\u65ad\u200b\u7236\u5b50\u200b\u8fdb\u7a0b\u200b\uff1b</p> <p>c)    \u200b\u5229\u7528\u200b<code>read()</code>, <code>write()</code>\u200b\u51fd\u6570\u200b\u5bf9\u200b\u7ba1\u9053\u200b\u8fdb\u884c\u200b\u8bfb\u5199\u200b\u3002</p> <p>d)   \u200b\u8bf7\u200b\u5728\u200b<code>user/pingpong.c</code>\u200b\u4e2d\u200b\u5b9e\u73b0\u200b\u3002</p> <p>e)   \u200b\u4fee\u6539\u200b<code>Makefile</code>\uff0c\u200b\u5c06\u200b\u7a0b\u5e8f\u200b\u6dfb\u52a0\u200b\u5230\u200b<code>UPROGS</code>\u3002</p>"},{"location":"lab1/part3/#322-find","title":"3.2.2  find","text":"<p>a)    \u200b\u53ef\u200b\u67e5\u770b\u200b<code>user/ls.c</code>\u200b\u4ee5\u200b\u4e86\u89e3\u200b\u5982\u4f55\u200b\u8bfb\u53d6\u200b\u76ee\u5f55\u200b\uff1b</p> <p>b)    \u200b\u53ef\u200b\u53c2\u7167\u200b<code>user/ls.c</code>\u200b\u7684\u200b\u903b\u8f91\u200b\u5b9e\u73b0\u200b\uff1b</p> <p>c)    \u200b\u4f7f\u7528\u200b\u9012\u5f52\u200b\u5141\u8bb8\u200b<code>find</code>\u200b\u8fdb\u5165\u200b\u5230\u200b\u5b50\u76ee\u5f55\u200b\uff1b</p> <p>d)    \u200b\u4e0d\u8981\u200b\u9012\u5f52\u200b\u8fdb\u5165\u200b<code>.</code>\u200b\u548c\u200b<code>..</code>\uff1b</p> <p>e)    \u200b\u6d4b\u8bd5\u200b\u65f6\u200b\u9700\u8981\u200b\u521b\u5efa\u200b\u65b0\u200b\u7684\u200b\u6587\u4ef6\u200b\u548c\u200b\u6587\u4ef6\u5939\u200b\uff0c\u200b\u53ef\u200b\u4f7f\u7528\u200b<code>make clean</code>\u200b\u6e05\u7406\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u5e76\u200b\u4f7f\u7528\u200b<code>make qemu</code>\u200b\u518d\u200b\u7f16\u8bd1\u200b\u8fd0\u884c\u200b\u3002</p> <p>\u200b\u63d0\u793a\u200b\uff1a</p> <ul> <li> <p>\u200b\u5173\u4e8e\u200b\u4ee5\u4e0a\u200b2\u200b\u4e2a\u200bUnix\u200b\u5b9e\u7528\u7a0b\u5e8f\u200b\u7684\u200b\u5b9e\u73b0\u200b\u4ea6\u53ef\u200b\u53c2\u8003\u200bMIT\u200b\u5b98\u65b9\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u6307\u5bfc\u200b\u5b8c\u6210\u200b\u5b9e\u9a8c\u200bLab: Xv6 and Unix utilities</p> </li> <li> <p>\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\u7684\u200b\u793a\u4f8b\u200b\u53ef\u200b\u67e5\u9605\u200b\u300axv6 book\u300bchapter 1\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c \u200b\u5c24\u5176\u200b\u662f\u200b1.2\u30011.3\u200b\u8282\u200b\u7684\u200b\u5185\u5bb9\u200b \u3002</p> </li> </ul>"},{"location":"lab1/part3/#33","title":"3.3 \u200b\u56de\u7b54\u200b\u95ee\u9898","text":"<p>\u200b\u4e00\u200b\u3001\u200b\u9605\u8bfb\u200bsleep.c\uff0c\u200b\u56de\u7b54\u200b\u4e0b\u5217\u200b\u95ee\u9898\u200b</p> <p>1) \u200b\u5f53\u200b\u7528\u6237\u200b\u5728\u200bxv6\u200b\u7684\u200bshell\u200b\u4e2d\u200b\uff0c\u200b\u8f93\u5165\u200b\u4e86\u200b\u547d\u4ee4\u200b<code>sleep hello world\\n</code>\uff0c\u200b\u8bf7\u95ee\u200bargc\u200b\u7684\u200b\u503c\u200b\u662f\u200b\u591a\u5c11\u200b\uff0cargv\u200b\u6570\u7ec4\u200b\u5927\u5c0f\u200b\u662f\u200b\u591a\u5c11\u200b\u3002  </p> <p>2) \u200b\u8bf7\u200b\u63cf\u8ff0\u200bmain\u200b\u51fd\u6570\u53c2\u6570\u200bargv\u200b\u4e2d\u200b\u7684\u200b\u6307\u9488\u200b\u6307\u5411\u200b\u4e86\u200b\u54ea\u4e9b\u200b\u5b57\u7b26\u4e32\u200b\uff0c\u200b\u4ed6\u4eec\u200b\u7684\u200b\u542b\u4e49\u200b\u662f\u200b\u4ec0\u4e48\u200b\u3002</p> <p>3) \u200b\u54ea\u4e9b\u200b\u4ee3\u7801\u200b\u8c03\u7528\u200b\u4e86\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u4e3a\u200b\u7a0b\u5e8f\u200bsleep\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u670d\u52a1\u200b\uff1f</p> <p>\u200b\u4e8c\u200b\u3001\u200b\u4e86\u89e3\u200b\u7ba1\u9053\u200b\u6a21\u578b\u200b\uff0c\u200b\u56de\u7b54\u200b\u4e0b\u5217\u200b\u95ee\u9898\u200b</p> <p>1) \u200b\u7b80\u8981\u200b\u8bf4\u660e\u200b\u4f60\u200b\u662f\u200b\u600e\u4e48\u200b\u521b\u5efa\u200b\u7ba1\u9053\u200b\u7684\u200b\uff0c\u200b\u53c8\u200b\u662f\u200b\u600e\u4e48\u200b\u4f7f\u7528\u200b\u7ba1\u9053\u200b\u4f20\u8f93\u6570\u636e\u200b\u7684\u200b\u3002  </p> <p>2) fork\u200b\u4e4b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u600e\u4e48\u200b\u7528\u200b\u7ba1\u9053\u200b\u5728\u200b\u7236\u5b50\u200b\u8fdb\u7a0b\u200b\u4f20\u8f93\u6570\u636e\u200b\uff1f </p> <p>3) \u200b\u8bd5\u200b\u89e3\u91ca\u200b\uff0c\u200b\u4e3a\u4ec0\u4e48\u200b\u8981\u200b\u63d0\u524d\u200b\u5173\u95ed\u200b\u7ba1\u9053\u200b\u4e2d\u200b\u4e0d\u200b\u4f7f\u7528\u200b\u7684\u200b\u4e00\u7aef\u200b\uff1f\uff08\u200b\u63d0\u793a\u200b\uff1a\u200b\u7ed3\u5408\u200b\u7ba1\u9053\u200b\u7684\u200b\u963b\u585e\u200b\u673a\u5236\u200b\uff09</p>"},{"location":"lab1/part3/#4-xv6","title":"4.  xv6\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u5206\u6790","text":"<p>\u200b\u5f53\u200b\u6211\u4eec\u200b\u8f93\u5165\u200b<code>make qemu</code>\u200b\u540e\u200b\uff0c\u200b\u5c31\u200b\u80fd\u200b\u542f\u52a8\u200bqemu\uff0c\u200b\u4ece\u200b\u63a7\u5236\u53f0\u200b\u53c2\u6570\u200b\u52a0\u8f7d\u200b\u8d44\u6e90\u200b\uff0c\u200b\u5c06\u200bxv6\u200b\u6574\u4f53\u200b\u52a0\u8f7d\u200b\u5230\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u4e2d\u200b\u3002xv6\u200b\u542f\u52a8\u200b\u6d89\u53ca\u200bkernel\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200bentry.S\u3001start.c\u200b\u4e0e\u200bmain.c\u200b\u7b49\u200b\u5c11\u6570\u51e0\u4e2a\u200b\u6587\u4ef6\u200b\uff0centry\u3001start\u200b\u4e24\u4e2a\u200b\u51fd\u6570\u200b\u8fd0\u884c\u200b\u5728\u200b\u673a\u5668\u200b\u6001\u200b\uff08\u200b\u7c7b\u4f3c\u200b\u4e8e\u200bBIOS\uff09\uff0cmain\u200b\u8fd0\u884c\u200b\u5728\u200b\u5185\u6838\u200b\u6001\u200b\uff08\u200b\u7279\u6743\u200b\u7ea7\u200b\uff09\uff0c\u200b\u540e\u9762\u200b\u7684\u200b\u7528\u6237\u200b\u7a0b\u5e8f\u8fd0\u884c\u200b\u5728\u200b\u7528\u6237\u200b\u6001\u200b\u3002</p> <p>\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u6b65\u9aa4\u200b\u5982\u4e0b\u200b:</p> <p>\uff081\uff09QEMU\u200b\u5c06\u200bpc\u200b\u8bbe\u200b\u4e3a\u200b0x8000_0000\uff0c\u200b\u5f00\u59cb\u8fd0\u884c\u200bxv6\u200b\u7684\u200b\u9996\u4e2a\u200b\u51fd\u6570\u200b\uff1a_entry (kernel/entry.S)\u3002</p> <p>\uff082\uff09entry\u200b\u51fd\u6570\u200b\u8bbe\u7f6e\u200b\u5f53\u524d\u200bCPU\u200b\u7684\u200b\u6808\u200b\u5bc4\u5b58\u5668\u200b(sp)\uff0c\u200b\u62e5\u6709\u200b\u6808\u540e\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u8c03\u7528\u51fd\u6570\u200b\u4e86\u200b\uff0c\u200b\u8fdb\u5165\u200bstart\u3002</p> <p>\uff083\uff09start\u200b\u51fd\u6570\u200b\u8fdb\u884c\u200b\u4e86\u200b\u5982\u4e0b\u200b\u64cd\u4f5c\u200b\uff1a</p> <ul> <li>\u200b\u521d\u59cb\u5316\u200b\u673a\u5668\u200b\u6001\u200b\u7279\u6743\u200b\u5bc4\u5b58\u5668\u200b</li> <li>\u200b\u542f\u7528\u200b\u65f6\u949f\u200b\u4e2d\u65ad\u200b</li> <li>\u200b\u628a\u200b\u5f53\u524d\u200bCPU\u200b\u7684\u200bid\u200b\u653e\u5165\u200btp\u200b\u5bc4\u5b58\u5668\u200b</li> </ul> <p>\uff084\uff09start\u200b\u51fd\u6570\u200b\u5b8c\u6210\u200b\u4e86\u200b\u673a\u5668\u200b\u6001\u200b\u521d\u59cb\u5316\u200b\uff0c\u200b\u968f\u540e\u200b\u5c31\u200b\u8fdb\u5165\u200b\u4e86\u200b\u5185\u6838\u200b\u6001\u200b\u7684\u200b\u9996\u4e2a\u200b\u51fd\u6570\u200b\uff1amain\u3002</p> <p>\uff085\uff09main\u200b\u51fd\u6570\u200b\u521d\u59cb\u5316\u200b\u4e86\u200b\u5404\u79cd\u200b\u5916\u8bbe\u200b\u7684\u200b\u9a71\u52a8\u200b\u3001\u200b\u5185\u5b58\u6a21\u5757\u200b\u3001\u200b\u8fdb\u7a0b\u200b\u6a21\u5757\u200b\u3001\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002</p> <p>\uff086\uff09\u200b\u5728\u200bmain\u200b\u51fd\u6570\u8c03\u7528\u200b\u7684\u200buserinit()\u200b\u91cc\u9762\u200b\uff0cxv6\u200b\u5728\u200b\u5185\u6838\u200b\u52a0\u8f7d\u200b\u4e86\u200b\u7b2c\u4e00\u4e2a\u200b\u7528\u6237\u7a0b\u5e8f\u200binitcode\uff0c\u200b\u53ea\u6709\u200b\u4e0d\u5230\u200b100\u200b\u5b57\u8282\u200b\u3002\u200b\u8fd9\u4e2a\u200b\u7a0b\u5e8f\u8fd0\u884c\u200b\u65f6\u200b\u53ea\u200b\u5360\u7528\u200b\u4e00\u4e2a\u200b\u5185\u5b58\u200b\u9875\u200b\uff08\u200b\u6570\u636e\u200b\u6765\u81ea\u200binitcode\uff09\uff0c\u200b\u8fd9\u4e2a\u200b\u9875\u200b\u517c\u5177\u200b\u4ee3\u7801\u6bb5\u200b\u3001\u200b\u6570\u636e\u200b\u6bb5\u200b\u3001\u200b\u6808\u200b\u7684\u200b\u529f\u80fd\u200b\u3002</p> <p>\uff087\uff09\u200b\u4ece\u200bmain\u200b\u51fd\u6570\u200b\u8fdb\u5165\u200bscheduler\u200b\u51fd\u6570\u200b\uff08\u200b\u8c03\u5ea6\u200b\u5668\u200b\uff09\u200b\u4e4b\u540e\u200b\uff0cscheduler\u200b\u8c03\u5ea6\u200b\u5230\u200b\u521d\u59cb\u200b\u8fdb\u7a0b\u200binitcode\uff0c\u200b\u5b83\u200b\u53ea\u200b\u505a\u200b\u4e00\u4ef6\u200b\u4e8b\u200b\uff1a\u200b\u8fd0\u884c\u200bexec(\u201c/init\u201d)\uff0c\u200b\u7136\u540e\u200b\u8fdb\u5165\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u3002\u200b\u8fd9\u6837\u200b\uff0cxv6\u200b\u5df2\u7ecf\u200b\u53ef\u4ee5\u200b\u6b63\u5e38\u200b\u8fd0\u884c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u4e86\u200b\uff0c\u200b\u53ea\u8981\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u5b58\u5728\u200b\u5c31\u200b\u4f1a\u200b\u88ab\u200bCPU\u200b\u8c03\u5ea6\u200b\u8fd0\u884c\u200b\u3002</p> <p>init\u200b\u7a0b\u5e8f\u200b\u88ab\u200b\u653e\u5728\u200b\u78c1\u76d8\u200b\u4e0a\u200b\uff0c\u200b\u5b83\u200b\u5c31\u662f\u200b\u6240\u6709\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7956\u5148\u200b\uff080\u200b\u53f7\u200b\u8fdb\u7a0b\u200b\uff09\u3002</p> <ul> <li>\u200b\u4ece\u200b\u78c1\u76d8\u200b\u52a0\u8f7d\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u662f\u200bexec\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5b8c\u6210\u200b\u7684\u200b</li> <li>\u200b\u5b83\u200b\u901a\u8fc7\u200bfork+exec\u200b\u7684\u200b\u65b9\u5f0f\u200b\u542f\u52a8\u200b\u63a7\u5236\u53f0\u200b\u7a0b\u5e8f\u200bsh</li> <li>\u200b\u5b83\u200b\u4e0d\u65ad\u200b\u5730\u200b\u8c03\u7528\u200bwait(0)\u200b\u6765\u200b\u56de\u6536\u200b\u6240\u6709\u200b\u50f5\u5c38\u200b\u8fdb\u7a0b\u200b</li> <li>\u200b\u5b83\u200b\u88ab\u200b\u542f\u52a8\u200b\u540e\u200b\u4f1a\u200b\u8f93\u51fa\u200b\u4e00\u884c\u200b\u201cinit: starting sh\u201d</li> <li>sh\u200b\u7a0b\u5e8f\u200b\u662f\u200b\u63a7\u5236\u53f0\u200b\u8fdb\u7a0b\u200b\u3002\u200b\u5b83\u200b\u88ab\u200b\u542f\u52a8\u200b\u540e\u200b\u5c31\u200b\u4f1a\u200b\u8f93\u51fa\u200b'$'</li> </ul> <p>\u200b\u6709\u200b\u5174\u8da3\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u4ee5\u200b\u7528\u200bGDB\u200b\u5728\u200b<code>_entry</code>\u200b\u51fd\u6570\u200b\u5904\u200b\u6253\u65ad\u200b\u70b9\u200b\uff0c\u200b\u8c03\u8bd5\u200b\u8ddf\u8e2a\u200bxv6\u200b\u7684\u200b\u542f\u52a8\u200b\uff08\u200b\u8be6\u89c1\u200bVSCode\u200b\u56fe\u5f62\u5316\u200b\u8c03\u8bd5\u200b\u6307\u5357\u200b\uff09</p> <p>\u200b\u5728\u200b\u7406\u89e3\u200bxv6\u200b\u7684\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u540e\u200b\uff0c\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u5f00\u59cb\u200b\u7f16\u5199\u200bxv6\u200b\u542f\u52a8\u200b\u6d41\u7a0b\u200b\u5b9e\u9a8c\u200b\u4e86\u200b\uff0c\u200b\u8be6\u89c1\u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u53ca\u200b\u8981\u6c42\u200b</p>"},{"location":"lab1/part4/","title":"\u5b9e\u9a8c\u200b\u63d0\u4ea4","text":"<p>\u200b\u5b9e\u9a8c\u200b\u4e00\u200b\u63d0\u4ea4\u200b \u200b\u5b9e\u9a8c\u62a5\u544a\u200b  \u200b\u548c\u200b  \u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b(\u200b\u53ea\u200b\u63d0\u4ea4\u200bcommit.patch\u200b\u6587\u4ef6\u200b)  \u3002</p>"},{"location":"lab1/part4/#1","title":"1 \u200b\u5b9e\u9a8c\u200b\u62a5\u544a\u4f1a\u200b\u7eb3\u5165\u200b\u8bc4\u5206\u200b\uff08\u200b\u867d\u7136\u200b\u4e0d\u200b\u591a\u200b\uff09","text":"<p>\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u8981\u6c42\u200b \u200b\u56de\u7b54\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u5e76\u200b\u5199\u51fa\u200b\u5b9e\u9a8c\u8bbe\u8ba1\u200b\u601d\u8def\u200b\u548c\u200b\u8fd0\u884c\u200b\u7ed3\u679c\u200b \u3002</p> <p>\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u4e5f\u200b\u662f\u200b\u8bc1\u660e\u200b\u5b9e\u9a8c\u200b\u662f\u200b\u72ec\u7acb\u200b\u5b8c\u6210\u200b\u7684\u200b\u91cd\u8981\u4f9d\u636e\u200b\uff0c\u200b\u6709\u200b\u5206\u6570\u200b\u8ffd\u6c42\u200b\u7684\u200b\u5927\u4f6c\u200b\uff08juanwang\uff09\u200b\u4eec\u200b\u4e0d\u8981\u200b\u53ea\u653e\u200b\u4ee3\u7801\u200b\u548c\u200b\u6307\u5bfc\u4e66\u200b\u7684\u200b\u622a\u56fe\u200b\u3002</p>"},{"location":"lab1/part4/#2-commitpatch","title":"2 \u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b(\u200b\u53ea\u200b\u63d0\u4ea4\u200bcommit.patch\u200b\u6587\u4ef6\u200b)","text":"<p>\u200b\u4e0d\u200b\u9700\u8981\u200b\u63d0\u4ea4\u200b\u5b8c\u6574\u200b\u7684\u200b\u4ee3\u7801\u200b\u5305\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u63d0\u4ea4\u200bcommit.patch\u200b\u6587\u4ef6\u200b\u5373\u53ef\u200b\uff0c\u200b\u64cd\u4f5c\u6b65\u9aa4\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>\u200b\u5728\u200b\u5b8c\u6210\u200b\u5b9e\u9a8c\u200b\u4e4b\u540e\u200b\uff0c\u200b\u5c06\u200b\u5f53\u524d\u200b\u5206\u652f\u200b\u4e0a\u200b\u7684\u200b\u6240\u6709\u200b\u66f4\u6539\u200b\u8fdb\u884c\u200b\u63d0\u4ea4\u200b\uff08commit\uff0c\u200b\u5177\u4f53\u65b9\u6cd5\u200b\u53c2\u8003\u200bgit\u200b\u4f7f\u7528\u200b\u6559\u7a0b\u200b\uff09</li> <li>\u200b\u5728\u200b\u4ed3\u5e93\u200b\u7684\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u4f7f\u7528\u200b<code>make diff</code>\u200b\u547d\u4ee4\u200b\u5bfc\u51fa\u200b\u66f4\u6539\u200b\u6587\u4ef6\u200b\uff08commit.patch\uff09</li> <li>\u200b\u5c06\u200b \u200b\u751f\u6210\u200b\u7684\u200bcommit.patch\u200b\u6587\u4ef6\u200b \u200b\u4e0e\u200b \u200b\u5b9e\u9a8c\u62a5\u544a\u200b \u200b\u4e00\u8d77\u200b\u6253\u5305\u200b\u63d0\u4ea4\u200b\u5230\u200b\u4f5c\u4e1a\u200b\u63d0\u4ea4\u200b\u5e73\u53f0\u200b\u5373\u53ef\u200b</li> </ul> <p>\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u5927\u5bb6\u200b\u6ce8\u610f\u200b\u4fdd\u5b58\u200b\u597d\u200b\u81ea\u5df1\u200b\u7684\u200b\u4ee3\u7801\u200b\uff0c\u200b\u4fdd\u5b58\u200b\u4ee3\u7801\u200b\u7684\u200b\u4e24\u4e2a\u200b\u65b9\u6cd5\u200b\uff1a</p> <p>\uff081\uff09\u200b\u628a\u200b\u6574\u4e2a\u200bxv6-oslab23-hitsz\u200b\u76ee\u5f55\u200b\u6253\u5305\u200b\uff0c\u200b\u7136\u540e\u200b\u7528\u200bscp\u200b\u6216\u8005\u200bmobaXterm\u200b\u5de5\u5177\u200b\u7684\u200bsftp\u200b\u62f7\u8d1d\u200b\u51fa\u6765\u200b\uff0c\u200b\u81ea\u884c\u200b\u4fdd\u5b58\u200b\u597d\u200b\u6574\u4e2a\u200b\u5de5\u7a0b\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4ee5\u5907\u200b\u4e0b\u6b21\u200b\u5b9e\u9a8c\u200b\u4f7f\u7528\u200b\u3002</p> <p>\uff082\uff09\u200b\u5f3a\u70c8\u63a8\u8350\u200b \u200b\u5c06\u200b\u4ee3\u7801\u200b\u63d0\u4ea4\u200b\u5230\u200b\u81ea\u5df1\u200b\u7684\u200bGithub/Gitee\u200b\u7b49\u200b\u4ee3\u7801\u200b\u6258\u7ba1\u200b\u670d\u52a1\u5668\u200b\u4e0a\u200b\uff0c\u200b\u5177\u4f53\u64cd\u4f5c\u200b\u8be6\u89c1\u200b\u5c06\u200b\u4ee3\u7801\u200b\u53d1\u5e03\u200b\u81f3\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002</p>"},{"location":"lab1/part4/#3-git","title":"3 git\u200b\u4f7f\u7528\u200b\u6559\u7a0b","text":"<p>git\u200b\u4f5c\u4e3a\u200b\u5f00\u53d1\u8005\u200b\u5e38\u7528\u200b\u7684\u200b\u5f00\u6e90\u200b\u5206\u5e03\u5f0f\u200b\u7248\u672c\u200b\u63a7\u5236\u7cfb\u7edf\u200b\uff0c\u200b\u5728\u200b\u4f7f\u7528\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u8fdb\u884c\u200b\u5f00\u53d1\u200b\u65f6\u200b\u5177\u6709\u200b\u4e0d\u53ef\u6216\u7f3a\u200b\u7684\u200b\u4f5c\u7528\u200b\u3002</p> <p>\u200b\u8fd9\u91cc\u200b\u6709\u200b\u8be6\u7ec6\u200b\u7684\u200bGit\u200b\u5206\u652f\u200b\u6559\u7a0b\u200b  \uff0c\u200b\u53ef\u4ee5\u200b\u5e2e\u52a9\u200b\u5927\u5bb6\u200b\u7406\u89e3\u200bGit\u200b\u7684\u200b\u5206\u652f\u200b\u7a76\u7adf\u200b\u662f\u200b\u600e\u4e48\u56de\u4e8b\u200b\uff1a\u201cLearning Git Branching\u201d \uff0chttps://learngitbranching.js.org/?locale=zh_CN</p> <ul> <li> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u60f3\u8981\u200b\u5efa\u7acb\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5e76\u4e14\u200b\u540c\u6b65\u200b\u81ea\u5df1\u200b\u7684\u200b\u4ee3\u7801\u200b\u3001\u200b\u5efa\u7acb\u200b\u4e00\u6574\u5957\u200b\u5b8c\u6574\u200b\u7684\u200b\u5de5\u4f5c\u200b\u6d41\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8bf7\u200b\u76f4\u63a5\u200b\u9605\u8bfb\u200b\u5c06\u200b\u4ee3\u7801\u200b\u53d1\u5e03\u200b\u81f3\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u90a3\u91cc\u200b\u975e\u5e38\u200b\u8be6\u7ec6\u200b\u5730\u200b\u4ecb\u7ecd\u200b\u4e86\u200b\u6574\u4e2a\u200b\u6d41\u7a0b\u200b\u3002</p> </li> <li> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u53ea\u662f\u200b\u60f3\u8981\u200b\u63d0\u4ea4\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\uff0c\u200b\u90a3\u4e48\u200b\u6309\u7167\u200b\u4e0b\u9762\u200b\u7684\u200b\u6d41\u7a0b\u200b\u5373\u53ef\u200b\u3002</p> </li> </ul>"},{"location":"lab1/part4/#git","title":"\u914d\u7f6e\u200bgit","text":"<p>\u200b\u5728\u200b\u4f7f\u7528\u200bgit\u200b\u63d0\u4ea4\u200b\u4e4b\u524d\u200b\u9700\u8981\u200b\u8fdb\u884c\u200b\u914d\u7f6e\u200b\uff1a</p> <pre><code>git config --global user.name \"\u200b\u4f60\u200b\u7684\u200b\u7528\u6237\u540d\u200b\"\ngit config --global user.email \"\u200b\u4f60\u200b\u7684\u200b\u90ae\u7bb1\u200b\"\n</code></pre> <p>\u200b\u7528\u6237\u540d\u200b\u548c\u200b\u90ae\u7bb1\u200b\u5177\u4f53\u200b\u662f\u200b\u4ec0\u4e48\u200b\u4e0d\u200b\u91cd\u8981\u200b\uff0c\u200b\u4f46\u200b\u4e0d\u80fd\u200b\u6ca1\u6709\u200b\uff0c\u200b\u968f\u610f\u200b\u586b\u5199\u200b\u5373\u53ef\u200b\u3002</p>"},{"location":"lab1/part4/#_2","title":"\u63d0\u4ea4\u200b\u672c\u5730\u200b\u4fee\u6539","text":"<p>\u200b\u5728\u200b\u90e8\u7f72\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u90e8\u5206\u200b\u5927\u5bb6\u200b\u5df2\u7ecf\u200b\u5c06\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u5b98\u65b9\u200b\u4ed3\u5e93\u200bclone\u200b\u4e0b\u6765\u200b\u3001\u200b\u5e76\u4e14\u200b\u5728\u200b\u8be5\u200b\u4ed3\u5e93\u200b\u91cc\u200b\u5b8c\u6210\u200b\u4e86\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u90a3\u4e48\u200b\u63d0\u4ea4\u200b\u6211\u4eec\u200b\u7684\u200b\u4ee3\u7801\u200b\u65f6\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u5c06\u200b\u81ea\u5df1\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u6539\u52a8\u200b\u6682\u5b58\u200b(add)\u200b\u5e76\u200b\u63d0\u4ea4\u200b(commit)\u200b\u5373\u53ef\u200b\uff0c\u200b\u5728\u200b\u9879\u76ee\u200b\u7684\u200b\u6839\u76ee\u5f55\u200b\u6267\u884c\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\uff1a</p> <pre><code>git add .\ngit commit -m \"\u200b\u4f60\u200b\u7684\u200b\u63d0\u4ea4\u200b\u65e5\u5fd7\u200b\"\n</code></pre> <p>\u200b\u826f\u597d\u200b\u7684\u200b\u63d0\u4ea4\u200b\u65e5\u5fd7\u200b\u6709\u52a9\u4e8e\u200b\u522b\u4eba\u200b\u5feb\u901f\u200b\u7684\u200b\u4e86\u89e3\u200b\u4f60\u200b\u7684\u200b\u5de5\u4f5c\u200b\uff0c\u200b\u5e76\u4e14\u200b\u4fbf\u4e8e\u200b\u540e\u7eed\u200b\u7684\u200b\u7248\u672c\u200b\u7ba1\u7406\u200b\u548c\u200b\u4ed3\u5e93\u200b\u7684\u200b\u7ef4\u62a4\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u60f3\u200b\u5b66\u4e60\u200b\u5982\u4f55\u200b\u5199\u200b\u597d\u200bcommit\u200b\u65e5\u5fd7\u200b\uff0c\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u4f60\u200b\u67e5\u770b\u200bcommit\u200b\u89c4\u8303\u200b\u3002</p>"},{"location":"lab1/part4/#_3","title":"\u83b7\u53d6\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u6539\u52a8","text":"<p>\u200b\u5f53\u200b\u6211\u4eec\u200b\u63d0\u4ea4\u200b\u5b8c\u200b\u4ee3\u7801\u200b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u7684\u200b\u9879\u76ee\u200b\u4fbf\u200b\u5b58\u50a8\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u7248\u672c\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u65f6\u5019\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\u5373\u53ef\u200b\u83b7\u53d6\u200b\u8fd9\u4e2a\u200b\u65b0\u200b\u7684\u200b\u7248\u672c\u200b\u8ddf\u200b\u539f\u5148\u200b\u7248\u672c\u200b\u4e4b\u95f4\u200b\u7684\u200b\u5dee\u5f02\u200b\uff0c\u200b\u5373\u200b\u6211\u4eec\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u6539\u52a8\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u8fd9\u6b21\u200b\u5b9e\u9a8c\u200b\u9700\u8981\u200b\u63d0\u4ea4\u200b\u7684\u200b\u4e1c\u897f\u200b\uff1a</p> <pre><code>make diff\n</code></pre> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u5982\u679c\u200b\u8be5\u200b\u547d\u4ee4\u200b\u6267\u884c\u200b\u51fa\u73b0\u200b\u62a5\u9519\u200b\uff1a <code>fatal:\u00a0ambiguous\u00a0argument\u00a0syscall-base':\u00a0unknown\u00a0revision\u00a0or\u00a0path\u00a0not\u00a0in\u00a0the\u00a0working tree.</code> \u200b\u90a3\u4e48\u200b\u8bc1\u660e\u200b\u4f60\u200b\u5f53\u524d\u200b\u7684\u200b\u4ed3\u5e93\u200b\u5e76\u200b\u6ca1\u6709\u200b\u83b7\u53d6\u200b\u5230\u200b\u6211\u4eec\u200b\u5728\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u91cc\u9762\u200b\u51bb\u7ed3\u200b\u7684\u200b\u4ed3\u5e93\u200b\u7248\u672c\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b<code>syscall-base</code>\u200b\u8fd9\u4e2a\u200btag\uff0c\u200b\u6211\u4eec\u200b\u6240\u6709\u200b\u7684\u200b\u66f4\u6539\u200b\u90fd\u200b\u662f\u200b\u8ddf\u200b\u8fd9\u4e2a\u200btag\u200b\u6765\u200b\u6bd4\u200b\u5bf9\u200b\u51fa\u6765\u200b\u7684\u200b\u3002</p> <p>\u200b\u6240\u4ee5\u200b\u4f60\u200b\u9700\u8981\u200b\u5c06\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u4e2d\u200b\u7684\u200btag\u200b\u83b7\u53d6\u200b\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u4f60\u200b\u76f4\u63a5\u200b<code>fetch</code>\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u7684\u200b\u6240\u6709\u200b\u66f4\u6539\u200b\uff1a <code>git fetch \u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5728\u200b\u672c\u5730\u200b\u7684\u200b\u6807\u5fd7\u200b</code> \u200b\u8fd9\u4e2a\u200b \u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5728\u200b\u672c\u5730\u200b\u6807\u5fd7\u200b \u200b\u6307\u200b\u7684\u200b\u662f\u200b\uff1a  \u200b\u4e0a\u56fe\u200b\u4e2d\u200b\u7684\u200b \u200b\u7ea2\u8272\u200b\u65b9\u6846\u200b \u200b\u5185\u200b\u7684\u200b\u5c31\u662f\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5728\u200b\u672c\u5730\u200b\u7684\u200b\u6807\u5fd7\u200b\uff0c\u200b\u4f46\u662f\u200b\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u6211\u4eec\u200b\u6709\u200b\u591a\u4e2a\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u7684\u200b\u65f6\u5019\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b<code>fetch</code>\u200b\u7684\u200b\u5bf9\u8c61\u200b\u4e00\u5b9a\u200b\u662f\u200b\u8ddf\u200b \u200b\u9ec4\u8272\u200b\u65b9\u6846\u200b \u200b\u4e2d\u200b\u7684\u200b\u7f51\u5740\u200b\u4e00\u6837\u200b\u7684\u200b\uff08\u200b\u4e5f\u200b\u5c31\u662f\u200b\u6211\u4eec\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u4e0d\u662f\u200b\u81ea\u5df1\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff09\uff01</p> <p>\u200b\u6267\u884c\u200b\u5b8c\u8be5\u200b\u547d\u4ee4\u200b\u540e\u4f1a\u200b\u5728\u200b\u9879\u76ee\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u751f\u6210\u200b\u4e00\u4e2a\u200b commit.patch \u200b\u6587\u4ef6\u200b\uff0c\u200b\u8be5\u200b\u6587\u4ef6\u200b\u8bb0\u5f55\u200b\u4e86\u200b\u8fd9\u6b21\u200b\u5b9e\u9a8c\u200b\u6211\u4eec\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u6240\u6709\u200b\u66f4\u6539\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u4f60\u200b\u9700\u8981\u200b\u63d0\u4ea4\u200b\u7684\u200b \u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff0c\u200b\u5c06\u200b\u5176\u200b\u62f7\u8d1d\u5230\u200b\u672c\u5730\u200b\u7535\u8111\u200b\uff0c\u200b\u518d\u200b\u8ddf\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u4e00\u8d77\u200b\u6253\u5305\u200b\u4e0a\u4f20\u200b\u81f3\u200b\u4f5c\u4e1a\u200b\u63d0\u4ea4\u200b\u5e73\u53f0\u200b\u5373\u53ef\u200b\u3002</p>"},{"location":"lab2/part1/","title":"\u5b9e\u9a8c\u200b\u6982\u8ff0","text":"<p>\u200b\u6e29\u200b\uff08\u200b\u5b88\u200b\uff09\u200b\u99a8\u200b\uff08\u200b\u4f4f\u200b\uff09\u200b\u63d0\u200b\uff08\u200b\u7ea2\u200b\uff09\u200b\u793a\u200b\uff08\u200b\u7ebf\u200b\uff09</p> <p>\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u5df2\u200b\u5f15\u5165\u200b\u4ee3\u7801\u200b\u81ea\u52a8\u200b\u67e5\u91cd\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u4fdd\u6301\u200b\u5b66\u672f\u200b\u8bda\u4fe1\u200b\uff01</p> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u672c\u200b\u8282\u200b\u5b9e\u9a8c\u200b\u4e0e\u200b\u7406\u8bba\u8bfe\u200b\u7684\u200b \u200b\u5bfc\u8bba\u200b\u4e0e\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7ed3\u6784\u200b \u200b\u548c\u200b \u200b\u8fdb\u7a0b\u200b\u4e0e\u200b\u7ebf\u7a0b\u200b\uff1a\u200b\u8fdb\u7a0b\u200b \u200b\u8fd9\u200b\u4e24\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u76f8\u5173\u200b\uff0c\u200b\u5728\u200b\u5f00\u59cb\u200b\u5b9e\u9a8c\u200b\u524d\u200b\uff0c\u200b\u8bf7\u200b\u590d\u4e60\u200b\u8fd9\u200b\u4e24\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u3002</p> <ul> <li> <p>\u200b\u7279\u522b\u200b\u63a8\u8350\u200b\u540c\u5b66\u200b\u4eec\u200b\u89c2\u770b\u200b\u6211\u6821\u200b\u7684\u200bXV6\u200b\u8bb2\u89e3\u200b\u89c6\u9891\u200b\uff1a</p> <ul> <li>HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e8c\u200b\uff09\u200b\u8fdb\u7a0b\u200b\u7ba1\u7406\u200b</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> <li> <p>B\u200b\u7ad9\u4e0a\u200b\u7684\u200bMIT 6.S081/Fall 2020\u200b\u8bfe\u7a0b\u200b\u89c6\u9891\u200b\uff1a</p> <ul> <li> <p>Lecture 3 - OS Organization and System Calls </p> </li> <li> <p>Lecture 6 - Isolation &amp; System Call Entry_Exit</p> </li> </ul> </li> <li> <p>xv6 book, Sections 4.3 and 4.4 of Chapter 4</p> </li> <li>\u200b\u63a8\u8350\u200b\u540c\u5b66\u200b\u4eec\u200b\u7528\u200bGDB\u200b\u8ddf\u8e2a\u200bXV6\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u8be6\u7ec6\u200b\u6b65\u9aa4\u200b\u8bf7\u200b\u67e5\u770b\u200bVSCode\u200b\u8c03\u8bd5\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u6307\u5357\u200b</li> </ul>"},{"location":"lab2/part1/#1","title":"1.  \u200b\u5b9e\u9a8c\u200b\u76ee\u7684","text":"<p>\u200b\u672c\u200b\u8282\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u76ee\u7684\u200b\u662f\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u6a21\u5757\u200b\u8fdb\u884c\u200b\u4fee\u6539\u200b\uff0c\u200b\u5c3d\u53ef\u80fd\u200b\u5728\u200b\u771f\u6b63\u200b\u4fee\u6539\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e4b\u524d\u200b\uff0c\u200b\u5148\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u6709\u200b\u4e00\u5b9a\u200b\u7684\u200b\u4e86\u89e3\u200b\u3002</p> <ol> <li>\u200b\u4e86\u89e3\u200bxv6\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5de5\u4f5c\u200b\u539f\u7406\u200b\u3002</li> <li>\u200b\u719f\u6089\u200bxv6\u200b\u901a\u8fc7\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7ed9\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u63d0\u4f9b\u200b\u670d\u52a1\u200b\u7684\u200b\u673a\u5236\u200b\u3002</li> <li>\u200b\u719f\u6089\u200b\u8fdb\u7a0b\u200b\u4e0a\u4e0b\u6587\u200b\u5207\u6362\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u3002</li> <li>\u200b\u4e86\u89e3\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5b8c\u6574\u200b\u751f\u547d\u5468\u671f\u200b\u3002</li> </ol>"},{"location":"lab2/part1/#2","title":"2.  \u200b\u5b9e\u9a8c\u200b\u5b66\u65f6","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e3a\u200b4\u200b\u5b66\u65f6\u200b\u3002</p>"},{"location":"lab2/part1/#3","title":"3.  \u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u53ca\u200b\u8981\u6c42","text":"<p>\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b<code>MIT XV6 lab2</code>\u200b\u548c\u200b<code>lab4</code>\u200b\u63d0\u4f9b\u200b\u7684\u200b\u90e8\u5206\u200b\u5b98\u65b9\u200b\u8bf4\u660e\u200b\uff1a[Lab: System calls(mit.edu)] \u3001[Lab: Trap(mit.edu)]\uff0c \u200b\u4f46\u200b\u8bf7\u200b\u4ee5\u200b\u6307\u5bfc\u4e66\u200b\u4e3a\u51c6\u200b\uff0c\u200b\u5426\u5219\u200b\u53ef\u80fd\u200b\u65e0\u6cd5\u200b\u901a\u8fc7\u200b\u6d4b\u8bd5\u200b\uff01 </p>"},{"location":"lab2/part1/#31","title":"3.1 \u200b\u5207\u6362\u200b\u5206\u652f","text":"<p>\u200b\u8bf7\u200b\u5148\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u5e76\u200b\u6ce8\u610f\u200b\u5207\u6362\u200b\u5230\u200bsyscall\u200b\u5206\u652f\u200b\u8fdb\u884c\u200b\u8bd5\u9a8c\u200b</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u57fa\u4e8e\u200bsyscall\u200b\u5206\u652f\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u6ce8\u610f\u200b\u5207\u6362\u200b\u3002</p> <p>Step 1. \u200b\u9996\u5148\u200b\uff0c\u200b\u4fdd\u5b58\u200b\u5b9e\u9a8c\u200b\u4e00\u200b\u7684\u200b\u4ee3\u7801\u200b\uff0c\u200b\u8bf7\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u5b9e\u7528\u5de5\u5177\u200b\u7684\u200b3.3.1 \u200b\u4f7f\u7528\u200b\u547d\u4ee4\u884c\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u6216\u8005\u200b3.3.2 \u200b\u4f7f\u7528\u200bVSCode\u200b\u5185\u5efa\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u8fd9\u200b\u4e24\u200b\u5c0f\u8282\u200b\uff0c\u200b\u5b8c\u6210\u200bcommit\u200b\u64cd\u4f5c\u200b\u3002\u200b\u6216\u8005\u200b\uff0c \u200b\u5982\u679c\u200b\u4f60\u200b\u5e0c\u671b\u200b\u76f4\u63a5\u200b\u653e\u5f03\u200b\u6389\u200b\u4e0a\u200b\u4e00\u6b21\u200bcommit\u200b\u540e\u200b\u7684\u200b\u6240\u6709\u200b\u66f4\u6539\u200b \uff0c\u200b\u90a3\u4e48\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b-f\u200b\u9009\u9879\u200b\u5f3a\u5236\u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff0c\u200b\u4f8b\u5982\u200b<code>git checkout -f syscall</code>\u3002</p> <p>Step 2. \u200b\u5207\u6362\u200b\u7684\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b -&gt; \u200b\u5b9e\u9a8c\u200b\u5b9e\u7528\u5de5\u5177\u200b -&gt; 3.1\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b ~ 3.3.3 \u200b\u5408\u5e76\u200b\u51b2\u7a81\u200b\u66f4\u6539\u200b\u3002</p> <p>\u200b\u540c\u5b66\u200b\u4eec\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u4e0b\u9762\u200b\u7684\u200b\u56fe\u7247\u200b\u8fdb\u884c\u200b\u5206\u652f\u200b\u5207\u6362\u200b\uff1a</p> <p></p> <p>\u200b\u5982\u56fe\u6240\u793a\u200b\uff0c</p> <ol> <li>\u200b\u901a\u8fc7\u200b<code>git remote -v</code>\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u6b64\u65f6\u200b\u5173\u8054\u200b\u7684\u200b\u6240\u6709\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u7136\u540e\u200b\u4ece\u4e2d\u200b\u627e\u51fa\u200b\u5bf9\u5e94\u200b\u7684\u200b\u94fe\u63a5\u200b\u662f\u200b\u6211\u4eec\u200b\u7684\u200b\u5b98\u65b9\u200b\u4ed3\u5e93\u200b(<code>https://gitee.com/greenhandzpx/xv6-oslab23-hitsz.git</code>\u200b\u6216\u8005\u200b<code>git@gitee.com:greenhandzpx/xv6-oslab23-hitsz.git</code>)\u200b\u7684\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u540d\u5b57\u200b\uff08\u200b\u4e0a\u56fe\u200b\u4e2d\u200b\u662f\u200b<code>public</code>\uff0c\u200b\u540c\u5b66\u200b\u4eec\u200b\u53ef\u80fd\u200b\u662f\u200b<code>upstream</code>\u200b\u4e4b\u7c7b\u200b\u7684\u200b\u522b\u7684\u200b\u540d\u5b57\u200b\uff09</li> <li>\u200b\u901a\u8fc7\u200b<code>git fetch \u200b\u5b98\u65b9\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u540d\u5b57\u200b</code>\u200b\u83b7\u53d6\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u7684\u200b\u6240\u6709\u200b\u5206\u652f\u200b\u53ca\u200b\u6807\u7b7e\u200b</li> <li>\u200b\u901a\u8fc7\u200b<code>git checkout syscall</code>\u200b\u5207\u6362\u200b\u5230\u200b<code>syscall</code>\u200b\u5206\u652f\u200b</li> <li>\u200b\u901a\u8fc7\u200b<code>git pull \u200b\u5b98\u65b9\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u540d\u5b57\u200b syscall</code>\u200b\u4ee5\u200b\u83b7\u53d6\u200b<code>syscall</code>\u200b\u5206\u652f\u200b\u7684\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\u3002</li> </ol> <p>\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u540c\u5b66\u200b\u4eec\u200b\u5728\u200b\u5207\u6362\u200b\u5206\u652f\u200b\u4e4b\u540e\u200b\u8fdb\u884c\u200b<code>make clean</code>\u200b\u5c06\u200b\u4e0a\u200b\u4e00\u4e2a\u200b\u5206\u652f\u200b\u7684\u200b<code>fs.img</code>\u200b\u5220\u9664\u200b\uff0c\u200b\u4e0d\u7136\u200b\u4f1a\u200b\u51fa\u73b0\u200b\u65e0\u6cd5\u200b\u542f\u52a8\u200bqemu\u200b\u7684\u200b\u95ee\u9898\u200b\uff08\u200b\u4f1a\u200b\u663e\u793a\u200b<code>fs.img</code>\u200b\u88ab\u200b\u5176\u4ed6\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u5360\u7528\u200b\uff09\u3002</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u9700\u8981\u200b\u4e3a\u200bxv6\u200b\u5b9e\u73b0\u200b\u4e00\u4e9b\u200b\u5fc5\u8981\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u548c\u200b\u529f\u80fd\u200b\uff0c\u200b\u5728\u200b\u5b8c\u6210\u200b\u8fd9\u4e9b\u200b\u4e4b\u540e\u200b\uff0c\u200b\u4f60\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u6b63\u5e38\u200b\u4f7f\u7528\u200b<code>exittest</code>, <code>waittest</code>\u200b\u548c\u200b<code>yieldtest</code>\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b\u3002\u200b\u5177\u4f53\u6765\u8bf4\u200b\uff0c\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u6709\u200b\u4e09\u200b\u90e8\u5206\u200b\uff1a</p>"},{"location":"lab2/part1/#32","title":"3.2 \u200b\u4efb\u52a1\u200b\u4e00\u200b\uff1a\u200b\u8fdb\u7a0b\u200b\u4fe1\u606f\u200b\u6536\u96c6","text":"<p>\u200b\u5728\u200b\u8be5\u200b\u4efb\u52a1\u200b\u4e2d\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5728\u200b\u7406\u89e3\u200bxv6\u200b\u7684\u200b<code>exit</code>\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u57fa\u7840\u200b\u4e0a\u200b\uff0c\u200b\u5b9e\u73b0\u200b \u200b\u8fdb\u7a0b\u200b\u5728\u200b\u9000\u51fa\u200b\u65f6\u200b\u6253\u5370\u200b\u81ea\u5df1\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u548c\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u4fe1\u606f\u200b \u200b\u8fd9\u4e00\u200b\u529f\u80fd\u200b\u3002</p> <p>\u200b\u5177\u4f53\u200b\u8981\u6c42\u200b\uff1a\u200b\u5728\u200bexit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5f53\u4e2d\u200b\u5bfb\u627e\u200b\u5408\u9002\u200b\u7684\u200b\u8f93\u51fa\u200b\u65f6\u95f4\u200b\u70b9\u200b\uff0c\u200b\u5728\u200b\u76f8\u5e94\u200b\u7684\u200b\u51fd\u6570\u200b\u5185\u200b\u8fdb\u884c\u200b\u7236\u5b50\u200b\u8fdb\u7a0b\u200b\u4fe1\u606f\u200b\u7684\u200b\u6253\u5370\u200b\u3002 </p>"},{"location":"lab2/part1/#321-exit","title":"3.2.1 exit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u529f\u80fd","text":"<p><code>void exit(int status)</code></p> <ol> <li>\u200b\u53c2\u6570\u200b<code>status</code> \uff1a\u200b\u9000\u51fa\u200b\u72b6\u6001\u200b\uff0c0\u200b\u8868\u793a\u200b\u6b63\u5e38\u200b\u9000\u51fa\u200b\uff0c-1\uff08\u200b\u5927\u90e8\u5206\u200b\uff09\u200b\u8868\u793a\u200b\u5f02\u5e38\u200b\u9000\u51fa\u200b\u3002  </li> <li>\u200b\u8fd4\u56de\u503c\u200b \uff1a\u200b\u65e0\u200b\uff0c\u200b\u51fd\u6570\u8c03\u7528\u200bexit\u200b\u4e4b\u540e\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u5728\u200b\u5185\u6838\u200b\u6001\u200b\u8fdb\u884c\u200bexit\u200b\u76f8\u5173\u200b\u7684\u200b\u8d44\u6e90\u200b\u56de\u6536\u200b\u4e4b\u540e\u200b\uff0c\u200b\u5bf9\u5e94\u200b\u8fdb\u7a0b\u200b\u7ec8\u6b62\u200b\uff0c\u200b\u4e0d\u4f1a\u200b\u8fd4\u56de\u200b\u3002  </li> <li>\u200b\u529f\u80fd\u200b \uff1a\u200b\u56de\u6536\u200b\u8fdb\u7a0b\u200b\u8d44\u6e90\u200b\uff0c\u200b\u56de\u6536\u200b\u5b8c\u6bd5\u200b\u4e4b\u540e\u200b\u7ec8\u6b62\u200b\u8fdb\u7a0b\u200b\u3002  <ul> <li>exit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5728\u200b\u5904\u7406\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8d44\u6e90\u200b\u65f6\u200b\uff0c\u200b\u5927\u81f4\u200b\u6d41\u7a0b\u200b\u4e3a\u200b\uff1a\u200b\u5173\u95ed\u200b\u6240\u6709\u200b\u6253\u5f00\u200b\u6587\u4ef6\u200b -&gt; \u200b\u8c03\u7528\u200breparent\u200b\u5c06\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u6240\u6709\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u4ea4\u7ed9\u200b\u521d\u59cb\u200b\u8fdb\u7a0b\u200binit -&gt; \u200b\u66f4\u6539\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u72b6\u6001\u200b -&gt; \u200b\u624b\u52a8\u200b\u8fdb\u5165\u200b\u8c03\u5ea6\u200b\u5668\u200b\uff08\u200b\u7b49\u5f85\u200b\u56de\u6536\u200b\uff09\u3002\u200b\u8be6\u7ec6\u200b\u539f\u7406\u200b\u8bf7\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u90e8\u5206\u200b\u3002  </li> <li>\u200b\u672c\u200b\u4efb\u52a1\u200b \u200b\u9700\u8981\u200b\u5b8c\u6210\u200b \u200b\u7684\u200b\u4fe1\u606f\u200b\u8f93\u51fa\u200b\u683c\u5f0f\u200b\uff1a \u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u4fe1\u606f\u200b\u8f93\u51fa\u200b\u683c\u5f0f\u200b \uff1a <code>proc PID exit, parent pid PID, name NAME, state STATE</code> \u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u4fe1\u606f\u200b\u8f93\u51fa\u200b\u683c\u5f0f\u200b \uff1a<code>proc PID exit, child CHILD_NUM, pid PID, name NAME, state STATE</code> \u200b\u5176\u4e2d\u200b\uff0cPID\u200b\u4ee3\u8868\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u53f7\u200b\uff0cCHILD_NUM\u200b\u8868\u793a\u200b\u8be5\u200b\u4fe1\u606f\u200b\u662f\u200b\u7b2c\u51e0\u4e2a\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u4fe1\u606f\u200b\uff0cNAME\u200b\u8868\u793a\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u6216\u8005\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u540d\u200b\uff0cSTATE\u200b\u8868\u793a\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u6216\u5b50\u200b\u8fdb\u7a0b\u200b\u72b6\u6001\u200b\uff0c\u200b\u6ce8\u610f\u200b\uff1a\u200b\u8fd9\u91cc\u200b\u7edf\u4e00\u200b\u7528\u200b\u5c0f\u5199\u5b57\u6bcd\u200b\u8868\u793a\u200b\u8fdb\u7a0b\u200b\u72b6\u6001\u200b\u3002</li> </ul> </li> </ol> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u5927\u5bb6\u200b\u4e0d\u8981\u200b\u4f7f\u7528\u200bprintf\u200b\u8f93\u51fa\u200b\uff0c \u200b\u8bf7\u200b\u4f7f\u7528\u200b\u6211\u4eec\u200b\u4e3a\u200b\u5927\u5bb6\u200b\u5c01\u88c5\u200b\u597d\u200b\u7684\u200b<code>exit_info</code>\u200b\u51fd\u6570\u200b\u8f93\u51fa\u200b \uff0c<code>exit_info</code>\u200b\u63d0\u4f9b\u200b\u4e0d\u540c\u200b\u989c\u8272\u200b\u548c\u200b\u6807\u8bb0\u200b\u7684\u200b\u8f93\u51fa\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u66f4\u52a0\u200b\u6e05\u6670\u200b\u5730\u200b\u770b\u51fa\u200b\u54ea\u4e9b\u200b\u662f\u200b\u672c\u200b\u4efb\u52a1\u200b\u9700\u8981\u200b\u7684\u200b\u6253\u5370\u8f93\u51fa\u200b\u3002</p> <p>\u200b\u8be5\u200b\u51fd\u6570\u200b\u7684\u200b\u4f7f\u7528\u200b\u65b9\u6cd5\u200b\u4e0e\u200bprintf\u200b\u4e00\u6837\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a<code>exit_info(\"proc %d exit\\n\", p-&gt;pid);</code></p>"},{"location":"lab2/part1/#322","title":"3.2.2 \u200b\u8fd0\u884c\u200b\u7ed3\u679c","text":"<p>\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u4e2a\u200bexittest\uff08\u200b\u89c1\u200b <code>user/exittest.c</code>\uff09\u200b\u7528\u6237\u200b\u7ea7\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\uff0c\u200b\u8be5\u200b\u7a0b\u5e8f\u200b\u9996\u5148\u200b\u901a\u8fc7\u200bfork\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u521b\u5efa\u200b3\u200b\u4e2a\u5b50\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u5e76\u200b\u901a\u8fc7\u200bsleep\u200b\u4fdd\u8bc1\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u5728\u200b\u9000\u51fa\u200b\u65f6\u5b50\u200b\u8fdb\u7a0b\u200b\u8fd8\u200b\u6ca1\u6709\u200b\u9000\u51fa\u200b\uff0c\u200b\u7136\u540e\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u5148\u200b\u9000\u51fa\u200b\uff0c3\u200b\u4e2a\u5b50\u200b\u8fdb\u7a0b\u200b\u518d\u200b\u9000\u51fa\u200b\u3002</p> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u5927\u5bb6\u200b\u4e0d\u8981\u200b\u4fee\u6539\u200b <code>user/exittest.c</code>\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\uff0c\u200b\u5b83\u200b\u53ea\u662f\u200b\u7528\u4e8e\u200b\u6d4b\u8bd5\u200b3.2.1 exit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u529f\u80fd\u200b\u3002</p> <p>\u200b\u5728\u200b\u4f60\u200b\u5b9e\u73b0\u200b\u5b8c\u200b\u4e0a\u8ff0\u200b\u529f\u80fd\u200b\u4e4b\u540e\u200b\uff0c\u200b\u8fd0\u884c\u200b\u7528\u6237\u7a0b\u5e8f\u200b exittest\u200b\u8fd0\u884c\u200b\u6b63\u786e\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u4ee5\u4e0b\u200b\u8f93\u51fa\u200b\uff1a</p> <pre><code>[cs@localhost xv6-oslab23-hitsz]$ make qemu\n\n/* \u200b\u4e00\u5927\u200b\u6ce2\u200b\u8f93\u51fa\u200b \u2026\u2026 */\n\nxv6 kernel is booting\n\nhart 1 starting\nhart 2 starting\ninit: starting sh\n$\n\n/* \u200b\u624b\u52a8\u200b\u8f93\u5165\u200bexittest */\n\n$ exittest\nexit test\n[INFO] proc 3 exit, parent pid 2, name sh, state sleep\n[INFO] proc 3 exit, child 0, pid 4, name child0, state sleep\n[INFO] proc 3 exit, child 1, pid 5, name child1, state sleep\n[INFO] proc 3 exit, child 2, pid 6, name child2, state sleep\n$ [INFO] proc 5 exit, parent pid 1, name init, state runble\n[INFO] proc 4 exit, parent pid 1, name init, state run\n[INFO] proc 6 exit, parent pid 1, name init, state run\n</code></pre> <p>\u200b\u6211\u4eec\u200b\u5148\u200b\u4e0d\u200b\u7740\u6025\u200b\u52a8\u624b\u200b\uff0c\u200b\u5148\u200b\u770b\u770b\u200b\u7ed3\u679c\u200b\u957f\u200b\u4ec0\u4e48\u6837\u200b\u3002\u200b\u5728\u200b\u8f93\u51fa\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u5b58\u5728\u200b\u4e24\u79cd\u200b\u4e0d\u540c\u200b\u7684\u200b\u8f93\u51fa\u200b\uff1a \u200b\u5bf9\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u4fe1\u606f\u200b\u7684\u200b\u8f93\u51fa\u200b\uff1a <pre><code>[INFO] proc 3 exit, parent pid 2, name sh, state sleep\n</code></pre> \u200b\u4ee5\u53ca\u200b\u5bf9\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u4fe1\u606f\u200b\u7684\u200b\u8f93\u51fa\u200b\uff1a <pre><code>[INFO] proc 3 exit, child 0, pid 4, name child0, state sleep\n</code></pre> \u200b\u540c\u65f6\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b3\u200b\u53f7\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u5728\u200b3\u200b\u53f7\u200b\u8fdb\u7a0b\u200b\u6b7b\u540e\u200b\uff0c\u200b\u5b83\u4eec\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u90fd\u200b\u53d8\u6210\u200b\u4e86\u200binit\u200b\u8fdb\u7a0b\u200b\uff1a <pre><code>$ [INFO] proc 5 exit, parent pid 1, name init, state runble\n[INFO] proc 4 exit, parent pid 1, name init, state run\n[INFO] proc 6 exit, parent pid 1, name init, state run\n</code></pre> \u200b\u5173\u4e8e\u200b\u8fd9\u70b9\u200b\u6211\u4eec\u200b\u4f1a\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u5f53\u4e2d\u200b\u8be6\u7ec6\u200b\u4ecb\u7ecd\u200b\u3002 \u200b\u4f60\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u5c1d\u8bd5\u200b\u5728\u200b\u4e0e\u200bexit\u200b\u76f8\u5173\u200b\u7684\u200b\u51fd\u6570\u200b\u5f53\u4e2d\u200b\u627e\u5230\u200b \u200b\u5408\u9002\u200b\u7684\u200b\u4f4d\u7f6e\u200b \u200b\u6765\u200b\u8fdb\u884c\u200b\u8f93\u51fa\u200b\uff0c\u200b\u6211\u4eec\u200b\u5efa\u8bae\u200b\u4f60\u200b\u5148\u200b\u9605\u8bfb\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\uff0c\u200b\u8fd9\u4f1a\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u66f4\u597d\u200b\u7684\u200b\u4e86\u89e3\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u548c\u200bexit\u200b\u7684\u200b\u5de5\u4f5c\u200b\u6d41\u7a0b\u200b\u3002</p>"},{"location":"lab2/part1/#33-wait","title":"3.3 \u200b\u4efb\u52a1\u200b\u4e8c\u200b\uff1await\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u975e\u200b\u963b\u585e\u200b\u9009\u9879\u200b\u5b9e\u73b0","text":"<p>\u200b\u5728\u200b\u8be5\u200b\u4efb\u52a1\u200b\u4e2d\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b \u200b\u5bf9\u200bwait\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fdb\u884c\u200b\u66f4\u6539\u200b\uff0c\u200b\u4f7f\u200b\u5176\u200b\u589e\u52a0\u200b\u4e00\u4e2a\u200b\u975e\u200b\u963b\u585e\u200b\u9009\u9879\u200b\u53c2\u6570\u200b<code>int flags</code>\uff0c\u200b\u5f53\u200b<code>flags</code>\u200b\u4e3a\u200b1\u200b\u65f6\u200b\u8868\u793a\u200b\u4e0d\u200b\u9700\u8981\u200b\u8fdb\u884c\u200b\u963b\u585e\u200b\u7b49\u5f85\u200b\uff0c\u200b\u5426\u5219\u200b\u9700\u8981\u200b\u8fdb\u884c\u200b\u963b\u585e\u200b\u7b49\u5f85\u200b\u3002</p> <ul> <li> <p>\u200b\u539f\u7248\u200b\u963b\u585e\u200b\u5b9e\u73b0\u200b\u7684\u200bwait \uff1a<code>int wait(int *status)</code>\uff0c\u200b\u5176\u4e2d\u200b\u53c2\u6570\u200bstatus\u200b\u8868\u793a\u200b\u5b58\u50a8\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u9000\u51fa\u200b\u72b6\u6001\u200b\u7684\u200b\u5730\u5740\u200b\u3002\u200b\u5728\u200b<code>kernel/proc.c</code>\u200b\u5f53\u4e2d\u200b\u7684\u200bwait\u200b\u51fd\u6570\u200b\u5185\u200b\u7684\u200b\u7ed3\u5c3e\u5904\u200b\uff0cxv6\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u4ee3\u7801\u200b\u5b9e\u73b0\u200bwait\u200b\u7684\u200b\u963b\u585e\u200b\u7b49\u5f85\u200b\uff1a     <pre><code>// Wait for a child to exit.\nsleep(p, &amp;p-&gt;lock);  // DOC: wait-sleep\n</code></pre>     \u200b\u5728\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u8c03\u7528\u200b\u8be5\u200b\u51fd\u6570\u200b\u4e4b\u540e\u200b\uff0c\u200b\u901a\u8fc7\u200bsleep\u200b\u8fdb\u884c\u200b\u7761\u7720\u200b\uff0c\u200b\u65e0\u6cd5\u200b\u518d\u200b\u6267\u884c\u200b\u5176\u4ed6\u200b\u4efb\u52a1\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u963b\u585e\u200b\u5728\u200b\u8fd9\u91cc\u200b\u3002</p> </li> <li> <p>\u200b\u672c\u200b\u4efb\u52a1\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b\u7684\u200bwait \uff1a<code>int wait(int *status, int flags)</code>\uff0c\u200b\u5176\u4e2d\u200bflags\u200b\u53c2\u6570\u200b\u7528\u4ee5\u200b \u200b\u8868\u793a\u200b\u662f\u5426\u200b\u963b\u585e\u200b\u7b49\u5f85\u200b \u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u9000\u51fa\u200b\u3002\u200b\u7528\u6237\u200b\u6001\u200b\u7684\u200bwait\u200b\u63a5\u53e3\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u5e2e\u200b\u540c\u5b66\u200b\u4eec\u200b\u66f4\u6539\u200b\u4e86\u200b\uff0c\u200b\u540c\u5b66\u200b\u4eec\u200b\u9700\u8981\u200b\u5c06\u200b\u5185\u6838\u200b\u6001\u200b\u7684\u200bwait\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u66f4\u6539\u200b\u3002  </p> </li> </ul> <p>\u200b\u5177\u4f53\u6765\u8bf4\u200b\uff0c\u200b\u540c\u5b66\u200b\u4eec\u200b\u9700\u8981\u200b\uff1a</p> <ol> <li>\u200b\u5c1d\u8bd5\u200b\u5728\u200b<code>kernel/sysproc.c</code>\u200b\u7684\u200b<code>sys_wait</code>\u200b\u51fd\u6570\u200b\u4e2d\u200b\u83b7\u53d6\u200b\u65b0\u200b\u6dfb\u52a0\u200b\u7684\u200b\u53c2\u6570\u200b\uff1b</li> <li>\u200b\u66f4\u6539\u200b<code>kernel/defs.h</code>\u200b\u5934\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200bwait\u200b\u7684\u200b\u5b9a\u4e49\u200b\uff1b</li> <li>\u200b\u66f4\u6539\u200bwait\u200b\u51fd\u6570\u200b\u4ee5\u200b\u6ee1\u8db3\u200b\u5f53\u524d\u200b\u7684\u200b\u8bed\u4e49\u200b\u3002</li> </ol> <p>\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u4e2a\u200b<code>waittest</code>\u200b\u7528\u6237\u200b\u7ea7\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\uff08\u200b\u89c1\u200b<code>user/waittest.c</code>\uff09\u3002</p> <p>\u200b\u5b8c\u6210\u200b\u4efb\u52a1\u200b\u540e\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200bxv6\u200b\u4e2d\u200b\u8fd0\u884c\u200b<code>waittest</code>\u200b\u7a0b\u5e8f\u200b\uff0c\u200b\u901a\u8fc7\u200b\u6d4b\u8bd5\u200b\u4f1a\u200b\u663e\u793a\u200b\u5982\u4e0b\u200b\u5185\u5bb9\u200b\uff1a</p> <p></p>"},{"location":"lab2/part1/#34-yield","title":"3.4 \u200b\u4efb\u52a1\u200b\u4e09\u200b\uff1a\u200b\u5b9e\u73b0\u200byield\u200b\u7cfb\u7edf\u200b\u8c03\u7528","text":"<p>\u200b\u5728\u200b\u8be5\u200b\u4efb\u52a1\u200b\u4e2d\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b\u4e00\u4e2a\u200b \u200b\u65b0\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b <code>yield</code>\uff0c\u200b\u5b83\u200b\u53ef\u4ee5\u200b\u4f7f\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u8ba9\u51fa\u200bCPU\uff0c\u200b\u4ece\u800c\u200b\u4f7f\u200bCPU\u200b\u53ef\u4ee5\u200b\u8c03\u5ea6\u200b\u5230\u200b\u522b\u7684\u200b\u8fdb\u7a0b\u200b\u3002\u200b\u5f53\u7136\u200b\uff0c\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u53ea\u662f\u200b\u6682\u65f6\u200b\u88ab\u200b\u6302\u200b\u8d77\u200b\uff0c\u200b\u6839\u636e\u200b\u6211\u4eec\u200b\u5728\u200b\u8bfe\u200b\u4e0a\u5b66\u200b\u8fc7\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u8c03\u5ea6\u200b\u7b97\u6cd5\u200b\uff0c\u200b\u5982\u200bRound-Robin\u200b\u5373\u200b\u65f6\u95f4\u200b\u7247\u200b\u8f6e\u8f6c\u200b\u8c03\u5ea6\u200b\u7b97\u6cd5\u200b\uff0c\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u5f88\u5feb\u200b\u4fbf\u4f1a\u200b\u518d\u6b21\u200b\u88ab\u200bCPU\u200b\u8c03\u5ea6\u200b\u5230\u200b\uff0c\u200b\u4ece\u800c\u200b\u4ece\u200byield\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u4e2d\u200b\u8fd4\u56de\u200b\uff0c\u200b\u7ee7\u7eed\u6267\u884c\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u540e\u9762\u200b\u7684\u200b\u4ee3\u7801\u200b\u3002\u200b\u53e6\u5916\u200b\u6211\u4eec\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u8fd8\u200b\u6709\u4e9b\u200b\u989d\u5916\u200b\u8981\u6c42\u200b\u3002</p> <p>\u200b\u5177\u4f53\u6765\u8bf4\u200b\uff0c\u200b\u5f53\u200b\u8c03\u7528\u200b<code>yield</code>\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u65f6\u200b\uff1a</p> <ol> <li>\u200b\u9700\u8981\u200b\u6253\u5370\u200b\u6b64\u65f6\u200b\u7528\u6237\u200b\u6001\u200b\u7684\u200bpc\u200b\u503c\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u9677\u5165\u200b\u5185\u6838\u200b\u7684\u200b\u90a3\u6761\u200b\u6307\u4ee4\u200b\u5730\u5740\u200b\uff0c\u200b\u5373\u200b<code>ecall</code>\u200b\u6307\u4ee4\u200b\u7684\u200b\u5730\u5740\u200b\uff0c\u200b\u8be6\u60c5\u200b\u89c1\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u63a5\u53e3\u200b\u4e2d\u200b\u63d0\u5230\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u6b65\u9aa4\u200b\uff0c\u200b\u6309\u200b\u5982\u4e0b\u200b\u683c\u5f0f\u200b\u6253\u5370\u200b\uff1a <pre><code>start to yield, user pc 0x???????\n</code></pre>    \u200b\u4e5f\u200b\u5c31\u662f\u200b\u5728\u200b\u67d0\u4e2a\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u6dfb\u52a0\u200b\u4e0a\u200b\u8fd9\u6837\u200b\u4e00\u53e5\u200b\u4ee3\u7801\u200b\uff1a <pre><code>printf(\"start to yield, user pc %p\\n\", pc);\n</code></pre></li> <li>\u200b\u5c06\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u8ba9\u51fa\u200bCPU\uff0c\u200b\u4ece\u800c\u200b\u8c03\u5ea6\u200b\u5230\u200b\u522b\u7684\u200b\u8fdb\u7a0b\u200b\u3002</li> </ol> <p>\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u4e2a\u200b<code>yieldtest</code>\u200b\u7528\u6237\u200b\u6001\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b\uff08\u200b\u89c1\u200buser/yieldtest.c\uff09\u3002\u200b\u5b8c\u6210\u200b\u4efb\u52a1\u200b\u540e\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200bxv6\u200b\u4e2d\u200b\u8fd0\u884c\u200b<code>yieldtest</code>\u200b\u7a0b\u5e8f\u200b\uff0c\u200b\u4e0d\u8fc7\u200b\u6709\u200b\u4ee5\u4e0b\u51e0\u70b9\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\uff1a</p> <ul> <li> <p>\uff081\uff09 \u200b\u9700\u8981\u200b\u624b\u52a8\u200b\u5c06\u200b<code>yieldtest</code>\u200b\u6dfb\u52a0\u200b\u8fdb\u200bMakefile\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u7f16\u8bd1\u200b\uff0c\u200b\u5373\u200b\u627e\u5230\u200b<code>UPROGS</code>\u200b\u53d8\u91cf\u200b\uff0c\u200b\u6dfb\u52a0\u200b\u4e00\u884c\u200b\uff1a </p> </li> <li> <p>\uff082\uff09 \u200b\u8be5\u200b\u4efb\u52a1\u200b\u6d4b\u8bd5\u200b\u7684\u200b\u65f6\u5019\u200b\u9700\u8981\u200b \u200b\u8bbe\u7f6e\u200bCPU\u200b\u7684\u200b\u6570\u91cf\u200b\u4e3a\u200b1 \uff0c\u200b\u5373\u200b\u4f7f\u7528\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\u8fd0\u884c\u200bxv6: <pre><code>make qemu CPUS=1\n</code></pre></p> </li> </ul> <p>\u200b\u6b63\u786e\u200b\u5b8c\u6210\u200b\u4efb\u52a1\u200b\u540e\u200b <code>yieldtest</code>\u200b\u7684\u200b\u8f93\u51fa\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p>"},{"location":"lab2/part1/#35","title":"3.5 \u200b\u6d4b\u8bd5","text":"<p>\u200b\u5f53\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u7684\u200b\u4e09\u4e2a\u200b\u4efb\u52a1\u200b\u540e\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5728\u200bxv6-oslab23-hitsz\u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u65b0\u5efa\u200btime.txt\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5728\u200b\u8be5\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u5199\u5165\u200b\u4f60\u200b\u505a\u200b\u5b8c\u200b\u8fd9\u4e2a\u200b\u5b9e\u9a8c\u6240\u200b\u82b1\u8d39\u200b\u7684\u200b\u65f6\u95f4\u200b\uff08\u200b\u4f30\u7b97\u200b\u4e00\u4e0b\u200b\u5c31\u884c\u200b\uff0c\u200b\u5355\u4f4d\u200b\u662f\u200b\u5c0f\u65f6\u200b\uff09\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u5199\u200b\u4e00\u4e2a\u200b\u6574\u6570\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u6700\u540e\u200b\uff0c\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u8f93\u5165\u200b <code>make grade</code> \u200b\u8fdb\u884c\u200b\u6d4b\u8bd5\u200b\u3002\u200b\u5982\u679c\u200b\u901a\u8fc7\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u4f1a\u200b\u663e\u793a\u200b\u5982\u4e0b\u200b\u5185\u5bb9\u200b\uff1a</p> <p></p>"},{"location":"lab2/part2/","title":"\u5b9e\u9a8c\u200b\u539f\u7406","text":"<p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u8fd9\u200b\u4e00\u7ae0\u200b\u8bb2\u8ff0\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\uff0c\u200b\u4ee5\u4e0b\u200b\u77e5\u8bc6\u200b\u4f1a\u200b\u5927\u5927\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u7406\u89e3\u200bxv6\u200b\u662f\u200b\u5982\u4f55\u200b\u5de5\u4f5c\u200b\u7684\u200b\u3002\u200b\u4f46\u662f\u200b\u4f60\u200b\u9700\u8981\u200b\u52a0\u4ee5\u200b\u601d\u8003\u200b\uff0c\u200b\u5e76\u4e14\u200b\u5c06\u200b\u5176\u200b\u4e00\u4e2a\u200b\u4e00\u4e2a\u200b\u4e32\u63a5\u200b\u8d77\u6765\u200b\uff0c\u200b\u4ee5\u200b\u5f62\u6210\u200b\u4e00\u4e2a\u200b\u6574\u4f53\u200b\u7684\u200b\u601d\u7ef4\u200b\u3002</p>"},{"location":"lab2/part2/#1","title":"1. \u200b\u7cfb\u7edf\u200b\u8c03\u7528","text":"<p>\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5c31\u662f\u200b\u8c03\u7528\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u63d0\u4f9b\u200b\u7684\u200b\u4e00\u7cfb\u5217\u200b\u5185\u6838\u200b\u51fd\u6570\u200b\u3002\u200b\u7531\u4e8e\u200b\u7528\u6237\u200b\u7a0b\u5e8f\u8fd0\u884c\u200b\u5728\u200bCPU\u200b\u7684\u200b\u7528\u6237\u200b\u6001\u200b\uff08\u200b\u53c8\u79f0\u200b\u975e\u200b\u7279\u6743\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u7528\u6237\u200b\u6a21\u5f0f\u200b\uff09\uff0c\u200b\u65e0\u6cd5\u200b\u76f4\u63a5\u200b\u8bbf\u95ee\u200b\u7cfb\u7edf\u200b\u786c\u4ef6\u200b\u548c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b\u7cfb\u7edf\u200b\u6570\u636e\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u53ea\u80fd\u200b\u53d1\u51fa\u8bf7\u6c42\u200b\uff0c\u200b\u7136\u540e\u200b\u7531\u200b\u5185\u6838\u200b\u8c03\u7528\u200b\u76f8\u5e94\u200b\u7684\u200b\u5185\u6838\u200b\u51fd\u6570\u200b\u6765\u200b\u5e2e\u200b\u7740\u200b\u5904\u7406\u200b\uff0c\u200b\u6700\u540e\u200b\u5c06\u200b\u7ed3\u679c\u200b\u8fd4\u56de\u200b\u7ed9\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u3002</p>"},{"location":"lab2/part2/#11","title":"1.1 \u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u4f7f\u7528\u200b\uff1a\u200b\u7528\u6237\u200b\u7684\u200b\u6743\u529b","text":"<p>\u200b\u5728\u200b\u7b2c\u4e00\u4e2a\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u548c\u200bC\u200b\u8bed\u8a00\u200b\u7684\u200b\u51fd\u6570\u200b\u653e\u5728\u200b\u4e00\u8d77\u200b\u505a\u200b\u4e86\u200b\u4e00\u5b9a\u200b\u7684\u200b\u8bf4\u660e\u200b\u3002</p> <p>\u201c\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u88ab\u200b \u200b\u5c01\u88c5\u200b \u200b\u4e3a\u200b\u51fd\u6570\u200b\u4ee5\u5411\u200b\u7528\u6237\u200b\u63d0\u4f9b\u200b\u63a5\u53e3\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u51fd\u6570\u8c03\u7528\u200b\u7684\u200b\u65b9\u5f0f\u200b\u8bf7\u6c42\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u670d\u52a1\u200b\u201d\u3002\u200b\u4ece\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\uff0c\u200b\u867d\u7136\u200b\u4e24\u8005\u200b\u770b\u8d77\u6765\u200b\u4e00\u6837\u200b\uff0c\u200b\u4f46\u662f\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b\u5c01\u88c5\u200b\u7684\u200b\u7ed3\u679c\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u6211\u4eec\u200b\u7b80\u8981\u200b\u4ecb\u7ecd\u200bxv6\u200b\u662f\u200b\u600e\u6837\u200b\u5c01\u88c5\u200b\u7684\u200b\u3002</p> <p>\u200b\u9996\u5148\u200b\u770b\u200b<code>user/user.h</code>\u200b\u6587\u4ef6\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u5bf9\u5e94\u200b\u6709\u200b\u8bb8\u591a\u200b\u7684\u200b\u51fd\u6570\u200b\u63a5\u53e3\u200b\uff0c\u200b\u5176\u4e2d\u200b\u6807\u8bc6\u200b\u4e86\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u548c\u200b\u7528\u6237\u5e93\u200b\uff08<code>ulib</code>\uff09\u3002\u200b\u4f46\u662f\u200b\u6211\u4eec\u200b\u53ea\u200b\u770b\u5230\u200b\u4e86\u200b\u5c01\u88c5\u200b\u7684\u200b\u63a5\u53e3\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5b9e\u9645\u4e0a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5b9e\u73b0\u200b\u662f\u200b\u4ec0\u4e48\u6837\u200b\u7684\u200b\u5462\u200b\uff1f</p>"},{"location":"lab2/part2/#12","title":"1.2 \u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u63a5\u53e3\u200b\uff1a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5185\u6838\u200b\u548c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u4e2d\u95f4\u4f53","text":"<p>\u200b\u73b0\u5728\u200b\u6211\u4eec\u200b\u770b\u5230\u200b<code>user/usys.pl</code>\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8be5\u200b\u811a\u672c\u200b\u6587\u4ef6\u200b\u4f1a\u200b\u5728\u200b\u7f16\u8bd1\u200b\u671f\u95f4\u200b\u88ab\u200b\u6267\u884c\u200b\uff0c\u200b\u751f\u6210\u200b\u4e00\u4e2a\u200b\u6c47\u7f16\u200b\u6587\u4ef6\u200b<code>usys.S</code>\u3002\u200b\u5176\u200b\u5bf9\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u62bd\u8c61\u200b\u63a5\u53e3\u200b\u90fd\u200b\u751f\u6210\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5177\u4f53\u200b\u7684\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u53eb\u505a\u200b<code>entry</code>\u3002</p> <pre><code> 1  #!/usr/bin/perl -w\n2\n3  # Generate usys.S, the stubs for syscalls.\n4\n5  print \"# generated by usys.pl - do not edit\\n\";\n6\n7  print \"#include \\\"kernel/syscall.h\\\"\\n\";\n8\n9  sub entry {\n10      my $name = shift;\n11      print \".global $name\\n\";\n12      print \"${name}:\\n\";\n13      print \" li a7, SYS_${name}\\n\";\n14      print \" ecall\\n\";\n15      print \" ret\\n\";\n16  }\n17\n18  entry(\"fork\");\n19  entry(\"exit\");\n\u2026\u2026\n</code></pre> <p>\u200b\u8fd9\u200b\u6bb5\u200b\u811a\u672c\u200b\u4e2d\u200b\u7684\u200bprint\u200b\u7684\u200b\u5185\u5bb9\u200b\u5b9e\u9645\u200b\u5c31\u662f\u200bRISC-V\u200b\u6307\u4ee4\u96c6\u200b\u7684\u200b\u6c47\u7f16\u8bed\u8a00\u200b\u3002<code>$name</code>\u200b\u5c31\u662f\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u540d\u5b57\u200b\uff0c\u200b\u5982\u200bfork\uff0cexit\u200b\u7b49\u200b\uff0c\u200b\u5f53\u200b\u811a\u672c\u200b\u6267\u884c\u200b\u65f6\u200b\uff0c18\u200b\u884c\u200b\u4e4b\u540e\u200bentry\u200b\u7684\u200b\u5185\u200b\u5b57\u7b26\u4e32\u200b\u4f1a\u200b\u88ab\u200b\u586b\u5165\u200b<code>$name</code>\u3002  </p> <p>\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u6b65\u9aa4\u200b\u5305\u62ec\u200b\u4ee5\u4e0b\u200b\u51e0\u6b65\u200b\uff1a</p> <ul> <li><code>li a7, SYS_${name}\\n</code>\uff1a\u200b\u5c06\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53f7\u200b <code>SYS_${name}</code>\uff08\u200b\u6765\u81ea\u200b<code>kernel/syscall.h</code>\uff09\u200b\u4f20\u7ed9\u200bRISC-V CPU\u200b\u4e0a\u200b\u7684\u200b<code>a7</code>\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u8fd9\u6837\u200b\u5185\u6838\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b<code>a7</code>\u200b\u5bc4\u5b58\u5668\u200b\u77e5\u9053\u200b\u73b0\u5728\u200b\u8981\u200b\u5904\u7406\u200b\u7684\u200b\u662f\u200b\u4ec0\u4e48\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u3002 </li> <li><code>ecall</code>\uff1a\u200b\u7279\u6b8a\u200b\u6307\u4ee4\u200b\uff0c\u200b\u7528\u6765\u200b\u8f6c\u5165\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5185\u6838\u200b\uff08 \u200b\u5173\u952e\u200b \u200b\u6307\u4ee4\u200b\uff09\u3002  </li> <li><code>ret</code>\uff1a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5185\u6838\u200b\u6267\u884c\u200b\u5b8c\u540e\u200b\u4f1a\u200b\u8fd4\u56de\u200b\u5230\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6267\u884c\u200bret\u200b\u5c31\u200b\u7ed3\u675f\u200b\u4e86\u200b\u7528\u6237\u200b\u770b\u5230\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u8fd4\u56de\u200b\u81f3\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u3002    \u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200b\u7f16\u8bd1\u200b\u540e\u200b\u9605\u8bfb\u200b<code>user/usys.S</code>\uff0c\u200b\u5c06\u200b\u5176\u200b\u4e0e\u200b\u4e0a\u8ff0\u200b\u811a\u672c\u200b\u5bf9\u5e94\u200b\u4ee5\u4fbf\u200b\u66f4\u597d\u200b\u5730\u200b\u7406\u89e3\u200b\u3002</li> </ul> <p>\u200b\u62d3\u5c55\u200b</p> <p>\u200b\u5728\u200bRISC-V\u200b\u6307\u4ee4\u96c6\u200b\u67b6\u6784\u200b\u4e2d\u200b\uff0c\u200b\u5904\u7406\u5668\u200b\u901a\u5e38\u200b\u5206\u4e3a\u200bM (<code>Machine</code>)\u3001S (<code>Supervisor</code>)\u3001U (<code>User</code>) \u200b\u4e09\u79cd\u200b\u5de5\u4f5c\u200b\u6a21\u5f0f\u200b\u3002\u200b\u4e00\u822c\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u7528\u6237\u200b\u7a0b\u5e8f\u8fd0\u884c\u200b\u5728\u200bU\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u800c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5185\u6838\u200b\u8fd0\u884c\u200b\u5728\u200bS\u200b\u6a21\u5f0f\u200b\u3002\u200b\u4e0a\u200b\u6587\u4e2d\u200b\u7684\u200b<code>ecall (Environment Call)</code>\u200b\u547d\u4ee4\u200b\u5c31\u662f\u200b\u4e0d\u540c\u200b\u7279\u6743\u200b\u7ea7\u200b\u4e4b\u95f4\u200b\u7684\u200b\u6865\u6881\u200b\uff0c\u200b\u4f8b\u5982\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u6267\u884c\u200b<code>ecall</code>\u200b\u540e\u200b\uff0cCPU\u200b\u4f1a\u200b\u4ece\u200bU\u200b\u6a21\u5f0f\u200b\u5207\u6362\u200b\u81f3\u200bS\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u540c\u65f6\u200b\u5c06\u200bPC\u200b\u7684\u200b\u503c\u7f6e\u200b\u4e3a\u200b\u4e00\u4e2a\u200b\u7531\u200b\u5185\u6838\u200b\u9884\u8bbe\u200b\u7684\u200b\u5730\u5740\u200b\uff0c\u200b\u8fdb\u800c\u200b\u5207\u6362\u200b\u81f3\u200b\u5185\u6838\u200b\u7684\u200b\u6267\u884c\u200b\u6d41\u200b\u3002<code>ecall</code>\u200b\u5b9e\u9645\u4e0a\u200b\u662f\u200b\u9677\u5165\u200b(<code>trap</code>)\u200b\u7684\u200b\u4e00\u79cd\u200b\uff0c\u200b\u60f3\u8981\u200b\u4e86\u89e3\u200b\u66f4\u200b\u591a\u200b\u7ec6\u8282\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u9605\u8bfb\u200bRISC-V\u200b\u624b\u518c\u200b\u3002</p>"},{"location":"lab2/part2/#13","title":"1.3 \u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u53c2\u6570\u200b\uff1a\u200b\u5bc4\u5b58\u5668\u200b\u4f20\u53c2","text":"<p>\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u8fd8\u200b\u5ffd\u7565\u200b\u4e86\u200b\u4e00\u70b9\u200b\uff0c\u200b\u90a3\u200b\u5c31\u662f\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fd8\u200b\u9700\u8981\u200b\u4f20\u9012\u200b\u53c2\u6570\u200b\u3002\u200b\u5b9e\u9645\u4e0a\u200b\uff0c\u200b\u4ece\u200b\u6c47\u7f16\u200b\u7684\u200b\u89d2\u5ea6\u200b\u6765\u770b\u200b\uff0c\u200b\u5f53\u200b\u6211\u4eec\u200b\u8c03\u7528\u200b\u4e00\u4e2a\u200b\u51fd\u6570\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f20\u5165\u200b\u7684\u200b\u53c2\u6570\u200b\u4e00\u822c\u200b\u4f1a\u200b\u6309\u7167\u200b\u4f4d\u7f6e\u200b\u4f9d\u6b21\u200b\u653e\u5728\u200b<code>a0</code>, <code>a1</code>, <code>a2</code>\u200b\u7b49\u200b\u4ee5\u6b64\u7c7b\u63a8\u200b\u7684\u200b\u5bc4\u5b58\u5668\u200b\u4e2d\u200b\u3002\u200b\u60f3\u8981\u200b\u4e86\u89e3\u200b\u66f4\u200b\u591a\u200b\u5173\u4e8e\u200b\u51fd\u6570\u53c2\u6570\u200b\u7684\u200b\u7ec6\u8282\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u9605\u8bfb\u200bRISC-V\u200b\u624b\u518c\u200b\u3002</p> <p></p> <p>\u200b\u4e5f\u5c31\u662f\u8bf4\u200b\uff0c\u200b\u8c03\u7528\u200b<code>user/user.h</code>\u200b\u4e2d\u200b\u7684\u200b\u51fd\u6570\u200b\u63a5\u53e3\u200b\u540e\u200b\uff0c\u200b\u53c2\u6570\u200b\u5df2\u7ecf\u200b\u5b58\u50a8\u200b\u4e8e\u200b\u5bc4\u5b58\u5668\u200b\u4e86\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u65f6\u5019\u200b\u6211\u4eec\u200b\u5c31\u200b\u539f\u5c01\u4e0d\u52a8\u200b\u5730\u200b\u7ee7\u7eed\u200b\u8c03\u7528\u200b<code>ecall</code>\uff0c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200ba0, a1, a2\u200b\u7b49\u200b\u5bc4\u5b58\u5668\u200b\u6765\u200b\u83b7\u53d6\u200b\u53c2\u6570\u200b\u4e86\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u51fd\u6570\u200b\u7684\u200b\u8fd4\u56de\u503c\u200b\u4e00\u822c\u200b\u5b58\u50a8\u200b\u4e8e\u200ba0\u200b\u5bc4\u5b58\u5668\u200b\u3002</p> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u6839\u636e\u200bRISC-V\u200b\u6807\u51c6\u89c4\u5b9a\u200b\uff0c\u200b\u51fd\u6570\u8c03\u7528\u200b\u901a\u8fc7\u200b\u5bc4\u5b58\u5668\u200b\u4f20\u9012\u200b\u53c2\u6570\u200b\u3002\u200b\u5728\u200b\u5185\u6838\u200b\u4e2d\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200bargint\u3001argaddr\u200b\u7b49\u200b\u51fd\u6570\u200b\u83b7\u53d6\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u53c2\u6570\u200b\uff0c\u200b\u5206\u522b\u200b\u5bf9\u5e94\u200b\u6574\u6570\u200b\u548c\u200b\u6307\u9488\u200b\uff0c\u200b\u5b83\u4eec\u200b\u90fd\u200b\u8c03\u7528\u200bargraw\u200b\u6765\u200b\u8bfb\u53d6\u200b\u5df2\u200b\u4fdd\u5b58\u200b\u7684\u200b\u5bc4\u5b58\u5668\u200b\u3002\u200b\u6bd4\u5982\u200b\uff0c<code>kernel/sycall.c</code>\u200b\u4e2d\u200b <code>argraw</code>\u200b\u51fd\u6570\u200b\u6240\u200b\u63cf\u8ff0\u200b\u7684\u200b\u5c31\u662f\u200b\u53d6\u51fa\u200b\u53c2\u6570\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u3002</p> <pre><code>static uint64 argraw(int n) {\nstruct proc *p = myproc();\nswitch (n) {\ncase 0:\nreturn p-&gt;trapframe-&gt;a0;\ncase 1:\nreturn p-&gt;trapframe-&gt;a1;\n// \u2026\u2026  \n</code></pre> <p>\u200b\u5176\u4e2d\u200b trapframe\u200b\u5c31\u662f\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5bc4\u5b58\u5668\u200b\u72b6\u6001\u200b \uff08\u200b\u4e0a\u4e0b\u6587\u200b\uff0c\u200b\u8be6\u89c1\u200b3.1 trapframe\uff09\u3002</p>"},{"location":"lab2/part2/#14","title":"1.4 \u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5206\u53d1\u200b\u548c\u200b\u5b9e\u73b0\u200b\uff1a\u200b\u89e3\u200b\u8026\u5408","text":"<p>\u200b\u6309\u7167\u200b\u4e4b\u524d\u200b\u6240\u8ff0\u200b\uff0c\u200b\u5b9a\u4e49\u200b\u4e00\u4e2a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5b9e\u9645\u4e0a\u200b\u5f88\u200b\u7b80\u5355\u200b\uff1a\u200b\u5c06\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53f7\u200b\u7684\u200b\u5b8f\u200b\u5b9a\u4e49\u200b<code>SYS_${name}</code>\u200b\u6dfb\u52a0\u200b\u5728\u200b<code>kernel/syscall.h</code>\uff0c\u200b\u6bcf\u6b21\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u65f6\u200b\u6839\u636e\u200b<code>a7</code>\u200b\u5bc4\u5b58\u5668\u200b\u4f20\u5165\u200b\u7684\u200b\u503c\u200b\u5224\u5b9a\u200b\u5177\u4f53\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7c7b\u578b\u200b\u5373\u53ef\u200b\u3002 \u200b\u90a3\u4e48\u200b\u63a5\u4e0b\u6765\u200b\u6211\u4eec\u200b\u9762\u4e34\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u95ee\u9898\u200b\u662f\u200b\uff1a\u200b\u5185\u6838\u200b\u600e\u4e48\u200b\u901a\u8fc7\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53f7\u200b\uff08\u200b\u5b58\u5728\u200b<code>a7</code>\uff09\u200b\u6765\u200b\u6267\u884c\u200b\u4e0d\u540c\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u51fd\u6570\u200b\u3002</p> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5173\u6ce8\u200b<code>kernel/syscall.c</code>\u200b\u4e2d\u200b\u5b9a\u4e49\u200b\u4e86\u200b\u4e00\u5927\u200b\u6bb5\u200b\u770b\u8d77\u6765\u200b\u5c31\u200b\u548c\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u6709\u5173\u200b\u7684\u200b\u90e8\u5206\u200b\u3002\u200b\u8fd9\u91cc\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b\u4e24\u4e2a\u200b\u90e8\u5206\u200b\uff0c\u200b\u4e00\u4e2a\u200b\u662f\u200b <code>extern</code> \u200b\u8fdb\u884c\u200b\u6807\u8bc6\u200b\u7684\u200b\u51fd\u6570\u200b\u63a5\u53e3\u200b\uff0c\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u662f\u200b\u4ee5\u200b<code>syscall</code>\u200b\u4e3a\u540d\u200b\u7684\u200b\u6570\u7ec4\u200b\u3002</p> <pre><code>extern uint64 sys_chdir(void);\nextern uint64 sys_close(void);\nextern uint64 sys_dup(void);\nextern uint64 sys_exec(void);\nextern uint64 sys_exit(void);\n\n// \u2026\u2026\n\nstatic uint64 (*syscalls[])(void) = {\n[SYS_fork] sys_fork,   [SYS_exit] sys_exit,     [SYS_wait] sys_wait,     [SYS_pipe] sys_pipe,\n[SYS_read] sys_read,   [SYS_kill] sys_kill,     [SYS_exec] sys_exec,     [SYS_fstat] sys_fstat,\n[SYS_chdir] sys_chdir, [SYS_dup] sys_dup,       [SYS_getpid] sys_getpid, [SYS_sbrk] sys_sbrk,\n[SYS_sleep] sys_sleep, [SYS_uptime] sys_uptime, [SYS_open] sys_open,     [SYS_write] sys_write,\n[SYS_mknod] sys_mknod, [SYS_unlink] sys_unlink, [SYS_link] sys_link,     [SYS_mkdir] sys_mkdir,\n[SYS_close] sys_close, [SYS_rename] sys_rename,\n};\n</code></pre> <ul> <li> <p>\u200b\u524d\u8005\u200b\u5b9e\u9645\u4e0a\u200b\u58f0\u660e\u200b\u4e86\u200b\u8fd9\u4e9b\u200b\u51fd\u6570\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u51fd\u6570\u200b\u7684\u200b\u5b9e\u73b0\u200b\u4e0d\u5fc5\u200b\u5728\u200b\u8fd9\u4e2a\u200b\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u800c\u662f\u200b\u5206\u5e03\u200b\u5728\u200b\u5404\u4e2a\u200b\u76f8\u5173\u200b\u7684\u200b\u4ee3\u7801\u200b\u6587\u4ef6\u200b\u4e2d\u200b\uff08\u200b\u4e00\u822c\u200b\u653e\u5728\u200b<code>sys</code>\u200b\u5f00\u5934\u200b\u7684\u200b\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u5305\u62ec\u200b<code>sysproc.c</code>\u200b\u4e0e\u200b<code>sysfile.c</code>\uff09\uff0c\u200b\u6211\u4eec\u200b\u5728\u200b\u8fd9\u4e9b\u200b\u4ee3\u7801\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u5b9e\u73b0\u200b\u597d\u200b\u5bf9\u5e94\u200b\u7684\u200b\u51fd\u6570\u200b\uff0c\u200b\u6700\u540e\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u7f16\u8bd1\u200b\u51fa\u200b\u5bf9\u5e94\u200b\u540d\u5b57\u200b\u7684\u200b\u6c47\u7f16\u200b\u4ee3\u7801\u200b\u51fd\u6570\u200b\uff0c <code>extern</code> \u200b\u5c31\u200b\u4f1a\u200b\u627e\u5230\u200b\u5bf9\u5e94\u200b\u7684\u200b\u51fd\u6570\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u3002</p> </li> <li> <p>\u200b\u540e\u8005\u200b\u5219\u200b\u662f\u200b\u5c06\u200b\u8fd9\u4e9b\u200b\u51fd\u6570\u200b\u7684\u200b\u6307\u9488\u200b\u90fd\u200b\u653e\u5728\u200b\u7edf\u4e00\u200b\u7684\u200b\u6570\u7ec4\u200b\u91cc\u200b\uff0c\u200b\u5e76\u4e14\u200b\u6570\u7ec4\u200b\u4e0b\u6807\u200b\u5c31\u662f\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53f7\u200b\uff0c\u200b\u8fd9\u6837\u200b\u6211\u4eec\u200b\u5728\u200b\u5206\u8fa8\u200b\u4e0d\u540c\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u65f6\u5019\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u5f88\u200b\u65b9\u4fbf\u200b\u5730\u7528\u200b\u6570\u7ec4\u200b\u6765\u200b\u8fdb\u884c\u200b\u64cd\u4f5c\u200b\u4e86\u200b\u3002<code>kernel/syscall.c</code>\u200b\u4e2d\u200b\u7684\u200b <code>syscall()</code> \u200b\u51fd\u6570\u200b\u5c31\u200b\u6839\u636e\u200b\u8fd9\u4e00\u200b\u65b9\u6cd5\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5206\u53d1\u200b\uff08\u200b\u901a\u8fc7\u200b\u4e0d\u540c\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53f7\u200b\u8c03\u7528\u200b\u4e0d\u540c\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u51fd\u6570\u200b\uff09\uff0c\u200b\u8bf7\u200b\u4ed4\u7ec6\u9605\u8bfb\u200b\u5e76\u200b\u5c1d\u8bd5\u200b\u7406\u89e3\u200b\u3002</p> </li> <li> <p>\u200b\u5c06\u200b\u4e24\u8005\u200b\u5408\u200b\u8d77\u6765\u200b\u4f7f\u7528\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u5f97\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b \u200b\u5b9e\u73b0\u200b \u200b\u548c\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b \u200b\u5206\u53d1\u200b \u200b\u5f7c\u6b64\u200b \u200b\u5206\u79bb\u200b \uff0c\u200b\u8fd9\u200b\u5bf9\u200b\u51fd\u6570\u200b\u7f16\u5199\u8005\u200b\u975e\u5e38\u200b\u53cb\u597d\u200b\uff0c\u200b\u4f46\u662f\u200b\u4f1a\u200b\u8ba9\u200b\u521d\u5b66\u8005\u200b\u6709\u4e9b\u200b\u8ff7\u60d1\u200b\uff0c\u200b\u8fd9\u662f\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u3002</p> </li> </ul>"},{"location":"lab2/part2/#2","title":"2. \u200b\u4e3e\u4f8b\u200b\uff1a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5b9e\u73b0","text":"<p>\u200b\u73b0\u5728\u200b\u6211\u4eec\u200b\u4ee5\u200b\u4e00\u4e2a\u200b\u5177\u4f53\u200b\u7684\u200b\u4f8b\u5b50\u200b\uff0c\u200b\u6765\u200b\u770b\u770b\u200bxv6\u200b\u662f\u200b\u600e\u4e48\u200b\u5b9e\u73b0\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u3002\u200b\u6211\u4eec\u200b\u51c6\u5907\u200b\u6311\u9009\u200b\u770b\u8d77\u6765\u200b\u6734\u5b9e\u65e0\u534e\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b<code>sleep</code>\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u5b9e\u9645\u4e0a\u200b\u6697\u85cf\u200b\u51f6\u9669\u200b\u3002</p> <p>\u200b\u5148\u200b\u6765\u770b\u200b\u5f20\u200b\u603b\u56fe\u200b\u628a\u63e1\u200b\u4e00\u4e0b\u200b\u6574\u4f53\u200b\u6d41\u7a0b\u200b\uff1a</p> <p></p> <p>\u200b\u4ee5\u4e0b\u200b\u53ea\u200b\u5bf9\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fc7\u7a0b\u200b\u67d0\u200b\u51e0\u4e2a\u200b\u5173\u952e\u70b9\u200b\u8fdb\u884c\u200b\u5206\u6790\u200b\uff0c\u200b\u5176\u4ed6\u200b\u76f8\u5173\u200b\u4ee3\u7801\u200b/\u200b\u6d41\u7a0b\u200b\u9700\u8981\u200b\u5927\u5bb6\u200b\u81ea\u884c\u200b\u67e5\u9605\u200b\u4ee3\u7801\u200b\uff1a</p>"},{"location":"lab2/part2/#21","title":"2.1 \u200b\u7528\u6237\u7a0b\u5e8f\u200b\u8c03\u7528","text":"<p>xv6\u200b\u5173\u4e8e\u200bsleep\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\u7684\u200b\u58f0\u660e\u200b\u5728\u200buser/user.h\u3002</p> <pre><code>/* user/user.h */\n\nint sleep(int);\n</code></pre>"},{"location":"lab2/part2/#22-usyss","title":"2.2 usys.S\u200b\u6c47\u7f16","text":"<p>\u200b\u7136\u800c\u200b\uff0cuser/user.h\u200b\u53ea\u662f\u200b\u5bf9\u200b\u51fd\u6570\u200b\u539f\u578b\u200b\u8fdb\u884c\u200b\u4e86\u200b\u58f0\u660e\u200b\u3002\u200b\u5177\u4f53\u200b\u505a\u200b\u4e86\u200b\u4ec0\u4e48\u200b\u4e8b\u200b\u5462\u200b\uff1f\u200b\u8fd9\u4e2a\u200b\u5b9a\u4e49\u200b\u662f\u200b\u5728\u200busys.S\u200b\u4e2d\u200b\uff0c\u200b\u8be6\u89c1\u200b1.2\u200b\u5c0f\u8282\u200b\u3002</p> <p>\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0cusys.S\u200b\u6c47\u7f16\u200b\u662f\u200b\u7531\u200busys.pl\uff08perl\u200b\u811a\u672c\u200b\uff09\u200b\u81ea\u52a8\u200b\u751f\u6210\u200b\u7684\u200b\u3002\u200b\u4e5f\u200b\u5c31\u662f\u200b\uff0c\u200b\u5f53\u200b\u4f60\u200b\u8981\u200b\u589e\u52a0\u200b\u65b0\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u65f6\u200b\uff0c\u200b\u4e0d\u8981\u200b\u4fee\u6539\u200busys.S\uff0c\u200b\u800c\u662f\u200b\u53c2\u8003\u200b\u5176\u4ed6\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u63a5\u53e3\u200b\u6765\u200b\u4fee\u6539\u200busys.pl\u3002</p>"},{"location":"lab2/part2/#23-uservec","title":"2.3 uservec\u200b\u6c47\u7f16","text":"<p>\u200b\u5f53\u200b\u6267\u884c\u200becall\u200b\u6307\u4ee4\u200b\u540e\u200b\uff0c\u200b\u5185\u6838\u200b\u4f1a\u200b\u5207\u6362\u200b\u5230\u200bsupervisor mode\u3002\u200b\u63a5\u7740\u200b\uff0c\u200b\u5185\u6838\u200b\u6267\u884c\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u6307\u4ee4\u200b\u662f\u200b\u6765\u81ea\u200btrampoline.S\u200b\u6587\u4ef6\u200b\u7684\u200buservec\u200b\u6c47\u7f16\u200b\u51fd\u6570\u200b\u3002</p>"},{"location":"lab2/part2/#24-usertrap","title":"2.4 usertrap","text":"<p>\u200b\u4e4b\u540e\u200b\uff0c\u200b\u4ee3\u7801\u200b\u8df3\u8f6c\u200b\u5230\u200b\u4e86\u200b\u7531\u200bC\u200b\u8bed\u8a00\u200b\u5b9e\u73b0\u200b\u7684\u200busertrap\u200b\u51fd\u6570\u200b\u4e2d\u200b\uff08trap.c\uff09\uff0c\u200b\u5224\u65ad\u200b\u5982\u679c\u200b\u662f\u200b\u6765\u81ea\u200b\u7528\u6237\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5219\u200b\u6267\u884c\u200bsyscall\u200b\u51fd\u6570\u200b\u3002</p> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u4e00\u822c\u200b\u8fdb\u5165\u200busertrap\u200b\u51fd\u6570\u200b\u6709\u200b\u4e09\u79cd\u200b\u60c5\u51b5\u200b\uff1a 1. syscall\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u662f\u200b\u7531\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u4e3b\u52a8\u200b\u8c03\u7528\u200becall\u200b\u6307\u4ee4\u200b\u6765\u200b\u5b9e\u73b0\u200b\u7684\u200b\u3002  2. device interrupt\u200b\u8bbe\u5907\u200b\u4e2d\u65ad\u200b\uff0c\u200b\u6bd4\u5982\u200b\uff1a\u200b\u78c1\u76d8\u200b\u8bbe\u5907\u200b\u5b8c\u6210\u200b\u4e86\u200b\u8bfb\u5199\u200b\u8bf7\u6c42\u200b\u64cd\u4f5c\u200b\u3002  3. exception\u200b\u5f02\u5e38\u200b\uff0c\u200b\u662f\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u6216\u200b\u5185\u6838\u200b\u7a0b\u5e8f\u200b\u7684\u200billegal instruction\u200b\u5bfc\u81f4\u200b\u7684\u200b\uff0c\u200b\u6bd4\u5982\u200b\uff1a\u200b\u9664\u200b0\u200b\u9519\u8bef\u200b\uff0c\u200b\u6216\u200b\u5f15\u7528\u200b\u65e0\u6548\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u3002  </p> <pre><code>void usertrap(void) {\n\nif (r_scause() == 8) {\n// system call\n\n// \u2026\u2026      \n} else if ((which_dev = devintr()) != 0) {\n// ok\n} else {\nprintf(\"usertrap(): unexpected scause %p pid=%d\\n\", r_scause(), p-&gt;pid);\nprintf(\"            sepc=%p stval=%p\\n\", r_sepc(), r_stval());\np-&gt;killed = 1;\n}\n// \u2026\u2026  \n</code></pre>"},{"location":"lab2/part2/#25-syscall","title":"2.5 syscall","text":"<p>syscall\u200b\u51fd\u6570\u200b\u91cc\u200b\u6709\u200b\u4e00\u4e2a\u200b\u8868\u5355\u200b\uff0c\u200b\u6839\u636e\u200b\u4f20\u5165\u200b\u7684\u200b\u4ee3\u8868\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u6570\u5b57\u200b\u8fdb\u884c\u200b\u67e5\u627e\u200b\uff0c\u200b\u5e76\u200b\u6267\u884c\u200b\u5177\u4f53\u200b\u5b9e\u73b0\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u529f\u80fd\u200b\u7684\u200b\u51fd\u6570\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u8fd9\u4e2a\u200b\u4f8b\u5b50\u200b\u6765\u8bf4\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u5c31\u662f\u200bsys_sleep\u3002</p>"},{"location":"lab2/part2/#26-sys_sleep","title":"2.6 sys_sleep","text":"<p>\u200b\u5176\u200b\u4ee3\u7801\u200b\u53ef\u89c1\u200b <code>kernel/sysproc.c</code> line55-74\uff1a</p> <pre><code>55  uint64\n56  sys_sleep(void)\n57  {\n58    int n;\n59    uint ticks0;\n60\n61    if(argint(0, &amp;n) &lt; 0)\n62      return -1;\n63    acquire(&amp;tickslock);\n64    ticks0 = ticks;\n65    while(ticks - ticks0 &lt; n){\n66      if(myproc()-&gt;killed){\n67        release(&amp;tickslock);\n68        return -1;\n69      }\n70      sleep(&amp;ticks, &amp;tickslock);\n71    }\n72    release(&amp;tickslock);\n73    return 0;\n74  }\n</code></pre> <ul> <li> <p>\u200b\u53c2\u6570\u200b\uff1a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b<code>sleep</code>\u200b\u6709\u200b\u4e00\u4e2a\u200b\u53c2\u6570\u200b\uff0c\u200b\u7528\u6765\u200b\u544a\u77e5\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b<code>sleep</code>\u200b\u7684\u200b\u6301\u7eed\u65f6\u95f4\u200b\u3002\u200b\u4f46\u662f\u200b\u8fd9\u91cc\u200b\u600e\u4e48\u200b\u662f\u200b<code>void</code>\uff1f</p> <ul> <li>\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200bxv6\u200b\u53c8\u200b\u8fdb\u884c\u200b\u4e86\u200b\u4e00\u6b21\u200b\u89e3\u200b\u8026\u5408\u200b\uff0c\u200b\u901a\u8fc7\u200b\u4e00\u4e2a\u200b\u989d\u5916\u200b\u7684\u200b\u51fd\u6570\u200b\u83b7\u53d6\u200b\u53c2\u6570\u200b\uff0c\u200b\u4ed6\u4eec\u200b\u4ee5\u200b<code>arg</code>\u200b\u5f00\u5934\u200b\uff0c\u200b\u5177\u4f53\u200b\u89c1\u200b<code>kernel/syscall.c</code>\u3002</li> </ul> </li> <li> <p>\u200b\u83b7\u5f97\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u72b6\u6001\u200b\uff1a\u200b\u6267\u884c\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u53c2\u6570\u200b\u4e0d\u4f1a\u200b\u544a\u8bc9\u200bxv6\u200b\u81ea\u5df1\u200b\u5230\u5e95\u200b\u662f\u200b\u4ec0\u4e48\u200b\u7a0b\u5e8f\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0cxv6\u200b\u9700\u8981\u200b\u989d\u5916\u200b\u7684\u200b\u8c03\u7528\u200b\u6765\u200b\u5f04\u6e05\u695a\u200b\uff0c\u200b\u73b0\u5728\u200b\u5230\u5e95\u200b\u662f\u200b\u4ec0\u4e48\u200b\u7a0b\u5e8f\u200b\u6b63\u5728\u200b\u8fd0\u884c\u200b\uff1f</p> <ul> <li>\u200b\u5173\u952e\u200b\u7684\u200b\u51fd\u6570\u200b\u662f\u200b <code>myproc()</code> \uff0c\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u5c06\u200b\u8fd4\u56de\u200b\u6307\u5411\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200bPCB\uff08\u200b\u4e5f\u200b\u5c31\u662f\u200b\u8fdb\u7a0b\u200b\u63a7\u5236\u200b\u5757\u200b\uff0c\u200b\u8be6\u89c1\u200b3. \u200b\u8fdb\u7a0b\u200b\u63a7\u5236\u200b\u5757\u200b\uff09\u200b\u7684\u200b\u6307\u9488\u200b\uff08<code>struct proc *</code>\uff09\uff0c\u200b\u91cc\u9762\u200b\u6709\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u5404\u79cd\u200b\u4fe1\u606f\u200b\u3002</li> </ul> </li> <li> <p><code>sleep</code>\u200b\u7684\u200b\u5b9e\u73b0\u200b\u903b\u8f91\u200b\uff1a\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u4e3b\u8981\u200b\u5c31\u662f\u200b\u6839\u636e\u200b\u5404\u4e2a\u200b\u4e0d\u540c\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u81ea\u8eab\u200b\u5e94\u200b\u7684\u200b\u903b\u8f91\u200b\u5373\u53ef\u200b\u3002\u200b\u73b0\u5728\u200b\u7b80\u8981\u200b\u4ecb\u7ecd\u200b<code>sleep</code>\u200b\u903b\u8f91\u200b\u3002</p> <ul> <li>line 61\uff1a\u200b\u83b7\u53d6\u200b\u53c2\u6570\u200b</li> <li>line 63\uff1a\u200b\u7ed9\u200b\u65f6\u949f\u200b\u52a0\u9501\u200b\uff0c\u200b\u83b7\u53d6\u200b\u5f53\u524d\u200b\u7684\u200b\u65f6\u95f4\u200b</li> <li>line 65\uff1a\u200b\u6bd4\u8f83\u200b\u662f\u5426\u200b\u5230\u200b\u4e86\u200b<code>sleep</code>\u200b\u7ed3\u675f\u200b\u7684\u200b\u65f6\u95f4\u200b</li> <li>line 66-69\uff1a\u200b\u8fdb\u7a0b\u200b\u7ed3\u675f\u200b\u4e86\u200b\u5c31\u200b\u9000\u51fa\u200b\uff0c\u200b\u4ec0\u4e48\u200b\u4e5f\u200b\u4e0d\u200b\u505a\u200b</li> <li>line 70\uff1a\u200b\u5426\u5219\u200b\u7ee7\u7eed\u200b\u7761\u7720\u200b</li> <li>line 72-73\uff1a\u200b\u5230\u200b\u65f6\u95f4\u200b\u4e86\u200b\u5219\u200b\u91ca\u653e\u200b\u65f6\u95f4\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u8fd4\u56de\u200b\u7a0b\u5e8f\u200b\uff0c<code>sleep</code>\u200b\u7ed3\u675f\u200b\u3002</li> </ul> </li> </ul>"},{"location":"lab2/part2/#27","title":"2.7 \u200b\u6267\u884c\u200b\u5b8c\u540e\u200b\u8fd4\u56de\u200b\u7528\u6237\u200b\u7a7a\u95f4","text":"<p>\u200b\u5f53\u200bsleep\u200b\u5b8c\u6210\u200b\u4e4b\u540e\u200b\uff0c\u200b\u8fd4\u56de\u200b\u81f3\u200bsyscall\u200b\u51fd\u6570\u200b\u3002\u200b\u5728\u200bsyscall\u200b\u51fd\u6570\u200b\u4e2d\u200b\u8c03\u7528\u200busertrapret\uff0c\u200b\u7528\u4e8e\u200b\u5b8c\u6210\u200b\u90e8\u5206\u200b\u65b9\u4fbf\u200b\u5728\u200bC\u200b\u4ee3\u7801\u200b\u5b9e\u73b0\u200b\u7684\u200b\u8fd4\u56de\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u5de5\u4f5c\u200b\u3002\u200b\u8fd8\u6709\u200b\u4e00\u4e9b\u200b\u5de5\u4f5c\u200b\u53ea\u80fd\u200b\u5728\u200b\u6c47\u7f16\u8bed\u8a00\u200b\u5b8c\u6210\u200b\uff0c\u200b\u5373\u200btrampoline.s\u200b\u4e2d\u200b\u7684\u200buserret\u200b\u51fd\u6570\u200b\u3002\u200b\u6700\u540e\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u6267\u884c\u200bsret\u200b\u6307\u4ee4\u200b\uff0c\u200b\u5207\u56de\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u6267\u884c\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200becall\u200b\u7684\u200b\u4e0b\u200b\u4e00\u6761\u200b\u6307\u4ee4\u200bret\u3002\u200b\u5f53\u200bret\u200b\u6267\u884c\u200b\u5b8c\u540e\u200b\uff0c\u200b\u8fd4\u56de\u200b\u8c03\u7528\u51fd\u6570\u200b\u7684\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u6267\u884c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u4e0b\u200b\u4e00\u6761\u200b\u8bed\u53e5\u200b\u3002</p> <p>\u200b\u4ee5\u4e0a\u200b\uff0c\u200b\u5373\u200b\u662f\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u5927\u81f4\u200b\u7684\u200b\u4ee3\u7801\u6267\u884c\u200b\u6d41\u7a0b\u200b\u3002</p>"},{"location":"lab2/part2/#3-pcb","title":"3. \u200b\u8fdb\u7a0b\u200b\u63a7\u5236\u200b\u5757\u200b\uff08PCB\uff09","text":"<p>\u200b\u76f8\u4fe1\u200b\u540c\u5b66\u200b\u4eec\u200b\u5728\u200b\u7406\u8bba\u8bfe\u200b\u4e0a\u200b\u5df2\u7ecf\u200b\u5b66\u4e60\u200b\u8fc7\u200b\u4e86\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u6982\u5ff5\u200b\uff0c\u200b\u5e76\u4e14\u200b\u5e94\u8be5\u200b\u4e5f\u200b\u77e5\u9053\u200b\u8fdb\u7a0b\u200b\u63a7\u5236\u200b\u5757\u200b\u662f\u200b \u200b\u4fdd\u5b58\u200b\u8fdb\u7a0b\u200b\u5404\u79cd\u200b\u4fe1\u606f\u200b \u200b\u7684\u200b\u5730\u65b9\u200b\u3002</p> <p>\u200b\u5728\u200bxv6\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>proc.h: struct proc</code>\u200b\u4e5f\u200b\u5c31\u662f\u200bproc\u200b\u7ed3\u6784\u200b\u4f53\u200b\u5f53\u4e2d\u200b\u770b\u5230\u200bxv6\u200b\u5bf9\u4e8e\u200b\u8fdb\u7a0b\u200b\u7684\u200bPCB\u200b\u7684\u200b\u5b9a\u4e49\u200b\uff1a <pre><code>struct proc {\nstruct spinlock lock;\n\n// p-&gt;lock must be held when using these:\nenum procstate state;        // Process state\nstruct proc *parent;         // Parent process\nvoid *chan;                  // If non-zero, sleeping on chan\nint killed;                  // If non-zero, have been killed\nint xstate;                  // Exit status to be returned to parent's wait\nint pid;                     // Process ID\n\n// these are private to the process, so p-&gt;lock need not be held.\nuint64 kstack;               // Virtual address of kernel stack\nuint64 sz;                   // Size of process memory (bytes)\npagetable_t pagetable;       // User page table\nstruct trapframe *trapframe; // data page for trampoline.S\nstruct context context;      // swtch() here to run process\nstruct file *ofile[NOFILE];  // Open files\nstruct inode *cwd;           // Current directory\nchar name[16];               // Process name (debugging)\n};\n</code></pre></p> <p>\u200b\u5728\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u63d0\u200b\u51e0\u4e2a\u200b\u4e0e\u200b\u5b9e\u9a8c\u200b\u76f8\u5173\u200b\u7684\u200b\u6210\u5458\u200b\uff1astate\u3001parent\u3001xstate\u3001trapframe\u3001context\u3002</p> <ul> <li><code>state</code>\uff1a\u200b\u7528\u4ee5\u200b\u8868\u5f81\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u72b6\u6001\u200b\u4fe1\u606f\u200b\uff0c\u200b\u5728\u200b<code>proc.h: enum procstate</code>\u200b\u5f53\u4e2d\u200b\u9009\u53d6\u200b\uff1b</li> <li><code>parent</code>\uff1a\u200b\u6307\u5411\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u6307\u9488\u200b\uff0c\u200b\u7528\u6765\u200b \u200b\u5524\u9192\u200b\u7236\u200b\u8fdb\u7a0b\u200b \u200b\u6216\u200b \u200b\u67e5\u627e\u200b\u5b50\u200b\u8fdb\u7a0b\u200b \uff1b</li> <li><code>xstate</code>\uff1a\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u9000\u51fa\u200b\u72b6\u6001\u200b\uff0c\u200b\u7528\u4e8e\u200b\u8fd4\u56de\u200b\u7ed9\u7236\u200b\u8fdb\u7a0b\u200b\u7684\u200bwait\u200b\u51fd\u6570\u200b\u4e2d\u200b\u7684\u200bstatus\u200b\u53c2\u6570\u200b\uff1b</li> <li><code>trapframe</code>\uff1a\u200b\u8fdb\u7a0b\u200b\u5728\u200b\u9677\u5165\u200b\u5185\u6838\u200b\u65f6\u200b\u521d\u59cb\u5316\u200b\u7684\u200b\u4fe1\u606f\u200b\uff0c\u200b\u5305\u542b\u200b\u5185\u6838\u200b\u6808\u200b\u3001\u200b\u7528\u6237\u200b\u6001\u4f20\u200b\u53c2\u7b49\u200b\u4fe1\u606f\u200b\uff0c\u200b\u8be6\u7ec6\u200b\u5185\u5bb9\u200b\u6211\u4eec\u200b\u63a5\u4e0b\u6765\u200b\u4ecb\u7ecd\u200b\uff1b</li> <li><code>context</code>\uff1a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u4e0a\u4e0b\u6587\u200b\u4fe1\u606f\u200b\uff0c\u200b\u5305\u542b\u200bra\u200b\u548c\u200bsp\u200b\u4ee5\u53ca\u200bcallee-saved\u200b\u7684\u200b\u5bc4\u5b58\u5668\u200b\uff1b</li> </ul>"},{"location":"lab2/part2/#31-trapframe","title":"3.1 trapframe","text":"<p>\u200b\u5728\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u5bf9\u200btrapframe\u200b\u8fd9\u4e00\u200b\u6982\u5ff5\u200b\u8fdb\u884c\u200b\u8be6\u7ec6\u200b\u4ecb\u7ecd\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\uff0c\u200b\u5f53\u200b\u8fdb\u7a0b\u200b\u4ece\u200b\u7528\u6237\u200b\u6001\u200b\u9677\u5165\u200b\u5185\u6838\u200b\u65f6\u200b\uff0c\u200b\u7531\u4e8e\u200b\u5185\u6838\u200b\u6001\u200b\u4e5f\u200b\u9700\u8981\u200b\u7528\u5230\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u56e0\u6b64\u200b\u9700\u8981\u200b\u5c06\u200b\u7528\u6237\u200b\u6001\u200b\u7684\u200b\u4e0a\u4e0b\u6587\u200b\uff08\u200b\u5bc4\u5b58\u5668\u200b\u4fe1\u606f\u200b\uff09\u200b\u4fdd\u5b58\u8d77\u6765\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u4e8e\u200b\u540e\u9762\u200b\u8fd4\u56de\u200b\u7528\u6237\u200b\u6001\u65f6\u200b\u91cd\u65b0\u200b\u6062\u590d\u200b\u8fd9\u4e9b\u200b\u4e0a\u4e0b\u6587\u200b\uff08\u200b\u5bc4\u5b58\u5668\u200b\uff09\u3002</p> <p><pre><code>struct trapframe {\n/*   0 */ uint64 kernel_satp;   // kernel page table\n/*   8 */ uint64 kernel_sp;     // top of process's kernel stack\n/*  16 */ uint64 kernel_trap;   // usertrap()\n/*  24 */ uint64 epc;           // saved user program counter\n/*  32 */ uint64 kernel_hartid; // saved kernel tp\n/*  40 */ uint64 ra;\n/*  48 */ uint64 sp;\n/*  56 */ uint64 gp;\n/*  64 */ uint64 tp;\n/*  72 */ uint64 t0;\n/*  80 */ uint64 t1;\n/*  88 */ uint64 t2;\n/*  96 */ uint64 s0;\n/* 104 */ uint64 s1;\n/* 112 */ uint64 a0;\n/* 120 */ uint64 a1;\n/* 128 */ uint64 a2;\n/* 136 */ uint64 a3;\n/* 144 */ uint64 a4;\n/* 152 */ uint64 a5;\n/* 160 */ uint64 a6;\n/* 168 */ uint64 a7;\n/* 176 */ uint64 s2;\n/* 184 */ uint64 s3;\n/* 192 */ uint64 s4;\n/* 200 */ uint64 s5;\n/* 208 */ uint64 s6;\n/* 216 */ uint64 s7;\n/* 224 */ uint64 s8;\n/* 232 */ uint64 s9;\n/* 240 */ uint64 s10;\n/* 248 */ uint64 s11;\n/* 256 */ uint64 t3;\n/* 264 */ uint64 t4;\n/* 272 */ uint64 t5;\n/* 280 */ uint64 t6;\n};\n</code></pre> \u200b\u4e0a\u9762\u200b\u662f\u200bxv6\u200b\u5bf9\u200btrapframe\u200b\u7ed3\u6784\u200b\u4f53\u200b\u7684\u200b\u5b9a\u4e49\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u770b\u89c1\u200b\uff0ctrapframe\u200b\u5f53\u4e2d\u200b\u5305\u542b\u200b\u5185\u6838\u200b\u7684\u200b\u6808\u200b\u6307\u9488\u200b\uff08<code>kernel_sp</code>\uff09\u3001\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u6307\u9488\u200b\uff08<code>kernel_satp</code>\uff09\u200b\u7b49\u200b\u5185\u6838\u200b\u6001\u200b\u76f8\u5173\u200b\u7684\u200b\u4fe1\u606f\u200b\u3002</p> <p>\u200b\u540c\u65f6\u200b\uff0ctrapframe\u200b\u4e5f\u200b\u4fdd\u5b58\u200b\u4e86\u200b\u5168\u5957\u200b\u7684\u200b\u7528\u6237\u200b\u6001\u200b\u5bc4\u5b58\u5668\u200b\u4fe1\u606f\u200b\uff0c\u200b\u4ee5\u53ca\u200b \u200b\u7528\u6237\u200b\u6001\u200b\u9677\u5165\u200b\u5185\u6838\u200b\u65f6\u200b\u5bf9\u5e94\u200b\u7684\u200bPC\u200b\u503c\u200b\uff08<code>epc</code>\uff09 \u3002</p>"},{"location":"lab2/part2/#4-exit","title":"4. exit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5de5\u4f5c\u200b\u6d41\u7a0b","text":"<p>\u200b\u5728\u200b\u4e0a\u9762\u200b\u5173\u4e8e\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u901a\u7528\u200b\u6267\u884c\u200b\u6d41\u7a0b\u200b\u7684\u200b\u57fa\u7840\u200b\u4e0a\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u4fbf\u4e8e\u200b\u540c\u5b66\u200b\u4eec\u200b\u66f4\u597d\u200b\u7684\u200b\u5b8c\u6210\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u6211\u4eec\u200b\u5728\u200b\u6b64\u200b\u4e3a\u200b\u540c\u5b66\u200b\u4eec\u200b\u8be6\u7ec6\u200b\u4ecb\u7ecd\u200bexit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5de5\u4f5c\u200b\u6d41\u7a0b\u200b\u3002</p> <p>\u200b\u9996\u5148\u200b\u6211\u4eec\u200b\u5148\u200b\u6765\u770b\u200b\u4e00\u5f20\u200b\u56fe\u200b\uff1a</p> <p></p> <p>exit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u4e0e\u200b\u5176\u4ed6\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u4e00\u6837\u200b\uff0c\u200b\u5728\u200b\u9677\u5165\u200b\u5185\u6838\u200b\u4e4b\u524d\u200b\u90fd\u200b\u9700\u8981\u200b\u8fdb\u884c\u200b\u76f8\u5e94\u200b\u7684\u200becall\u3001usertrap\u200b\u7b49\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u8fd9\u200b\u4e00\u90e8\u5206\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b\u7684\u200b\u4e3e\u4f8b\u200b\uff1a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u5b9e\u73b0\u200b\u3002\u200b\u6211\u4eec\u200b\u5728\u200b\u8fd9\u91cc\u200b\u4e0d\u518d\u200b\u8fdb\u884c\u200b\u8be6\u7ec6\u200b\u4ecb\u7ecd\u200b\uff0c\u200b\u6211\u4eec\u200b\u7740\u91cd\u200b\u4ecb\u7ecd\u200bexit\u200b\u5728\u200b\u5185\u6838\u200b\u6001\u200b\u7684\u200b\u4e3b\u4f53\u200b\u51fd\u6570\u200b\uff08<code>proc.c: exit(int)</code>\uff09\u200b\u7684\u200b\u5de5\u4f5c\u200b\u6d41\u7a0b\u200b\u3002</p>"},{"location":"lab2/part2/#41","title":"4.1 \u200b\u8fdb\u7a0b\u200b\u8d44\u6e90\u200b\u56de\u6536","text":"<p>exit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u4e3b\u8981\u200b\u529f\u80fd\u200b\u5b9e\u9645\u4e0a\u200b\u5c31\u662f\u200b\u9000\u51fa\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u90a3\u4e48\u200b\u9000\u51fa\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u5c31\u200b\u5fc5\u987b\u200b \u200b\u5148\u8981\u200b\u5c06\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8d44\u6e90\u200b\u8fdb\u884c\u200b\u56de\u6536\u200b \uff0c\u200b\u5426\u5219\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u5185\u5b58\u200b\u6cc4\u6f0f\u200b\u7b49\u200b\u4e00\u7cfb\u5217\u200b\u5947\u602a\u200b\u7684\u200b\u95ee\u9898\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u63a5\u4e0b\u6765\u200b\u4ece\u200bxv6\u200b\u7684\u200b\u6e90\u7801\u200b\u6765\u200b\u5206\u6790\u200b\u8fdb\u7a0b\u200b\u4e3b\u8981\u200b\u9700\u8981\u200b\u54ea\u4e9b\u65b9\u9762\u200b\u7684\u200b\u8d44\u6e90\u200b\u56de\u6536\u200b\u3002</p>"},{"location":"lab2/part2/#411","title":"4.1.1 \u200b\u6253\u5f00\u200b\u6587\u4ef6\u200b\u56de\u6536","text":"<p>\u200b\u9996\u5148\u200b\u56de\u6536\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u6253\u5f00\u200b\u7684\u200b\u6240\u6709\u200b\u6587\u4ef6\u200b\uff1a <pre><code>// Close all open files.\nfor (int fd = 0; fd &lt; NOFILE; fd++) {\nif (p-&gt;ofile[fd]) {\nstruct file *f = p-&gt;ofile[fd];\nfileclose(f);\np-&gt;ofile[fd] = 0;\n}\n}\n</code></pre> xv6\u200b\u4f7f\u7528\u200b\u4e0a\u8ff0\u200b\u4ee3\u7801\u200b\u8fdb\u884c\u200b\u6253\u5f00\u200b\u6587\u4ef6\u200b\u7684\u200b\u56de\u6536\u200b\u3002\u200b\u901a\u8fc7\u200bfor\u200b\u5faa\u73af\u200b\u904d\u5386\u200b\u6240\u6709\u200b\u53ef\u80fd\u200b\u7684\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\uff08fd\uff09\uff0c\u200b\u4f9d\u6b21\u200b\u5224\u65ad\u200b\u8be5\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u662f\u5426\u200b\u5b58\u5728\u200b\u4e8e\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200bPCB\u200b\u4e2d\u200b\u7684\u200bofile\uff08open file\uff09\u200b\u6570\u7ec4\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u5982\u679c\u200b\u5b58\u5728\u200b\uff0c\u200b\u610f\u5473\u7740\u200b\u5f53\u524d\u200bfd\u200b\u5bf9\u5e94\u200b\u7684\u200b\u6587\u4ef6\u200b\u5904\u4e8e\u200b\u6253\u5f00\u200b\u72b6\u6001\u200b\uff0c\u200b\u9700\u8981\u200b\u5173\u95ed\u200b\u56de\u6536\u200b\u3002</p>"},{"location":"lab2/part2/#412","title":"4.1.2 \u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u56de\u6536","text":"<p>\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u56de\u6536\u200b\u9700\u8981\u200b\u591a\u200b\u6b65\u200b\u8fdb\u884c\u200b\uff1a</p> <ol> <li>\u200b\u5524\u9192\u200b\u521d\u59cb\u200b\u8fdb\u7a0b\u200b\uff08initproc\uff09\uff0c\u200b\u4e3a\u200b\u5207\u6362\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u505a\u200b\u51c6\u5907\u200b <pre><code>acquire(&amp;initproc-&gt;lock);\nwakeup1(initproc);\nrelease(&amp;initproc-&gt;lock);\n</code></pre></li> <li>\u200b\u4fdd\u5b58\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u6307\u9488\u200b\uff0c\u200b\u4e3a\u200b\u540e\u7eed\u200b\u5524\u9192\u200b\u505a\u200b\u51c6\u5907\u200b <pre><code>acquire(&amp;p-&gt;lock);\nstruct proc *original_parent = p-&gt;parent;\nrelease(&amp;p-&gt;lock);\n</code></pre></li> <li>\u200b\u5c06\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b \u200b\u5b50\u200b\u8fdb\u7a0b\u200b \u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u6307\u9488\u200b\u66f4\u200b\u6539\u6210\u200binitproc\uff0c\u200b\u5373\u200b\u7406\u8bba\u8bfe\u200b\u4e0a\u200b\u63d0\u5230\u200b\uff1a \u200b\u6240\u6709\u200b\u5b64\u513f\u200b\u8fdb\u7a0b\u200b\u4f1a\u200b\u88ab\u200binitproc\u200b\u7ba1\u7406\u200b <pre><code>acquire(&amp;original_parent-&gt;lock);\n\nacquire(&amp;p-&gt;lock);\n\n// Give any children to init.\nreparent(p);\n</code></pre> \u200b\u5e0c\u671b\u200b\u540c\u5b66\u200b\u4eec\u200b\u80fd\u591f\u200b\u81ea\u5df1\u200b\u67e5\u770b\u200b<code>proc.c: reparent(struct proc *p)</code>\u200b\u51fd\u6570\u200b\uff0c\u200b\u5e76\u200b\u7406\u89e3\u200b\u91cc\u9762\u200b\u67e5\u627e\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u903b\u8f91\u200b\uff0c\u200b\u8fd9\u4f1a\u200b\u5bf9\u200b\u4f60\u200b\u89e3\u51b3\u200b\u4efb\u52a1\u200b\u4e00\u6709\u200b\u5e2e\u52a9\u200b (=  </li> <li>\u200b\u5524\u9192\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7236\u200b\u8fdb\u7a0b\u200b <pre><code>wakeup1(original_parent);\n</code></pre> \u200b\u5173\u4e8e\u200b\u4e3a\u4ec0\u4e48\u200b\u5524\u9192\u200b\u7236\u200b\u8fdb\u7a0b\u200b\uff1a\u200b\u56e0\u4e3a\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u6b64\u65f6\u200b\u53ef\u80fd\u200b\u5904\u5728\u200bwait()\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u800c\u200bxv6\u200b\u7684\u200bwait\u200b\u7684\u200b\u5b9e\u73b0\u200b\u662f\u200b\u8ba9\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7761\u7720\u200b\uff0c\u200b\u7b49\u5f85\u200b\u88ab\u200b\u5524\u9192\u200b\uff0c\u200b\u5982\u679c\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u9000\u51fa\u200b\u65f6\u200b\u4e0d\u200b\u5524\u9192\u200b\u7236\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u90a3\u4e48\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u5c06\u4f1a\u200b\u4e00\u76f4\u200b\u7761\u4e0b\u53bb\u200b... \u200b\u6211\u4eec\u200b\u7684\u200b\u4efb\u52a1\u200b\u4e8c\u200b\u5c31\u662f\u200b\u5728\u200b\u66f4\u6539\u200bwait\u200b\u7684\u200b\u8fd9\u200b\u4e00\u200b\u5b9e\u73b0\u200b\u3002</li> </ol>"},{"location":"lab2/part2/#42","title":"4.2 \u200b\u66f4\u6539\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u72b6\u6001","text":"<p><pre><code>p-&gt;xstate = status;\np-&gt;state = ZOMBIE;\n</code></pre> \u200b\u5176\u4e2d\u200bxstate\u200b\u8868\u793a\u200b\u9000\u51fa\u200b\u65f6\u200b\u8fd4\u56de\u200b\u7ed9\u7236\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u72b6\u6001\u200b\uff0cstate\u200b\u8868\u793a\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u72b6\u6001\u200b\uff0c\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u72b6\u6001\u200b\u90fd\u200b\u5b58\u50a8\u200b\u5728\u200b\u8fdb\u7a0b\u200b\u7684\u200bPCB\uff08<code>proc.h: struct proc</code>\uff09\u200b\u5f53\u4e2d\u200b\u3002</p>"},{"location":"lab2/part2/#43","title":"4.3 \u200b\u8fdb\u5165\u200b\u8c03\u5ea6\u200b\u5668\u200b\u7b49\u5f85\u200b\u88ab\u200b\u56de\u6536","text":"<pre><code>// Jump into the scheduler, never to return.\nsched();\npanic(\"zombie exit\");\n</code></pre>"},{"location":"lab2/part2/#5-wait","title":"5. wait\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff08\u200b\u963b\u585e\u200b\u4e0e\u975e\u200b\u963b\u585e\u200b\uff09\u200b\u7684\u200b\u5de5\u4f5c\u200b\u6d41\u7a0b","text":"<p>\u200b\u540c\u6837\u200b\u7684\u200b\uff0c\u200b\u6211\u4eec\u200b\u5148\u200b\u6765\u770b\u200b\u5f20\u56fe\u200b\uff1a</p> <p></p>"},{"location":"lab2/part2/#51-wait","title":"5.1 \u200b\u963b\u585e\u200b\u65b9\u5f0f\u200b\u7684\u200bwait","text":"<p>\u200b\u5c31\u200b\u50cf\u200b\u521a\u521a\u200b\u56fe\u7247\u200b\u5f53\u4e2d\u200b\u770b\u89c1\u200b\u7684\u200b\uff0c\u200b\u963b\u585e\u200b\u65b9\u5f0f\u200b\u5b9e\u73b0\u200b\u7684\u200bwait\u200b\u4f1a\u200b\u5728\u200b\u7ecf\u5386\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u901a\u7528\u200b\u8c03\u7528\u200b\u6d41\u7a0b\u200b\u4e4b\u540e\u200b\u6765\u5230\u200b\u5185\u6838\u200b\u4e2d\u200b\u7684\u200bwait\u200b\u4e3b\u4f53\u200b\u51fd\u6570\u200b\uff1a<code>proc.c: wait(int)</code>\u3002</p> <p>\u200b\u5728\u200bwait\u200b\u51fd\u6570\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u5b66\u6709\u200b\u4f59\u529b\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u9605\u8bfb\u200b\u4ee3\u7801\u200b\uff0c\u200b\u7406\u89e3\u200b\u5176\u200b\u67e5\u627e\u200b\u50f5\u5c38\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u903b\u8f91\u200b\u3002\u200b\u5f53\u7136\u200b\u4e0d\u200b\u7406\u89e3\u200b\u4e5f\u200b\u662f\u200b\u53ef\u4ee5\u200b\u5b8c\u6210\u200b\u6211\u4eec\u200b\u7684\u200b\u4efb\u52a1\u200b\u4e8c\u200b\u7684\u200b (=\u3002</p> <p>\u200b\u9996\u5148\u200b\uff0cxv6\u200b\u539f\u672c\u200b\u7684\u200b\u5b9e\u73b0\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u5728\u200b<code>proc.c: wait(int)</code>\u200b\u51fd\u6570\u200b\u7684\u200b\u6700\u540e\u200b\u51e0\u884c\u200b\uff1a <pre><code>for (;;) {\n// \u200b\u4e00\u5927\u5806\u200b\u4ee3\u7801\u200b\uff0c\u200b\u4f5c\u7528\u200b\u5c31\u662f\u200b\u7528\u6765\u200b\u67e5\u627e\u200b\u662f\u5426\u200b\u5b58\u5728\u200b\u50f5\u5c38\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u6709\u200b\u5c31\u200b\u8fd4\u56de\u200b\u5bf9\u5e94\u200b\u7684\u200b\u50f5\u5c38\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u7684\u200bpid\n// Wait for a child to exit.\nsleep(p, &amp;p-&gt;lock);  // DOC: wait-sleep\n}\n</code></pre> \u200b\u5b9e\u9645\u4e0a\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u7684\u200bsleep\u200b\u5c31\u662f\u200b\u8ba9\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u8fdb\u884c\u200b\u7761\u89c9\u200b\u7684\u200b\u5730\u65b9\u200b\uff0c\u200b\u5f53\u200b\u4f60\u200b\u67e5\u770b\u200b<code>proc.c: sleep(void *chan, struct spinlock *lk)</code>\u200b\u51fd\u6570\u200b\u7684\u200b\u65f6\u5019\u200b\uff1a <pre><code>// Go to sleep.\np-&gt;chan = chan;\np-&gt;state = SLEEPING;\n</code></pre> \u200b\u5728\u200b\u8fd9\u200b2\u200b\u884c\u200b\u4ee3\u7801\u200b\u5b8c\u6210\u200b\u4e86\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u72b6\u6001\u200b\u66f4\u6539\u200b\uff0c\u200b\u6b64\u540e\u200b\u8c03\u5ea6\u200b\u5668\u200b\u5c31\u200b\u4f1a\u200b\u53d1\u73b0\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u5728\u200b\u7761\u89c9\u200b\uff0c\u200b\u4e0d\u4f1a\u200b\u8c03\u5ea6\u200b\u5230\u200b\u5b83\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c31\u200b\u4f1a\u200b\u6709\u200b\u6211\u4eec\u200b\u56fe\u4e2d\u200b\u5c55\u73b0\u200b\u7684\u200b \u200b\u5728\u200b\u5185\u6838\u200b\u6001\u200b\u7761\u89c9\u200b\uff0c\u200b\u7b49\u5f85\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u5524\u9192\u200b \u200b\u7684\u200b\u73b0\u8c61\u200b\uff0c\u200b\u8fd9\u65f6\u200b\uff0c\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u5c31\u662f\u200b\u88ab\u200b\u963b\u585e\u200b\u4e86\u200b\u3002</p>"},{"location":"lab2/part2/#52-wait","title":"5.2 \u200b\u975e\u200b\u963b\u585e\u200b\u65b9\u5f0f\u200b\u7684\u200bwait","text":"<p>\u200b\u6211\u4eec\u200b\u5728\u200b\u4e86\u89e3\u200b\u4e86\u200b\u963b\u585e\u200b\u65b9\u5f0f\u200b\u7684\u200bwait\u200b\u4e4b\u540e\u200b\uff0c\u200b\u76f8\u6bd4\u200b\u540c\u5b66\u200b\u4eec\u200b\u5df2\u7ecf\u200b\u731c\u5230\u200b\u4e86\u200b\u8be5\u200b\u5982\u4f55\u200b\u5b9e\u73b0\u200b\u975e\u200b\u963b\u585e\u200b\u7684\u200bwait\u200b\u4e86\u200b\uff1a\u200b\u6ca1\u9519\u200b\uff0c\u200b\u5c31\u662f\u200b\u8df3\u8fc7\u200bsleep\uff01</p> <p>\u200b\u4f46\u662f\u200b\uff0c\u200b\u963b\u585e\u200b\u5b9e\u73b0\u200b\u548c\u200b\u975e\u200b\u963b\u585e\u200b\u5b9e\u73b0\u200b\u7684\u200bwait\u200b\u5728\u200b\u5b9e\u9645\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5b9e\u73b0\u200b\u5f53\u4e2d\u200b\u90fd\u200b\u6709\u200b\u5927\u7528\u5904\u200b\uff0c\u200b\u6bd4\u5982\u200b\uff1a \u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u4f7f\u7528\u200b\u975e\u200b\u963b\u585e\u200b\u7684\u200bwait\u200b\u6765\u200b\u5224\u65ad\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u662f\u5426\u200b\u51c6\u5907\u200b\u597d\u200b\u9700\u8981\u200b\u7684\u200b\u8d44\u6e90\u200b\uff0c\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\uff0c\u200b\u7236\u200b\u8fdb\u7a0b\u200b\u53ef\u4ee5\u200b\u5148\u200b\u5e76\u884c\u6267\u884c\u200b\u5176\u4ed6\u200b\u4efb\u52a1\u200b\uff0c\u200b\u7b49\u5f85\u200b\u9700\u8981\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\u63d0\u4f9b\u200b\u7684\u200b\u8d44\u6e90\u200b\u65f6\u200b\uff0c\u200b\u4f7f\u7528\u200b\u963b\u585e\u200bwait\u200b\u6765\u200b\u4fdd\u8bc1\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u8bed\u4e49\u200b\u6b63\u786e\u200b\uff0c\u200b\u8fd9\u662f\u200b\u4e00\u79cd\u200b\u53ef\u884c\u200b\u7684\u200b\u5e76\u884c\u200b\u4f18\u5316\u200b\u624b\u6bb5\u200b\u3002 \u200b\u6240\u4ee5\u200b\u6211\u4eec\u200b\u5fc5\u987b\u200b \u200b\u65b0\u589e\u200b\u4e00\u4e2a\u200b\u6807\u5fd7\u200b\u53c2\u6570\u200bflags \u200b\u6765\u200b\u8868\u793a\u200b\u662f\u5426\u200b\u8fdb\u884c\u200b\u975e\u200b\u963b\u585e\u200bwait\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u76f4\u63a5\u200b\u5c06\u200b\u539f\u6709\u200b\u7684\u200b\u963b\u585e\u200bwait\u200b\u6539\u6210\u200b\u975e\u200b\u963b\u585e\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u5047\u8bbe\u200b\u8fd9\u4e2a\u200b<code>flags=1</code>\u200b\u65f6\u200b\u8868\u793a\u200b\u8fdb\u884c\u200b\u975e\u200b\u963b\u585e\u200bwait\uff0c\u200b\u90a3\u4e48\u200b\u6211\u4eec\u200b\u7684\u200b\u6d4b\u8bd5\u7528\u4f8b\u200b\u6d41\u7a0b\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u7528\u200b\u4e0a\u200b\u56fe\u200b\u7684\u200b\u53f3\u200b\u534a\u8fb9\u200b\u6765\u200b\u5c55\u73b0\u200b\u3002</p> <p>\u200b\u8fd9\u91cc\u200b\u9700\u8981\u200b\u5927\u5bb6\u200b\u5b9e\u73b0\u200b<code>flags=1</code>\u200b\u65f6\u200b\uff0c\u200b\u4e0d\u200b\u8fdb\u884c\u200bsleep\uff0c\u200b\u800c\u662f\u200b\u76f4\u63a5\u200b\u8fd4\u56de\u200b-1\u3002\u200b\u4e3a\u6b64\u200b\uff0c\u200b\u4f60\u200b\u53ef\u80fd\u200b\u9700\u8981\u200b\u77e5\u9053\u200b\uff1a 1. \u200b\u5982\u4f55\u200b\u83b7\u53d6\u200b\u7528\u6237\u200b\u6001\u200b\u4f20\u5165\u200b\u7684\u200b\u53c2\u6570\u200b 2. \u200b\u5728\u200b<code>proc.c: wait(int)</code>\u200b\u5f53\u4e2d\u200b\u4e3a\u4e86\u200b\u4fdd\u8bc1\u200b\u8fdb\u7a0b\u200bPCB\u200b\u7684\u200b\u64cd\u4f5c\u200b\u7684\u200b\u4e92\u65a5\u6027\u200b\uff0c\u200b\u9700\u8981\u200b\u4e0a\u9501\u200b<code>acquire(&amp;p-&gt;lock)</code>\uff0c\u200b\u6240\u4ee5\u200b \u200b\u8bb0\u5f97\u200b\u5728\u200b\u8fd4\u56de\u200b\u4e4b\u524d\u200b\u89e3\u9501\u200b \uff1a<code>release(&amp;p-&gt;lock)</code></p>"},{"location":"lab2/part2/#6-yield","title":"6. yield\u200b\u8fdb\u7a0b\u200b\u6302\u200b\u8d77\u200b\u7684\u200b\u8bed\u4e49\u200b\u4ecb\u7ecd","text":"<p>\u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u8fd0\u884c\u200b\u8fc7\u7a0b\u200b\u5176\u5b9e\u200b\u5c31\u662f\u200bCPU\u200b\u5728\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u6307\u4ee4\u200b\u6bb5\u200b\u9010\u6761\u200b\u53d6\u6307\u200b\u6267\u884c\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5f53\u200bCPU\u200b\u8df3\u8f6c\u200b\u5230\u200b\u53e6\u5916\u200b\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u6307\u4ee4\u200b\u6bb5\u200b\u8fdb\u884c\u200b\u53d6\u6307\u200b\u6267\u884c\u200b\u65f6\u200b\uff0c\u200b\u4fbf\u200b\u53d1\u751f\u200b\u4e86\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5207\u6362\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u5728\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7406\u8bba\u8bfe\u200b\u4e0a\u200b\u5df2\u7ecf\u200b\u5b66\u4e60\u200b\u8fc7\u200b\u8fdb\u7a0b\u200b\u8c03\u5ea6\u200b\u662f\u200b\u600e\u4e48\u200b\u4e00\u200b\u56de\u4e8b\u200b\u4e86\u200b\uff0c\u200b\u90a3\u4e48\u200byield\uff08\u200b\u8fdb\u7a0b\u200b\u6302\u200b\u8d77\u200b\uff09\u200b\u662f\u200b\u4ec0\u4e48\u200b\u610f\u601d\u200b\u5462\u200b\uff1f\u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\u8fdb\u7a0b\u200b\u8fd0\u884c\u200b\u65f6\u200b\u9700\u8981\u200b\u5360\u7528\u200bCPU\uff0c\u200b\u5982\u4e0a\u6240\u8ff0\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8fdb\u7a0b\u200b\u6302\u200b\u8d77\u200b\u5c31\u662f\u200b\u8ba9\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u8ba9\u51fa\u200bCPU\uff0c\u200b\u4ece\u800c\u200b\u4f7f\u200bCPU\u200b\u53ef\u4ee5\u200b\u8c03\u5ea6\u200b\u5230\u200b\u522b\u7684\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p>"},{"location":"lab2/part2/#7","title":"7. \u200b\u53c2\u8003\u8d44\u6599","text":"<p>[1] xv6 book, Sections 4.3 and 4.4 of Chapter 4 [2] Related source files:  </p> <ul> <li>The user-space code for systems calls is in <code>user/user.h</code> and <code>user/usys.pl</code>.  </li> <li>The kernel-space code is <code>kernel/syscall.h</code>, <code>kernel/syscall.c</code>.  </li> <li>The process-related code is <code>kernel/proc.h</code> and <code>kernel/proc.c</code>.  </li> </ul> <p>\u200b    </p>"},{"location":"lab2/part3/","title":"\u5b9e\u9a8c\u200b\u5b9e\u73b0","text":"<p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5bf9\u200b\u4e00\u4e9b\u200b\u5b9e\u73b0\u200b\u7684\u200b\u7ec6\u8282\u200b\u505a\u200b\u4e00\u5b9a\u200b\u63d0\u9192\u200b\uff0c\u200b\u4f46\u662f\u200b\u5b8c\u6574\u200b\u7684\u200b\u6d41\u7a0b\u200b\u9700\u8981\u200b\u81ea\u5df1\u200b\u628a\u63e1\u200b\uff0c\u200b\u6211\u4eec\u200b \u200b\u4e0d\u4f1a\u200b\u7ed9\u51fa\u200b\u6bcf\u200b\u4e00\u6b65\u200b\u5b9e\u73b0\u200b\u6b65\u9aa4\u200b \u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u8fd8\u662f\u200b\u9605\u8bfb\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u5185\u5bb9\u200b\uff0c\u200b\u5f97\u51fa\u200b\u81ea\u5df1\u200b\u7684\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff0c\u200b\u7136\u540e\u200b\u53c2\u8003\u200b\"\u200b\u5b9e\u9a8c\u200b\u5b9e\u73b0\u200b\"\u200b\u8fd9\u90e8\u5206\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u503c\u5f97\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0cxv6\u200b\u7684\u200b\u4ee3\u7801\u200b\u5f88\u200b\u503c\u5f97\u200b\u53c2\u8003\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u770b\u200b\u5176\u4ed6\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u548c\u200b\u529f\u80fd\u200b\u662f\u200b\u600e\u4e48\u200b\u5b9e\u73b0\u200b\u7684\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b <code>printf</code> \u200b\u6216\u8005\u200b <code>gdb</code> \u200b\u7b49\u200b\u65b9\u6cd5\u200b\u67e5\u770b\u200b\u5177\u4f53\u200b\u7684\u200b\u6267\u884c\u200b\u60c5\u51b5\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u9605\u8bfb\u200b xv6 \u200b\u6307\u5bfc\u4e66\u200b\uff0c\u200b\u770b\u770b\u200b\u80cc\u540e\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u673a\u7406\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u5728\u200b\u5b9e\u73b0\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u9047\u5230\u56f0\u96be\u200b\uff0c\u200b\u53ef\u4ee5\u200b \u200b\u5148\u200b\u5c1d\u8bd5\u200b\u56de\u7b54\u200b\u4efb\u52a1\u200b\u56db\u200b \u200b\u63d0\u51fa\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u5b83\u4eec\u200b\u6216\u8bb8\u200b\u53ef\u4ee5\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u66f4\u597d\u200b\u5730\u200b\u7406\u89e3\u200b\u3002</p>"},{"location":"lab2/part3/#1","title":"1. \u200b\u4efb\u52a1\u200b\u4e00\u200b\uff1a\u200b\u8fdb\u7a0b\u200b\u4fe1\u606f\u200b\u6536\u96c6","text":"<p>\u200b\u5177\u4f53\u200b\u8981\u6c42\u200b\uff1a\u200b\u5728\u200bexit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5f53\u4e2d\u200b\u5bfb\u627e\u200b\u5408\u9002\u200b\u7684\u200b\u8f93\u51fa\u200b\u65f6\u95f4\u200b\u70b9\u200b\uff0c\u200b\u5728\u200b\u76f8\u5e94\u200b\u7684\u200b\u51fd\u6570\u200b\u5185\u200b\u8fdb\u884c\u200b\u7236\u5b50\u200b\u8fdb\u7a0b\u200b\u4fe1\u606f\u200b\u7684\u200b\u6253\u5370\u200b\u3002</p>"},{"location":"lab2/part3/#11","title":"1.1 \u200b\u6d41\u7a0b","text":"<p>\u200b\u9996\u5148\u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff1a</p> <ul> <li>\u200b\u53c2\u8003\u200b\u8fd9\u4e2a\u200b\u6307\u5357\u200b\uff0c\u200b\u5207\u6362\u200b\u5230\u200bsyscall\u200b\u5206\u652f\u200b\u5e76\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff1b</li> </ul> <p>\u200b\u5728\u200b\u5185\u6838\u200b\u90e8\u5206\u200b\uff1a</p> <ul> <li>\u200b\u53c2\u8003\u200bexit\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5de5\u4f5c\u200b\u6d41\u7a0b\u200b\uff0c\u200b\u9605\u8bfb\u200b<code>proc.c: exit(int)</code>\u200b\u76f8\u5173\u200b\u6e90\u7801\u200b\uff0c\u200b\u5728\u200b\u5408\u9002\u200b\u7684\u200b\u4f4d\u7f6e\u200b\u4f7f\u7528\u200b<code>exit_info</code>\u200b\u8f93\u51fa\u200b\u3002</li> <li>\u200b\u7136\u540e\u200b\u542f\u52a8\u200bxv6\uff0c\u200b\u5728\u200bshell\u200b\u8f93\u5165\u200b <code>exittest</code> \uff0c\u200b\u8981\u200b\u80fd\u200b\u6ee1\u8db3\u200b\u5b9e\u9a8c\u200b\u6982\u8ff0\u200b\u4e2d\u200b\u63d0\u5230\u200b\u7684\u200b\u8f93\u51fa\u200b\u3002</li> </ul>"},{"location":"lab2/part3/#2-wait","title":"2. \u200b\u4efb\u52a1\u200b\u4e8c\u200b\uff1await\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u975e\u200b\u963b\u585e\u200b\u9009\u9879\u200b\u5b9e\u73b0","text":"<p>\u200b\u5177\u4f53\u200b\u8981\u6c42\u200b\uff1a\u200b\u66f4\u6539\u200b\u539f\u6709\u200b\u7684\u200bwait\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u6dfb\u52a0\u200b\u65b0\u200b\u53c2\u6570\u200b\uff0c\u200b\u5b9e\u73b0\u200bwait\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u975e\u200b\u963b\u585e\u200b\u9009\u9879\u200b\u3002</p>"},{"location":"lab2/part3/#21","title":"2.1 \u200b\u6d41\u7a0b","text":"<p>\u200b\u5728\u200b\u7528\u6237\u200b\u90e8\u5206\u200b\uff1a</p> <ul> <li>\u200b\u7531\u4e8e\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u5c06\u200b\u7528\u6237\u200b\u6001\u200b\u7684\u200bwait\u200b\u63a5\u53e3\u200b\u505a\u597d\u200b\u4e86\u200b\u66f4\u6539\u200b\uff0c\u200b\u540c\u5b66\u200b\u4eec\u200b\u65e0\u9700\u200b\u66f4\u6539\u200b\u7528\u6237\u200b\u90e8\u5206\u200b\u4ee3\u7801\u200b\u3002</li> </ul> <p>\u200b\u5728\u200b\u5185\u6838\u200b\u90e8\u5206\u200b\uff1a</p> <ul> <li>\u200b\u66f4\u6539\u200b\u5185\u6838\u200b\u90e8\u5206\u200b\u7684\u200bwait\u200b\u63a5\u53e3\u5b9a\u4e49\u200b\uff08\u200b\u5728\u200b<code>defs.h</code>\u200b\u4e2d\u200b\uff09\uff0c\u200b\u4ee5\u53ca\u200b\u76f8\u5e94\u200b\u7684\u200b\u51fd\u6570\u200b\u63a5\u53e3\u200b\uff08<code>proc.c: wait(uint64)</code>\uff09\uff1b</li> <li>\u200b\u5728\u200b<code>sysproc.c: sys_wait(void)</code>\u200b\u51fd\u6570\u200b\u4e2d\u200b\u83b7\u53d6\u200b\u7528\u6237\u200b\u6001\u200b\u4f20\u5165\u200b\u7684\u200b\u65b0\u200b\u53c2\u6570\u200b\uff1b</li> <li>\u200b\u5728\u200b<code>proc.c: wait(uint64, int)</code>\u200b\u4e2d\u200b\u5b9e\u73b0\u200b\u975e\u200b\u963b\u585e\u200b\u903b\u8f91\u200b\u3002</li> <li>\u200b\u7136\u540e\u200b\u542f\u52a8\u200bxv6\uff0c\u200b\u5728\u200bshell\u200b\u8f93\u5165\u200b <code>waittest</code> \uff0c\u200b\u8981\u200b\u80fd\u200b\u6ee1\u8db3\u200b\u5b9e\u9a8c\u200b\u6982\u8ff0\u200b\u4e2d\u200b\u63d0\u5230\u200b\u7684\u200b\u8f93\u51fa\u200b\u3002</li> </ul>"},{"location":"lab2/part3/#3-yield","title":"3. \u200b\u4efb\u52a1\u200b\u4e09\u200b\uff1a\u200b\u5b9e\u73b0\u200byield\u200b\u7cfb\u7edf\u200b\u8c03\u7528","text":"<p>\u200b\u5177\u4f53\u200b\u8981\u6c42\u200b\uff1a\u200b\u5b9e\u73b0\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200byield\uff0c\u200b\u5e76\u4e14\u200b\u5728\u200b\u8c03\u7528\u200b\u8be5\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u65f6\u200b\uff0c\u200b\u6253\u5370\u200b\u7528\u6237\u200b\u6001\u200bPC\u200b\u503c\u200b\u3002</p>"},{"location":"lab2/part3/#31","title":"3.1 \u200b\u6d41\u7a0b","text":"<p>\u200b\u5728\u200b\u7528\u6237\u200b\u90e8\u5206\u200b\uff1a</p> <ul> <li>\u200b\u5728\u200b<code>user.h</code>\u200b\u6dfb\u52a0\u200b\u76f8\u5173\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u58f0\u660e\u200b\uff1b</li> <li>\u200b\u5728\u200b<code>usys.pl</code>\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u65b0\u589e\u200b\u4e00\u4e2a\u200bentry\uff1b</li> <li>\u200b\u5728\u200b<code>Makefile</code>\u200b\u7684\u200b<code>UPROGS</code>\u200b\u53d8\u91cf\u200b\u4e2d\u200b\u65b0\u589e\u200b\u4e00\u4e2a\u200b\u7528\u6237\u7a0b\u5e8f\u200b<code>_yieldtest</code>\u3002</li> </ul> <p>\u200b\u5728\u200b\u5185\u6838\u200b\u90e8\u5206\u200b\uff1a</p> <ul> <li>\u200b\u5728\u200b<code>syscall.h</code>\u200b\u4e2d\u200b\u589e\u52a0\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53f7\u200b\uff0c\u200b\u5177\u4f53\u200b\u503c\u200b\u4f60\u200b\u81ea\u5df1\u200b\u51b3\u5b9a\u200b\uff1b</li> <li>\u200b\u5728\u200b<code>syscall.c</code>\u200b\u4e2d\u200b\u589e\u52a0\u200b\u4e00\u4e2a\u200bextern\u200b\u51fd\u6570\u200b\u58f0\u660e\u200b\uff0c\u200b\u4ee5\u53ca\u200b\u5728\u200b<code>syscalls</code>\u200b\u6570\u7ec4\u200b\u4e2d\u200b\u589e\u52a0\u200b\u4e00\u9879\u200b\uff1b</li> <li>\u200b\u5728\u200b<code>sysproc.c</code>\u200b\u4e2d\u200b\u589e\u52a0\u200b\u4e00\u4e2a\u200b<code>sys_yield</code>\u200b\u51fd\u6570\u200b\uff0c\u200b\u5728\u200b\u8be5\u200b\u51fd\u6570\u200b\u4e2d\u200b\uff1a<ul> <li>\u200b\u9996\u5148\u200b\u9700\u8981\u200b\u83b7\u53d6\u200b\u5230\u200b\u7528\u6237\u200b\u4e0a\u4e0b\u6587\u200b\u4e2d\u200b\u4fdd\u5b58\u200b\u7684\u200bPC\u200b\u503c\u200b\uff0c\u200b\u7136\u540e\u200b\u6253\u5370\u200b\u51fa\u6765\u200b\uff1b</li> <li>\u200b\u7136\u540e\u200b\u5c06\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u6302\u200b\u8d77\u200b\uff0cXV6\u200b\u5185\u6838\u200b\u6001\u200b\u5df2\u7ecf\u200b\u5e2e\u200b\u6211\u4eec\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u4e00\u4e2a\u200b<code>yield</code>\u200b\u51fd\u6570\u200b\u4e86\u200b\u3002</li> </ul> </li> </ul>"},{"location":"lab2/part3/#4","title":"4. \u200b\u4efb\u52a1\u200b\u56db\u200b\uff1a\u200b\u56de\u7b54\u200b\u95ee\u9898","text":"<p>\u200b\u56de\u7b54\u200b\u95ee\u9898\u200b</p> <p>(1) \u200b\u9605\u8bfb\u200b<code>kernel/syscall.c</code>\uff0c\u200b\u8bd5\u200b\u89e3\u91ca\u200b\u51fd\u6570\u200b <code>syscall()</code> \u200b\u5982\u4f55\u200b\u6839\u636e\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53f7\u200b\u8c03\u7528\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5904\u7406\u51fd\u6570\u200b\uff08\u200b\u4f8b\u5982\u200b<code>sys_fork</code>\uff09\uff1f<code>syscall()</code> \u200b\u5c06\u200b\u5177\u4f53\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u7684\u200b\u8fd4\u56de\u503c\u200b\u5b58\u653e\u200b\u5728\u200b\u54ea\u91cc\u200b\uff1f</p> <p>(2) \u200b\u9605\u8bfb\u200b<code>kernel/syscall.c</code>\uff0c\u200b\u54ea\u4e9b\u200b\u51fd\u6570\u200b\u7528\u4e8e\u200b\u4f20\u9012\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u53c2\u6570\u200b\uff1f\u200b\u8bd5\u200b\u89e3\u91ca\u200bargraw()\u200b\u51fd\u6570\u200b\u7684\u200b\u542b\u4e49\u200b\u3002</p> <p>(3) \u200b\u9605\u8bfb\u200b<code>kernel/proc.c</code>\u200b\u548c\u200b<code>proc.h</code>\uff0c\u200b\u8fdb\u7a0b\u200b\u63a7\u5236\u200b\u5757\u200b\u5b58\u50a8\u200b\u5728\u200b\u54ea\u4e2a\u200b\u6570\u7ec4\u200b\u4e2d\u200b\uff1f\u200b\u8fdb\u7a0b\u200b\u63a7\u5236\u200b\u5757\u200b\u4e2d\u200b\u54ea\u4e2a\u200b\u6210\u5458\u200b\u6307\u793a\u200b\u4e86\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u72b6\u6001\u200b\uff1f\u200b\u4e00\u5171\u200b\u6709\u200b\u54ea\u4e9b\u200b\u72b6\u6001\u200b\uff1f</p> <p>(4) \u200b\u5728\u200b\u4efb\u52a1\u200b\u4e00\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u4e3a\u4ec0\u4e48\u200b\u5b50\u200b\u8fdb\u7a0b\u200b\uff084\u30015\u30016\u200b\u53f7\u200b\u8fdb\u7a0b\u200b\uff09\u200b\u7684\u200b\u8f93\u51fa\u200b\u4e4b\u524d\u200b\u4f1a\u200b \u200b\u7a33\u5b9a\u200b\u7684\u200b \u200b\u51fa\u73b0\u200b\u4e00\u4e2a\u200b<code>$</code>\u200b\u7b26\u53f7\u200b\uff1f\uff08\u200b\u63d0\u793a\u200b\uff1ashell\u200b\u7a0b\u5e8f\u200b(<code>sh.c</code>)\u200b\u4e2d\u200b\u4ec0\u4e48\u200b\u65f6\u5019\u200b\u6253\u5370\u200b\u51fa\u200b<code>$</code>\u200b\u7b26\u53f7\u200b\uff1f\uff09 </p> <p>(5) \u200b\u5728\u200b\u4efb\u52a1\u200b\u4e09\u200b\u5f53\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u63d0\u5230\u200b\u6d4b\u8bd5\u200b\u65f6\u200b\u9700\u8981\u200b\u6307\u5b9a\u200bCPU\u200b\u7684\u200b\u6570\u91cf\u200b\u4e3a\u200b1\uff0c\u200b\u56e0\u4e3a\u200b\u5982\u679c\u200bCPU\u200b\u6570\u91cf\u200b\u5927\u4e8e\u200b1\u200b\u7684\u8bdd\u200b\uff0c\u200b\u8f93\u51fa\u200b\u7ed3\u679c\u200b\u4f1a\u200b\u51fa\u73b0\u200b\u4e71\u7801\u200b\uff0c\u200b\u8fd9\u662f\u200b\u4e3a\u4ec0\u4e48\u200b\u5462\u200b\uff1f\uff08\u200b\u63d0\u793a\u200b\uff1a\u200b\u591a\u200b\u6838\u5fc3\u200b\u8c03\u5ea6\u200b\u548c\u200b\u5355\u6838\u5fc3\u200b\u8c03\u5ea6\u200b\u6709\u200b\u4ec0\u4e48\u200b\u533a\u522b\u200b\uff1f\uff09</p> <p>\u200b      </p>"},{"location":"lab2/part4/","title":"\u63d0\u4ea4\u200b\u6587\u6863","text":""},{"location":"lab2/part4/#_1","title":"\u5b9e\u9a8c\u200b\u63d0\u4ea4","text":"<p>\u200b\u5b9e\u9a8c\u200b\u4e8c\u200b\u63d0\u4ea4\u200b \u200b\u5b9e\u9a8c\u62a5\u544a\u200b  \u200b\u548c\u200b  \u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b(\u200b\u53ea\u200b\u63d0\u4ea4\u200bcommit.patch\u200b\u6587\u4ef6\u200b)  \u3002</p>"},{"location":"lab2/part4/#1","title":"1 \u200b\u5b9e\u9a8c\u200b\u62a5\u544a\u4f1a\u200b\u7eb3\u5165\u200b\u8bc4\u5206","text":"<p>\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u8981\u6c42\u200b \u200b\u56de\u7b54\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u5e76\u200b\u5199\u51fa\u200b\u5b9e\u9a8c\u8bbe\u8ba1\u200b\u601d\u8def\u200b\u548c\u200b\u8fd0\u884c\u200b\u7ed3\u679c\u200b \u3002</p> <p>\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u4e5f\u200b\u662f\u200b\u8bc1\u660e\u200b\u5b9e\u9a8c\u200b\u662f\u200b\u72ec\u7acb\u200b\u5b8c\u6210\u200b\u7684\u200b\u91cd\u8981\u4f9d\u636e\u200b\uff0c\u200b\u6709\u200b\u5206\u6570\u200b\u8ffd\u6c42\u200b\u7684\u200b\u5927\u4f6c\u200b\uff08juanwang\uff09\u200b\u4eec\u200b\u4e0d\u8981\u200b\u53ea\u653e\u200b\u4ee3\u7801\u200b\u548c\u200b\u6307\u5bfc\u4e66\u200b\u7684\u200b\u622a\u56fe\u200b\u3002</p>"},{"location":"lab2/part4/#2-commitpatch","title":"2 \u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b(\u200b\u53ea\u200b\u63d0\u4ea4\u200bcommit.patch\u200b\u6587\u4ef6\u200b)","text":"<p>\u200b\u4e0d\u200b\u9700\u8981\u200b\u63d0\u4ea4\u200b\u5b8c\u6574\u200b\u7684\u200b\u4ee3\u7801\u200b\u5305\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u63d0\u4ea4\u200bcommit.patch\u200b\u6587\u4ef6\u200b\u5373\u53ef\u200b\uff0c\u200b\u64cd\u4f5c\u6b65\u9aa4\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>\u200b\u5728\u200b\u5b8c\u6210\u200b\u5b9e\u9a8c\u200b\u4e4b\u540e\u200b\uff0c\u200b\u5c06\u200b\u5f53\u524d\u200b\u5206\u652f\u200b\u4e0a\u200b\u7684\u200b\u6240\u6709\u200b\u66f4\u6539\u200b\u8fdb\u884c\u200b\u63d0\u4ea4\u200b\uff08commit\uff0c\u200b\u5177\u4f53\u65b9\u6cd5\u200b\u53c2\u8003\u200bgit\u200b\u4f7f\u7528\u200b\u6559\u7a0b\u200b\uff09</li> <li>\u200b\u5728\u200b\u4ed3\u5e93\u200b\u7684\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u4f7f\u7528\u200b<code>make diff</code>\u200b\u547d\u4ee4\u200b\u5bfc\u51fa\u200b\u66f4\u6539\u200b\u6587\u4ef6\u200b\uff08commit.patch\uff09</li> <li>\u200b\u5c06\u200b \u200b\u751f\u6210\u200b\u7684\u200bcommit.patch\u200b\u6587\u4ef6\u200b \u200b\u4e0e\u200b \u200b\u5b9e\u9a8c\u62a5\u544a\u200b \u200b\u4e00\u8d77\u200b\u6253\u5305\u200b\u63d0\u4ea4\u200b\u5230\u200b\u4f5c\u4e1a\u200b\u63d0\u4ea4\u200b\u5e73\u53f0\u200b\u5373\u53ef\u200b</li> </ul>"},{"location":"lab3/part1/","title":"\u5b9e\u9a8c\u200b\u6982\u8ff0","text":"<p>\u200b\u6e29\u200b\uff08\u200b\u5b88\u200b\uff09\u200b\u99a8\u200b\uff08\u200b\u4f4f\u200b\uff09\u200b\u63d0\u200b\uff08\u200b\u7ea2\u200b\uff09\u200b\u793a\u200b\uff08\u200b\u7ebf\u200b\uff09</p> <p>\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u5df2\u200b\u5f15\u5165\u200b\u4ee3\u7801\u200b\u81ea\u52a8\u200b\u67e5\u91cd\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u4fdd\u6301\u200b\u5b66\u672f\u200b\u8bda\u4fe1\u200b\uff01</p> <p>\u200b\u5173\u4e8e\u200b\u7b2c\u4e8c\u6b21\u200b\u5b9e\u9a8c\u8bfe\u200b\u8003\u6838\u200b</p> <p>\u200b\u6211\u4eec\u200b\u5c06\u200b\u5728\u200b\u7b2c\u56db\u6b21\u200b\u5b9e\u9a8c\u8bfe\u200b\u8fdb\u884c\u200b\u7b2c\u4e8c\u6b21\u200b\u5b9e\u9a8c\u200b\u73b0\u573a\u200b\u9a8c\u6536\u200b\uff1a  </p> <ul> <li> <p>\u200b\u9a8c\u6536\u200b\u5185\u5bb9\u200b \uff1a\u200b\u524d\u200b\u4e09\u6b21\u200b\u5b9e\u9a8c\u200b</p> <ul> <li>Lab1\uff1aXV6\u200b\u4e0e\u200bUnix\u200b\u5b9e\u7528\u7a0b\u5e8f\u200b</li> <li>Lab2\uff1a\u200b\u8fdb\u7a0b\u200b\u4e0e\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b</li> <li>Lab3\uff1a\u200b\u9501\u200b\u673a\u5236\u200b\u7684\u200b\u5e94\u7528\u200b  </li> </ul> </li> <li> <p>\u200b\u9a8c\u6536\u200b\u76ee\u7684\u200b \uff1a\u200b\u8003\u5bdf\u200b\u540c\u5b66\u200b\u4eec\u200b\u662f\u5426\u662f\u200b\u81ea\u5df1\u200b\u5b8c\u6210\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u201c\u200b\u590d\u5236\u200b\u62f7\u8d1d\u200b\u201d\u3002  </p> </li> <li> <p>\u200b\u9a8c\u6536\u200b\u5f62\u5f0f\u200b \uff1a\u200b\u52a9\u6559\u200b\u4e0e\u200b\u540c\u5b66\u200b\u4eec\u200b\u8fdb\u884c\u200b\u4e00\u5bf9\u4e00\u200b\u95ee\u7b54\u200b  </p> </li> </ul> <p>\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u8ba4\u771f\u5bf9\u5f85\u200b\uff01</p> <p>\u200b\u8bfe\u7a0b\u200b\u590d\u4e60\u200b\u548c\u200b\u9884\u4e60\u200b\u8981\u6c42\u200b</p> <p>\u200b\u672c\u200b\u8282\u200b\u5b9e\u9a8c\u200b\u4e0e\u200b\u7406\u8bba\u8bfe\u200b\u7684\u200b \u201c\u200b\u591a\u7ebf\u7a0b\u200b\u201d \u3001  \u201c\u200b\u4fe1\u53f7\u91cf\u200b\u201d   \u200b\u548c\u200b \u201c\u200b\u6b7b\u9501\u200b\u201d \u200b\u8fd9\u200b\u4e09\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u76f8\u5173\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u590d\u4e60\u200b\u8fd9\u200b\u4e09\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u5728\u200b\u505a\u200b\u5b9e\u9a8c\u200b\u4e4b\u524d\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u9605\u8bfb\u200bxv6 book\u200b\u7684\u200b\u4ee5\u4e0b\u200b\u7ae0\u8282\u200b\u53ca\u200b\u76f8\u5173\u200b\u6e90\u4ee3\u7801\u200b\uff1a</p> <ul> <li>[1] xv6 book, Chapter 6 Locking (\u200b\u9501\u200b)</li> <li>[2] xv6 book, 3.5 Code: Physical memory allocator\uff08\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\uff09</li> <li>[3] xv6 book, Chapter 8 File system\uff1a8.1 Overview ~ 8.3 Code: Buffer cache\uff08\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\uff09</li> </ul> <p>\u200b\u5b9e\u9a8c\u200b\u80cc\u666f\u200b</p> <p>\u200b\u9501\u200b\u8d77\u5230\u200b\u4e86\u200b\u4fdd\u62a4\u200b\u4f5c\u7528\u200b\uff0c\u200b\u8ba9\u200b\u4e00\u4e9b\u200b\u5173\u952e\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u5728\u200b\u5e76\u884c\u200b\u73af\u5883\u200b\u4e0b\u200b\u4ecd\u200b\u80fd\u200b\u4fdd\u6301\u200b\u4e00\u81f4\u6027\u200b\u3002</p> <p>\u200b\u5728\u200b\u8fd9\u4e2a\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4e3a\u200b\u591a\u200bCPU\u200b\u6838\u200b\u7684\u200bxv6\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u548c\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\uff08buffer cache\uff09\u200b\u91cd\u65b0\u200b\u8bbe\u8ba1\u200b\u4ee3\u7801\u200b\u4ee5\u200b\u63d0\u9ad8\u200b\u5e76\u884c\u6027\u200b\u3002\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u5b9e\u9a8c\u200b\u5206\u522b\u200b\u7528\u5230\u200b\u4e86\u200b\u4e24\u79cd\u200b \u200b\u4e0d\u540c\u200b \u200b\u7684\u200b\u8bbe\u8ba1\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u6765\u200b\u9002\u7528\u200b\u81ea\u8eab\u200b\u7684\u200b\u7ed3\u6784\u200b\uff0c\u200b\u5927\u5927\u51cf\u5c11\u200b\u9501\u4e89\u200b\u7528\u200b\uff08\u200b\u5728\u200b\u4fdd\u8bc1\u200b\u529f\u80fd\u200b\u6b63\u786e\u200b\u7684\u200b\u524d\u63d0\u200b\u4e0b\u200b\uff09\u3002</p>"},{"location":"lab3/part1/#1","title":"1.  \u200b\u5b9e\u9a8c\u200b\u76ee\u7684","text":"<ol> <li>\u200b\u4e86\u89e3\u200bLock\u200b\u7684\u200b\u5b9e\u73b0\u200b\u539f\u7406\u200b\uff0c\u200b\u7406\u89e3\u200bCPU\u200b\u4e3a\u200bLock\u200b\u7684\u200b\u5b9e\u73b0\u200b\u63d0\u4f9b\u200b\u7684\u200b\u652f\u6301\u200b\u3002  </li> <li>\u200b\u7406\u89e3\u200bxv6\u200b\u7684\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200bkalloc\u200b\u4ee5\u53ca\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200bbuffer cache\u200b\u7684\u200b\u5de5\u4f5c\u200b\u539f\u7406\u200b\uff0c\u200b\u638c\u63e1\u200bLock\u200b\u5728\u200bxv6\u200b\u4e2d\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b/\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u4e2d\u200b\u7684\u200b\u4f5c\u7528\u200b\u3002  </li> <li>\u200b\u638c\u63e1\u200b\u9501\u200b\u7ade\u4e89\u200b\u5bf9\u200b\u7a0b\u5e8f\u200b\u5e76\u884c\u6027\u200b\u7684\u200b\u5f71\u54cd\u200b\u3002  </li> <li>\u200b\u5b66\u4e60\u200b\u51cf\u5c11\u200b\u9501\u200b\u7ade\u4e89\u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002</li> </ol>"},{"location":"lab3/part1/#2","title":"2.  \u200b\u5b9e\u9a8c\u200b\u5b66\u65f6","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e3a\u200b4\u200b\u5b66\u65f6\u200b\u3002</p>"},{"location":"lab3/part1/#3","title":"3.  \u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u53ca\u200b\u8981\u6c42","text":"<p>\u200b\u8bf7\u200b\u5148\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u5e76\u200b\u6ce8\u610f\u200b\u5207\u6362\u200b\u5230\u200block\u200b\u5206\u652f\u200b\u8fdb\u884c\u200b\u8bd5\u9a8c\u200b</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u57fa\u4e8e\u200b lock \u200b\u5206\u652f\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u53c2\u8003\u200b\u201cLab2\uff1a\u200b\u8fdb\u7a0b\u200b\u4e0e\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u201d\u200b\u7684\u200b3.1 \u200b\u5207\u6362\u200b\u5206\u652f\u200b\u8fdb\u884c\u200b\u5207\u6362\u200b\u3002</p>"},{"location":"lab3/part1/#31-memory-allocator","title":"3.1 \u200b\u4efb\u52a1\u200b\u4e00\u200b\uff1a\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\uff08Memory allocator\uff09","text":"<p>\u200b\u4fee\u6539\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\uff08\u200b\u4e3b\u8981\u200b\u4fee\u6539\u200bkernel/kalloc.c\uff09 \uff0c\u200b\u4f7f\u200b\u6bcf\u4e2a\u200bCPU\u200b\u6838\u200b\u4f7f\u7528\u200b\u72ec\u7acb\u200b\u7684\u200b\u5185\u5b58\u200b\u94fe\u8868\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u73b0\u5728\u200b\u7684\u200b\u5171\u4eab\u200b\u94fe\u8868\u200b\u3002</p> <p>XV6\u200b\u7684\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b\u5185\u5b58\u200b\u94fe\u8868\u200b\u4f9b\u200b\u591a\u4e2a\u200bCPU\u200b\u6838\u200b\u4f7f\u7528\u200b\u3002\u200b\u5728\u200b\u4f7f\u7528\u200b<code>kalloc()</code>\u200b\u83b7\u53d6\u200b\u5185\u5b58\u200b\u65f6\u200b\uff0c\u200b\u7531\u4e8e\u200b\u6dfb\u52a0\u200b\u4e86\u200b\u5185\u5b58\u200b\u9501\u200b<code>kmem.lock</code>\uff0c\u200b\u5176\u4ed6\u200bCPU\u200b\u5982\u679c\u200b\u8981\u200b\u5207\u6362\u200b\u8fdb\u884c\u200b\u5185\u5b58\u200b\u7533\u8bf7\u200b\u5fc5\u987b\u200b\u7b49\u5f85\u200b\u5f53\u524d\u200b\u8fdb\u7a0b\u200b\u91ca\u653e\u200b\u5185\u5b58\u200b\u9501\u200b\u3002\u200b\u8981\u200b\u6d88\u9664\u200b\u9501\u4e89\u200b\u7528\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u9700\u8981\u200b\u91cd\u65b0\u200b\u8bbe\u8ba1\u200b\u5185\u5b58\u200b\u94fe\u8868\u200b\u7ba1\u7406\u673a\u5236\u200b\u4ee5\u200b\u907f\u514d\u200b\u5355\u4e2a\u200b\u9501\u200b\u548c\u200b\u5355\u4e2a\u200b\u94fe\u8868\u200b\u3002\u200b\u5b9e\u9a8c\u200b\u57fa\u672c\u200b\u4efb\u52a1\u200b\u662f\u200b\u8ba9\u200b\u6bcf\u4e2a\u200bCPU\u200b\u62e5\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u5185\u5b58\u200b\u94fe\u8868\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u94fe\u8868\u200b\u90fd\u200b\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u9501\u200b\u3002\u200b\u5176\u4e2d\u200b\u6700\u5177\u200b\u6311\u6218\u200b\u7684\u200b\u5c31\u662f\u200b\uff0c\u200b\u5f53\u200b\u4e00\u4e2a\u200bCPU\u200b\u5185\u5b58\u200b\u94fe\u8868\u200b\u4e0d\u8db3\u200b\u65f6\u200b\uff0c\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u5176\u4ed6\u200b\u94fe\u8868\u200b \u200b\u7a83\u53d6\u200b \u200b\u5185\u5b58\u200b\u5757\u200b\uff0c\u200b\u8fd9\u6837\u200b\uff0c\u200b\u5c31\u200b\u4e0d\u4f1a\u200b\u8ba9\u200b\u6240\u6709\u200b\u7684\u200bCPU\u200b\u4e89\u62a2\u200b\u4e00\u4e2a\u200b\u7a7a\u95f2\u200b\u533a\u57df\u200b\uff08\u200b\u7a83\u53d6\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5f15\u53d1\u200b\u9501\u4e89\u200b\u7528\u200b\uff0c\u200b\u4f46\u200b\u8fd9\u200b\u4e5f\u200b\u662f\u200b\u4e0d\u53ef\u907f\u514d\u200b\u7684\u200b\u60c5\u51b5\u200b\uff09\u3002</p> <p>\u200b\u600e\u4e48\u200b\u67e5\u770b\u200bXV6\u200b\u5f00\u542f\u200b\u4e86\u200b\u591a\u5c11\u200b\u4e2a\u200bCPU\u200b\u6838\u200b\uff1f</p> <p>\u200b\u5728\u200b\u8f93\u5165\u200bmake qemu\u200b\u65f6\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4f1a\u200b\u542f\u52a8\u200b3\u200b\u4e2a\u200bCPU\u200b\u6838\u200b\uff0c\u200b\u5177\u4f53\u200b\u53ef\u4ee5\u200b\u67e5\u770b\u200bMakefile\u200b\u6587\u4ef6\u200b\uff1a</p> <pre><code>264 ifndef CPUS\n265 CPUS := 3\n266 endif\n</code></pre> <p>\u200b\u5982\u679c\u200b\u8981\u200b\u5f00\u542f\u200b\u5355\u4e2a\u200bCPU\uff0c\u200b\u4f7f\u7528\u200b\u547d\u4ee4\u200b make CPUS=1 qemu \u200b\u91cd\u65b0\u200b\u7f16\u8bd1\u200b\u5373\u53ef\u200b\u3002\u200b\u5728\u200bC\u200b\u4ee3\u7801\u200b\u4e2d\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200bkernel/param.h\u200b\u4e2d\u200b\u7684\u200bNCPU\u200b\u5b8f\u6765\u200b\u67e5\u770b\u200bCPU\u200b\u7684\u200b\u6570\u76ee\u200b\uff08maximum number of CPUs\uff09\u3002</p>"},{"location":"lab3/part1/#311-kalloctest","title":"3.1.1 \u200b\u5173\u4e8e\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200bkalloctest","text":"<p>\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200b<code>kalloctest</code>\uff08\u200b\u89c1\u200buser/kalloctest.c\uff09\u200b\u6709\u200b\u4e24\u4e2a\u200btest\uff0c\u200b\u5206\u522b\u200b\u662f\u200btest1\u200b\u548c\u200btest2\u3002</p> <ul> <li>(1) \u200b\u5728\u200btest1\u200b\u4e2d\u200bfork\u200b\u51fa\u200b\u591a\u4e2a\u200b\u8fdb\u7a0b\u200b\uff0c\u200b\u5b83\u4eec\u200b\u5e76\u53d1\u200b\u8fd0\u884c\u200b\u4e8e\u200b\u4e0d\u540c\u200bCPU\u200b\u6838\u5fc3\u200b\uff0c\u200b\u7528\u200b <code>sbrk()</code> \u200b\u8fdb\u884c\u200b\u9891\u7e41\u200b\u83b7\u53d6\u200b\u7a7a\u95f2\u200b\u5185\u5b58\u200b\uff08\u200b\u901a\u8fc7\u200b\u8c03\u7528\u200b<code>kalloc()</code>\u200b\u5b9e\u73b0\u200b\uff09\uff0c\u200b\u7136\u540e\u200b\u53c8\u200b\u91ca\u653e\u200b\uff08\u200b\u901a\u8fc7\u200b\u8c03\u7528\u200b<code>kfree()</code>\u200b\u5b9e\u73b0\u200b\uff09\u3002\u200b\u5728\u200b\u83b7\u53d6\u200b\u5185\u5b58\u200b\u7684\u200b\u65f6\u5019\u200b\u4e0d\u540c\u200bCPU\u200b\u6838\u5fc3\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u4e89\u62a2\u200b\u9501\u200b\u3002</li> </ul> <ul> <li>(2) \u200b\u5728\u200btest2\u200b\u4e2d\u200b\u6d4b\u8bd5\u200b\u6240\u6709\u200b\u7a7a\u95f2\u200b\u5185\u5b58\u200b\u7684\u200b\u83b7\u53d6\u200b\u548c\u200b\u91ca\u653e\u200b\uff0c\u200b\u7531\u4e8e\u200btest2\u200b\u672a\u200b\u4f7f\u7528\u200bfork\uff0c\u200b\u53ea\u200b\u5728\u200b\u5355\u200b\u8fdb\u7a0b\u200b\u4e2d\u200b\u6d4b\u8bd5\u200b\u3002</li> </ul> <p>\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200bkalloctest\u200b\u6700\u7ec8\u200b\u4f1a\u200b\u6253\u5370\u200b\u51fa\u200b<code>fetch-and-add</code>\u200b\u7684\u200b\u6570\u76ee\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b \u200b\u6ca1\u6709\u200b\u6210\u529f\u200b\u83b7\u53d6\u200b \u200b\u5230\u200bkmem\u200b\u9501\u200b\u7684\u200b\u6b21\u6570\u200b\uff0c\u200b\u8fd9\u79cd\u200b\u7c97\u7565\u200b\u6d4b\u91cf\u200b\u9501\u4e89\u200b\u7528\u200b\u7684\u200b\u65b9\u5f0f\u200b\uff08\u200b\u5b9e\u9a8c\u200b\u524d\u200b\uff0c\u200b\u5373\u200b\u672a\u4fee\u6539\u200b\u524d\u200b\uff09\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>$ kalloctest\nstart test1\ntest1 results:\n--- lock kmem/bcache stats\nlock: kmem: #fetch-and-add 46375 #acquire() 433016\nlock: bcache: #fetch-and-add 0 #acquire() 1242\n--- top 5 contended locks:\nlock: kmem: #fetch-and-add 46375 #acquire() 433016\nlock: proc: #fetch-and-add 21429 #acquire() 170067\nlock: virtio_disk: #fetch-and-add 13306 #acquire() 114\nlock: proc: #fetch-and-add 6023 #acquire() 170143\nlock: proc: #fetch-and-add 3661 #acquire() 170147\ntot= 46375\ntest1 FAIL\nstart test2\ntotal free number of pages: 32499 (out of 32768)\n.....\ntest2 OK\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c\"lock: kmem\"\u3001\"lock: bcache\"\u3001\"lock: proc\" \u200b\u7b49\u200b\u6307\u793a\u200b\u4e86\u200b\u9501\u200b\u7684\u200b\u7c7b\u578b\u200b\uff0cacquire()\u200b\u8bb0\u5f55\u200b\u4e86\u200b\u6bcf\u79cd\u200b\u9501\u200b \u200b\u88ab\u200b\u8bf7\u6c42\u200b \u200b\u7684\u200b\u6b21\u6570\u200b\uff0cfetch-and-add\u200b\u5c31\u662f\u200b \u200b\u8fdb\u7a0b\u200b\u6ca1\u6709\u200b\u6210\u529f\u200b\u83b7\u53d6\u200b\u5230\u200b\u6b64\u9501\u200b \u200b\u7684\u200b\u6b21\u6570\u200b\u3002\u200b\u4f8b\u5982\u200b\uff0c lock: kmem: #fetch-and-add 46375 #acquire() 433016 \u200b\u8fd9\u53e5\u200b\u8bdd\u200b\u7684\u200b\u610f\u601d\u200b\u662f\u200b\uff0ckmem.lock\u200b\u8bf7\u6c42\u200b\u4e86\u200b433016\u200b\u6b21\u200b\uff0c\u200b\u4ec5\u200b\u6210\u529f\u200b\u4e86\u200b433016 - 46375 = 386641\u200b\u6b21\u200b\uff0c\u200b\u8fd9\u200b\u5c31\u662f\u200b\u53d1\u751f\u200b\u4e86\u200b\u9501\u200b\u4e89\u7528\u200b\u4e86\u200b\uff08lock contention\uff09\u3002</p> <p>\u200b\u8fd9\u4e9b\u200b\u8ba1\u6570\u200b\u6765\u81ea\u200b\u4e8e\u200b\u5728\u200bkalloctest\u200b\u8c03\u7528\u200b\u7684\u200bntas()\uff0c\u200b\u5b83\u200b\u901a\u8fc7\u200b\u6267\u884c\u200bstatistics()\u200b\u51fd\u6570\u200b\uff0c\u200b\u6253\u5f00\u200b\"statistics\"\u200b\u8bbe\u5907\u200b\u6587\u4ef6\u200b\uff0c\u200b\u83b7\u53d6\u200b\u5185\u6838\u200b\u6253\u5370\u200b\u7684\u200b\u90a3\u4e9b\u200b\u9488\u5bf9\u200bkmem\u200b\u548c\u200bbcache\u200b\u9501\u200b( \u200b\u672c\u9a8c\u200b\u7684\u200b\u91cd\u70b9\u200b )\u200b\u53ca\u200b5\u200b\u4e2a\u200b\u7ade\u4e89\u200b\u6700\u200b\u6fc0\u70c8\u200b\u7684\u200b\u9501\u200b\u7684\u200b\u8ba1\u6570\u200b\uff08\u200b\u89c1\u200bkernel/spinlock.c\u200b\u4e2d\u200b\u7684\u200b<code>statslock()</code>\uff09\u3002\u200b\u5173\u4e8e\u200b#acquire\u200b\u548c\u200b#fetch-and-add\u200b\u7684\u200b\u8ba1\u6570\u200b\u7b97\u6cd5\u200b\u89c1\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200bkalloctest\u200b\u5bf9\u9501\u200b\u7684\u200b\u68c0\u6d4b\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u5b58\u5728\u200b\u9501\u4e89\u200b\u7528\u200b\uff0cfetch-and-add\u200b\u7684\u200b\u6570\u91cf\u200b\u5c06\u4f1a\u200b\u5f88\u200b\u9ad8\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5728\u200bacquire()\u200b\u83b7\u5f97\u200b\u9501\u200b\u4e4b\u524d\u200b\u8981\u200b\u8fdb\u884c\u200b\u8bb8\u591a\u200b\u5faa\u73af\u200b\u8fed\u4ee3\u200b\uff0c\"statistics\"\u200b\u8bbe\u5907\u200b\u6587\u4ef6\u200b\u4f1a\u200b\u8fd4\u56de\u200bkmem\u200b\u548c\u200bbcache\u200b\u9501\u200b\u7684\u200b#test-and-set\u200b\u7684\u200b\u603b\u548c\u200b\uff08\u200b\u4e5f\u200b\u5c31\u662f\u200b<code>tot</code>\u200b\u7684\u200b\u503c\u200b\uff0c\u200b\u5373\u200b\u6ca1\u6709\u200b\u83b7\u53d6\u200b\u5230\u200b\u6b64\u9501\u200b\u7684\u200b\u6b21\u6570\u200b\uff09\u3002</p>"},{"location":"lab3/part1/#312","title":"3.1.2 \u200b\u5177\u4f53\u200b\u8981\u6c42","text":"<p>1)   \u200b\u8bf7\u200b\u4f7f\u7528\u200b<code>initlock()</code>\u200b\u521d\u59cb\u5316\u200b\u9501\u200b\uff0c\u200b\u5e76\u200b\u8981\u6c42\u200b\u9501\u200b\u540d\u5b57\u200b\u4ee5\u200b<code>kmem</code>\u200b\u5f00\u5934\u200b\uff1b 2)   \u200b\u8fd0\u884c\u200b<code>kalloctest</code>\u200b\u67e5\u770b\u200b\u5b9e\u73b0\u200b\u7684\u200b\u4ee3\u7801\u200b\u662f\u5426\u200b\u51cf\u5c11\u200b\u4e86\u200b\u9501\u200b\u4e89\u7528\u200b\uff08<code>tot</code>\u200b\u6ca1\u6709\u200b\u83b7\u53d6\u200b\u5230\u200b\u6b64\u9501\u200b\u7684\u200b\u6b21\u6570\u200b\u5c0f\u4e8e\u200b10\u200b\u5219\u200b\u4e3a\u200b\u901a\u8fc7\u200b\uff09\uff1b 3)   \u200b\u8fd0\u884c\u200b <code>usertests sbrkmuch</code> \u200b\u4ee5\u200b\u6d4b\u8bd5\u200b\u4fee\u6539\u200b\u4ee3\u7801\u200b\u540e\u200b\u7cfb\u7edf\u200b\u662f\u5426\u200b\u4ecd\u200b\u53ef\u4ee5\u200b\u5206\u914d\u200b\u6240\u6709\u200b\u7684\u200b\u5185\u5b58\u200b\uff1b 4)   \u200b\u8fd0\u884c\u200b<code>usertests</code>\uff0c\u200b\u786e\u4fdd\u200b\u5176\u80fd\u200b\u80fd\u591f\u200b\u5168\u90e8\u200b\u901a\u8fc7\u200b\uff1b 5)   kalloctest\u200b\u548c\u200busertests\u200b\u7684\u200b\u8f93\u51fa\u200b\u5982\u4e0b\u200b\u56fe\u200b\uff08\u200b\u9501\u4e89\u200b\u7528\u200b\u7684\u200b\u6b21\u6570\u200b\u5927\u5927\u51cf\u5c11\u200b\uff09\uff0c\u200b\u5177\u4f53\u200b\u7684\u200b\u6570\u636e\u200b\u4f1a\u200b\u6709\u6240\u200b\u5dee\u522b\u200b\uff1a</p>"},{"location":"lab3/part1/#32-buffer-cache","title":"3.2 \u200b\u4efb\u52a1\u200b\u4e8c\u200b\uff1a\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\uff08Buffer cache\uff09","text":"<p>\u200b\u5728\u200b\u8bbf\u95ee\u200b\u6587\u4ef6\u200b\u6570\u636e\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4f1a\u200b\u5c06\u200b\u6587\u4ef6\u200b\u7684\u200b\u6570\u636e\u200b\u653e\u7f6e\u200b\u5728\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u4e2d\u200b\u3002\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u662f\u200b\u4e0d\u540c\u200b\u8fdb\u7a0b\u200b\u4e4b\u95f4\u200b\u7684\u200b\u5171\u4eab\u8d44\u6e90\u200b\uff0c\u200b\u56e0\u6b64\u200b\u9700\u8981\u200b\u901a\u8fc7\u200b\u9501\u200b\u786e\u4fdd\u200b\u4f7f\u7528\u200b\u7684\u200b\u6b63\u786e\u6027\u200b\u3002\u200b\u5982\u679c\u200b\u6709\u200b\u591a\u200b\u8fdb\u7a0b\u200b\u5bc6\u96c6\u200b\u5730\u200b\u4f7f\u7528\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u4ed6\u4eec\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u7ade\u4e89\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u7684\u200b<code>bcache.lock</code>\u200b\u9501\u200b\u3002</p> <p>\u200b\u76ee\u524d\u200b\uff0cxv6\u200b\u91c7\u7528\u200b\u5355\u4e2a\u200b\u9501\u6765\u200b\u7ba1\u7406\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u3002\u200b\u5047\u8bbe\u200b\u6709\u200b\u4e09\u4e2a\u200b\u8fdb\u7a0b\u200b\u5927\u91cf\u200b\u8bfb\u5199\u200b\u78c1\u76d8\u200b\uff0c\u200b\u800c\u200b\u7531\u4e8e\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b<code>bcache.lock</code>\u200b\u9501\u200b\uff0c\u200b\u8fd9\u200b\u5c31\u200b\u5bfc\u81f4\u200b\u4e09\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7ade\u4e89\u200b\u5f02\u5e38\u200b\u6fc0\u70c8\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b \u200b\u4fee\u6539\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u5757\u200b\u5217\u8868\u200b\u7684\u200b\u7ba1\u7406\u673a\u5236\u200b\uff08\u200b\u4e3b\u8981\u200b\u4fee\u6539\u200bkernel/bio.c\uff09 \uff0c\u200b\u4f7f\u5f97\u200b\u53ef\u7528\u200b\u591a\u4e2a\u200b\u9501\u200b\u7ba1\u7406\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u4ece\u800c\u200b\u51cf\u5c11\u200b\u7f13\u5b58\u200b\u5757\u200b\u7ba1\u7406\u200b\u7684\u200b\u9501\u200b\u4e89\u7528\u200b\u3002</p>"},{"location":"lab3/part1/#321-bcachetest","title":"3.2.1 \u200b\u5173\u4e8e\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200bbcachetest","text":"<p>\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200bbcachetest\uff08\u200b\u89c1\u200buser/bcachetest.c\uff09\u200b\u901a\u8fc7\u200b\u521b\u5efa\u200b\u591a\u4e2a\u200b\u8fdb\u7a0b\u200b\u91cd\u590d\u200b\u53bb\u200b\u8bfb\u53d6\u200b\u4e0d\u540c\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4ece\u800c\u200b\u9020\u6210\u200bbcache.lock\u200b\u9501\u4e89\u200b\u7528\u200b\u3002</p> <p>\u200b\u6d4b\u8bd5\u200b\u65b9\u5f0f\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b\u5b9e\u9a8c\u200b\u524d\u200b\uff08\u200b\u5373\u200b\u672a\u4fee\u6539\u200b\u524d\u200b\uff09\uff0c\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200bbcachetest\u200b\u7684\u200b\u8f93\u51fa\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\uff0cbcache\u200b\u7684\u200b<code>fetch-and-add</code>\u200b\u503c\u200b\u975e\u5e38\u200b\u5927\u200b\uff0c\u200b\u8bf4\u660e\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u9501\u200b\u7684\u200b\u4e89\u7528\u200b\u975e\u5e38\u200b\u4e25\u91cd\u200b\u3002</p> <p>\u200b\u4fee\u6539\u200bbuffer cache\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u540e\u200b\uff0c\u200b\u6240\u6709\u200b\u9501\u200b\u7684\u200bfetch-and-add\u200b\u7684\u200b\u6570\u76ee\u200b\u5e94\u5f53\u200b\u63a5\u8fd1\u200b\u4e8e\u200b0\u3002</p>"},{"location":"lab3/part1/#322","title":"3.2.2 \u200b\u5177\u4f53\u200b\u8981\u6c42","text":"<p>1)   \u200b\u7406\u60f3\u200b\u72b6\u6001\u200b\u4e0b\u200b\uff0c<code>bcachetest</code>\u200b\u4e2d\u200b\u6570\u636e\u200b\u5757\u200b\u7f13\u5b58\u200b\u76f8\u5173\u200b\u7684\u200b\u6240\u6709\u200b\u9501\u200b<code>fetch-and-add</code>\u200b\u7684\u200b\u603b\u548c\u200b\u5e94\u8be5\u200b\u4e3a\u200b0\uff0c\u200b\u4f46\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u603b\u548c\u200b<code>tot</code>\u200b\u4e0d\u200b\u8d85\u8fc7\u200b500\u200b\u5373\u53ef\u200b\uff1b 2)   \u200b\u8bf7\u200b\u4fee\u6539\u200b<code>bget()</code>\u200b\u548c\u200b<code>brelse()</code>\uff0c\u200b\u4f7f\u5f97\u200b\u7f13\u5b58\u200b\u533a\u200b\u5e76\u53d1\u200b\u7684\u200b\u67e5\u8be2\u200b\u548c\u200b\u91ca\u653e\u200b\u4e0d\u200b\u5bb9\u6613\u200b\u53d1\u751f\u200b\u9501\u4e89\u200b\u7528\u200b\uff0c\u200b\u6bd4\u5982\u200b\uff0c\u200b\u4e0d\u662f\u200b\u6240\u6709\u200b\u6d41\u7a0b\u200b\u90fd\u200b\u5f97\u200b\u7b49\u200bbcache.lock\uff1b 3)   \u200b\u540c\u6837\u200b\u8981\u6c42\u200b<code>usertests</code>\u200b\u4e2d\u200b\u7684\u200b\u7528\u4f8b\u200b\u5168\u90e8\u200b\u901a\u8fc7\u200b\uff0c\u200b\u6700\u540e\u200b\u7684\u200b\u8f93\u51fa\u200b\u5982\u4e0b\u200b\uff08\u200b\u5177\u4f53\u200b\u6570\u636e\u200b\u6709\u6240\u200b\u51fa\u5165\u200b\uff09\uff1a  </p>"},{"location":"lab3/part1/#33","title":"3.3 \u200b\u6d4b\u8bd5","text":"<p>\u200b\u5f53\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u7684\u200b\u4e24\u4e2a\u200b\u5b9e\u9a8c\u200b\u540e\u200b\uff0c\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u8f93\u5165\u200b <code>make grade</code> \u200b\u8fdb\u884c\u200b\u6700\u7ec8\u200b\u6d4b\u8bd5\u200b\u3002</p>"},{"location":"lab3/part2/","title":"\u5b9e\u9a8c\u200b\u539f\u7406","text":"<p>\u200b\u5173\u4e8e\u200b\u9501\u200b\u7684\u200b\u4e00\u4e9b\u200b\u89e3\u91ca\u200b</p> <p>\u200b\u9501\u200b\u7528\u6765\u200b\u4fdd\u8bc1\u6570\u636e\u200b\u4e00\u81f4\u6027\u200b\u7684\u200b\u624b\u6bb5\u200b\u5341\u5206\u200b\u7b80\u5355\u200b\u7c97\u66b4\u200b\uff1a\u200b\u5f53\u200b\u6709\u4eba\u200b\u64cd\u4f5c\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4e0d\u200b\u5141\u8bb8\u200b\u5176\u4ed6\u4eba\u200b\u64cd\u4f5c\u200b\u3002</p> <p>\u200b\u5728\u200b\u591a\u200b\u6838\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u8fd9\u200b\u5c31\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u5f53\u200b\u5f88\u591a\u200bCPU\u200b\u6838\u5fc3\u200b\u8981\u200b\u64cd\u4f5c\u200b\u4e00\u4e2a\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u5982\u200bkalloc\u200b\u4e2d\u200b\u7684\u200bfreelist\uff09\u200b\u65f6\u200b\uff0c\u200b\u9700\u8981\u200b\u6392\u961f\u200b\uff0c\u200b\u4e00\u4e2a\u4e2a\u200b\u6765\u200b\u3002\u200b\u4e00\u4e2a\u200b\u6838\u5fc3\u200b\u5728\u200b\u5e72\u6d3b\u200b\uff0c\u200b\u5176\u4ed6\u200b\u7684\u200b\u6838\u5fc3\u200b\u53ea\u80fd\u200b\u88ab\u200b\u963b\u585e\u4f4f\u200b\uff0c\u200b\u8fd9\u200b\u5c31\u200b\u5bfc\u81f4\u200b\u4e86\u200b\u5e76\u884c\u6027\u200b\u7684\u200b\u4e0b\u964d\u200b\u3002</p> <p>\u200b\u90a3\u200b\u6211\u4eec\u200b\u628a\u200b\u9501\u200b\u5220\u200b\u4e86\u200b\uff0c\u200b\u4e0d\u200b\u963b\u585e\u200b\uff0c\u200b\u5e76\u884c\u6027\u200b\u4e0d\u200b\u5c31\u200b\u4e0a\u53bb\u200b\u4e86\u200b\u5417\u200b\uff1f\u200b\u786e\u5b9e\u200b\uff0c\u200b\u4f46\u200b\u8fd9\u6837\u200b\u529f\u80fd\u200b\u5c31\u200b\u4e0d\u80fd\u200b\u4fdd\u8bc1\u200b\u6b63\u786e\u200b\u4e86\u200b\u3002\u200b\u529f\u80fd\u200b\u6b63\u786e\u200b\u7684\u200b\u91cd\u8981\u6027\u200b\u5f80\u5f80\u200b\u6bd4\u200b\u6027\u80fd\u200b\u9ad8\u200b\u7684\u200b\u91cd\u8981\u6027\u200b\u5927\u5f97\u591a\u200b\u3002\u200b\u56e0\u6b64\u200b\u5728\u200b\u6210\u719f\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e2d\u200b\uff0c\u200b\u4e00\u822c\u200b\u90fd\u200b\u4f1a\u200b\u91c7\u53d6\u200b\u9501\u200b\u7684\u200b\u673a\u5236\u200b\uff0c\u200b\u540c\u65f6\u200b\u901a\u8fc7\u200b\u51cf\u5c11\u200b\u9501\u4e89\u200b\u7528\u200b\u7684\u200b\u65b9\u6cd5\u200b\u4f18\u5316\u200b\u6027\u80fd\u200b\u3002\u200b\u8fd9\u200b\u662f\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u7684\u200b \u200b\u6839\u672c\u200b\u76ee\u7684\u200b \uff0c\u200b\u4e4b\u540e\u200b\u7684\u200b\u7ae0\u8282\u200b\u4e3b\u8981\u200b\u8ba8\u8bba\u200b\u4f7f\u7528\u200b\u9501\u200b\u7684\u200b\u4e00\u4e9b\u200b\u90e8\u4ef6\u200b\uff0c\u200b\u6211\u4eec\u200b\u5728\u200b\u8fd9\u4e9b\u200b\u573a\u666f\u200b\u4e0b\u6765\u200b\u8fdb\u884c\u200b\u9501\u200b\u7684\u200b\u4f18\u5316\u200b\u3002</p>"},{"location":"lab3/part2/#1-memory-allocator","title":"1. \u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\uff08Memory Allocator\uff09","text":"<p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u672c\u200b\u90e8\u5206\u200b\uff0c\u200b\u4f60\u200b\u5e94\u8be5\u200b\u8981\u200b\u77e5\u9053\u200b\uff1a</p> <ul> <li>\u200b\u4ec0\u4e48\u200b\u662f\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\uff1f</li> <li>\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u662f\u200b\u4ec0\u4e48\u200b\uff1f</li> <li>\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u7684\u200b\u6240\u6709\u200b\u64cd\u4f5c\u200b\u53ca\u5176\u200b\u5bf9\u200b\u6570\u636e\u7ed3\u6784\u200b\u7684\u200b\u6539\u53d8\u200b\uff1f</li> <li>\u200b\u6211\u4eec\u200b\u5e94\u8be5\u200b\u5982\u4f55\u200b\u4fee\u6539\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u4ee5\u200b\u8fbe\u5230\u200b\u5b9e\u9a8c\u200b\u76ee\u6807\u200b\uff1f</li> </ul>"},{"location":"lab3/part2/#11","title":"1.1 \u200b\u7b80\u4ecb","text":"<p>\u200b\u5728\u200bxv6\u200b\u4e2d\u200b\uff0c\u200b\u8bbe\u7f6e\u200b\u4e86\u200b\u603b\u91cf\u200b\u4e3a\u200b128MB\u200b\u7684\u200b\u7269\u7406\u200b\u5185\u5b58\u7a7a\u95f4\u200b\uff0c\u200b\u89c1\u200bMakefile\u200b\u4e2d\u200b\u7684\u200b\u7f16\u8bd1\u200b\u8fd0\u884c\u200b\u9009\u9879\u200b\uff1a</p> <pre><code>QEMUOPTS = -machine virt -bios none -kernel $K/kernel -m 128M -smp $(CPUS) -nographic\n</code></pre> <p>\u200b\u5728\u200b\u5185\u6838\u200b\u4ee3\u7801\u200b\u4e2d\u200b\uff0c\u200b\u4e5f\u200b\u7ed9\u51fa\u200b\u4e86\u200b\u5185\u5b58\u5730\u5740\u200b\u5b9a\u4e49\u200b\uff0c\u200b\u5728\u200bkernel/memlayout.h\u3002</p> <pre><code>// the kernel expects there to be RAM\n// for use by the kernel and user pages\n// from physical address 0x80000000 to PHYSTOP.\n#define KERNBASE 0x80000000L\n#define PHYSTOP (KERNBASE + 128*1024*1024)\n</code></pre> <p>\u200b\u5728\u200bxv6 book 3.2\u200b\u5c0f\u8282\u200b\uff0c\u200b\u7ed9\u51fa\u200b\u4e86\u200b\u7269\u7406\u5730\u5740\u200b\u548c\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b\u5206\u5e03\u200b\u53ca\u200b\u6620\u5c04\u200b\u5173\u7cfb\u200b\uff08\u200b\u89c1\u200b\u4e0b\u56fe\u200b\uff09\u3002\u200b\u4e0b\u56fe\u200b\u5de6\u8fb9\u200b\u662f\u200b\u5185\u6838\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\uff0c\u200b\u53f3\u8fb9\u200b\u4e0a\u534a\u200b\u90e8\u5206\u200b\u662f\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\uff08DRAM\uff09\uff0c\u200b\u53f3\u8fb9\u200b\u4e0b\u200b\u534a\u200b\u90e8\u5206\u200b\u662f\u200bI/O\u200b\u8bbe\u5907\u200b\u3002\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u4e3b\u8981\u200b\u5173\u6ce8\u200b\u56fe\u4e2d\u200b\u7684\u200b\u53f3\u8fb9\u200b\u4e0a\u534a\u200b\u90e8\u5206\u200b\uff08\u200b\u6211\u4eec\u200b\u4f1a\u200b\u5728\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u518d\u6b21\u200b\u4ecb\u7ecd\u200b\u5de6\u8fb9\u200b\u90e8\u5206\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\uff1a\uff09\u3002\u200b\u5f53\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u542f\u52a8\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u4ece\u200b\u5730\u5740\u200b0x80000000\u200b\u5f00\u59cb\u8fd0\u884c\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u5730\u5740\u200b\u5176\u5b9e\u200b\u662f\u200b\u7531\u200b\u786c\u4ef6\u200b\u8bbe\u8ba1\u8005\u200b\u51b3\u5b9a\u200b\u7684\u200b\u3002\u200b\u5728\u200bxv6\u200b\u5185\u6838\u200b\u521a\u200b\u542f\u52a8\u200b\u65f6\u200b\uff0c\u200b\u4ece\u200bkernel\u200b\u7ed3\u675f\u200b\u5730\u5740\u200b\uff08end\uff09\u200b\u4e00\u76f4\u200b\u5230\u200bPHYSTOP\u200b\u7684\u200b\u7a7a\u95f4\u200b\u90fd\u200b\u662f\u200b\u7a7a\u95f2\u200b\u7684\u200b\u3002\u200b\u5b9e\u9645\u4e0a\u200b\uff0c\u200b\u5185\u6838\u200b\u4ee3\u7801\u6bb5\u200b\uff08kernel text\uff09\u200b\u548c\u200b\u6570\u636e\u200b\u6bb5\u200b\uff08kernel data\uff09\u200b\u4f1a\u200b\u5360\u7528\u200b\u4e00\u90e8\u5206\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u5269\u4f59\u200b\u7684\u200b\u7a7a\u95f2\u200b\u7a7a\u95f4\u200b\u6bd4\u200b128MB\u200b\u8981\u200b\u5c0f\u200b\u3002</p> <p></p> <p>\u200b\u62d3\u5c55\u200b\u9605\u8bfb\u200b</p> <ul> <li>trampoline\uff1a\u200b\u7528\u6237\u200b\u6001\u200b-\u200b\u5185\u6838\u200b\u6001\u200b\u8df3\u677f\u200b</li> <li>kstack \uff1a\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5185\u6838\u200b\u6808\u200b\u7a7a\u95f4\u200b</li> <li>Guard page\uff1a\u200b\u540c\u65f6\u200b\u5728\u200b\u5185\u6838\u200b\u7a7a\u95f4\u200b\u548c\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7528\u6765\u200b\u4fdd\u62a4\u200bStack\u3002\u200b\u5982\u679c\u200bkernel stack\u200b\u8017\u5c3d\u200b\u4e86\u200b\uff0c\u200b\u5b83\u4f1a\u200b\u6ea2\u51fa\u200b\u5230\u200bGuard page\uff0c\u200b\u4f46\u662f\u200b\u56e0\u4e3a\u200bGuard page\u200b\u7684\u200bPTE\u200b\u4e2d\u200bValid\u200b\u6807\u5fd7\u200b\u4f4d\u672a\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u7acb\u5373\u200b\u89e6\u53d1\u200bpage fault\uff0c\u200b\u8fd9\u6837\u200b\u7684\u200b\u7ed3\u679c\u200b\u597d\u8fc7\u200b\u5185\u5b58\u200b\u8d8a\u754c\u200b\u4e4b\u540e\u200b\u9020\u6210\u200b\u7684\u200b\u6570\u636e\u200b\u6df7\u4e71\u200b\u3002</li> <li>free memory\uff1a\u200b\u9875\u200b\u5206\u914d\u5668\u200b\u7ba1\u7406\u200b\u7684\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u5373\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u4e2d\u200bfreerange\u200b\u8981\u200b\u7ba1\u7406\u200b\u7684\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b</li> <li>kernel data/text\uff1a\u200b\u6570\u636e\u200b\u6bb5\u200b/\u200b\u4ee3\u7801\u6bb5\u200b</li> <li>KERNBASE\uff1a\u200b\u5185\u6838\u200b\u6001\u200b\u57fa\u5740\u200b</li> <li>VIRTIO disk\uff1a\u200b\u78c1\u76d8\u200bIO\u200b\u64cd\u4f5c\u200b\u5730\u5740\u200b</li> <li>UART0\uff1a\u200b\u4e32\u53e3\u200bIO\u200b\u64cd\u4f5c\u200b\u5730\u5740\u200b</li> <li>PLIC\uff1a\u200b\u5e73\u53f0\u200b\u7ea7\u200b\u4e2d\u65ad\u200b\u63a7\u5236\u5668\u200b\u5730\u5740\u200b</li> <li>CLINT\uff1acore-local\u200b\u4e2d\u65ad\u200b\u63a7\u5236\u5668\u200b\u5730\u5740\u200b</li> <li>boot ROM\uff1a\u200b\u7528\u4e8e\u200b\u542f\u52a8\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u3002\u200b\u5f53\u200b\u4e3b\u677f\u200b\u4e0a\u7535\u540e\u200b\uff0c\u200b\u8fd0\u884c\u200b\u7684\u200b\u662f\u200b\u5b58\u50a8\u200b\u5728\u200bboot ROM\u200b\u4e2d\u200b\u7684\u200b\u4ee3\u7801\u200b\uff0c\u200b\u5f53\u200bboot\u200b\u5b8c\u6210\u200b\u4e4b\u540e\u200b\uff0c\u200b\u4f1a\u200b\u8df3\u8f6c\u200b\u5230\u200b\u5730\u5740\u200b0x80000000\u3002</li> </ul> <p>xv6\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u5bf9\u200b\u4e0a\u5c42\u200b\u63d0\u4f9b\u200bkalloc()\u200b\u548c\u200bkfree()\u200b\u63a5\u53e3\u200b\u6765\u200b\u7ba1\u7406\u200b\u8fd9\u200b\u6bb5\u200b\u5269\u4f59\u200b\u7684\u200b\u7a7a\u95f2\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u3002\u200b\u5728\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u65b0\u200b\u5185\u5b58\u7a7a\u95f4\u200b\u7684\u200b\u65f6\u5019\u200b\u8c03\u7528\u200bkalloc()\uff0c\u200b\u5728\u200b\u9700\u8981\u200b\u91ca\u653e\u200b\u5185\u5b58\u7a7a\u95f4\u200b\u7684\u200b\u65f6\u5019\u200b\u8c03\u7528\u200bkfree()\u3002 \u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\uff08allocator\uff09\u200b\u5b9a\u4e49\u200b\u5728\u200bkernel/kalloc.c\u3002</p> <pre><code>struct run {\nstruct run *next;\n};\n\nstruct {\nstruct spinlock lock;\nstruct run *freelist;\n} kmem;\n</code></pre> <p>\u200b\u5206\u914d\u5668\u200b\u7684\u200b\u6838\u5fc3\u200b\u6570\u636e\u7ed3\u6784\u200b\u662f\u200b\u7531\u200b\u7a7a\u95f2\u200b\u7269\u7406\u200b\u9875\u200b\u7ec4\u6210\u200b\u7684\u200b\u94fe\u8868\u200b<code>freelist</code>\uff0c\u200b\u8fd9\u4e2a\u200b\u7a7a\u95f2\u200b\u9875\u200b\u94fe\u8868\u200b\u5c06\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u5212\u5206\u200b\u6210\u200b4KB\u200b\u5927\u5c0f\u200b\u7684\u200b\u9875\u200b\u5e27\u200b\u6765\u200b\u7ba1\u7406\u200b\uff0c\u200b\u5e76\u200b\u4f7f\u7528\u200b \u200b\u81ea\u65cb\u200b\u9501\u200b \uff08spinlock\uff09\u200b\u8fdb\u884c\u200b\u4fdd\u62a4\u200b\u3002\u200b\u6bcf\u4e2a\u200b\u7a7a\u95f2\u200b\u9875\u200b\u5728\u200b\u94fe\u8868\u200b\u91cc\u200b\u90fd\u200b\u662f\u200b<code>struct run next</code>\u200b\u6307\u5411\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u7a7a\u95f2\u200b\u7269\u7406\u200b\u9875\u200b\u3002</p> <p>\u200b\u8fd9\u200b\u53ef\u80fd\u200b\u6bd4\u8f83\u200b\u96be\u200b\u7406\u89e3\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e0d\u59a8\u200b\u4ece\u200b\u8fd9\u4e2a\u200b\u94fe\u8868\u200b\u7684\u200b\u6784\u5efa\u200b\u5f00\u59cb\u200b\u4e86\u89e3\u200b\u3002\u200b\u5728\u200b\u7cfb\u7edf\u542f\u52a8\u200b\u65f6\u200b\uff0c<code>main()</code>\u200b\u51fd\u6570\u200b\uff08\u200b\u89c1\u200bkernel/main.c\uff09\u200b\u8c03\u7528\u200b<code>kinit()</code>\u200b\u6765\u200b\u521d\u59cb\u5316\u200b\u5206\u914d\u5668\u200b\uff0c\u200b\u5b83\u200b\u901a\u8fc7\u200b\u4fdd\u5b58\u200b\u6240\u6709\u200b\u7a7a\u95f2\u200b\u9875\u200b\u6765\u200b\u521d\u59cb\u5316\u200b\u94fe\u8868\u200b\u3002kinit()\u200b\u8c03\u7528\u200b<code>freerange()</code>\u200b\u6765\u200b\u628a\u200b\u7a7a\u95f2\u200b\u5185\u5b58\u200b\u9875\u200b\u52a0\u5230\u200b\u94fe\u8868\u200b\u91cc\u200b\uff0cfreerange()\u200b\u5219\u200b\u662f\u200b\u901a\u8fc7\u200b\u8c03\u7528\u200b<code>kfree()</code>\u200b\u628a\u200b\u6bcf\u4e2a\u200b\u7a7a\u95f2\u200b\u9875\u200b\uff08\u200b\u5730\u5740\u200b\u8303\u56f4\u200b\u4ece\u200bpa_start\u200b\u81f3\u200bpa_end\uff09\u200b\u9010\u4e00\u200b\u52a0\u200b\u5230\u200b\u94fe\u8868\u200b\u91cc\u200b\u6765\u200b\u5b9e\u73b0\u200b\u6b64\u200b\u529f\u80fd\u200b\u7684\u200b\u3002kfree() \u200b\u51fd\u6570\u200b\u7528\u4e8e\u200b\u91ca\u653e\u200b\u6307\u5b9a\u200b\u7684\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u9875\u200b\uff0c\u200b\u5c06\u200b\u5176\u200b\u6dfb\u52a0\u200b\u81f3\u200b<code>freelist</code>\u200b\u4e2d\u200b\uff0c\u200b\u53c2\u6570\u200b<code>pa</code>\u200b\u4e3a\u200b\u9700\u8981\u200b\u91ca\u653e\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u9875\u200b\u53f7\u200b\uff0c\u200b\u5373\u200b\u7269\u7406\u200b\u9875\u200b\u7684\u200b\u9996\u200b\u5730\u5740\u200b\uff0c\u200b\u5b83\u200b\u88ab\u200b\u770b\u4f5c\u200b\u4e00\u4e2a\u200b\u6ca1\u6709\u200b\u7c7b\u578b\u200b\u7684\u200b\u6307\u9488\u200b\u3002\u200b\u5728\u200bkfree()\u200b\u4e2d\u200b\uff0cpa\u200b\u88ab\u200b \u200b\u5f3a\u5236\u200b\u8f6c\u6362\u200b \u200b\u4e3a\u200brun\u200b\u7c7b\u578b\u200b\u7684\u200b\u6307\u9488\u200b\uff0c\u200b\u8fdb\u800c\u200b\u53ef\u4ee5\u200b\u653e\u5165\u200bfreelist\u200b\u4e2d\u200b\u3002\u200b\u56e0\u4e3a\u200b\u7a7a\u95f2\u200b\u9875\u200b\u91cc\u200b\u4ec0\u4e48\u200b\u90fd\u200b\u6ca1\u6709\u200b\uff0c\u200b\u6240\u4ee5\u200b\u7ed3\u6784\u200b\u4f53\u200b<code>run</code>\u200b\u7684\u200b\u6210\u5458\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b \u200b\u4fdd\u5b58\u200b\u5728\u200b\u7a7a\u95f2\u200b\u9875\u200b\u81ea\u8eab\u200b\u91cc\u200b \u3002</p>"},{"location":"lab3/part2/#12","title":"1.2 \u200b\u529f\u80fd\u200b\u4e0e\u200b\u64cd\u4f5c","text":"<p>\u200b\u5173\u4e8e\u200b\u94fe\u8868\u200b\u7684\u200b\u64cd\u4f5c\u200b\u4e3b\u8981\u200b\u6709\u200b\u4e24\u4e2a\u200b\uff1a</p> <p>1\u3001\u200b\u91ca\u653e\u200b\u5185\u5b58\u200b</p> <p>\u200b\u91ca\u653e\u200b\u5185\u5b58\u200b\u7684\u200b\u51fd\u6570\u200b\u662f\u200b<code>kfree(void *pa)</code>\uff0c\u200b\u9996\u5148\u200b\u5c06\u200b <code>void *pa</code> \u200b\u5f00\u59cb\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u7684\u200b\u5185\u5bb9\u200b\u5168\u90e8\u200b\u7f6e\u200b\u4e3a\u200b1\uff0c\u200b\u8fd9\u662f\u200b\u4e3a\u4e86\u200b\u8ba9\u200b\u4e4b\u524d\u200b\u4f7f\u7528\u200b\u5b83\u200b\u7684\u200b\u4ee3\u7801\u200b\u4e0d\u80fd\u200b\u518d\u200b\u8bfb\u53d6\u200b\u5230\u200b\u6709\u6548\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u4f7f\u5f97\u200b\u8fd9\u4e9b\u200b\u4ee3\u7801\u200b\u80fd\u200b\u5c3d\u65e9\u200b\u5d29\u6e83\u200b\u4ee5\u200b\u66b4\u9732\u200b\u95ee\u9898\u200b\u3002\u200b\u7136\u540e\u200b\u5c06\u200b\u8fd9\u200b\u7a7a\u95f2\u200b\u9875\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u52a0\u200b\u5230\u200b\u94fe\u8868\u200b\u5934\u200b\u3002</p> <p>2\u3001\u200b\u7533\u8bf7\u200b\u5185\u5b58\u200b</p> <p><code>void* kalloc(void *)</code>\u200b\u7528\u6765\u200b\u5206\u914d\u5185\u5b58\u200b\u7269\u7406\u200b\u9875\u200b\uff0c\u200b\u529f\u80fd\u200b\u5f88\u200b\u7b80\u5355\u200b\uff0c\u200b\u5c31\u662f\u200b\u79fb\u9664\u200b\u5e76\u200b\u8fd4\u56de\u200b\u7a7a\u95f2\u200b\u94fe\u8868\u200b\u5934\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u5143\u7d20\u200b\uff0c\u200b\u5373\u200b\u7ed9\u200b\u8c03\u7528\u8005\u200b\u5206\u914d\u200b1\u200b\u9875\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u3002</p> <p>\u200b\u7531\u4e8e\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u662f\u200b\u5728\u200b\u591a\u200b\u8fdb\u7a0b\u200b\u4e4b\u95f4\u200b\u5171\u4eab\u200b\u7684\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4e0d\u7ba1\u200b\u662f\u200b\u5206\u914d\u200b\u8fd8\u662f\u200b\u91ca\u653e\u200b\u9875\u9762\u200b\uff0c\u200b\u6bcf\u6b21\u200b\u64cd\u4f5c\u200bkmem.freelist\u200b\u65f6\u200b\u90fd\u200b\u9700\u8981\u200b\u5148\u200b\u7533\u8bf7\u200bkmem.lock\uff0c\u200b\u6b64\u540e\u200b\u518d\u200b\u8fdb\u884c\u200b\u5185\u5b58\u200b\u9875\u9762\u200b\u7684\u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"lab3/part2/#13","title":"1.3 \u200b\u9501\u200b\u673a\u5236","text":"<p><code>kalloc</code>\u200b\u5728\u200b\u4ec0\u4e48\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u4f7f\u7528\u200b\u4e86\u200b\u9501\u200b\uff1f</p> <p>\u200b\u67e5\u9605\u200b<code>kalloc.c</code>\u200b\u4ee3\u7801\u200b\u53ef\u77e5\u200b\uff0c<code>kalloc</code>\u200b\u53ea\u200b\u5728\u200b<code>kalloc()</code>\u200b\u548c\u200b<code>kfree()</code>\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u4e86\u200b\u9501\u200b\uff0c\u200b\u90a3\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u7528\u9501\u200b\u7684\u200b\u60c5\u51b5\u200b\u6709\u200b\u4ec0\u4e48\u200b\u5171\u540c\u4e4b\u5904\u200b\u5462\u200b\uff1f</p> <p>\u200b\u6ca1\u9519\u200b\uff0c\u200b\u4ed6\u4eec\u200b\u90fd\u200b\u662f\u200b\u628a\u200b \u200b\u5bf9\u200b<code>freelist</code>\u200b\u7684\u200b\u64cd\u4f5c\u200b \u200b\u9501\u200b\u4e86\u200b\u8d77\u6765\u200b\u3002<code>kfree()</code>\u200b\u5728\u200b\u5f80\u200b<code>freelist</code>\u200b\u91cc\u200b\u52a0\u5165\u200b\u7a7a\u95f2\u200b\u9875\u200b\u524d\u9501\u200b\u4e86\u200b\u4e00\u4e0b\u200b\uff0c\u200b\u64cd\u4f5c\u200b\u5b8c\u200b\u4e4b\u540e\u200b\u89e3\u9501\u200b\u4e86\u200b\u3002<code>kalloc()</code>\u200b\u5728\u200b\u79fb\u9664\u200b<code>freelist</code>\u200b\u7b2c\u4e00\u4e2a\u200b\u5143\u7d20\u200b\u65f6\u200b\u4e5f\u200b\u540c\u6837\u200b\u52a0\u200b\u4e86\u200b\u9501\u200b\uff0c\u200b\u64cd\u4f5c\u200b\u5b8c\u6210\u200b\u518d\u200b\u91ca\u653e\u200b\u9501\u200b\u3002\u200b\u6240\u4ee5\u200b\u5bf9\u4e8e\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u4e2d\u200b\u9700\u8981\u200b\u9501\u200b\u4fdd\u62a4\u200b\u7684\u200b\u53ea\u6709\u200b\u5bf9\u200b<code>freelist</code>\u200b\u7684\u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"lab3/part2/#14","title":"1.4 \u200b\u4f18\u5316\u200b\u65b9\u6cd5\u200b\uff08\u200b\u91cd\u8981\u200b\uff09","text":"<p>\u200b\u4fee\u6539\u200b\u7a7a\u95f2\u200b\u5185\u5b58\u200b\u94fe\u8868\u200b\u5c31\u662f\u200b<code>freelist</code>\uff0c\u200b\u73b0\u5728\u200b\u6211\u4eec\u200b\u8981\u200b\u51cf\u5c11\u200b\u9501\u200b\u7684\u200b\u4e89\u62a2\u200b\uff0c \u200b\u4f7f\u200b\u6bcf\u4e2a\u200b<code>CPU</code>\u200b\u6838\u200b\u4f7f\u7528\u200b\u72ec\u7acb\u200b\u7684\u200b\u94fe\u8868\u200b \uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u73b0\u5728\u200b\u7684\u200b\u5171\u4eab\u200b\u94fe\u8868\u200b\u3002\u200b\u8fd9\u6837\u200b\u7b49\u200b\u5206\u200b\uff0c\u200b\u5c31\u200b\u4e0d\u4f1a\u200b\u8ba9\u200b\u6240\u6709\u200b\u7684\u200b<code>CPU</code>\u200b\u4e89\u62a2\u200b\u4e00\u4e2a\u200b\u7a7a\u95f2\u200b\u533a\u57df\u200b\u3002\u200b\u6ce8\u610f\u200b\uff1a\u200b\u6bcf\u4e2a\u200b\u7a7a\u95f2\u200b\u7269\u7406\u200b\u9875\u200b\u53ea\u80fd\u200b\u5b58\u5728\u200b\u4e8e\u200b\u4e00\u4e2a\u200bfreelist\u200b\u4e2d\u200b\u3002\u00a0</p>"},{"location":"lab3/part2/#2-buffer-cache","title":"2. \u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\uff08Buffer Cache\uff09","text":"<p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u672c\u200b\u90e8\u5206\u200b\uff0c\u200b\u4f60\u200b\u5e94\u8be5\u200b\u8981\u200b\u77e5\u9053\u200b\uff1a</p> <ul> <li>\u200b\u4ec0\u4e48\u200b\u662f\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\uff1f</li> <li>\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u662f\u200b\u4ec0\u4e48\u200b\uff08bcache\u200b\u548c\u200bbuf\uff09\uff1f</li> <li>\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u7684\u200b\u6240\u6709\u200b\u64cd\u4f5c\u200b\u53ca\u5176\u200b\u5bf9\u200b\u6570\u636e\u7ed3\u6784\u200b\u7684\u200b\u6539\u53d8\u200b\uff1f</li> <li>\u200b\u6211\u4eec\u200b\u5e94\u8be5\u200b\u5982\u4f55\u200b\u4fee\u6539\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u4ee5\u200b\u8fbe\u5230\u200b\u5b9e\u9a8c\u200b\u76ee\u6807\u200b\uff1f  </li> </ul>"},{"location":"lab3/part2/#21","title":"2.1 \u200b\u7b80\u4ecb","text":"<p>xv6\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u662f\u200b\u4ee5\u200b\u78c1\u76d8\u200b\u6570\u636e\u200b\u5757\u200b\u4e3a\u200b\u5355\u4f4d\u200b\u4ece\u200b\u78c1\u76d8\u200b\u8bfb\u5199\u200b\u6570\u636e\u200b\u7684\u200b\u3002\u200b\u7531\u4e8e\u200b\u5bf9\u200b\u78c1\u76d8\u200b\u7684\u200b\u8bfb\u53d6\u200b\u975e\u5e38\u200b\u6162\u200b\uff0c\u200b\u800c\u200b\u5185\u5b58\u200b\u7684\u200b\u901f\u5ea6\u200b\u8981\u200b\u5feb\u5f97\u591a\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5c06\u200b\u6700\u8fd1\u200b\u7ecf\u5e38\u200b\u8bbf\u95ee\u200b\u7684\u200b\u78c1\u76d8\u200b\u5757\u200b\u7f13\u5b58\u200b\u5728\u200b\u5185\u5b58\u200b\u91cc\u200b\u53ef\u4ee5\u200b\u5927\u5927\u200b\u63d0\u5347\u200b\u6027\u80fd\u200b\uff08\u200b\u6b64\u65f6\u200b\u5185\u5b58\u200b\u8d77\u5230\u200bcache\u200b\u7684\u200b\u4f5c\u7528\u200b\uff09\u3002Buffer Cache\uff08\u200b\u4e5f\u200b\u79f0\u4e3a\u200bbcache\uff09\u200b\u5c31\u200b\u62c5\u4efb\u200b\u4e86\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u4e00\u804c\u200b\uff0c\u200b\u5b83\u200b\u662f\u200b\u78c1\u76d8\u200b\u4e0e\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4ea4\u4e92\u200b\u7684\u200b\u4e2d\u95f4\u5c42\u200b\u3002</p> <p>xv6\u200b\u7684\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u6a21\u5757\u200b\u4e3b\u8981\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4ee5\u4e0b\u200b\u529f\u80fd\u200b\uff1a</p> <ol> <li>\u200b\u540c\u6b65\u200b\u8bbf\u95ee\u200b\u78c1\u76d8\u200b\u5757\u200b\u4ee5\u200b\u786e\u4fdd\u200b\u5185\u5b58\u200b\u91cc\u200b\u6bcf\u4e2a\u200b\u5757\u200b\u53ea\u6709\u200b\u4e00\u4efd\u200b\u590d\u5236\u200b\uff0c\u200b\u4e14\u200b\u6bcf\u6b21\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b\u5185\u6838\u200b\u8fdb\u7a0b\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u90a3\u200b\u4efd\u200b\u590d\u5236\u200b\u3002  </li> <li>\u200b\u7f13\u5b58\u200b\u5e38\u7528\u200b\u5757\u200b\uff0c\u200b\u4f7f\u5f97\u200b\u4e0d\u5fc5\u200b\u6bcf\u6b21\u200b\u90fd\u200b\u4ece\u200b\u786c\u76d8\u200b\u4e0a\u200b\u8bfb\u53d6\u200b\u5b83\u4eec\u200b\u3002  </li> <li>\u200b\u4fee\u6539\u200b\u7f13\u5b58\u200b\u5757\u200b\u7684\u200b\u5185\u5bb9\u200b\u540e\u200b\uff0c\u200b\u786e\u4fdd\u200b\u78c1\u76d8\u200b\u4e2d\u200b\u5bf9\u5e94\u200b\u5185\u5bb9\u200b\u7684\u200b\u66f4\u65b0\u200b\u3002  </li> </ol>"},{"location":"lab3/part2/#22","title":"2.2 \u200b\u57fa\u672c\u200b\u7ed3\u6784","text":"<p>\u200b\u6570\u636e\u7ed3\u6784\u200bbcache\uff08\u200b\u89c1\u200bkernel/bio.c\uff09\u200b\u7ef4\u62a4\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u7531\u200b\u9759\u6001\u200b\u6570\u7ec4\u200b<code>struct buf buf[NBUF]</code>\u200b\u7ec4\u6210\u200b\u7684\u200b\u53cc\u5411\u200b\u94fe\u8868\u200b\uff0c\u200b\u5b83\u200b\u4ee5\u5757\u200b\u4e3a\u200b\u5355\u4f4d\u200b\uff0c\u200b\u6bcf\u6b21\u200b\u8bfb\u5165\u200b\u6216\u200b\u5199\u51fa\u200b\u4e00\u4e2a\u200b\u78c1\u76d8\u200b\u5757\u200b\uff0c\u200b\u653e\u5230\u200b\u4e00\u4e2a\u200b\u5185\u5b58\u200b\u7f13\u5b58\u200b\u5757\u200b\u4e2d\u200b\uff08bcache.buf\uff09\uff0c\u200b\u540c\u65f6\u200b\u81ea\u65cb\u200b\u9501\u200b<code>bcache.lock</code>\u200b\u7528\u4e8e\u200b\u7528\u6237\u200b\u4e92\u65a5\u200b\u8bbf\u95ee\u200b\u3002\u200b\u6240\u6709\u200b\u5bf9\u200b\u7f13\u5b58\u200b\u5757\u200b\u7684\u200b\u8bbf\u95ee\u200b\u90fd\u200b\u662f\u200b\u901a\u8fc7\u200b<code>bcache.head</code>\u200b\u5f15\u7528\u200b\u94fe\u8868\u200b\u6765\u200b\u5b9e\u73b0\u200b\u7684\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200bbuf\u200b\u6570\u7ec4\u200b\u3002</p> <pre><code>struct {\nstruct spinlock lock;\nstruct buf buf[NBUF];\n// Linked list of all buffers, through prev/next.\n// head.next is most recently used.\nstruct buf head;\n} bcache;\n</code></pre> <pre><code>struct buf {\nint valid;   // has data been read from disk?\nint disk;    // does disk \"own\" buf?\nuint dev;\nuint blockno;\nstruct sleeplock lock;\nuint refcnt;\nstruct buf *prev; // LRU cache list\nstruct buf *next;\nuchar data[BSIZE];\n};\n</code></pre> <p>\u200b\u6bcf\u4e2a\u200b\u7f13\u5b58\u200b\u5757\u200b\uff08\u200b\u89c1\u200bstruct buf\uff09\u200b\u90fd\u200b\u7531\u200b\u4e09\u4e2a\u200b\u90e8\u5206\u200b\u7ec4\u6210\u200b\uff1a</p> <ul> <li>\uff081\uff09<code>data</code>\u200b\u5b57\u200b\u6bb5\u200b <code>\uff08data[BSIZE]\uff09</code>\u200b\u6807\u793a\u200b\u4e86\u200b\u5b83\u200b\u7684\u200b\u5185\u5bb9\u200b;</li> <li>\uff082\uff09\u200b\u6307\u9488\u200b\u5b57\u200b\u6bb5\u200b <code>\uff08\\*prev\uff0c\\*next\uff09</code>\u200b\u7528\u4e8e\u200b\u7ec4\u6210\u200b\u94fe\u8868\u200b;</li> <li> <p>\uff083\uff09\u200b\u6570\u503c\u5b57\u200b\u6bb5\u200b \u200b\u7528\u4e8e\u200b\u6807\u793a\u200b\u5b83\u200b\u7684\u200b\u5c5e\u6027\u200b\uff0c\u200b\u5982\u200b</p> <ul> <li><code>valid</code> \u200b\u662f\u200b\u7f13\u5b58\u200b\u533a\u200b\u5305\u542b\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5757\u200b\u7684\u200b\u590d\u5236\u200b\uff08\u200b\u5373\u8be5\u200bbuffer\u200b\u5305\u542b\u200b\u5bf9\u5e94\u200b\u78c1\u76d8\u200b\u5757\u200b\u7684\u200b\u6570\u636e\u200b\uff09;</li> <li><code>disk</code> \u200b\u662f\u200b\u7f13\u5b58\u200b\u533a\u200b\u7684\u200b\u5185\u5bb9\u200b\u662f\u5426\u200b\u5df2\u7ecf\u200b\u88ab\u200b\u63d0\u4ea4\u200b\u5230\u200b\u4e86\u200b\u78c1\u76d8\u200b;</li> <li><code>dev</code> \u200b\u662f\u200b\u78c1\u76d8\u200b\u5757\u200b\u7684\u200b\u8bbe\u5907\u200b\u53f7\u200b\uff0c\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200bdev\u200b\u90fd\u200b\u662f\u200b0;</li> <li><code>blockno</code> \u200b\u662f\u200b\u7f13\u5b58\u200b\u7684\u200b\u78c1\u76d8\u200b\u5757\u200b\u53f7\u200b;</li> <li><code>refcnt</code> \u200b\u662f\u200b\u8be5\u200b\u5757\u200b\u88ab\u200b\u5f15\u7528\u200b\u6b21\u6570\u200b\uff08\u200b\u5373\u200b\u88ab\u200b\u591a\u5c11\u200b\u4e2a\u200b\u8fdb\u7a0b\u200b\u62e5\u6709\u200b\uff09;</li> <li><code>lock</code> \u200b\u662f\u200b\u7f13\u5b58\u200b\u78c1\u76d8\u200b\u5757\u200b\u7684\u200b\u7761\u7720\u200b\u9501\u200b\u3002</li> </ul> </li> </ul> <p>\u200b\u4e0a\u56fe\u200b\u662f\u200bbcache\u200b\u7ed3\u6784\u200b\u793a\u610f\u56fe\u200b\u3002bcache.lock\u200b\u662f\u200b\u81ea\u65cb\u200b\u9501\u200b\uff0c\u200b\u7528\u4e8e\u200b\u8868\u793a\u200b bcache \u200b\u94fe\u8868\u200b\u662f\u5426\u200b\u88ab\u200b\u9501\u4f4f\u200b\u3002b-&gt;lock\u200b\u662f\u200b\u7761\u7720\u200b\u9501\u200b\uff0c\u200b\u7528\u4e8e\u200b\u8868\u793a\u200b\u7f13\u5b58\u6570\u636e\u200b\u5757\u200bbuf\u200b\u662f\u5426\u200b\u88ab\u200b\u9501\u4f4f\u200b\u3002</p> <p>\u200b\u5173\u4e8e\u200bbcache</p> <p>\u200b\u770b\u5230\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u5927\u5bb6\u200b\u8fd8\u200b\u662f\u5426\u200b\u8bb0\u5f97\u200b\u6211\u4eec\u200b\u5728\u200b\u300a\u200b\u8ba1\u7b97\u673a\u200b\u7ec4\u6210\u200b\u539f\u7406\u200b\u300b\u200b\u5b9e\u9a8c\u200b\u8bfe\u7a0b\u200b\u4e0a\u200b\u505a\u200b\u8fc7\u200b\u7684\u200bCache\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u5176\u200b\u7ed3\u6784\u200b\u662f\u200b\uff1a\u200b\u6709\u6548\u200b\u4f4d\u200b\uff08Valid\uff09\u3001\u200b\u6807\u8bb0\u200b\uff08Tag\uff09\u200b\u548c\u200b\u6570\u636e\u200b\uff08Data\uff09\u3002\u200b\u4e3b\u8981\u200b\u5dee\u5f02\u200b\u5728\u4e8e\u200b\uff0c\u200b\u7ec4\u6210\u200b\u539f\u7406\u200b\u5b9e\u9a8c\u200b\u662f\u200b\u786c\u4ef6\u200bCache\uff0c\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u662f\u200b\u7528\u200bC\u200b\u8bed\u8a00\u200b\u5199\u200b\u7684\u200b\u5185\u5b58\u200bCache\u3002</p>"},{"location":"lab3/part2/#23","title":"2.3 \u200b\u529f\u80fd\u200b\u4e0e\u200b\u64cd\u4f5c","text":"<p>\u200b\u5bf9\u200bbcache\u200b\u7684\u200b\u64cd\u4f5c\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>\u200b\u5728\u200b\u7cfb\u7edf\u542f\u52a8\u200b\u65f6\u200b\uff0c<code>main()</code>\u200b\u51fd\u6570\u200b\uff08\u200b\u89c1\u200bkernel/main.c\uff09\u200b\u8c03\u7528\u200b<code>binit()</code>\u200b\u6765\u200b\u521d\u59cb\u5316\u200b\u7f13\u5b58\u200b\uff0c\u200b\u968f\u5373\u200b\u8c03\u7528\u200binitlock()\u200b\u521d\u59cb\u5316\u200bbcache.lock\uff0c\u200b\u7136\u540e\u200b\u5faa\u73af\u200b\u904d\u5386\u200bbuf\u200b\u6570\u7ec4\u200b\uff0c\u200b\u91c7\u7528\u200b\u5934\u200b\u63d2\u6cd5\u200b\u9010\u4e2a\u200b\u94fe\u63a5\u200b\u5230\u200bbcache.head\u200b\u540e\u9762\u200b\u3002</li> <li>\u200b\u4e0a\u5c42\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u8bfb\u200b\u78c1\u76d8\u200b\u65f6\u200b\uff0c\u200b\u8c03\u7528\u200b<code>bread()</code>\uff0c\u200b\u968f\u5373\u200b\u8c03\u7528\u200b<code>bget()</code>\u200b\u68c0\u67e5\u200b\u8bf7\u6c42\u200b\u7684\u200b\u78c1\u76d8\u200b\u5757\u200b\u662f\u5426\u200b\u5728\u200b\u7f13\u5b58\u200b\u4e2d\u200b\uff0c\u200b\u5982\u679c\u200b\u547d\u4e2d\u200b\uff0c\u200b\u8fd4\u56de\u200b\u7f13\u5b58\u200b\u547d\u4ee4\u200b\u7ed3\u679c\u200b\u3002\u200b\u5982\u679c\u200b\u672a\u200b\u547d\u4e2d\u200b\uff0c\u200b\u8f6c\u200b\u5230\u200b\u5e95\u5c42\u200b\u7684\u200b<code>virtio_disk_rw()</code>\u200b\u51fd\u6570\u200b\u5148\u200b\u5c06\u200b\u6b64\u200b\u78c1\u76d8\u200b\u5757\u200b\u4ece\u200b\u78c1\u76d8\u200b\u52a0\u8f7d\u200b\u8fdb\u200b\u7f13\u5b58\u200b\u4e2d\u200b\uff0c\u200b\u518d\u200b\u8fd4\u56de\u200b\u6b64\u200b\u78c1\u76d8\u200b\u5757\u200b\u3002</li> <li>\u200b\u4e0a\u5c42\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5199\u200b\u78c1\u76d8\u200b\u65f6\u200b\uff0c\u200b\u8c03\u7528\u200b<code>bwrite()</code>\uff0c\u200b\u968f\u5373\u200b\u8c03\u7528\u200b<code>virtio_disk_rw()</code>\u200b\u51fd\u6570\u200b\u76f4\u63a5\u200b\u5c06\u200b\u7f13\u5b58\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</li> <li>\u200b\u4e0a\u5c42\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u53ef\u200b\u901a\u8fc7\u200b\u8c03\u7528\u200b<code>brelse()</code>\u200b\u91ca\u653e\u200b\u4e00\u5757\u200b\u4e0d\u518d\u200b\u4f7f\u7528\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\u3002</li> <li>\u200b\u4e0a\u5c42\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u53ef\u200b\u901a\u8fc7\u200b<code>bpin()</code>\u200b\u8ba9\u200b\u8be5\u200bbuf\u200b\u7f13\u5b58\u200b\u5757\u200b\u59cb\u7ec8\u200b\u5b58\u200b\u7740\u200b\u67d0\u4e9b\u200b\u6570\u636e\u200b\uff0c\u200b\u5373\u200b\u56fa\u5b9a\u200b\u8be5\u200b\u7f13\u5b58\u200b\u5757\u200b\u4e0d\u80fd\u200b\u88ab\u200b\u66ff\u6362\u200b\u3002<code>bunpin()</code>\u200b\u5219\u200b\u53cd\u4e4b\u200b\u3002</li> </ul> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u78c1\u76d8\u200b\u5c42\u200b\u5728\u200bvirtio_disk.c\uff0c\u200b\u5b9e\u9645\u4e0a\u200b\u5c31\u662f\u200b\u786c\u76d8\u200b\u9a71\u52a8\u200b\u3002</p> <p>\u200b\u7f13\u51b2\u533a\u200b\u7f13\u5b58\u200b\u5c42\u200b\u7528\u5230\u200b\u7684\u200b\u63a5\u53e3\u200b\u662f\u200bvirtio_disc_rw(struct buf *b, int write)</p> <ul> <li>\u200b\u4f5c\u7528\u200b\uff1a\u200b\u5bf9\u200b\u78c1\u76d8\u200b\u8fdb\u884c\u200b\u8bfb\u200b\u6216\u200b\u5199\u200b</li> <li>*b : \u200b\u7f13\u51b2\u533a\u200b\u7684\u200b\u6307\u9488\u200b   </li> <li>write : \u200b\u5f53\u4e3a\u200b1\u200b\u65f6\u200b\u662f\u200b\u628a\u200b\u7f13\u51b2\u533a\u200b\u7684\u200b\u5185\u5bb9\u200b\u5199\u5165\u200b\u5230\u200b\u78c1\u76d8\u200b\uff0c\u200b\u4e3a\u200b0\u200b\u65f6\u200b\u662f\u200b\u628a\u200b\u78c1\u76d8\u200b\u7684\u200b\u5185\u5bb9\u200b\u8bfb\u53d6\u200b\u5230\u200b\u7f13\u51b2\u533a\u200b   </li> </ul>"},{"location":"lab3/part2/#24","title":"2.4 \u200b\u4f18\u5316\u200b\u65b9\u6cd5\u200b\uff08\u200b\u91cd\u8981\u200b\uff09","text":"<p>\u200b\u5728\u200bkernel/bio.c\u200b\u4e2d\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\uff0c\u200b\u6240\u6709\u200b\u7684\u200bbuffer\u200b\u90fd\u200b\u88ab\u200b\u7ec4\u7ec7\u200b\u5230\u200b \u200b\u4e00\u6761\u200b\u94fe\u8868\u200b \u200b\u4e2d\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5982\u679c\u200b\u6709\u200b\u591a\u4e2a\u200b\u8fdb\u7a0b\u200b\u8981\u200b\u4f7f\u7528\u200bbuffer\uff0c\u200b\u5b83\u4eec\u200b\u5e76\u53d1\u200b\u7684\u200b\u8bf7\u6c42\u200b\u53ea\u80fd\u200b\u88ab\u200b\u987a\u5e8f\u200b\u5730\u200b\u5904\u7406\u200b\u3002</p> <p>\u200b\u5173\u4e8e\u200bbcache\u200b\u7684\u200b\u4f18\u5316\u200b\u7b56\u7565\u200b</p> <p>MIT\u200b\u5b98\u65b9\u200b\u6307\u5bfc\u4e66\u200b\u63a8\u8350\u200b\u4f7f\u7528\u200b \u200b\u54c8\u5e0c\u200b\u6876\u200b \u200b\u548c\u200b \u200b\u65f6\u95f4\u200b\u6233\u200b \u200b\u4e24\u4e2a\u200b\u65b9\u6848\u200b\uff0c\u200b\u6b64\u5916\u200b\uff0c\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u8fd8\u200b\u7ed9\u51fa\u200b\u4e86\u200b\u57fa\u4e8e\u200b CLOCK\u200b\u7b97\u6cd5\u200b \u200b\u7684\u200b\u4f18\u5316\u200b\u7b56\u7565\u200b\uff0c\u200b\u5927\u5bb6\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u9009\u62e9\u200b\u4f18\u5316\u200b\u7b56\u7565\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4e00\u8d77\u200b\u4f7f\u7528\u200b\uff08\u200b\u5982\u200b\u54c8\u5e0c\u200b\u6876\u200b\u7ed3\u5408\u200b\u65f6\u95f4\u200b\u6233\u200b\uff09\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5355\u72ec\u200b\u5206\u5f00\u200b\u7528\u200b\uff0c\u200b\u9700\u8981\u200b\u81ea\u884c\u200b\u6d4b\u8bd5\u200b\u770b\u770b\u200b\u80fd\u5426\u200b\u901a\u8fc7\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200b\u3002</p>"},{"location":"lab3/part2/#241","title":"2.4.1 \u200b\u54c8\u5e0c\u200b\u6876","text":"<p>\u200b\u4f7f\u7528\u200b\u54c8\u5e0c\u200b\u6876\u200b\uff0c\u200b\u5c06\u200b\u5404\u200b\u5757\u5757\u200b\u53f7\u200bblockno\u200b\u7684\u200b\u67d0\u79cd\u200b\u6563\u5217\u503c\u200b\u4f5c\u4e3a\u200bkey\u200b\u5bf9\u5757\u200b\u8fdb\u884c\u200b\u5206\u7ec4\u200b\uff0c\u200b\u5e76\u200b\u4e3a\u200b\u6bcf\u4e2a\u200b\u54c8\u5e0c\u200b\u6876\u200b\u5206\u914d\u200b\u4e00\u4e2a\u200b\u4e13\u7528\u200b\u7684\u200b\u9501\u200b\u3002\u200b\u901a\u8fc7\u200b\u54c8\u5e0c\u200b\u6876\u200b\u6765\u200b\u4ee3\u66ff\u200b\u94fe\u8868\u200b\uff0c\u200b\u5f53\u8981\u200b\u83b7\u53d6\u200b\u548c\u200b\u91ca\u653e\u200b\u7f13\u5b58\u200b\u5757\u200b\u65f6\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u5bf9\u200b\u67d0\u4e2a\u200b\u54c8\u5e0c\u200b\u6876\u200b\u8fdb\u884c\u200b\u52a0\u9501\u200b\uff0c\u200b\u6876\u200b\u4e4b\u95f4\u200b\u7684\u200b\u64cd\u4f5c\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u5e76\u884c\u200b\u8fdb\u884c\u200b\uff0c\u200b\u63d0\u4f9b\u200b\u5e76\u884c\u200b\u6027\u80fd\u200b\u3002  </p> <ol> <li> <p>\u200b\u5728\u200b<code>bget()</code>\u200b\u4e2d\u200b\u67e5\u627e\u200b\u6307\u5b9a\u200b\u5757\u200b\u65f6\u200b\uff0c\u200b\u9501\u4e0a\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9501\u200b\uff08\u200b\u83b7\u53d6\u200b\u7a7a\u95f2\u200b\u5757\u200b\u53f7\u200b\u987b\u200b\u53e6\u4f5c\u200b\u5904\u7406\u200b\uff09\u3002  </p> </li> <li> <p>\u200b\u5f53\u200bbget()\u200b\u67e5\u627e\u200b\u6570\u636e\u200b\u5757\u200b\u672a\u200b\u547d\u4e2d\u200b\u65f6\u200b\uff0cbget()\u200b\u53ef\u200b\u4ece\u200b\u5176\u4ed6\u200b\u54c8\u5e0c\u200b\u6876\u200b\u9009\u62e9\u200b\u4e00\u4e2a\u200b\u672a\u200b\u88ab\u200b\u4f7f\u7528\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u79fb\u5165\u200b\u5230\u200b\u5f53\u524d\u200b\u7684\u200b\u54c8\u5e0c\u200b\u6876\u200b\u94fe\u8868\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u3002</p> </li> <li> <p>\u200b\u9009\u62e9\u200b\u5408\u9002\u200b\u7684\u200b\u6563\u5217\u200b\u51fd\u6570\u200b\u4ee5\u200b\u5206\u7ec4\u200b\uff0c\u200b\u5206\u7ec4\u200b\u7684\u200b\u6570\u91cf\u200b\u4e0d\u5fc5\u200b\u52a8\u6001\u200b\u8c03\u6574\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u53d6\u5b9a\u503c\u200b\uff0c\u200b\u63a8\u8350\u200b\u4f7f\u7528\u200b\u8d28\u200b\u6570\u7ec4\u200b\uff08\u200b\u5982\u200b13\u200b\u7ec4\u200b\uff09\u200b\u4ee5\u200b\u51cf\u5c11\u200b\u54c8\u5e0c\u200b\u4e89\u7528\u200b\u3002  </p> </li> <li> <p>\u200b\u54c8\u5e0c\u200b\u8868\u200b\u7684\u200b\u641c\u7d22\u200b\u548c\u200b\u7a7a\u95f2\u200b\u7f13\u5b58\u200b\u5757\u200b\u7684\u200b\u67e5\u627e\u200b\u9700\u8981\u200b\u4fdd\u8bc1\u200b\u539f\u5b50\u200b\u6027\u200b\u3002 </p> </li> </ol>"},{"location":"lab3/part2/#242","title":"2.4.2 \u200b\u65f6\u95f4\u200b\u6233","text":"<p>\u200b\u79fb\u9664\u200b\u7a7a\u95f2\u200b\u7f13\u5b58\u200b\u5757\u200b\u5217\u8868\u200b(<code>bcache.head</code>)\u3002\u200b\u4f7f\u7528\u200b \u200b\u65f6\u95f4\u200b\u6233\u200b \u200b\u4f5c\u4e3a\u200b\u5224\u65ad\u200b\u7f13\u5b58\u200b\u5757\u200b\u6700\u200b\u4e00\u6b21\u200b\u88ab\u200b\u8bbf\u95ee\u200b\u7684\u200b\u987a\u5e8f\u200b\u7684\u200b\u4f9d\u636e\u200b\u3002  </p> <ol> <li> <p>\u200b\u6b64\u9879\u200b\u6539\u52a8\u200b\u53ef\u200b\u4f7f\u200b<code>brelse</code>\u200b\u4e0d\u518d\u200b\u9700\u8981\u200b\u9501\u4e0a\u200b<code>bcache lock</code>\u3002  </p> </li> <li> <p>bget\u200b\u5728\u200b\u627e\u200b\u7a7a\u95f2\u200b\u5757\u200b\u65f6\u200b\u4e5f\u200b\u53ef\u200b\u901a\u8fc7\u200b\u65f6\u95f4\u200b\u6233\u200b\u5f97\u77e5\u200b\u6700\u540e\u200b\u4e00\u6b21\u200b\u88ab\u200b\u8bbf\u95ee\u200b\u65f6\u95f4\u200b\u6700\u65e9\u200b\u7684\u200b\u7a7a\u95f2\u200b\u7f13\u5b58\u200b\u5757\u200b\u3002  </p> </li> <li> <p>\u200b\u65f6\u95f4\u200b\u6233\u200b\u53ef\u200b\u901a\u8fc7\u200bkernel/trap.c\u200b\u4e2d\u200b\u7684\u200bticks\u200b\u51fd\u6570\u200b\u83b7\u5f97\u200b\uff08ticks\u200b\u5df2\u200b\u5728\u200bkernel/def.h\u200b\u4e2d\u200b\u58f0\u660e\u200b\uff0cbio.c\u200b\u4e2d\u200b\u53ef\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b\uff09\u3002  </p> </li> </ol>"},{"location":"lab3/part2/#243-clock","title":"2.4.3 CLOCK\u200b\u7b97\u6cd5","text":"<p>\u200b\u9664\u6b64\u4e4b\u5916\u200b\uff0c\u200b\u7406\u8bba\u8bfe\u200b\u4e0a\u200b\u6211\u4eec\u200b\u8fd8\u200b\u5b66\u4e60\u200b\u8fc7\u200b\u9664\u4e86\u200b LRU \u200b\u4ee5\u5916\u200b\u7684\u200b\u66ff\u6362\u7b97\u6cd5\u200b\uff0c\u200b\u4f8b\u5982\u200b CLOCK \u200b\u7b97\u6cd5\u200b\u7b49\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5728\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u3002</p> <p>CLOCK \u200b\u7b97\u6cd5\u200b\u7684\u200b\u5b9e\u73b0\u200b\u601d\u8def\u200b\u4e3a\u200b:</p> <ol> <li> <p>\u200b\u5c06\u200b\u6570\u636e\u7ed3\u6784\u200b\u6539\u4e3a\u200b\u4f7f\u7528\u200b \u200b\u6570\u7ec4\u200b \u200b\u6784\u6210\u200b\u7684\u200b\u5faa\u73af\u200b\u961f\u5217\u200b\uff0c\u200b\u6bcf\u4e2a\u200b buf \u200b\u62e5\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u9501\u200b\u3002</p> </li> <li> <p><code>bget()</code> \u200b\u67e5\u627e\u200b\u65f6\u200b\uff0c\u200b\u4e0d\u200b\u9700\u8981\u200b\u83b7\u53d6\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u67e5\u627e\u200b\u5230\u200b\u4e4b\u540e\u200b\uff0c\u200b\u9501\u4e0a\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u7136\u540e\u200b\u91cd\u65b0\u200b\u68c0\u67e5\u200b\u8fd9\u4e2a\u200b buf \u200b\u662f\u5426\u662f\u200b\u60f3\u8981\u200b\u7684\u200b\uff0c\u200b\u68c0\u67e5\u200b\u5b8c\u540e\u200b\u8fdb\u884c\u200b\u5bf9\u5e94\u200b\u7684\u200b\u64cd\u4f5c\u200b\u3002</p> </li> <li> <p>\u200b\u6bcf\u4e2a\u200b buf \u200b\u7ef4\u62a4\u200b\u4e00\u4e2a\u200b\u8bbf\u95ee\u200b\u4f4d\u200b\uff0c\u200b\u5f53\u200b <code>bget()</code> \u200b\u6ca1\u6709\u200b\u627e\u5230\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7f13\u5b58\u200b buf \u200b\u65f6\u200b\uff0c\u200b\u6839\u636e\u200b CLOCK \u200b\u7b97\u6cd5\u200b\u7ef4\u62a4\u200b\u8bbf\u95ee\u200b\u4f4d\u200b\u5e76\u200b\u5206\u914d\u200b\u4e00\u4e2a\u200b buf\u3002</p> <ol> <li> <p>\u200b\u5982\u200b\u5f53\u524d\u200b\u67e5\u8be2\u200b\u7684\u200b buf \u200b\u547d\u4e2d\u200b\uff0c\u200b\u8bbf\u95ee\u200b\u4f4d\u200b -&gt; \u200b\u7f6e\u200b\u201c1\u201d\uff0c\u200b\u6307\u9488\u200b\u4fdd\u6301\u200b\u4e0d\u200b\u52a8\u200b</p> </li> <li> <p>\u200b\u5426\u5219\u200b\uff0c\u200b\u5faa\u73af\u200b\u68c0\u67e5\u200b\u5404\u200b\u9875\u9762\u200b\u7684\u200b\u4f7f\u7528\u200b\u60c5\u51b5\u200b\u3002\u200b\u82e5\u200b\u8bbf\u95ee\u200b\u4f4d\u4e3a\u200b\u201c0\u201d\uff0c\u200b\u9009\u62e9\u200b\u8be5\u9875\u200b\u6dd8\u6c70\u200b\uff0c\u200b\u6307\u9488\u200b\u524d\u200b\u8fdb\u4e00\u6b65\u200b\u3002\u200b\u82e5\u200b\u8bbf\u95ee\u200b\u4f4d\u4e3a\u200b\u201c1\u201d\uff0c\u200b\u590d\u4f4d\u200b\u8bbf\u95ee\u200b\u4f4d\u4e3a\u200b\u201c0\u201d\uff0c\u200b\u6307\u9488\u200b\u8fdb\u4e00\u6b65\u200b\u3002</p> </li> </ol> </li> </ol> <p>CLOCK \u200b\u7b97\u6cd5\u200b\u5b9e\u73b0\u200b\u601d\u8def\u200b\u4e2d\u200b\u6211\u4eec\u200b\u63d0\u5230\u200b\uff0c\u200b\u67e5\u627e\u200b\u65f6\u200b\u4e0d\u200b\u9700\u8981\u200b\u83b7\u53d6\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8fd9\u4e2a\u200b\u662f\u5426\u200b\u5b89\u5168\u200b\uff1f\u200b\u5982\u679c\u200b\u67e5\u627e\u200b\u65f6\u200b\u4e5f\u200b\u83b7\u53d6\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u4f1a\u200b\u53d1\u751f\u200b\u4ec0\u4e48\u200b\uff1f\u200b\u5176\u5b9e\u200b\u8fd9\u200b\u4e24\u79cd\u200b\u505a\u6cd5\u200b\u5206\u522b\u200b\u5bf9\u5e94\u200b\u201c \u200b\u4e50\u89c2\u200b\u9501\u200b \u201d\u200b\u548c\u200b\u201c \u200b\u60b2\u89c2\u200b\u9501\u200b \u201d\u3002\u201c\u200b\u4e50\u89c2\u200b\u9501\u200b\u201d\u200b\u6bcf\u6b21\u200b\u53bb\u200b\u62ff\u200b\u6570\u636e\u200b\u7684\u200b\u65f6\u5019\u200b\u90fd\u200b\u8ba4\u4e3a\u200b\u522b\u4eba\u200b\u4e0d\u4f1a\u200b\u4fee\u6539\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4e0d\u4f1a\u200b\u4e0a\u9501\u200b\uff0c\u200b\u4f46\u662f\u200b\u5728\u200b\u66f4\u65b0\u200b\u7684\u200b\u65f6\u5019\u200b\u4f1a\u200b\u5224\u65ad\u200b\u4e00\u4e0b\u200b\u5728\u6b64\u671f\u95f4\u200b\u522b\u4eba\u200b\u6709\u6ca1\u6709\u200b\u53bb\u200b\u66f4\u65b0\u200b\u8fd9\u4e2a\u200b\u6570\u636e\u200b\u3002\u201c\u200b\u60b2\u89c2\u200b\u9501\u200b\u201d\u200b\u603b\u662f\u200b\u5047\u8bbe\u200b\u6700\u574f\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u6bcf\u6b21\u200b\u53bb\u200b\u62ff\u200b\u6570\u636e\u200b\u7684\u200b\u65f6\u5019\u200b\u90fd\u200b\u8ba4\u4e3a\u200b\u522b\u4eba\u200b\u4f1a\u200b\u4fee\u6539\u200b\uff0c\u200b\u6240\u4ee5\u200b\u6bcf\u6b21\u200b\u5728\u200b\u62ff\u200b\u6570\u636e\u200b\u7684\u200b\u65f6\u5019\u200b\u90fd\u200b\u4f1a\u200b\u4e0a\u9501\u200b\u3002\u200b\u611f\u5174\u8da3\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u4ee5\u200b\u5c1d\u8bd5\u200b\u6bd4\u8f83\u200b\u8fd9\u200b\u4e24\u79cd\u200b\u505a\u6cd5\u200b\uff0c\u200b\u518d\u200b\u4e0e\u200b\u7f51\u4e0a\u200b\u641c\u7d22\u200b\u7684\u200b\u5e38\u89c1\u200b\u7528\u9014\u200b\u76f8\u5bf9\u200b\u6bd4\u200b\u3002</p> <p>\u200b\u4e0a\u8ff0\u200b\u4e09\u4e2a\u200b\u65b9\u6848\u200b\u5728\u200b\u4ee5\u4e0b\u200b\u60c5\u51b5\u200b\u4e2d\u200b\u90fd\u200b\u5b58\u5728\u200b\u5c11\u91cf\u200b\u9501\u4e89\u200b\u7528\u200b\uff0c\u200b\u5728\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u8fd9\u662f\u200b\u5141\u8bb8\u200b\u7684\u200b\uff1a</p> <ol> <li>\u200b\u5f53\u200b\u4e24\u4e2a\u200b\u8fdb\u7a0b\u200b\u540c\u65f6\u200b\u8bbf\u95ee\u200b\u540c\u4e00\u4e2a\u200b\u7f13\u5b58\u6570\u636e\u200b\u5757\u200b\u53f7\u200bblockno\u200b\u65f6\u200b\uff1b</li> <li>\u200b\u5f53\u200b\u4e24\u4e2a\u200b\u8fdb\u7a0b\u200b\u540c\u65f6\u200b\u6ca1\u6709\u200b\u547d\u4e2d\u200bcache\uff0c\u200b\u9700\u8981\u200b\u627e\u200b\u4e00\u4e2a\u200b\u672a\u200b\u4f7f\u7528\u200b\u7684\u200bblock\u200b\u6765\u200b\u66ff\u4ee3\u200b\u65f6\u200b\uff1b</li> <li>\u200b\u5f53\u200b\u4e24\u4e2a\u200b\u8fdb\u7a0b\u200b\u540c\u65f6\u200b\u4f7f\u7528\u200b\u5757\u200b\u65f6\u200b\uff0c\u200b\u65e0\u8bba\u200b\u4f7f\u7528\u200b\u4f55\u79cd\u200b\u6a21\u5f0f\u200b\u5212\u5206\u200b\u6570\u636e\u200b\u5757\u200b\u548c\u200b\u9501\u200b\uff0c\u200b\u90fd\u200b\u4f1a\u200b\u4ea7\u751f\u200b\u4e89\u7528\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u6bd4\u5982\u200b\u5728\u200b\u54c8\u5e0c\u200b\u6876\u200b\u7684\u200b\u4f18\u5316\u200b\u7b56\u7565\u200b\u4e2d\u200b\uff0c\u200b\u5982\u679c\u200b\u4e24\u4e2a\u200b\u8fdb\u7a0b\u200b\u4f7f\u7528\u200b\u7684\u200b\u4e24\u4e2a\u200b\u6570\u636e\u200b\u5757\u200b\uff0c\u200b\u901a\u8fc7\u200b\u54c8\u5e0c\u200b\u8868\u200b\u6620\u5c04\u200b\u5230\u200b\u540c\u4e00\u4e2a\u200b\u54c8\u5e0c\u200b\u7ec4\u200b\u90e8\u5206\u200b\uff08\u200b\u8fd9\u200b\u53d6\u51b3\u4e8e\u200b\u5177\u4f53\u200b\u7684\u200b\u8bbe\u8ba1\u200b\uff0c\u200b\u8bf7\u200b\u5c1d\u8bd5\u200b\u8c03\u6574\u200b\u5177\u4f53\u200b\u7684\u200b\u6a21\u5f0f\u200b\u6765\u200b\u907f\u514d\u200b\u4e89\u7528\u200b\uff0c\u200b\u6bd4\u5982\u200b\u53ef\u4ee5\u200b\u8c03\u6574\u200b\u54c8\u5e0c\u200b\u8868\u200b\u7684\u200b\u5927\u5c0f\u200b\uff09\u3002</li> </ol>"},{"location":"lab3/part2/#25","title":"2.5 \u200b\u907f\u514d\u200b\u6b7b\u9501\u200b\uff08\u200b\u91cd\u8981\u200b\uff09","text":"<p>bcache \u200b\u4e0e\u200b\u524d\u9762\u200b kalloc \u200b\u5b9e\u9a8c\u200b\u7684\u200b\u91cd\u8981\u200b\u533a\u522b\u200b\u662f\u200b\uff0cbcache \u200b\u5b9e\u9a8c\u200b\u9700\u8981\u200b\u5904\u7406\u200b\u66ff\u6362\u200b/\u200b\u5206\u914d\u60c5\u51b5\u200b\uff0c\u200b\u56e0\u6b64\u200b\u540c\u5b66\u200b\u4eec\u200b\u7b2c\u4e00\u6b21\u200b\u8bbe\u8ba1\u200b \u200b\u6781\u6613\u200b \u200b\u51fa\u73b0\u200b\u6b7b\u9501\u200b\u3002</p> <p>\u200b\u6b7b\u9501\u200b\u7684\u200b\u53d1\u751f\u200b\u5177\u6709\u200b\u6982\u7387\u200b\u6027\u200b\uff0c\u200b\u6240\u4ee5\u200b<code>bcachetest</code>\u200b\u901a\u8fc7\u200b\u5e76\u200b\u4e0d\u200b\u4ee3\u8868\u200b\u4f60\u200b\u7f16\u5199\u200b\u7684\u200b\u4ee3\u7801\u200b\u4e0d\u200b\u5b58\u5728\u200b\u6b7b\u9501\u200b\u3002\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u540c\u5b66\u200b\u4eec\u200b\u901a\u8fc7\u200b\u7684\u200b<code>usertests</code>\u200b\u662f\u200b\u8f83\u4e3a\u200b\u5168\u9762\u200b\u7684\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u5404\u200b\u65b9\u9762\u200b\u5747\u200b\u8fdb\u884c\u200b\u4e86\u200b\u8f83\u5927\u200b\u5f3a\u5ea6\u200b\u7684\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u6240\u4ee5\u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b\u4ee3\u7801\u200b\u4e0d\u200b\u80fd\u591f\u200b\u901a\u8fc7\u200b<code>usertests</code>\u200b\u6216\u200b\u5728\u200b\u6d4b\u8bd5\u200b\u4e2d\u200b\u5361\u6b7b\u200b\uff0c\u200b\u6216\u200b \u200b\u6709\u200b\u6982\u7387\u200b\u4e0d\u200b\u901a\u8fc7\u200b \u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u90a3\u4e48\u200b\u4e00\u822c\u6765\u8bf4\u200b\u4ee3\u8868\u200b\u4f60\u200b\u7684\u200b\u4ee3\u7801\u200b\u51fa\u73b0\u200b\u6b7b\u9501\u200b/\u200b\u7ade\u4e89\u200b\u6761\u4ef6\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u5373\u4f7f\u200b\u4f60\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u901a\u8fc7\u200b\u4e86\u200b\u5168\u90e8\u200b\u7684\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u4e5f\u200b\u4e0d\u200b\u4ee3\u8868\u200b\u4f60\u200b\u7684\u200b\u4ee3\u7801\u200b100%\u200b\u6ca1\u6709\u200b\u6b7b\u9501\u200b\u3002\u200b\u5982\u4f55\u200b\u786e\u4fdd\u200b\u4ee3\u7801\u200b\u662f\u200b\u65e0\u200b bug \u200b\u7684\u200b\u8d85\u51fa\u200b\u4e86\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7684\u200b\u8303\u7574\u200b\uff0c\u200b\u611f\u5174\u8da3\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u4ee5\u200b\u4e86\u89e3\u200b \u200b\u5f62\u5f0f\u5316\u200b\u9a8c\u8bc1\u200b\u3002</p> <p>\u200b\u540c\u6837\u200b\uff0c\u200b\u8bbe\u8ba1\u65b9\u6848\u200b\u65f6\u200b\u5f62\u5f0f\u5316\u200b\u5730\u200b\u601d\u8003\u200b\u7406\u8bba\u8bfe\u200b\u4e0a\u200b\u5b66\u4e60\u200b\u7684\u200b\u77e5\u8bc6\u200b\uff0c\u200b\u6709\u52a9\u4e8e\u200b\u4f60\u200b\u8bbe\u8ba1\u200b\u51fa\u200b\u6b63\u786e\u200b\u7684\u200b\u4ee3\u7801\u200b\u3002</p> <p>\u200b\u4e3a\u4ec0\u4e48\u200b\u4f1a\u200b\u51fa\u73b0\u200b\u6b7b\u9501\u200b\uff1f\u200b\u4ee5\u200b\u54c8\u5e0c\u200b\u6876\u200b\u7684\u200b\u4f18\u5316\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u540c\u5b66\u200b\u4eec\u200b\u4e00\u822c\u200b\u505a\u6cd5\u200b\u90fd\u200b\u4f1a\u200b\u4e3a\u200b\u6bcf\u4e2a\u200b\u54c8\u5e0c\u200b\u6876\u200b\u8bbe\u7f6e\u200b\u4e00\u4e2a\u200b\u9501\u200b\u3002\u200b\u4f46\u662f\u200b\u5728\u200b\u9700\u8981\u200b\u8fdb\u884c\u200b\u66ff\u6362\u200b/\u200b\u5206\u914d\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u5f80\u5c4a\u200b\u540c\u5b66\u200b\u4eec\u200b\u7684\u200b\u505a\u6cd5\u200b\u901a\u5e38\u200b\u662f\u200b\u5185\u6838\u200b\u6301\u6709\u200b\u4e00\u4e2a\u6876\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u7136\u540e\u200b\u540c\u65f6\u200b\u62a2\u200b\u53e6\u200b\u4e00\u4e2a\u6876\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u6b64\u65f6\u200b\u51fa\u73b0\u200b\u4e86\u200b\u540c\u65f6\u200b\u6301\u6709\u200b \u200b\u4e24\u4e2a\u200b\u81ea\u65cb\u200b\u9501\u200b\uff0c\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u5728\u200b\u5b9e\u9645\u200b\u4e1a\u52a1\u200b\u4ee3\u7801\u200b\u91cc\u200b\u662f\u200b\u6bd4\u8f83\u200b\u5371\u9669\u200b\u7684\u200b\uff0c\u200b\u5728\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e5f\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u6b7b\u9501\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u601d\u8003\u200b\u8fd9\u662f\u200b\u4e3a\u4ec0\u4e48\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u6709\u200b\u7684\u200b\u540c\u5b66\u200b\u4e3a\u4e86\u200b\u89e3\u51b3\u200b\u6b7b\u9501\u200b\u95ee\u9898\u200b\uff0c\u200b\u8bbe\u8ba1\u200b\u4e86\u200b\u4e00\u79cd\u200b\u65b9\u6cd5\u200b\uff1a</p> <p>\u200b\u5148\u200b\u91ca\u653e\u200b\u539f\u6709\u200b\u6876\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u7136\u540e\u200b\u518d\u200b\u83b7\u53d6\u200b\u53e6\u200b\u4e00\u4e2a\u6876\u200b\u7684\u200b\u9501\u200b\u3002</p> <p>\u200b\u8fd9\u79cd\u200b\u505a\u6cd5\u200b\u662f\u200b\u4e0d\u200b\u5b89\u5168\u200b\u7684\u200b\uff0c\u200b\u8bf7\u200b\u5927\u5bb6\u200b\u601d\u8003\u200b\u4e3a\u4ec0\u4e48\u200b\u4e0d\u200b\u5b89\u5168\u200b\uff1f</p> <p>\u200b\u4e0b\u9762\u200b\u4ee5\u200b\u54c8\u5e0c\u200b\u6876\u200b\u7684\u200b\u4f18\u5316\u200b\u65b9\u5f0f\u200b\u4e3a\u4f8b\u200b\u7ed9\u51fa\u200b\u4e00\u79cd\u200b\u66ff\u6362\u200b/\u200b\u5206\u914d\u200b\u601d\u8def\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u601d\u8def\u200b\u4e5f\u200b\u51fa\u73b0\u200b\u4e86\u200b\u540c\u65f6\u200b\u6301\u6709\u200b\u4e24\u4e2a\u200b\u6216\u200b\u4ee5\u4e0a\u200b\u81ea\u65cb\u200b\u9501\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u601d\u8003\u200b\u8fd9\u79cd\u200b\u505a\u6cd5\u200b\u662f\u5426\u200b\u6709\u200b\u6b7b\u9501\u200b\uff0c\u200b\u662f\u5426\u200b\u51fa\u73b0\u200b\u7ade\u4e89\u200b\u3002</p> <ol> <li>\u200b\u9996\u5148\u200b\u83b7\u53d6\u200b\u8bf7\u6c42\u200b\u5bf9\u5e94\u200b\u6876\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u67e5\u627e\u200b\u4e0d\u5230\u200b\u4ee5\u540e\u200b\u8fdb\u5165\u200b\u66ff\u6362\u200b/\u200b\u5206\u914d\u200b\u6d41\u7a0b\u200b\uff0c\u200b\u91ca\u653e\u200b\u9501\u200b\u3002</li> <li>\u200b\u7136\u540e\u200b\u83b7\u53d6\u200b\u5168\u5c40\u200b\u5206\u914d\u200b\u5927\u9501\u200b\uff0c\u200b\u83b7\u53d6\u200b\u539f\u6709\u200b\u6876\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u83b7\u53d6\u200b\u65b0\u6876\u200b\u7684\u200b\u9501\u200b\uff0c\u200b\u68c0\u67e5\u200b\u662f\u5426\u200b\u5df2\u200b\u5b8c\u6210\u200b\u66ff\u6362\u200b\uff0c\u200b\u5982\u672a\u200b\u5b8c\u6210\u200b\u5219\u200b\u8fdb\u884c\u200b\u66ff\u6362\u200b\uff0c\u200b\u6700\u540e\u200b\u6309\u5e8f\u200b\u91ca\u653e\u200b\u6240\u6709\u200b\u9501\u200b\u3002</li> </ol>"},{"location":"lab3/part3/","title":"\u5b9e\u9a8c\u200b\u5b9e\u73b0","text":"<p>\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5bf9\u200b\u4e00\u4e9b\u200b\u5b9e\u73b0\u200b\u7684\u200b\u7ec6\u8282\u200b\u505a\u200b\u4e00\u5b9a\u200b\u7684\u200b\u63d0\u9192\u200b\u3002\u200b\u4f46\u662f\u200b\u5b8c\u6574\u200b\u7684\u200b\u6d41\u7a0b\u200b\u9700\u8981\u200b\u81ea\u5df1\u200b\u628a\u63e1\u200b\uff0c\u200b\u6211\u4eec\u200b \u200b\u4e0d\u4f1a\u200b\u7ed9\u51fa\u200b\u6bcf\u200b\u4e00\u6b65\u200b\u5b9e\u73b0\u200b\u6b65\u9aa4\u200b \u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u8fd8\u662f\u200b\u9605\u8bfb\u200b \u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b \u200b\u5185\u5bb9\u200b\uff0c\u200b\u5f97\u51fa\u200b\u81ea\u5df1\u200b\u7684\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff0c\u200b\u7136\u540e\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u5b9e\u73b0\u200b\u8fd9\u90e8\u5206\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u503c\u5f97\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0cxv6\u200b\u7684\u200b\u4ee3\u7801\u200b\u662f\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u7684\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u770b\u200b\u76f8\u5173\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u662f\u200b\u600e\u4e48\u200b\u5b9e\u73b0\u200b\u7684\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u63d2\u6869\u200b\uff0c\u200b\u4f7f\u7528\u200bprintf/GDB\u200b\u7b49\u200b\u65b9\u6cd5\u200b\u770b\u770b\u200b\u5177\u4f53\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u9605\u8bfb\u200bxv6 book\uff0c\u200b\u770b\u770b\u200b\u80cc\u540e\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u673a\u7406\u200b\u3002</p>"},{"location":"lab3/part3/#0","title":"0. \u200b\u4efb\u52a1\u200b\u96f6\u200b\uff1a\u200b\u56de\u7b54\u200b\u95ee\u9898","text":"<p>\u200b\u56de\u7b54\u200b\u95ee\u9898\u200b</p> <p>\u200b\u4efb\u52a1\u200b\u5f00\u59cb\u200b\u4e4b\u524d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5e94\u8be5\u200b\u5148\u200b\u8981\u200b\u9996\u5148\u200b\u56de\u7b54\u200b\u4e00\u4e9b\u200b\u539f\u7406\u200b\u6027\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u8fd9\u90e8\u5206\u200b\u5e94\u8be5\u200b\u88ab\u200b\u5305\u542b\u200b\u5728\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u4e2d\u200b\uff1a</p> <ol> <li>\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b<ol> <li>\u200b\u4ec0\u4e48\u200b\u662f\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\uff1f\u200b\u5b83\u200b\u7684\u200b\u4f5c\u7528\u200b\u662f\u200b\uff1f</li> <li>\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u662f\u200b\u4ec0\u4e48\u200b\uff1f\u200b\u5b83\u200b\u6709\u200b\u54ea\u4e9b\u200b\u64cd\u4f5c\u200b\uff08\u200b\u51fd\u6570\u200b\uff09\uff0c\u200b\u5206\u522b\u200b\u5b8c\u6210\u200b\u4e86\u200b\u4ec0\u4e48\u200b\u529f\u80fd\u200b\uff1f</li> <li>\u200b\u4e3a\u4ec0\u4e48\u200b\u6307\u5bfc\u4e66\u200b\u63d0\u53ca\u200b\u7684\u200b\u4f18\u5316\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u63d0\u5347\u200b\u6027\u80fd\u200b\uff1f</li> </ol> </li> <li>\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b<ol> <li>\u200b\u4ec0\u4e48\u200b\u662f\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\uff1f\u200b\u5b83\u200b\u7684\u200b\u4f5c\u7528\u200b\u662f\u200b\uff1f</li> <li>buf\u200b\u7ed3\u6784\u200b\u4f53\u200b\u4e3a\u4ec0\u4e48\u200b\u6709\u200bprev\u200b\u548c\u200bnext\u200b\u4e24\u4e2a\u200b\u6210\u5458\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u53ea\u200b\u4fdd\u7559\u200b\u5176\u4e2d\u200b\u4e00\u4e2a\u200b\uff1f\u200b\u8bf7\u200b\u4ece\u200b\u8fd9\u6837\u200b\u505a\u200b\u7684\u200b\u4f18\u70b9\u200b\u5206\u6790\u200b\uff08\u200b\u63d0\u793a\u200b\uff1a\u200b\u7ed3\u5408\u200b\u901a\u8fc7\u200b\u8fd9\u200b\u4e24\u79cd\u200b\u6307\u9488\u200b\u904d\u5386\u200b\u94fe\u8868\u200b\u7684\u200b\u5177\u4f53\u200b\u573a\u666f\u200b\u8fdb\u884c\u200b\u601d\u8003\u200b\uff09\u3002</li> <li>\u200b\u4e3a\u4ec0\u4e48\u200b\u54c8\u5e0c\u200b\u8868\u200b\u53ef\u4ee5\u200b\u63d0\u5347\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u7684\u200b\u6027\u80fd\u200b\uff1f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u7684\u200b\u4f18\u5316\u200b\u65b9\u6cd5\u200b\u4f18\u5316\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u5417\u200b\uff1f\u200b\u8bf7\u200b\u8bf4\u660e\u200b\u539f\u56e0\u200b\u3002</li> </ol> </li> </ol> <p>\u200b\u4ee5\u4e0a\u200b\u9898\u76ee\u200b\u7684\u200b\u7b54\u6848\u200b\u51e0\u4e4e\u200b\u90fd\u200b\u80fd\u200b\u5728\u200b\u6307\u5bfc\u4e66\u200b\u4e2d\u200b\u627e\u5230\u200b\uff0c\u200b\u6240\u4ee5\u200b\u8bf7\u200b\u4ed4\u7ec6\u9605\u8bfb\u200b\u6307\u5bfc\u4e66\u200b\u3002</p> <p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u4ee3\u7801\u200b\u91cf\u200b\u8f83\u200b\u5c0f\u200b\uff0c\u200b\u4f46\u200b\u8fd9\u200b\u53cd\u800c\u200b\u610f\u5473\u7740\u200b\u96be\u5ea6\u200b\u8f83\u5927\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5efa\u8bae\u200b\u5927\u5bb6\u200b\u4ee5\u200b \u200b\u56fe\u200b \u200b\u7684\u200b\u5f62\u5f0f\u200b \u200b\u753b\u51fa\u200b\u6570\u636e\u7ed3\u6784\u200b\u4ee5\u53ca\u200b\u6570\u636e\u7ed3\u6784\u200b\u4e4b\u95f4\u200b\u7684\u200b\u5173\u7cfb\u200b\u4ee5\u53ca\u200b\u5728\u200b\u64cd\u4f5c\u200b\u65f6\u200b\u4ed6\u4eec\u200b\u53d1\u751f\u200b\u4e86\u200b\u4ec0\u4e48\u200b\u53d8\u5316\u200b\uff0c\u200b\u540c\u65f6\u200b\u4e3b\u5f20\u200b\u4ee5\u200b \u200b\u7b80\u77ed\u200b\u800c\u200b\u7cbe\u70bc\u200b \u200b\u7684\u200b\u6587\u5b57\u200b\u56de\u7b54\u200b\u6240\u6709\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"lab3/part3/#1","title":"1. \u200b\u4efb\u52a1\u200b\u4e00\u200b \u200b\u5185\u5b58\u200b\u5206\u914d\u5668","text":""},{"location":"lab3/part3/#11","title":"1.1 \u200b\u6d41\u7a0b","text":"<p>\u200b\u5177\u4f53\u6b65\u9aa4\u200b\u5982\u4e0b\u200b\uff1a</p> <p>Step 1 \uff1a\u200b\u53c2\u8003\u200b\u201cLab2\uff1a\u200b\u8fdb\u7a0b\u200b\u4e0e\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u201d\u200b\u7684\u200b3.1 \u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff0c\u200b\u5207\u6362\u200b\u5230\u200block\u200b\u5206\u652f\u200b\u5e76\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b\uff1b</p> <p>Step 2 \uff1a\u200b\u7406\u89e3\u200bkalloc\u200b\u5185\u5b58\u200b\u5206\u914d\u200b\u7684\u200b\u65b9\u5f0f\u200b\u548c\u200b\u5176\u4e2d\u200b\u9501\u200b\u7684\u200b\u539f\u7406\u200b\uff1b</p> <p>Step 3 \uff1a\u200b\u4fee\u6539\u200b\u5185\u5b58\u200b\u5206\u914d\u5668\u200b\u6570\u636e\u7ed3\u6784\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff0c\u200b\u5c06\u200bkalloc\u200b\u7684\u200b\u5171\u4eab\u200bfreelist\u200b\u6539\u4e3a\u200b\u6bcf\u4e2a\u200bCPU\u200b\u72ec\u7acb\u200b\u7684\u200bfreelist\uff1b</p> <pre><code>struct run {\nstruct run *next;\n};\nstruct kmem{\nstruct spinlock lock;\nstruct run *freelist;\n};\nstruct kmem kmems[NCPU];\n</code></pre> <p>freerange\u200b\u4e3a\u200b\u6240\u6709\u200b\u8fd0\u884c\u200bfreerange\u200b\u7684\u200bCPU\u200b\u5206\u914d\u200b\u7a7a\u95f2\u200b\u7684\u200b\u5185\u5b58\u200b\u3002</p> <p>Step 4 \uff1a\u200b\u4fee\u6539\u200b\u548c\u200b\u5185\u5b58\u200b\u7ba1\u7406\u5668\u200b\u6709\u5173\u200b\u7684\u200b\u6240\u6709\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u5c3d\u53ef\u80fd\u51cf\u5c11\u200b\u9501\u4e89\u200b\u7528\u200b\uff1b</p> <p>Step 5 \uff1a\u200b\u542f\u52a8\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b\u8fdb\u884c\u200b\u6d4b\u8bd5\u200b\u3002</p>"},{"location":"lab3/part3/#12","title":"1.2 \u200b\u5b9e\u73b0\u200b\u63d0\u793a","text":"<ul> <li> <p>\u200b\u5206\u914d\u5185\u5b58\u200b\u5757\u200b\uff1a \u200b\u4f18\u5148\u200b \u200b\u5206\u914d\u200b \u200b\u5f53\u524d\u200b CPU\u200b\u7684\u200bfreelist\u200b\u4e2d\u200b\u7684\u200b\u5185\u5b58\u200b\u5757\u200b\uff1b\u200b\u5f53\u524d\u200bCPU\u200b\u6ca1\u6709\u200b\u7a7a\u95f2\u200b\u5185\u5b58\u200b\u5757\u200b\uff0c\u200b\u5219\u200b\u4ece\u200b\u5176\u4ed6\u200bCPU\u200b\u7684\u200bfreelist\u200b\u4e2d\u200b \u200b\u7a83\u53d6\u200b \u200b\u5185\u5b58\u200b\u5757\u200b\uff1b\u200b\u6240\u6709\u200bCPU\u200b\u90fd\u200b\u6ca1\u6709\u200b\u7a7a\u95f2\u200b\u5757\u200b\u65f6\u200b\uff0c\u200b\u8fd4\u56de\u200b0\u3002  </p> </li> <li> <p>\u200b\u91ca\u653e\u200b\u5185\u5b58\u200b\u5757\u200b\uff1a\u200b\u5c06\u200b\u5185\u5b58\u200b\u5757\u200b\u653e\u5165\u200b\u5f53\u524d\u200bCPU\u200b\u7684\u200bfreelist\u200b\u4e2d\u200b\u3002  </p> </li> <li> <p>\u200b\u9501\u200b\u7684\u200b\u673a\u5236\u200b\uff1a\u200b\u9501\u200b\u7684\u200b\u4f7f\u7528\u200b\u548c\u200b\u539f\u6765\u200b\u4f1a\u200b\u6709\u4e9b\u200b\u4e0d\u540c\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u4f60\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u5e94\u8be5\u200b\u8981\u200b\u6ee1\u8db3\u200b\u4e00\u81f4\u6027\u200b\u3002\u200b\u7b80\u5355\u200b\u5730\u8bf4\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u4fdd\u8bc1\u200b\u591a\u4e2a\u200bcpu\u200b\u8bbf\u95ee\u200b\u540c\u4e00\u4e2a\u200b\u6570\u636e\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f1a\u200b\u51fa\u9519\u200b\u7684\u8bdd\u200b\u5c31\u8981\u200b\u52a0\u9501\u200b\u3002  </p> <ul> <li>\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200bkernel/param.h\u200b\u4e2d\u200b\u7684\u200b\u5b8f\u200bNCPU\uff0c\u200b\u5176\u200b\u8868\u793a\u200bCPU\u200b\u7684\u200b\u6570\u76ee\u200b\u3002  </li> <li>\u200b\u4f7f\u7528\u200bcpuid()\u200b\u51fd\u6570\u200b\u4f1a\u200b\u8fd4\u56de\u200b\u5f53\u524d\u200bCPU\u200b\u7684\u200bid\u200b\u53f7\u200b\uff08\u200b\u8303\u56f4\u200b0~NCPU-1\uff09\u3002\u200b\u5728\u200b\u8c03\u7528\u200bcpuid()\u200b\u5e76\u200b\u4f7f\u7528\u200b\u5176\u200b\u8fd4\u56de\u503c\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u9700\u8981\u200b\u5173\u95ed\u200b\u4e2d\u65ad\u200b\u3002\u200b\u4f7f\u7528\u200bpush_off()\u200b\u53ef\u4ee5\u200b\u5173\u95ed\u200b\u4e2d\u65ad\u200b\uff0c\u200b\u4f7f\u7528\u200bpop_off()\u200b\u53ef\u4ee5\u200b\u6253\u5f00\u200b\u4e2d\u65ad\u200b\u3002  </li> <li>\u200b\u8bf7\u200b\u4f7f\u7528\u200binitlock()\u200b\u521d\u59cb\u5316\u200b\u9501\u200b\uff0c\u200b\u5e76\u200b \u200b\u8981\u6c42\u200b\u9501\u200b\u540d\u5b57\u200b\u4ee5\u200bkmem\u200b\u5f00\u5934\u200b \u3002  </li> <li>\u200b\u4f7f\u7528\u200bfreerange\u200b\u4e3a\u200b\u6240\u6709\u200b\u8fd0\u884c\u200bfreerange\u200b\u7684\u200bCPU\u200b\u5206\u914d\u200b\u7a7a\u95f2\u200b\u7684\u200b\u5185\u5b58\u200b\u3002  </li> </ul> </li> </ul>"},{"location":"lab3/part3/#2","title":"2. \u200b\u4efb\u52a1\u200b\u4e8c\u200b \u200b\u78c1\u76d8\u200b\u7f13\u5b58","text":"<p>\u200b\u5177\u4f53\u200b\u8981\u6c42\u200b\uff1a\u200b\u4fee\u6539\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u5757\u200b\u5217\u8868\u200b\u7684\u200b\u7ba1\u7406\u673a\u5236\u200b \uff0c\u200b\u4f7f\u5f97\u200b\u53ef\u7528\u200b\u591a\u4e2a\u200b\u9501\u200b\u7ba1\u7406\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u4ece\u800c\u200b\u51cf\u5c11\u200b\u7f13\u5b58\u200b\u5757\u200b\u7ba1\u7406\u200b\u7684\u200b\u9501\u200b\u4e89\u7528\u200b\u3002</p> <p>xv6 book\u200b\u4e2d\u200b8.2 - 8.3 \u200b\u8282\u6709\u200b\u5173\u4e8e\u200b\u5757\u200b\u7f13\u5b58\u200b\u7684\u200b\u63cf\u8ff0\u200b\u3002</p>"},{"location":"lab3/part3/#21","title":"2.1 \u200b\u6d41\u7a0b","text":"<p>\u200b\u5177\u4f53\u6b65\u9aa4\u200b\u5982\u4e0b\u200b\uff1a</p> <p>Step 1 \uff1a \u200b\u7406\u89e3\u200bbio.c\u200b\u4e2d\u200b\u4ee3\u7801\u200b\u7684\u200b\u884c\u4e3a\u200b\u4ee5\u53ca\u200b\u539f\u7406\u200b\uff1b</p> <p>Step 2 \uff1a \u200b\u7406\u89e3\u200bbio.c\u200b\u4e2d\u9501\u200b\u7684\u200b\u4f5c\u7528\u200b\u4ee5\u53ca\u200b\u539f\u7406\u200b\uff1b</p> <p>Step 3 \uff1a\u200b\u6784\u5efa\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u6570\u636e\u200b\u7ed3\u6784\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u6784\u5efa\u200b13\u200b\u4e2a\u200b\u54c8\u5e0c\u200b\u7ec4\u200b\uff1b</p> <pre><code>#define NBUCKETS 13\nstruct {\nstruct spinlock lock[NBUCKETS];\nstruct buf buf[NBUF];\n// Linked list of all buffers, through prev/next.\n// head.next is most recently used.\n//struct buf head;\nstruct buf hashbucket[NBUCKETS]; //\u200b\u6bcf\u4e2a\u200b\u54c8\u5e0c\u200b\u961f\u5217\u200b\u4e00\u4e2a\u200blinked list\u200b\u53ca\u200b\u4e00\u4e2a\u200block\n} bcache;\n</code></pre> <p>Step 4 \uff1a\u200b\u4fee\u6539\u200b\u548c\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u6709\u5173\u200b\u7684\u200b\u6240\u6709\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u5c3d\u53ef\u80fd\u51cf\u5c11\u200b\u9501\u4e89\u200b\u7528\u200b\uff1b</p> <p>Step 5 \uff1a\u200b\u542f\u52a8\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b\u8fdb\u884c\u200b\u6d4b\u8bd5\u200b\u3002</p>"},{"location":"lab3/part3/#22","title":"2.2 \u200b\u5b9e\u73b0\u200b\u63d0\u793a","text":"<ul> <li> <p>\u200b\u6bcf\u4e2a\u200b\u6570\u636e\u200b\u5757\u200b\u6700\u200b\u591a\u200b\u53ea\u80fd\u200b\u7ef4\u62a4\u200b\u4e00\u4efd\u200b\u7f13\u5b58\u200b\u3002  </p> </li> <li> <p>\u200b\u8bf7\u200b\u5c06\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u6d89\u53ca\u200b\u7684\u200b\u9501\u200b\u4ee5\u200b<code>bcache</code>\u200b\u5f00\u5934\u200b\u6765\u200b\u547d\u540d\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8c03\u7528\u200binitlock()\u200b\u6765\u200b\u521d\u59cb\u5316\u200bbcache\u200b\u9501\u200b\u3002  </p> </li> <li> <p>\u200b\u54c8\u5e0c\u200b\u6876\u200b\u7684\u200b\u6570\u91cf\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u56fa\u5b9a\u200b\u7684\u200b\u6570\u76ee\u200b\uff0c\u200b\u4e0d\u200b\u9700\u8981\u200b\u52a8\u6001\u200b\u5730\u200b\u6269\u5c55\u200b\u54c8\u5e0c\u200b\u8868\u200b\u7684\u200b\u5927\u5c0f\u200b\u3002\u200b\u8bf7\u200b\u4f7f\u7528\u200b\u7d20\u6570\u200b\uff08\u200b\u6bd4\u5982\u200b13\uff09\u200b\u6765\u200b\u5b9a\u4e49\u200b\u54c8\u5e0c\u200b\u7ec4\u200b\u7684\u200b\u6570\u76ee\u200b\u6765\u200b\u5c3d\u53ef\u80fd\u51cf\u5c11\u200b\u54c8\u5e0c\u200b\u4e89\u7528\u200b\u3002  </p> </li> <li> <p>\u200b\u5728\u200b\u54c8\u5e0c\u200b\u8868\u4e2d\u200b\u641c\u7d22\u200b\u5757\u200b\u7f13\u5b58\u200b\u4e14\u200b\u4e3a\u200b\u672a\u200b\u547d\u4e2d\u200b\u7684\u200b\u7f13\u5b58\u200b\u5206\u914d\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u6761\u76ee\u200b\uff0c\u200b\u8fd9\u200b\u6574\u4e2a\u200b\u64cd\u4f5c\u200b\u5fc5\u987b\u200b\u662f\u200b\u539f\u5b50\u200b\u6027\u200b\u64cd\u4f5c\u200b\u7684\u200b\uff08\u200b\u4f3c\u4e4e\u200b\u8981\u200b\u52a0\u9501\u200b\u5662\u200b\uff09\u3002 </p> </li> <li> <p>\u200b\u5141\u8bb8\u200b\u6309\u200b\u987a\u5e8f\u200b\u67e5\u627e\u200b\u672a\u200b\u88ab\u200b\u4f7f\u7528\u200b\u7684\u200b\u6570\u636e\u200b\u7f13\u5b58\u200b\u5757\u200b\uff08\u200b\u5373\u200b\u5f15\u7528\u200b\u8ba1\u6570\u200brefcnt\u200b\u4e3a\u200b0\uff09\uff0c\u200b\u4e5f\u5c31\u662f\u8bf4\u200b\u5f53\u200bbget()\u200b\u67e5\u627e\u200b\u6570\u636e\u200b\u5757\u200b\u672a\u200b\u547d\u4e2d\u200b\u65f6\u200b\uff0cbget\u200b\u53ef\u4ee5\u200b\u9009\u62e9\u200b\u4e00\u4e2a\u200b\u8fd9\u6837\u200b\u7684\u200b\u672a\u200b\u88ab\u200b\u4f7f\u7528\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u79fb\u5165\u200b\u5230\u200b\u4ee5\u200bblockno\u200b\u4e3a\u200bkey\u200b\u7684\u200b\u54c8\u5e0c\u200b\u7ec4\u200b\u94fe\u8868\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u3002</p> </li> <li> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b\u5b9e\u73b0\u200b\u4e2d\u200b\u51fa\u73b0\u200b\u4e86\u200b\u540c\u65f6\u200b\u9501\u4e0a\u200b\u4e24\u4e2a\u200b\u4ee5\u4e0a\u200b\u7684\u200b\u9501\u200b\u7684\u200b\u60c5\u51b5\u200b\uff08\u200b\u6bd4\u5982\u8bf4\u200b\uff0cbget()\u200b\u5728\u200b\u83b7\u53d6\u200b\u7a7a\u95f2\u200b\u5757\u200b\u65f6\u200b\uff0c\u200b\u53ef\u80fd\u200b\u9700\u8981\u200b\u79fb\u52a8\u200b\u4e00\u4e2a\u200b\u5185\u5b58\u200b\u5757\u200b\u4ece\u200b\u4e00\u4e2a\u200b\u54c8\u5e0c\u200b\u7ec4\u5230\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u54c8\u5e0c\u200b\u7ec4\u200b\uff09\uff0c\u200b\u6ce8\u610f\u200b\u907f\u514d\u200b\u6b7b\u9501\u200b\u7684\u200b\u51fa\u73b0\u200b\u3002  </p> </li> <li> <p>\u200b\u4e00\u4e9b\u200b\u8c03\u8bd5\u200b\u7684\u200b\u63d0\u793a\u200b \uff1a\u200b\u9650\u5236\u200bCPU\u200b\u4e32\u884c\u200b\u8bbf\u95ee\u200b\u53ef\u4ee5\u200b\u4fbf\u4e8e\u200b\u8c03\u8bd5\u200b\u9501\u200b\u7ade\u4e89\u200b\u4e4b\u5916\u200b\u7684\u200b\u95ee\u9898\u200b\u3002\u200b\u4f8b\u5982\u200b\uff0c\u200b\u4f7f\u7528\u200b\u54c8\u5e0c\u200b\u8868\u200b\u7684\u200b\u65b9\u6cd5\u200b\u4f18\u5316\u200b\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5148\u200b\u4fdd\u7559\u200bbget\u200b\u4e2d\u200b\u5bf9\u200b\u5168\u5c40\u200b\u9501\u200b bcache.lock \u200b\u7684\u200b\u4f7f\u7528\u200b\uff0c\u200b\u5f53\u200b\u786e\u4fdd\u200b\u4f60\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u6ca1\u200b\u95ee\u9898\u200b\u65f6\u200b\uff0c\u200b\u518d\u200b\u5c06\u200b\u5176\u200b\u53bb\u9664\u200b\u3002\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5728\u200b\u8c03\u8bd5\u200b\u6b64\u7c7b\u200b\u95ee\u9898\u200b\u65f6\u4ec5\u200b\u5f00\u542f\u200b\u5355\u4e2a\u200bCPU\uff0c\u200b\u4f7f\u7528\u200b\u547d\u4ee4\u200b <code>make CPUS=1 qemu</code> \u200b\u91cd\u65b0\u200b\u7f16\u8bd1\u200b\u5373\u53ef\u200b\uff0c\u200b\u4f46\u200b\u8bf7\u200b\u8bb0\u5f97\u200b\u5728\u200b\u6d4b\u8bd5\u200b\u524d\u200b\u6253\u5f00\u200b\u3002</p> </li> </ul>"},{"location":"lab3/part4/","title":"xv6\u200b\u4e2d\u200bLock\u200b\u7684\u200b\u5b9e\u73b0\u200b\uff08\u200b\u9009\u8bfb\u200b\uff09","text":"<p>\u200b\u8fd9\u90e8\u5206\u200b\u6df1\u5165\u63a2\u8ba8\u200b\u4e86\u200b\u9501\u200b\u7684\u200b\u57fa\u672c\u539f\u7406\u200b\u3001\u200b\u5b9e\u73b0\u200b\u65b9\u6cd5\u200b\u548c\u200b\u4f7f\u7528\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u53ef\u80fd\u200b\u6709\u4e9b\u200b\u96be\u4ee5\u200b\u7406\u89e3\u200b\uff0c\u200b\u8d85\u51fa\u200b\u4e86\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u6c34\u5e73\u200b\u8981\u6c42\u200b\uff0c\u200b\u4f46\u200b\u4ecd\u7136\u200b\u5728\u200b\u77e5\u8bc6\u200b\u8303\u56f4\u200b\u5185\u200b\uff0c\u200b\u56e0\u6b64\u200b\u53ef\u200b\u4f9b\u200b\u611f\u5174\u8da3\u200b\u7684\u200b\u540c\u5b66\u200b\u8fdb\u884c\u200b\u53c2\u8003\u200b\u3002</p>"},{"location":"lab3/part4/#1","title":"1. \u200b\u9501\u200b\u7684\u200b\u57fa\u672c\u200b\u5b9e\u9a8c\u200b\u539f\u7406","text":"<p>kalloc.c\u200b\u4e2d\u200b\u8c03\u7528\u200bacquire()\u200b\u548c\u200brelease()\u200b\u6765\u200b\u83b7\u53d6\u200b\u9501\u200b\u548c\u200b\u91ca\u653e\u200b\u9501\u200b\u3002\u200b\u9996\u5148\u200b\u9700\u8981\u200b\u77e5\u9053\u200b\u7684\u200b\u662f\u200b\u9501\u200b\u7684\u200bacquire\uff08\u200b\u6216\u8005\u200b\u53eb\u200bP\uff09\u200b\u548c\u200brelease\uff08V\uff09\u200b\u7684\u200b\u5b9e\u73b0\u200b\u5e76\u200b\u4e0d\u662f\u200b\u4e00\u4ef6\u200b\u7b80\u5355\u200b\u7684\u200b\u4e8b\u60c5\u200b\u3002\u200b\u6211\u4eec\u200b\u5148\u200b\u6765\u770b\u200b\u4e00\u4e2a\u200b\u6700\u200bnaive\u200b\u7684\u200b\u5b9e\u73b0\u200b\uff1a</p> <pre><code>1.  void acquire(struct spinlock *lk) // does not work!\n2.  {\n3.      for(;;) {\n4.          if(lk-&gt;locked == 0) {\n5.              lk-&gt;locked = 1;\n6.              break;\n7.          }\n8.      }\n9.  }\n</code></pre> <p>\u200b\u8fd9\u4e2a\u200b\u4ee3\u7801\u200b\u975e\u5e38\u5bb9\u6613\u200b\u7406\u89e3\u200b\uff0c\u200b\u5982\u679c\u200blk\u200b\u88ab\u200b\u9501\u4e0a\u200b\u4e86\u200b\uff0c\u200b\u90a3\u200b\u5c31\u200b\u7ee7\u7eed\u200b\u5faa\u73af\u200b\uff0c\u200b\u5982\u679c\u200blk\u200b\u672a\u200b\u88ab\u200b\u9501\u4e0a\u200b\uff0c\u200b\u90a3\u200b\u5c31\u200b\u7ed9\u200b\u5b83\u200b\u52a0\u9501\u200b\u5e76\u200b\u9000\u51fa\u200b\u3002\u200b\u4f46\u200b\u8fd9\u4e2a\u200b\u5b9e\u73b0\u200b\u662f\u200b\u6709\u200b\u7f3a\u9677\u200b\u7684\u200b\uff0c\u200b\u8ba9\u200b\u6211\u4eec\u200b\u8bd5\u60f3\u200b\u4e00\u4e0b\u200b\u4ee5\u4e0b\u200b\u573a\u666f\u200b\uff1a</p> <p>\u200b\u67d0\u4e2a\u200b\u9519\u8bef\u200b\u573a\u666f\u200b</p> <ul> <li>lk\u200b\u4e00\u200b\u5f00\u59cb\u200b\u6ca1\u6709\u200b\u88ab\u200b\u9501\u4e0a\u200b\uff0c\u200b\u5373\u200blk-&gt;locked = 0; </li> <li>\u200b\u7136\u540e\u200bCPU0\u200b\u5728\u200b\u8dd1\u200b\u8fdb\u7a0b\u200bA\u200b\u800c\u200bCPU1\u200b\u5728\u200b\u8dd1\u200b\u8fdb\u7a0b\u200bB\uff0cA\u200b\u548c\u200bB\u200b\u540c\u65f6\u200b\u5bf9\u200b\u8fd9\u4e2a\u200b\u9501\u200b\u53d1\u8d77\u200b\u4e86\u200bacquire\uff1b</li> <li>\u200b\u6211\u4eec\u200b\u6240\u200b\u5e0c\u671b\u200b\u770b\u5230\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u9501\u200b\u88ab\u200b\u4e14\u200b\u53ea\u200b\u88ab\u200bA\u200b\u6216\u200bB\u200b\u4e2d\u200b\u7684\u200b\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u9501\u4f4f\u200b\uff0c\u200b\u800c\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u5219\u200b\u7ee7\u7eed\u200b\u5728\u200bfor\u200b\u4e2d\u200b\u5faa\u73af\u200b\u7b49\u5f85\u200b\u3002</li> <li>\u200b\u4f46\u662f\u200b\uff0c\u200b\u5047\u8bbe\u200bCPU0\u200b\u548c\u200bCPU1\u200b\u540c\u65f6\u200b\u6267\u884c\u200b\u5230\u200b\u4e86\u200b\u7b2c\u200b6\u200b\u884c\u200b\uff0c\u200b\u90a3\u4e48\u200b\u4f1a\u200b\u53d1\u751f\u200b\u4ec0\u4e48\u200b\u5462\u200b\uff1f</li> <li>\u200b\u6ca1\u9519\u200b\uff0c\u200b\u4e24\u4e2a\u200bCPU\u200b\u90fd\u200b\u53d1\u73b0\u200blk-&gt;locked == 0\uff0c\u200b\u56e0\u4e3a\u200b\u53e6\u200b\u4e00\u4e2a\u200bCPU\u200b\u8fd8\u200b\u6ca1\u6709\u200b\u6765\u5f97\u53ca\u200b\u6539\u52a8\u200blk-&gt;locked;</li> <li>\u200b\u8fd9\u200b\u5c31\u200b\u4f1a\u200b\u5bfc\u81f4\u200bA\u200b\u548c\u200bB\u200b\u540c\u65f6\u200b\u83b7\u5f97\u200b\u9501\u200b\uff0c\u200b\u5e76\u200b\u4ece\u200bacquire\u200b\u4e2d\u200b\u8fd4\u56de\u200b\uff0c\u200b\u8fd9\u200b\u663e\u7136\u200b\u4e0d\u662f\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u770b\u5230\u200b\u7684\u200b\u3002</li> </ul> <p>\u200b\u90a3\u200bacquire\u200b\u5230\u5e95\u200b\u662f\u200b\u600e\u4e48\u200b\u5b9e\u73b0\u200b\u7684\u200b\u5462\u200b\uff1f\u200b\u8fd9\u4e2a\u200b\u4ec5\u51ed\u200b\u8f6f\u4ef6\u200b\u662f\u200b\u65e0\u6cd5\u200b\u5b9e\u73b0\u200b\u7684\u200b\uff0c\u200b\u9700\u8981\u200b\u786c\u4ef6\u200b\u53c2\u4e0e\u200b\u8f85\u52a9\u200b\u5b9e\u73b0\u200b\u3002 \u200b\u5728\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u5148\u200b\u4ecb\u7ecd\u200b\u4e00\u6761\u200b\u7279\u6b8a\u200b\u7684\u200bCPU\u200b\u6307\u4ee4\u200b<code>amoswap</code>\u3002<code>amoswap</code>\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u5728\u200b\u4e00\u6761\u200b\u6307\u4ee4\u200b\u5b8c\u6210\u200b\u4e00\u6b21\u200b load \u200b\u548c\u200b store\uff0c\u200b\u66f4\u200b\u5177\u4f53\u200b\u7684\u200b\u8bf4\u200b\uff0c\u200b\u5c31\u662f\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u4e00\u4e2a\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u503c\u200b\u548c\u200b\u67d0\u200b\u4e00\u200b\u5185\u5b58\u5730\u5740\u200b\u7684\u200b\u503c\u200b\u505a\u200b\u4ea4\u6362\u200b\uff0c\u200b\u5c06\u200b\u6307\u5b9a\u200b\u5185\u5b58\u5730\u5740\u200b\u7684\u200b\u503c\u200b\u653e\u5165\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u540c\u65f6\u200b\u5c06\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u503c\u200b\u653e\u5165\u200b\u5185\u5b58\u200b\u3002\u200b\u6b64\u5916\u200b\uff0cCPU\u200b\u8fd8\u4f1a\u200b\u4fdd\u8bc1\u200b\u67d0\u4e00\u200bCPU\u200b\u6838\u5728\u200b\u6267\u884c\u200b\u8fd9\u4e00\u200b\u6307\u4ee4\u200b\u65f6\u200b\uff0c\u200b\u5176\u4ed6\u200bCPU\u200b\u6838\u200b\u4e0d\u80fd\u200b\u8bfb\u200b\u6216\u200b\u5199\u200b\u5bf9\u5e94\u200b\u7684\u200b\u5185\u5b58\u5730\u5740\u200b\u3002</p> <p>amoswap\u200b\u6307\u4ee4\u200b\u548c\u200b__sync_lock_test_and_set</p> <p>\u200b\u5728\u200bC\u200b\u8bed\u8a00\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u8fd9\u4e00\u200b\u6c47\u7f16\u200b\u6307\u4ee4\u200b\u7684\u200b\u8bed\u53e5\u200b\u8c03\u7528\u200b\u662f\u200b<code>__sync_lock_test_and_set()</code>\u3002 \u200b\u8fd9\u4e00\u200b\u51fd\u6570\u200b\u63a5\u6536\u200b\u4e24\u4e2a\u200b\u53c2\u6570\u200b\uff0c\u200b\u8981\u200b\u5199\u5165\u200b\u7684\u200b\u5730\u5740\u200b\u548c\u200b\u8981\u200b\u5199\u5165\u200b\u7684\u200b\u503c\u200b\uff0c\u200b\u8fd4\u56de\u503c\u200b\u662f\u200b\u5199\u5165\u200b\u5730\u5740\u200b\u539f\u6765\u200b\u7684\u200b\u503c\u200b\u3002 \u200b\u8bf7\u200b\u4ed4\u7ec6\u200b\u6bd4\u8f83\u200bamoswap\u200b\u6307\u4ee4\u200b\u548c\u200b__sync_lock_test_and_set\u200b\u884c\u4e3a\u200b\u4e0a\u200b\u7684\u200b\u76f8\u4f3c\u4e4b\u5904\u200b\uff0c \u200b\u786e\u4fdd\u200b\u4f60\u200b\u5df2\u7ecf\u200b\u5927\u81f4\u200b\u77e5\u9053\u200b__sync_lock_test_and_set\u200b\u662f\u200b\u5982\u4f55\u200b\u4f7f\u7528\u200bamoswap\u200b\u5b9e\u73b0\u200b\u529f\u80fd\u200b\u3002</p> <p>\u200b\u4e86\u89e3\u200b\u4e86\u200b__sync_lock_test_and_set\u200b\u4e4b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u5728\u200b\u56de\u5230\u200bacquire\u200b\u7684\u200b\u95ee\u9898\u200b\u4e0a\u6765\u200b\u3002\u200b\u5148\u200b\u770b\u770b\u200bxv6\u200b\u4e2d\u662f\u200b\u5982\u4f55\u200b\u5b9e\u73b0\u200bacquire\u200b\u7684\u200b\u3002</p> <pre><code>1.    // Acquire the lock.\n2.    // Loops (spins) until the lock is acquired.\n3.    void\n4.    acquire(struct spinlock *lk)\n5.    {\n6.        push_off(); // disable interrupts to avoid deadlock.\n7.        if(holding(lk))\n8.            panic(\"acquire\");\n9.        __sync_fetch_and_add(&amp;(lk-&gt;n), 1);\n10.        // On RISC-V, sync_lock_test_and_set turns into anatomic swap:\n11.        //   a5 = 1\n12.        //   s1 = &amp;lk-&gt;locked\n13.        //   amoswap.w.aq a5, a5, (s1)\n14.        while(__sync_lock_test_and_set(&amp;lk-&gt;locked, 1) != 0) {\n15.            __sync_fetch_and_add(&amp;lk-&gt;nts, 1);\n16.        }\n\n17.        // Tell the C compiler and the processor to not moveloads or stores\n18.        // past this point, to ensure that the criticalsection's memory\n19.        // references happen after the lock is acquired.\n20.        __sync_synchronize();\n21.        // Record info about lock acquisition for holding() anddebugging.\n22.        lk-&gt;cpu = mycpu();\n23.    }\n</code></pre> <p>\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b14-16\u200b\u884c\u200b\u7684\u200bwhile\u200b\u5faa\u73af\u200b\u3002\u200b\u8fd9\u91cc\u200b\u4f7f\u7528\u200b\u4e86\u200b<code>__sync_lock_test_and_set()</code>\uff08\u200b\u4f7f\u7528\u200bamoswap\uff09\uff0c\u200b\u4fdd\u8bc1\u200b\u4e86\u200b\u5bf9\u200blk-&gt;locked\u200b\u8bfb\u5199\u200b\u7684\u200b\u4e00\u81f4\u6027\u200b\u3002\u200b\u4e0b\u9762\u200b\u6211\u4eec\u200b\u6765\u200b\u5206\u6790\u200b\u4ee5\u4e0b\u200b\u5177\u4f53\u200b\u7684\u200b\u5de5\u4f5c\u200b\u6d41\u7a0b\u200b\u3002</p> <ul> <li> <p>\u200b\u5f53\u200blk-&gt;locked==0\uff0c\u200b\u5373\u200b\u5f53\u524d\u200b\u9501\u200b\u7a7a\u95f2\u200b\u65f6\u200b\uff0c__sync_lock_test_and_set()\u200b\u5728\u200b\u8fd4\u56de\u200b0\u200b\u7684\u200b\u540c\u65f6\u200b\uff0c\u200b\u4f1a\u5f80\u200blk-&gt;locked\u200b\u5199\u5165\u200b1\uff0c\u200b\u5373\u200b\u4e0a\u9501\u200b\u3002\u200b\u6574\u4e2a\u200b\u8fc7\u7a0b\u200b\u56e0\u4e3a\u200b\u7531\u200bamoswap\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4e0d\u4f1a\u200b\u88ab\u200b\u5176\u200b\u7684\u200bCPU\u200b\u6838\u6240\u200b\u5e72\u6270\u200b\u3002\u200b\u8fd4\u56de\u200b0\u200b\u4e4b\u540e\u200b\u9000\u51fa\u200bwhile\u200b\u5faa\u73af\u200b\uff0c\u200b\u7b26\u5408\u200b\u6211\u4eec\u200b\u7684\u200b\u9884\u671f\u200b\u3002</p> </li> <li> <p>\u200b\u5f53\u200blk-&gt;locked==1\uff0c\u200b\u5373\u200b\u5f53\u524d\u200b\u9501\u200b\u88ab\u200b\u9501\u5b9a\u200b\u65f6\u200b\uff0c__sync_lock_test_and_set\u200b\u5728\u200b\u8fd4\u56de\u200b1\u200b\u7684\u200b\u540c\u65f6\u200b\uff0c\u200b\u5f80\u200blk-&gt;locked\u200b\u91cc\u200b\u5199\u5165\u200b\u4e86\u200b1\u3002\u200b\u4e8b\u5b9e\u4e0a\u200b\u5728\u200b\u9501\u200b\u88ab\u200b\u9501\u5b9a\u200b\u540e\u200b\u6211\u4eec\u200b\u4e0d\u200b\u5e94\u8be5\u200b\u5f80\u200blk-&gt;locked\u200b\u91cc\u200b\u5199\u200b\u4e1c\u897f\u200b\uff08\u200b\u5f53\u7136\u200b\uff0c\u200b\u9664\u4e86\u200b\u89e3\u9501\u200b\u7684\u200b\u65f6\u5019\u200b\uff09\uff0c\u200b\u4f46\u662f\u200b\u56e0\u4e3a\u200b\u9501\u200b\u672c\u6765\u200b\u5c31\u662f\u200b1\uff0c\u200b\u518d\u200b\u5199\u5165\u200b\u4e00\u4e2a\u200b1\u200b\u76f8\u5f53\u4e8e\u200b\u6ca1\u6709\u200b\u6539\u53d8\u200b\u5185\u5bb9\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4e5f\u200b\u6ca1\u5dee\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u8fd4\u56de\u200b\u4e86\u200b1\uff0c\u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\u5f53\u524d\u200b\u9501\u200b\u88ab\u200b\u9501\u4f4f\u200b\u4e86\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4f1a\u200b\u7ee7\u7eed\u200b\u5728\u200bwhile\u200b\u4e2d\u200b\u5faa\u73af\u200b\u3002</p> </li> <li> <p>\u200b\u81f3\u4e8e\u200b\u7b2c\u200b15\u200b\u884c\u200b\u4ee3\u7801\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u4e8b\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u548c\u200b\u9501\u200b\u7684\u200b\u529f\u80fd\u200b\u65e0\u5173\u200b\uff0c\u200b\u4f46\u200b\u5f53\u7136\u200b\u5b83\u200b\u6709\u200b\u53e6\u5916\u200b\u7684\u200b\u4f5c\u7528\u200b\u3002\u200b\u8fd9\u6b21\u200b\u4e0d\u200b\u505a\u200b\u89e3\u91ca\u200b\uff0c\u200b\u6709\u200b\u5174\u8da3\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u7814\u7a76\u200b\u3002</p> </li> </ul> <p>\u200b\u5230\u200b\u8fd9\u91cc\u200b\u5bf9\u200bLock\u200b\u7684\u200b\u5b9e\u73b0\u200b\u89e3\u91ca\u200b\u5c31\u200b\u7ed3\u675f\u200b\u4e86\u200b\u3002\u200b\u5728\u200b\u8fdb\u884c\u200b\u4e0b\u200b\u4e00\u6b65\u200b\u7684\u200b\u9605\u8bfb\u200b\u524d\u200b\uff0c\u200b\u5f3a\u70c8\u5efa\u8bae\u200b\u5bf9\u200b\u4e0a\u9762\u200b\u7684\u200b\u4e24\u4e2a\u200b\u5b9e\u73b0\u200b\u505a\u200b\u6bd4\u8f83\u200b\u548c\u200b\u63e3\u6469\u200b\uff0c\u200b\u76f4\u5230\u200b\u4f60\u200b\u5bf9\u200b\u4e3a\u4ec0\u4e48\u200b\u9501\u8981\u200b\u4f7f\u7528\u200b__sync_lock_test_and_set\u200b\u6709\u200b\u4e86\u200b\u6e05\u6670\u200b\u7684\u200b\u8ba4\u8bc6\u200b\u3002</p> <p>\u200b\u6ce8\u200b\uff1a\u200b\u4ee5\u4e0a\u200b\u89e3\u91ca\u200b\u53ef\u200b\u5728\u200bxv6 book\u200b\u7684\u200bLocking\u200b\u7ae0\u8282\u200b\u4e2d\u200b\u627e\u5230\u200b\u3002</p>"},{"location":"lab3/part4/#2-kalloc","title":"2. \u200b\u9501\u200b\u4e0e\u200bkalloc","text":"<p>\u200b\u5728\u200b\u524d\u9762\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u90e8\u5206\u200b\uff0c\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u89e3\u91ca\u200b\u4e86\u200b\u201c<code>kalloc</code>\u200b\u5728\u200b\u4ec0\u4e48\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u4f7f\u7528\u200b\u4e86\u200b\u9501\u200b\uff1f\u201d\u200b\u8fd9\u4e2a\u200b\u95ee\u9898\u200b\u3002\u200b\u90a3\u200b\u4e3a\u4ec0\u4e48\u200b\u8981\u200b\u5728\u200b\u64cd\u4f5c\u200bfreelist\u200b\u7684\u200b\u65f6\u5019\u200b\u4e0a\u9501\u200b\u5462\u200b\uff1f\u200b\u4e0a\u9501\u200b\u5fc5\u7136\u200b\u662f\u200b\u4e3a\u4e86\u200b\u9632\u6b62\u200b\u5e76\u884c\u200b\u8fd0\u884c\u200b\u7684\u200b\u65f6\u5019\u200b\u51fa\u200b\u95ee\u9898\u200b\uff0c\u200b\u5982\u679c\u200b\u6211\u4eec\u200b\u80fd\u200b\u8bbe\u60f3\u200b\u51fa\u4e00\u200b\u573a\u666f\u200b\uff08\u200b\u8fd9\u4e2a\u200b\u573a\u666f\u200b\u663e\u7136\u200b\u662f\u200b\u5e76\u884c\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u7684\u200b\uff09\u200b\u8ba9\u200b\u6ca1\u200b\u4e0a\u9501\u200b\u7684\u200b\u94fe\u8868\u200b\u64cd\u4f5c\u200b\u51fa\u200b\u95ee\u9898\u200b\uff0c\u200b\u90a3\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u89e3\u91ca\u200b\u4e3a\u4ec0\u4e48\u200b\u8981\u200b\u4e0a\u9501\u200b\u4e86\u200b\u3002</p> <pre><code>// Allocate one 4096-byte page of physical memory.\n// Returns a pointer that the kernel can use.\n// Returns 0 if the memory cannot be allocated.\n68 void *\n69 kalloc(void)\n70 {\n71  struct run *r;\n72\n73  acquire(&amp;kmem.lock);\n74  r = kmem.freelist;\n75  if(r)\n76    kmem.freelist = r-&gt;next;\n77  release(&amp;kmem.lock);\n78\n79  if(r)\n80    memset((char*)r, 5, PGSIZE); // fill with junk\n81  return (void*)r;\n82 }\n</code></pre> <p>\u200b\u67d0\u4e2a\u200b\u9519\u8bef\u200b\u573a\u666f\u200b</p> <p>\u200b\u4ee5\u200bkalloc()\u200b\u51fd\u6570\u200b\u4e3a\u4f8b\u200b\uff08\u200b\u89c1\u200bkernel/kalloc.c\uff09\u3002\u200b\u5047\u8bbe\u200b\u7b2c\u200b73\u200b\u548c\u200b77\u200b\u884c\u200b\u7684\u200b\u9501\u200b\u64cd\u4f5c\u200b\u88ab\u200b\u6ce8\u91ca\u200b\u6389\u200b\u4e86\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c31\u200b\u53ef\u80fd\u200b\u6709\u200b\u4e24\u4e2a\u200bCPU\uff0c\u200b\u8bb0\u200b\u4e3a\u200bCPU0\u200b\u548c\u200bCPU1\uff0c\u200b\u540c\u65f6\u200b\u6267\u884c\u200b\u5230\u200b\u7b2c\u200b74\u200b\u884c\u200b\u3002\u200b\u7136\u540e\u200b\uff0c\u200b\u4e24\u4e2a\u200bCPU\u200b\u5c31\u200b\u4f1a\u200b\u4ece\u200bfreelist\u200b\u4e2d\u200b\u62ff\u51fa\u200b\u540c\u4e00\u4e2a\u200b\u5185\u5b58\u200b\u5757\u200b\uff0c\u200b\u8fd9\u200b\u5c31\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u4e24\u4e2a\u200b\u8fdb\u7a0b\u200b\u5171\u7528\u200b\u4e00\u5757\u200b\u5185\u5b58\u200b\uff0c\u200b\u4f46\u200b\u5bf9\u4e8e\u200b\u8fdb\u7a0b\u200b\u6765\u8bf4\u200b\u5b83\u200b\u8ba4\u4e3a\u200b\u5b83\u200b\u5f97\u5230\u200b\u7684\u200b\u5185\u5b58\u200b\u662f\u200b\u72ec\u4eab\u200b\u7684\u200b\uff0c\u200b\u8fd9\u6837\u200bA\u200b\u8fdb\u7a0b\u200b\u518d\u200b\u5f80\u200b\u8fd9\u5757\u200b\u5185\u5b58\u200b\u4e2d\u5199\u200b\u6570\u636e\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u628a\u200bB\u200b\u4e4b\u524d\u200b\u5199\u8fdb\u53bb\u200b\u7684\u200b\u6570\u636e\u200b\u7834\u574f\u200b\u6389\u200b\uff0c\u200b\u8fd9\u200b\u663e\u7136\u200b\u4e0d\u662f\u200b\u6211\u4eec\u200b\u6240\u200b\u5e0c\u671b\u200b\u7684\u200b\u3002\u200b\u6240\u4ee5\u200bkalloc()\u200b\u91cc\u200b\u4ece\u200bfreelist\u200b\u4e2d\u53d6\u200b\u5185\u5b58\u200b\u5757\u200b\u7684\u200b\u64cd\u4f5c\u200b\u9700\u8981\u200b\u9501\u200b\uff0cCPU0\u200b\u5728\u200b\u53d6\u200b\u7684\u200b\u65f6\u5019\u200bCPU1\u200b\u9677\u5165\u200b\u7b49\u5f85\u200b\uff0c\u200b\u76f4\u5230\u200bCPU0\u200b\u628a\u200bfreelist\u200b\u66f4\u65b0\u200b\u5b8c\u200b\u89e3\u9501\u200b\u540e\u200b\uff0cCPU1\u200b\u518d\u200b\u8fdb\u53bb\u200b\u53d6\u200b\uff0c\u200b\u4ece\u800c\u200b\u4fdd\u8bc1\u200b\u6bcf\u4e2a\u200b\u5185\u5b58\u200b\u5757\u200b\u53ea\u200b\u88ab\u200b\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u53d6\u200b\u8d70\u200b\u3002</p> <p>\u200b\u5bf9\u200bkfree\u200b\u51fd\u6570\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u81ea\u884c\u200b\u60f3\u8c61\u200b\u4e00\u4e2a\u200b\u6ca1\u6709\u200b\u9501\u4f1a\u200b\u51fa\u73b0\u200b\u9519\u8bef\u200b\u7684\u200b\u573a\u666f\u200b\uff0c\u200b\u5728\u200b\u6b64\u200b\u4e0d\u518d\u200b\u505a\u200b\u8ba8\u8bba\u200b\u3002</p>"},{"location":"lab3/part4/#3-bio","title":"3. \u200b\u9501\u200b\u4e0e\u200bbio","text":"<p>\u200b\u5728\u200bbio.c\u200b\u4e2d\u200b\uff0c\u200b\u4e00\u5171\u200b\u4f7f\u7528\u200b\u4e24\u79cd\u200b\u7c7b\u578b\u200b\u7684\u200b\u9501\u200b\uff1a\u200b\u81ea\u65cb\u200b\u9501\u200b<code>spinlock</code>\uff08bcache.lock\uff09\u200b\u548c\u200b\u7761\u7720\u200b\u9501\u200b<code>sleeplock</code>\uff08b.lock\uff09\u3002</p>"},{"location":"lab3/part4/#31","title":"3.1 \u200b\u81ea\u65cb\u200b\u9501","text":"<p>bcache.lock \u200b\u7528\u4e8e\u200b\u8868\u793a\u200b\u5f53\u524d\u200b\u8bbf\u95ee\u200b\u7684\u200bbcache\u200b\u7f13\u5b58\u200b\u5757\u200b\u6570\u636e\u7ed3\u6784\u200b\u662f\u5426\u200b\u88ab\u200b\u9501\u4f4f\u200b\u3002 \u200b\u5f53\u200bbcache.lock\u200b\u4e3a\u200b0\u200b\u65f6\u200b\u8868\u793a\u200b\u672a\u200b\u9501\u4f4f\u200b\uff0c\u200b\u80fd\u591f\u200b\u8bbf\u95ee\u200b\u5f53\u524d\u200b\u6570\u636e\u7ed3\u6784\u200bbcache\uff0c\u200b\u5982\u679c\u200b\u4e3a\u200b1\uff0c\u200b\u5373\u200b\u6682\u65f6\u200b\u65e0\u6cd5\u200b\u83b7\u5f97\u200b\u9501\u200b\uff0c\u200b\u5219\u200b\u4e0d\u65ad\u200b\u5faa\u73af\u200b\u3001\u200b\u81ea\u65cb\u200b\u3001\u200b\u7b49\u5f85\u200b\u9501\u200b\u91cd\u65b0\u200b\u53ef\u7528\u200b\u3002</p> <ul> <li> <p>bget() \u200b\u5728\u200b\u64cd\u4f5c\u200bbcache\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u4fee\u6539\u200brefcnt\u3001dev\u3001blockno\u3001valid\uff09\u200b\u65f6\u200b\uff0c\u200b\u9700\u8981\u200b\u83b7\u53d6\u200b\u5230\u200b\u81ea\u65cb\u200b\u9501\u200b bcache.lock\uff0c\u200b\u64cd\u4f5c\u200b\u5b8c\u6210\u200b\u540e\u200b\u518d\u200b\u91ca\u653e\u200b\u8be5\u9501\u200b\u3002</p> </li> <li> <p>brelse() \u200b\u9700\u8981\u200b\u83b7\u53d6\u200b\u5230\u200b\u81ea\u65cb\u200b\u9501\u200b bcache.lock\uff0c\u200b\u624d\u80fd\u200b\u5c06\u200brefcnt\uff08\u200b\u5f15\u7528\u200b\u8ba1\u6570\u200b\uff09\u200b\u51cf\u200b1\uff0c\u200b\u4e14\u200b\u53ea\u6709\u200b\u5728\u200brefcnt\u200b\u4e3a\u200b0\u200b\u65f6\u200b\uff0c\u200b\u5c06\u200b\u8be5\u200b\u6570\u636e\u200b\u7f13\u5b58\u200b\u5757\u200b\u63d2\u5165\u200b\u5230\u200bbcache.head\u200b\u94fe\u8868\u200b\u540e\u9762\u200b\uff0c\u200b\u64cd\u4f5c\u200b\u5b8c\u6210\u200b\u540e\u200b\u518d\u200b\u91ca\u653e\u200b\u8be5\u9501\u200b\u3002</p> </li> <li> <p>bpin()\u200b\u548c\u200bbunpin() \u200b\u83b7\u53d6\u200b\u5230\u200b\u9501\u200b\u540e\u200b\uff0c\u200b\u624d\u80fd\u200b\u4fee\u6539\u200brefcnt\uff0c\u200b\u64cd\u4f5c\u200b\u5b8c\u6210\u200b\u540e\u200b\u518d\u200b\u91ca\u653e\u200b\u8be5\u9501\u200b\u3002</p> </li> </ul>"},{"location":"lab3/part4/#32","title":"3.2 \u200b\u7761\u7720\u200b\u9501","text":"<p>b.lock\u200b\u7528\u4e8e\u200b\u8868\u793a\u200bbcache\u200b\u7f13\u5b58\u200b\u5757\u200b\u6570\u636e\u7ed3\u6784\u200b\u4e2d\u200b\u7684\u200b\u5f53\u524d\u200b\u7f13\u5b58\u6570\u636e\u200b\u5757\u200bbuf\u200b\u662f\u5426\u200b\u88ab\u200b\u9501\u4f4f\u200b\uff0c\u200b\u5f53\u200bb.lock\u200b\u4e3a\u200b1\u200b\u65f6\u200b\uff0c\u200b\u5219\u200b\u8c03\u7528\u200bsleep()\u200b\u7761\u7720\u200b\u7b49\u5f85\u200b\u9501\u200b\u91cd\u65b0\u200b\u53ef\u7528\u200b\uff0c\u200b\u4e3a\u200b0\u200b\u5219\u200b\u8868\u793a\u200b\u9501\u200b\u5df2\u7ecf\u200b\u88ab\u200b\u91ca\u653e\u200b\u3002\u200b\u7761\u7720\u200b\u9501\u200b\u7684\u200b\u4e09\u4e2a\u200b\u63a5\u53e3\u51fd\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li> <p>acquiresleep()\uff1a\u200b\u67e5\u8be2\u200bb.lock\u200b\u662f\u5426\u200b\u88ab\u200b\u9501\u200b\uff0c\u200b\u5982\u679c\u200b\u88ab\u200b\u9501\u200b\u4e86\u200b\uff0c\u200b\u5c31\u200b\u7761\u7720\u200b\uff0c\u200b\u8ba9\u51fa\u200bCPU\uff0c\u200b\u76f4\u5230\u200bwakeup()\u200b\u5524\u9192\u200b\u540e\u200b\uff0c\u200b\u83b7\u53d6\u200b\u5230\u200b\u9501\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200bb.lock\u200b\u7f6e\u200b1\u3002</p> </li> <li> <p>releasesleep()\uff1a\u200b\u91ca\u653e\u200b\u9501\u200b\uff0c\u200b\u5e76\u200b\u8c03\u7528\u200bwakeup()\u3002</p> </li> <li> <p>holdingsleep()\uff1a\u200b\u8fd4\u56de\u200b\u9501\u200b\u7684\u200b\u72b6\u6001\u200b\uff081\uff1a\u200b\u9501\u4f4f\u200b\u6216\u200b0\uff1a\u200b\u672a\u9501\u200b\uff09\u3002</p> </li> </ul> <p>\u200b\u7761\u7720\u200b\u9501\u200b\u7684\u200b\u4f7f\u7528\u200b\uff1a  </p> <ul> <li>bget() \u200b\u5728\u200b\u83b7\u53d6\u200b\u5230\u200b\u7f13\u5b58\u200b\u5757\u200b\uff08\u200b\u547d\u4e2d\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u6216\u8005\u200b\uff0c\u200b\u672a\u200b\u547d\u4e2d\u200b\u65f6\u200b\u901a\u8fc7\u200bLRU\u200b\u7b97\u6cd5\u200b\u66ff\u6362\u200b\u51fa\u6765\u200b\u7f13\u5b58\u200b\u4e2d\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\uff09\u200b\u540e\u200b\uff0c\u200b\u8c03\u7528\u200bacquiresleep()\u200b\u83b7\u53d6\u200b\u7761\u7720\u200b\u9501\u200b\u3002</li> <li>bwrite() \u200b\u5728\u200b\u5199\u5165\u200b\u5230\u200b\u78c1\u76d8\u200b\u4e4b\u524d\u200b\uff0c\u200b\u5148\u200b\u8c03\u7528\u200bholdingsleep()\u200b\u67e5\u8be2\u200b\u662f\u5426\u200b\u5df2\u7ecf\u200b\u83b7\u53d6\u200b\u5230\u200b\u8be5\u200b\u7761\u7720\u200b\u9501\u200b\uff0c\u200b\u786e\u4fdd\u200b\u6709\u200b\u5e26\u9501\u200b\u800c\u5165\u200b\u3002</li> <li>brelse() \u200b\u4e5f\u200b\u5148\u200b\u8c03\u7528\u200bholdingsleep()\u200b\u67e5\u8be2\u200b\u662f\u5426\u200b\u5df2\u7ecf\u200b\u83b7\u53d6\u200b\u5230\u200b\u8be5\u200b\u7761\u7720\u200b\u9501\u200b\uff0c\u200b\u786e\u4fdd\u200b\u6709\u200b\u5e26\u9501\u200b\u540e\u200b\uff0c\u200b\u624d\u200b\u8c03\u7528\u200breleasesleep()\u200b\u91ca\u653e\u200b\u8be5\u9501\u200b\u3002</li> </ul> <p>\u200b\u81ea\u65cb\u200b\u9501\u200b\u548c\u200b\u7761\u7720\u200b\u9501\u200b\u7684\u200b\u533a\u522b\u200b</p> <p>Spinlock       1. \u200b\u5728\u200b\u77ed\u65f6\u95f4\u200b\u5185\u200b\u8fdb\u884c\u200b\u8f7b\u91cf\u7ea7\u200b\u52a0\u9501\u200b;       2. \u200b\u83b7\u53d6\u200b\u8fc7\u7a0b\u200b\u4e00\u76f4\u200b\u8fdb\u884c\u200b\u5fd9\u200b\u5faa\u73af\u200b\u2014\u200b\u65cb\u8f6c\u200b\u2014\u200b\u7b49\u5f85\u200b\u9501\u200b\u91cd\u65b0\u200b\u53ef\u7528\u200b\uff08\u200b\u5360\u7528\u200bCPU\u200b\u65f6\u95f4\u200b\u957f\u200b\uff09\uff1b       3. xv6\u200b\u8981\u6c42\u200b\u5728\u200b\u6301\u6709\u200bspinlock\u200b\u671f\u95f4\u200b\uff0c\u200b\u4e2d\u65ad\u200b\u4e0d\u200b\u5141\u8bb8\u200b\u53d1\u751f\u200b\u3002    </p> <p>sleep-lock       1. \u200b\u9002\u5408\u200b\u957f\u65f6\u95f4\u200b\u6301\u6709\u200b\uff1b       2. \u200b\u83b7\u53d6\u200b\u9501\u200b\u671f\u95f4\u200b\u53ef\u4ee5\u200b\u8ba9\u51fa\u200bCPU\uff1b         3. \u200b\u6301\u6709\u200bSleep-lock\u200b\u671f\u95f4\u200b\u5141\u8bb8\u200b\u4e2d\u65ad\u200b\u53d1\u751f\u200b\uff0c\u200b\u4f46\u200b\u4e0d\u200b\u5141\u8bb8\u200b\u5728\u200b\u4e2d\u65ad\u200b\u7a0b\u5e8f\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u3002  </p>"},{"location":"lab3/part4/#4-kalloctest","title":"4. \u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200bkalloctest\u200b\u5bf9\u9501\u200b\u7684\u200b\u68c0\u6d4b","text":"<p>\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200b\u4f1a\u200b\u68c0\u67e5\u200b\u9501\u200b\u88ab\u200b\u963b\u585e\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u8fd8\u200b\u8bb0\u5f97\u200b\u4e0a\u6587\u200b\u63d0\u5230\u200b\u7684\u200bacquire\u200b\u4ee3\u7801\u200b\u5417\u200b\uff1f</p> <pre><code>1.    // Acquire the lock.\n2.    // Loops (spins) until the lock is acquired.\n3.    void\n4.    acquire(struct spinlock *lk)\n5.    {\n6.        push_off(); // disable interrupts to avoid deadlock.\n7.        if(holding(lk))\n8.            panic(\"acquire\");\n9.        __sync_fetch_and_add(&amp;(lk-&gt;n), 1);\n10.        // On RISC-V, sync_lock_test_and_set turns into anatomic swap:\n11.        //   a5 = 1\n12.        //   s1 = &amp;lk-&gt;locked\n13.        //   amoswap.w.aq a5, a5, (s1)\n14.        while(__sync_lock_test_and_set(&amp;lk-&gt;locked, 1) != 0) {\n15.            __sync_fetch_and_add(&amp;lk-&gt;nts, 1);\n16.        }\n\n17.        // Tell the C compiler and the processor to not moveloads or stores\n18.        // past this point, to ensure that the criticalsection's memory\n19.        // references happen after the lock is acquired.\n20.        __sync_synchronize();\n21.        // Record info about lock acquisition for holding() anddebugging.\n22.        lk-&gt;cpu = mycpu();\n23.    }\n</code></pre> <p><code>lk-&gt;n</code>\uff1a\u200b\u5373\u200b#acquire\uff0c\u200b\u60f3\u8981\u200b\u83b7\u53d6\u200b\u9501\u200b\u7684\u200b\u6b21\u6570\u200b\u3002</p> <p><code>lk-&gt;nts</code>\uff1a\u200b\u5373\u200b#fetch-and-add\uff0c\u200b\u6ca1\u6709\u200b\u83b7\u53d6\u200b\u5230\u200b\u9501\u200b\u7684\u200b\u6b21\u6570\u200b\u3002</p> <p>\u200b\u6bcf\u5f53\u200b\u6267\u884c\u200b\u4e00\u6b21\u200bacquire()\u200b\u51fd\u6570\u200b\uff0c\u200b\u7b2c\u200b9\u200b\u884c\u200b<code>__sync_fetch_and_add(&amp;(lk-&gt;n), 1);</code>\u200b\u5c31\u200b\u4f1a\u200b\u5c06\u200blk-&gt;n\u200b\u52a0\u200b1\u3002</p> <p>\u200b\u5f53\u200b\u6267\u884c\u200b\u5230\u200b\u7b2c\u200b14\u200b\u884c\u65f6\u200b\uff0c\u200b\u5982\u679c\u200b <code>__sync_lock_test_and_set(&amp;lk-&gt;locked, 1)</code>\u200b\u7684\u200b\u8fd4\u56de\u503c\u200b\u4e3a\u200b1\uff08\u200b\u5373\u9501\u200b\u5df2\u200b\u88ab\u200b\u5176\u4ed6\u200b\u8fdb\u7a0b\u200b\u9501\u4e0a\u200b\uff09\uff0clk-&gt;nts\u200b\u7684\u200b\u503c\u200b\u5c31\u200b\u4f1a\u52a0\u200b1\u3002</p> <p>\u200b\u6d4b\u8bc4\u200b\u7a0b\u5e8f\u200b\u4f1a\u200b\u68c0\u67e5\u200blk-&gt;nts\u200b\u7684\u200b\u503c\u200b\u3002\u200b\u5f53\u200blk-&gt;nts\u200b\u503c\u200b\u63a5\u8fd1\u200b0\u200b\u65f6\u200b\uff0c\u200b\u624d\u80fd\u200b\u901a\u8fc7\u200b\u6d4b\u8bd5\u200b\u3002\u200b\u6240\u4ee5\u200b\u8fd9\u6b21\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u9700\u8981\u200b\u505a\u200b\u7684\u200b\u5c31\u662f\u200b\u51cf\u5c11\u200b\u8fdb\u7a0b\u200b\u4e2d\u200b\u7684\u200b\u9501\u200b\u51b2\u7a81\u200b\uff0c\u200b\u5c3d\u91cf\u200b\u8ba9\u200b\u8fdb\u7a0b\u200b\u5728\u200b\u83b7\u53d6\u200b\u9501\u65f6\u200b\uff0c\u200b\u9501\u200b\u7684\u200b\u72b6\u6001\u200b\u90fd\u200b\u662f\u200b\u672a\u200b\u88ab\u200b\u9501\u4e0a\u200b\u7684\u200b\u3002</p>"},{"location":"lab3/part5/","title":"\u4ee3\u7801\u200b\u63d0\u4ea4","text":"<p>\u200b\u8bf7\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u4e8c\u200b\u7684\u200b\u4ee3\u7801\u200b\u63d0\u4ea4\u200b\u65b9\u5f0f\u200b\u3002</p>"},{"location":"lab4/part1/","title":"\u5b9e\u9a8c\u200b\u6982\u8ff0","text":"<p>\u200b\u6e29\u200b\uff08\u200b\u5b88\u200b\uff09\u200b\u99a8\u200b\uff08\u200b\u4f4f\u200b\uff09\u200b\u63d0\u200b\uff08\u200b\u7ea2\u200b\uff09\u200b\u793a\u200b\uff08\u200b\u7ebf\u200b\uff09</p> <p>\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u5df2\u200b\u5f15\u5165\u200b\u4ee3\u7801\u200b\u81ea\u52a8\u200b\u67e5\u91cd\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u4fdd\u6301\u200b\u5b66\u672f\u200b\u8bda\u4fe1\u200b\uff01</p> <p>\u200b\u8bfe\u7a0b\u200b\u590d\u4e60\u200b\u548c\u200b\u9884\u4e60\u200b\u8981\u6c42\u200b</p> <p>\u200b\u672c\u200b\u8282\u200b\u5b9e\u9a8c\u200b\u4e0e\u200b\u7406\u8bba\u8bfe\u200b\u7684\u200b \u201c\u200b\u865a\u62df\u5185\u5b58\u200b\u201d \u200b\u548c\u200b \u201c\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u201d \u200b\u8fd9\u200b\u4e24\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u76f8\u5173\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u590d\u4e60\u200b\u8fd9\u200b\u4e24\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u5728\u200b\u505a\u200b\u5b9e\u9a8c\u200b\u4e4b\u524d\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u9605\u8bfb\u200bxv6\u200b\u624b\u518c\u200b\u7684\u200b\u4ee5\u4e0b\u200b\u7ae0\u8282\u200b\u53ca\u200b\u76f8\u5173\u200b\u6e90\u4ee3\u7801\u200b\uff1a</p> <ul> <li>[1] xv6 book, Chapter 3 Page tables (\u200b\u9875\u8868\u200b)</li> <li>[2] kernel/memlayout.h \uff08\u200b\u5b9a\u4e49\u200b\u5185\u5b58\u200b\u7684\u200b\u5e03\u5c40\u200b\uff09</li> <li>[3] kernel/vm.c \uff08\u200b\u865a\u62df\u5185\u5b58\u200b\u4ee3\u7801\u200b\uff09</li> <li>[4] kernel/kalloc.c \uff08\u200b\u5206\u914d\u200b\u548c\u200b\u91ca\u653e\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u4ee3\u7801\u200b\uff09</li> </ul> <p>\u200b\u6b64\u5916\u200b\uff0c\u200b\u7279\u522b\u200b\u63a8\u8350\u200b\u540c\u5b66\u200b\u4eec\u200b\u89c2\u770b\u200b\u7531\u200b\u6211\u6821\u200bOS\u200b\u8bfe\u9898\u7ec4\u200b\u3001\u200b\u5404\u7ea7\u200b\u5b66\u957f\u200b\u52a9\u6559\u200b\u4eec\u200b\u5408\u529b\u200b\u4e3a\u200b\u5927\u5bb6\u200b\u5f55\u5236\u200b\u7684\u200bXV6\u200b\u8bb2\u89e3\u200b\u89c6\u9891\u200b\uff0c\u200b\u5e0c\u671b\u200b\u80fd\u591f\u200b\u8ba9\u200b\u5927\u5bb6\u200b\u5bf9\u200b\u6574\u4e2a\u200bXV6\u200b\u7cfb\u7edf\u200b\u6709\u200b\u4e00\u4e2a\u200b\u66f4\u4e3a\u200b\u76f4\u89c2\u200b\u7684\u200b\u8ba4\u8bc6\u200b\uff0c\u200b\u63a8\u8350\u200b\u5927\u5bb6\u200b\u6309\u200b\u9700\u200b\u89c2\u770b\u200b\uff1a</p> <ol> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e00\u200b\uff09\u200b\u542f\u52a8\u200b\u8fc7\u7a0b\u200b\u3011            </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1mK411S7N9?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e8c\u200b\uff09\u200b\u8fdb\u7a0b\u200b\u7ba1\u7406\u200b\u3011 </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1ge4y1J7Je?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> <li> <p>\u3010HITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e09\u200b\uff09\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u3011 </p> <ul> <li>\u200b\u89c6\u9891\u200b\u94fe\u63a5\u200b: https://www.bilibili.com/video/BV1Te4y1i77z?share_source=copy_web&amp;vd_source=225a99017e082147ac525beeddd6e3e2</li> <li>\u200b\u8bfe\u7a0b\u200bPPT: \u200b\u70b9\u200b\u8fd9\u91cc\u200b\u4e0b\u8f7d\u200b</li> </ul> </li> </ol> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u672c\u200b\u8282\u200b\u5b9e\u9a8c\u200b\u5c06\u200b\u63a2\u7d22\u200b\u5185\u6838\u200b\u7684\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u6a21\u5757\u200b\uff0c\u200b\u5e76\u4e14\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u76f8\u5e94\u200b\u7684\u200b\u90e8\u5206\u200b\u3002\u200b\u5efa\u8bae\u200b\u9605\u8bfb\u200b\u5b8c\u200b\u6240\u6709\u200b\u90e8\u5206\u200b\uff0c\u200b\u518d\u200b\u5f00\u59cb\u200b\u4ee3\u7801\u200b\u7684\u200b\u7f16\u5199\u200b\u3002</p>"},{"location":"lab4/part1/#0","title":"0.  \u200b\u5b9e\u9a8c\u200b\u5206\u6570","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u6709\u200b\u4e09\u4e2a\u200b\u4efb\u52a1\u200b\uff0c\u200b\u4f5c\u4e3a\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200bMIT xv6\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u4efb\u52a1\u200b\u4e8c\u200b\u548c\u200b\u4efb\u52a1\u200b\u4e09\u200b\u7684\u200b\u96be\u5ea6\u200b\u76f8\u6bd4\u200b\u4e4b\u524d\u200b\u6765\u8bf4\u200b\u6709\u200b \u200b\u660e\u663e\u63d0\u9ad8\u200b \uff0c\u200b\u4f46\u662f\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u5927\u5bb6\u200b\u80fd\u591f\u200b\u5c3d\u91cf\u200b\u5b8c\u6210\u200b\uff0c\u200b\u5982\u679c\u200b\u5b9e\u5728\u200b\u65e0\u6cd5\u200b\u5b8c\u6210\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u7ed9\u51fa\u200b\u4f60\u200b\u7684\u200b\u601d\u8def\u200b\uff0c\u200b\u4ee5\u200b\u5c3d\u53ef\u80fd\u200b\u62ff\u5230\u200b\u5206\u6570\u200b\uff0c\u200b\u5373\u4f7f\u200b\u4efb\u52a1\u200b\u4e8c\u200b\u548c\u200b\u4efb\u52a1\u200b\u4e09\u200b\u7684\u200b\u5206\u6570\u200b\u5360\u200b\u6bd4\u200b\u4e0d\u200b\u9ad8\u200b\u3002</p> <p>1. \u200b\u5b9e\u9a8c\u62a5\u544a\u200b</p> <ul> <li>\u200b\u56de\u7b54\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u7684\u200b\u95ee\u9898\u200b 40%\uff1b</li> <li>\u200b\u7ed9\u51fa\u200b\u5b9e\u9a8c\u8bbe\u8ba1\u200b\u601d\u8def\u200b 60%\uff1a<ul> <li>\u200b\u4efb\u52a1\u200b\u4e00\u200b\uff1a30%</li> <li>\u200b\u4efb\u52a1\u200b\u4e8c\u200b\uff1a20%</li> <li>\u200b\u4efb\u52a1\u200b\u4e09\u200b\uff1a10%</li> </ul> </li> </ul> <p>\u200b\u82e5\u200b\u5bf9\u5e94\u200b\u4efb\u52a1\u200b\u672a\u200b\u7ed9\u51fa\u200b\u5b9e\u9a8c\u8bbe\u8ba1\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5bf9\u5e94\u200b\u4efb\u52a1\u200b\u4ee3\u7801\u200b\u5206\u8bb0\u200b0\u200b\u5206\u200b\u3002</p> <p>2. \u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b</p> <ul> <li>\u200b\u4efb\u52a1\u200b\u4e00\u200b\uff1a50%</li> <li>\u200b\u4efb\u52a1\u200b\u4e8c\u200b\uff1a30%</li> <li>\u200b\u4efb\u52a1\u200b\u4e09\u200b\uff1a20%</li> </ul> <p>\u200b\u82e5\u200b\u5bf9\u5e94\u200b\u4efb\u52a1\u200b\u4ee3\u7801\u200b\u65e0\u6cd5\u200b\u901a\u8fc7\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u4e2d\u200b\u5bf9\u5e94\u200b\u4efb\u52a1\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u5206\u200b\u6700\u9ad8\u200b\u53ea\u80fd\u200b\u5f97\u5230\u200b\u6ee1\u5206\u200b\u7684\u200b50%\u3002 \u200b\u56e0\u6b64\u200b\uff0c\u200b\u5373\u4f7f\u200b\u6ca1\u6709\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u4f60\u200b\u4e5f\u200b\u5e94\u8be5\u200b\u5e94\u8be5\u200b\u5c3d\u53ef\u80fd\u200b\u5730\u200b\u7ed9\u51fa\u200b\u4f60\u200b\u7684\u200b\u601d\u8def\u200b\u3002</p>"},{"location":"lab4/part1/#1","title":"1.  \u200b\u5b9e\u9a8c\u200b\u76ee\u7684","text":"<ol> <li>\u200b\u4e86\u89e3\u200b\u9875\u8868\u200b\u7684\u200b\u5b9e\u73b0\u200b\u539f\u7406\u200b\u3002</li> <li>\u200b\u4fee\u6539\u200b\u9875\u8868\u200b\uff0c\u200b\u4f7f\u200b\u5185\u6838\u200b\u66f4\u200b\u65b9\u4fbf\u200b\u7684\u200b\u8fdb\u884c\u200b\u7528\u6237\u200b\u865a\u62df\u5730\u5740\u200b\u7ffb\u8bd1\u200b\u3002</li> </ol>"},{"location":"lab4/part1/#2","title":"2.  \u200b\u5b9e\u9a8c\u200b\u5b66\u65f6","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e3a\u200b4\u200b\u5b66\u65f6\u200b\u3002</p>"},{"location":"lab4/part1/#3","title":"3.  \u200b\u5b9e\u9a8c\u200b\u5185\u5bb9\u200b\u53ca\u200b\u8981\u6c42","text":"<p>\u200b\u8bf7\u200b\u5148\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u5e76\u200b\u6ce8\u610f\u200b\u5207\u6362\u200b\u5230\u200bpgtbl \u200b\u5206\u652f\u200b\u8fdb\u884c\u200b\u8bd5\u9a8c\u200b</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u57fa\u4e8e\u200b pgtbl \u200b\u5206\u652f\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u6ce8\u610f\u200b\u5207\u6362\u200b\u3002</p> <p>Step 1. \u200b\u9996\u5148\u200b\uff0c\u200b\u4fdd\u5b58\u200b\u5b9e\u9a8c\u200b\u4e09\u200b\u7684\u200b\u4ee3\u7801\u200b\uff0c\u200b\u8bf7\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u5b9e\u7528\u5de5\u5177\u200b\u7684\u200b3.3.1 \u200b\u4f7f\u7528\u200b\u547d\u4ee4\u884c\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u6216\u8005\u200b3.3.2 \u200b\u4f7f\u7528\u200bVSCode\u200b\u5185\u5efa\u200b\u7684\u200b\u56fe\u5f62\u5316\u200b\u754c\u9762\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u8fd9\u200b\u4e24\u200b\u5c0f\u8282\u200b\uff0c\u200b\u5b8c\u6210\u200bcommit\u200b\u64cd\u4f5c\u200b\u3002\u200b\u6216\u8005\u200b\uff0c \u200b\u5982\u679c\u200b\u4f60\u200b\u5e0c\u671b\u200b\u76f4\u63a5\u200b\u653e\u5f03\u200b\u6389\u200b\u4e0a\u200b\u4e00\u6b21\u200bcommit\u200b\u540e\u200b\u7684\u200b\u6240\u6709\u200b\u66f4\u6539\u200b \uff0c\u200b\u90a3\u4e48\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b-f\u200b\u9009\u9879\u200b\u5f3a\u5236\u200b\u5207\u6362\u200b\u5206\u652f\u200b\uff0c\u200b\u4f8b\u5982\u200b<code>git checkout -f pgtbl</code>\u3002</p> <p>Step 2. \u200b\u5207\u6362\u200b\u7684\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b -&gt; \u200b\u5b9e\u9a8c\u200b\u5b9e\u7528\u5de5\u5177\u200b -&gt; 3.1\u200b\u540c\u6b65\u200b\u4e0a\u6e38\u200b\u4ed3\u5e93\u200b ~ 3.3.3 \u200b\u5408\u5e76\u200b\u51b2\u7a81\u200b\u66f4\u6539\u200b\u3002</p> <p>\u200b\u540c\u65f6\u200b\uff0c\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u7684\u200b \u200b\u8f93\u51fa\u200b\u683c\u5f0f\u200b\u4e0d\u540c\u4e8e\u200bMIT\u200b\u539f\u7248\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u8bf7\u200b\u4e25\u683c\u200b\u6309\u7167\u200b\u6307\u5bfc\u4e66\u200b\u8981\u6c42\u200b\uff01 </p>"},{"location":"lab4/part1/#31","title":"3.1 \u200b\u4efb\u52a1\u200b\u4e00\u200b\uff1a\u200b\u6253\u5370\u200b\u9875\u8868","text":"<p>\u200b\u672c\u200b\u4efb\u52a1\u200b\u4e2d\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u52a0\u5165\u200b\u9875\u8868\u200b\u6253\u5370\u200b\u529f\u80fd\u200b\uff0c\u200b\u6765\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u5728\u200b\u4e4b\u540e\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u8fdb\u884c\u200bdebug\u3002</p> <p>\u200b\u9996\u5148\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4e86\u89e3\u200b\u9875\u8868\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u3002\u200b\u7136\u540e\u200b\uff0c\u200b\u6309\u200b\u5c42\u6b21\u200b\u6bcf\u9875\u200b\u6253\u5370\u200b\u5373\u53ef\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u91c7\u7528\u200b\u8fed\u4ee3\u200b\u7684\u200b\u7b97\u6cd5\u200b\u3002</p>"},{"location":"lab4/part1/#311","title":"3.1.1 \u200b\u6253\u5370\u51fd\u6570\u200b\u5b9a\u4e49","text":"<p><code>void vmprint(pagetable_t pgtbl)</code></p> <p>\u200b\u8be5\u200b\u51fd\u6570\u200b\u5c06\u200b\u83b7\u53d6\u200b\u4e00\u4e2a\u200b \u200b\u6839\u200b\u9875\u8868\u200b\u6307\u9488\u200b \u200b\u4f5c\u4e3a\u200b\u53c2\u6570\u200b\uff0c\u200b\u7136\u540e\u200b\u6253\u5370\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9875\u8868\u200b\u6570\u636e\u200b\u3002</p> <p>\u200b\u51fd\u6570\u200b\u7684\u200b\u4f7f\u7528\u200b\u4f4d\u7f6e\u200b \uff1a\u200b\u6ce8\u610f\u200b\uff01\u200b\u8be5\u200b\u51fd\u6570\u200b\u4e00\u5b9a\u200b\u8981\u200b\u63d2\u5165\u200b\u5728\u200b<code>exec()</code>\u200b\u903b\u8f91\u200b\u7ed3\u675f\u200b\u7684\u200b\u672b\u5c3e\u200b\uff0c\u200b\u6765\u200b\u6253\u5370\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u6216\u521a\u200b\u8f7d\u5165\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u9875\u8868\u200b\u6570\u636e\u200b\u3002\u200b\u5728\u200b\u5f00\u53d1\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u63d2\u5165\u200b\u5230\u200b\u5176\u4ed6\u200b\u7684\u200b\u5730\u65b9\u200b\uff0c\u200b\u4f46\u662f\u200b\u6700\u540e\u200b\u4e00\u5b9a\u200b\u53ea\u200b\u4fdd\u7559\u200b\u8fd9\u200b\u4e00\u4e2a\u200b\u5730\u65b9\u200b\u7684\u200b\u51fd\u6570\u200b\u4f7f\u7528\u200b\u3002</p> <ul> <li>\u200b\u5728\u200bexec.c\u200b\u4e2d\u200b\u7684\u200b\u8fd4\u56de\u200bargc\u200b\u4e4b\u524d\u200b\u63d2\u5165\u200bvmprint()\u200b\u51fd\u6570\u200b\uff0c\u200b\u4ee5\u200b\u8f93\u51fa\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u6216\u521a\u200b\u8f7d\u5165\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u9875\u8868\u200b\u3002\u200b\u5176\u4e2d\u200b\uff0cvmprin()\u200b\u51fd\u6570\u200b\u7684\u200b\u5165\u200b\u53c2\u200b\u53ef\u4ee5\u200b\u6839\u636e\u200b\u4f60\u200b\u81ea\u5df1\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u6765\u200b\u586b\u5165\u200b\u3002</li> </ul> <p></p>"},{"location":"lab4/part1/#312","title":"3.1.2 \u200b\u7ed3\u679c\u200b\u793a\u4f8b","text":"<p>\u200b\u5f53\u200bxv6\u200b\u542f\u52a8\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u5b83\u200b\u81ea\u8eab\u200b\u4f1a\u200b\u8c03\u7528\u200b <code>exec()</code> \u200b\u542f\u52a8\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b <code>init</code> \uff0c\u200b\u8fd9\u4e2a\u200b\u65f6\u5019\u200b\u6211\u4eec\u200b\u7684\u200b\u51fd\u6570\u200b\u4f1a\u200b\u5f97\u5230\u200b\u4ee5\u4e0b\u200b\u7684\u200b\u8f93\u51fa\u200b\uff1a</p> <pre><code>xv6 kernel is booting\n\nhart 1 starting\nhart 2 starting\npage table 0x0000000087f6e000\n/* \u200b\u6839\u200b\u9875\u8868\u200b\u7269\u7406\u5730\u5740\u200b\uff1a0x0000000087f6e000 */\n||0: pte 0x0000000021fda801 pa 0x0000000087f6a000\n/* \u200b\u6839\u9875\u200b\u76ee\u5f55\u200b\u9879\u200b 0\uff0cPTE\u200b\u5185\u5bb9\u200b\u4e3a\u200b0x0000000021fda801\uff0c\u200b\u8868\u793a\u200b\u4e0b\u200b\u4e00\u7ea7\u200b\uff08\u200b\u7b2c\u4e8c\u7ea7\u200b\uff09\u200b\u9875\u8868\u200b\u7684\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\u4e3a\u200b0x87f6a\uff0cFlags\u200b\u4e3a\u200b0x001\uff0cPTE_V\u200b\u6709\u6548\u200b\u3002\u200b\u8be5\u200b\u7269\u7406\u200b\u9875\u200b\u7684\u200b\u8d77\u59cb\u200b\u7269\u7406\u5730\u5740\u200b\u4e3a\u200b0x0000000087f6a000\u3002*/\n|| ||0: pte 0x0000000021fda401 pa 0x0000000087f69000\n/* \u200b\u7b2c\u4e8c\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b 0\uff0cPTE\u200b\u7684\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff1a0x87f69\uff0cFlags\u200b\u4e3a\u200b0x001\u3002 */\n|| || ||0: pte 0x0000000021fdac1f pa 0x0000000087f6b000\n/* \u200b\u7b2c\u4e09\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b 0\uff0c\u200b\u5176\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff1a0x87f6b\uff0cFlags\u200b\u4e3a\u200b0x01f\uff0c\u200b\u7269\u7406\u200b\u5757\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b\uff1a0x0000000087f6b000 */\n|| || ||1: pte 0x0000000021fda00f pa 0x0000000087f68000\n/* \u200b\u7b2c\u4e09\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b 1\uff0c\u200b\u5176\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff1a0x87f68\uff0cFlags\u200b\u4e3a\u200b0x00f\uff0c\u200b\u7269\u7406\u200b\u5757\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b\uff1a0x0000000087f68000 */\n|| || ||2: pte 0x0000000021fd9c1f pa 0x0000000087f67000\n/* \u200b\u7b2c\u4e09\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b 2\uff0c\u200b\u5176\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff1a0x87f67\uff0cFlags\u200b\u4e3a\u200b0x01f\uff0c\u200b\u7269\u7406\u200b\u5757\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b\uff1a0x0000000087f67000 */\n||255: pte 0x0000000021fdb401 pa 0x0000000087f6d000\n/* \u200b\u6839\u9875\u200b\u76ee\u5f55\u200b\u9879\u200b 255\uff0c\u200b\u4e0b\u200b\u4e00\u7ea7\u200b\uff08\u200b\u7b2c\u4e8c\u7ea7\u200b\uff09\u200b\u9875\u8868\u200b\u7684\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\u4e3a\u200b0x87f6d\uff0cFlags\u200b\u4e3a\u200b0x001\uff0cPTE_V\u200b\u6709\u6548\u200b\u3002\u200b\u8be5\u200b\u7269\u7406\u200b\u9875\u200b\u7684\u200b\u8d77\u59cb\u200b\u7269\u7406\u5730\u5740\u200b\u4e3a\u200b0x0000000087f6d000 */\n|| ||511: pte 0x0000000021fdb001 pa 0x0000000087f6c000\n/* \u200b\u7b2c\u4e8c\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b 511\uff0cPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\u4e3a\u200b0x87f6c\uff0cFlags\u200b\u4e3a\u200b0x001 */\n|| || ||510: pte 0x0000000021fdd807 pa 0x0000000087f76000\n/* \u200b\u7b2c\u4e09\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b 510\uff0c\u200b\u5176\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff1a0x87f76\uff0cFlags\u200b\u4e3a\u200b0x007\uff0c\u200b\u7269\u7406\u200b\u5757\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b\uff1a0x0000000087f76000 */\n|| || ||511: pte 0x0000000020001c0b pa 0x0000000080007000\n/* \u200b\u7b2c\u4e09\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b 511\uff0c\uff0c\u200b\u5176\u200bPPN\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff1a0x80007\uff0cFlags\u200b\u4e3a\u200b0x00b\uff0c\u200b\u7269\u7406\u200b\u5757\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b\uff1a0x0000000080007000 */\n</code></pre> <p>\u200b\u6211\u4eec\u200b\u5148\u200b\u4e0d\u200b\u7740\u6025\u200b\u52a8\u624b\u200b\uff0c\u200b\u5148\u200b\u770b\u770b\u200b\u7ed3\u679c\u200b\u957f\u200b\u4ec0\u4e48\u6837\u200b\uff08\u200b\u4e0d\u200b\u6e05\u695a\u200b\u9875\u8868\u200b\u7684\u200b\u542b\u4e49\u200b\u5148\u4e0d\u6025\u200b\uff0c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u4f1a\u200b\u544a\u8bc9\u200b\u4f60\u200b\uff09\u3002</p> <ul> <li>\u200b\u7b2c\u4e00\u884c\u200b\u6253\u5370\u200b\u7684\u200b\u662f\u200b <code>vmprint</code> \u200b\u7684\u200b\u53c2\u6570\u200b\uff0c\u200b\u5373\u200b\u83b7\u5f97\u200b\u7684\u200b\u9875\u8868\u200b\u53c2\u6570\u200b\u5177\u4f53\u200b\u7684\u200b\u503c\u200b\u3002</li> <li>\u200b\u5728\u200b\u4e4b\u540e\u200b\u6253\u5370\u200b\u7684\u200b\u5219\u200b\u662f\u200b\u9875\u8868\u200b\u9879\u200b\u3002RISC-V\u200b\u7684\u200b\u9875\u8868\u200b\u88ab\u200b\u8bbe\u8ba1\u200b\u6210\u200b\u4e86\u200b\u4e09\u5c42\u200b\uff08\u200b\u5177\u4f53\u200b\u89c1\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\uff09\uff0c\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u201d||\u201c\u200b\u90fd\u200b\u4ee3\u8868\u200b\u4e00\u5c42\u200b\u3002</li> <li>\u200b\u4e4b\u540e\u200b\u6253\u5370\u200b\u7684\u200b\u683c\u5f0f\u200b\u4e3a\u200b\uff1a <code>$index: pte $pte_bits pa $physical_address</code> \u3002<ul> <li><code>index</code>:  \u200b\u6307\u793a\u200b\u4e86\u200b\u8be5\u200b\u9875\u8868\u200b\u9879\u200b\u5728\u200b\u5f53\u524d\u200b\u7b49\u7ea7\u200b\u9875\u8868\u200b\u5185\u200b\u7684\u200b\u5e8f\u53f7\u200b\uff08\u200b\u53d6\u503c\u200b\u8303\u56f4\u200b\uff1a0-511\uff09\uff1b</li> <li><code>pte_bits</code>\uff1a\u200b\u6307\u793a\u200b\u4e86\u200b\u8fd9\u4e2a\u200b\u9875\u8868\u200b\u9879\u200b\u7684\u200b\u5341\u516d\u8fdb\u5236\u200b\u503c\u200b\uff08PTE\uff09\uff1b</li> <li><code>physical_address</code>\uff1a\u200b\u6307\u793a\u200b\u4e86\u200b\u8fd9\u4e2a\u200b\u9875\u8868\u200b\u9879\u200b\u5bf9\u5e94\u200b\u7684\u200b\u5341\u516d\u8fdb\u5236\u200b\u7269\u7406\u5730\u5740\u200b\uff1b</li> <li>\u200b\u53ea\u200b\u6253\u5370\u200b\u6709\u6548\u200b\u7684\u200bpte\u3002</li> </ul> </li> </ul> <p>\u200b\u5728\u200b\u4e0a\u9762\u200b\u7684\u200b\u793a\u4f8b\u200b\u4e2d\u200b\uff0c\u200b\u6839\u200b\u9875\u8868\u200b\u9879\u200b\u53ea\u6709\u200b\u7b2c\u200b0\u200b\u9879\u200b\u548c\u200b\u7b2c\u200b255\u200b\u9879\u200b\u7684\u200b\u6620\u5c04\u200b\u662f\u200b\u6709\u6548\u200b\u7684\u200b\uff0c\u200b\u5176\u4e2d\u200b\u7b2c\u200b0\u200b\u9879\u200b\u7684\u200b\u6b21\u200b\u9875\u8868\u200b\u53ea\u200b\u6620\u5c04\u200b\u4e86\u200b\u7d22\u5f15\u200b0\uff0c\u200b\u8be5\u200b\u7d22\u5f15\u200b0\u200b\u6620\u5c04\u200b\u4e86\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u7684\u200b0\u30011\u200b\u548c\u200b2\u3002</p> <p>\u200b\u4f60\u200b\u7684\u200b\u4ee3\u7801\u200b\u8f93\u51fa\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u4e0e\u200b\u4e0a\u8ff0\u200b\u793a\u4f8b\u200b\u53ef\u80fd\u200b\u4e0d\u200b\u76f8\u540c\u200b\uff0c\u200b\u4f46\u200b\u663e\u793a\u200b\u9879\u6570\u200b\u548c\u200b\u865a\u62df\u5730\u5740\u200b\u5e94\u200b\u76f8\u540c\u200b\u3002</p>"},{"location":"lab4/part1/#313","title":"3.1.3 \u200b\u6d4b\u8bd5","text":"<p>\u200b\u8fd0\u884c\u200b<code>make grade</code> \uff0c\u200b\u5176\u4e2d\u200b\u7684\u200b<code>pte printout</code>\u200b\u6d4b\u8bd5\u200b\u5c31\u662f\u200b\u8be5\u200b\u4efb\u52a1\u200b\u7684\u200b\u6d4b\u8bd5\u200b\uff08\u200b\u53ef\u200b\u53c2\u8003\u200b\u6d4b\u8bc4\u200b 3.4\uff09\u3002</p>"},{"location":"lab4/part1/#32","title":"3.2 \u200b\u4efb\u52a1\u200b\u4e8c\u200b\uff1a\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff08\u200b\u96be\u200b\uff09","text":"<p>\u200b\u76ee\u524d\u200b\uff0cxv6\u200b\u7684\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u90fd\u200b\u6709\u200b\u81ea\u5df1\u200b\u72ec\u7acb\u200b\u7684\u200b \u200b\u7528\u6237\u200b\u9875\u8868\u200b \uff08\u200b\u53ea\u200b\u5305\u542b\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u7528\u6237\u200b\u5185\u5b58\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u4ece\u200b\u865a\u62df\u5730\u5740\u200b0\u200b\u5f00\u59cb\u200b\uff09\uff0c\u200b\u4f46\u662f\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u8fdb\u5165\u200b\u5185\u6838\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f1a\u200b\u4f7f\u7528\u200b\u552f\u4e00\u200b\u7684\u200b\u4e00\u4e2a\u200b \u200b\u5168\u5c40\u200b\u5171\u4eab\u200b\u5185\u6838\u200b\u9875\u8868\u200b \u3002\u200b\u6211\u4eec\u200b\u9700\u8981\u200b \u200b\u5c06\u200b\u5168\u5c40\u200b\u5171\u4eab\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u6539\u6210\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b \uff0c\u200b\u4f7f\u5f97\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u62e5\u6709\u200b\u81ea\u5df1\u200b\u72ec\u7acb\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u5168\u5c40\u200b\u5171\u4eab\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u526f\u672c\u200b\u3002</p> <p>\u200b\u8fd9\u90e8\u5206\u200b\u6709\u200b\u4e00\u5b9a\u200b\u7684\u200b\u96be\u5ea6\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6307\u5bfc\u4e66\u200b\u4f1a\u200b\u5c3d\u53ef\u80fd\u200b\u7ed9\u51fa\u200b\u591a\u200b\u7684\u200b\u63cf\u8ff0\u200b\uff0c\u200b\u5927\u5bb6\u200b\u5e94\u200b\u53cd\u590d\u200b\u9605\u8bfb\u200b\uff0c\u200b\u5e76\u200b\u8bd5\u56fe\u200b\u5c06\u200b\u77e5\u8bc6\u70b9\u200b\u4e32\u8054\u200b\u8d77\u6765\u200b\u3002</p>"},{"location":"lab4/part1/#321","title":"3.2.1 \u200b\u72ec\u7acb\u200b\u9875\u8868\u200b\u7684\u200b\u80cc\u666f","text":"<p>\u200b\u5171\u4eab\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\uff0c\u200b\u6240\u6709\u200b\u7269\u7406\u5730\u5740\u200b\u90fd\u200b\u548c\u200b\u4e0e\u200b\u4e4b\u200b\u5b8c\u5168\u200b\u76f8\u7b49\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u5efa\u7acb\u200b\u6620\u5c04\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u76f4\u63a5\u200b\u6620\u5c04\u200b\u3002\u200b\u8fd9\u200b\u662f\u200b\u8ba9\u200b\u5185\u6838\u200b\u80fd\u591f\u200b\u76f4\u63a5\u200b\u4ee5\u200b\u7269\u7406\u5730\u5740\u200b\u8bbf\u95ee\u200b\u5185\u5b58\u200b\u7684\u200b\u6570\u636e\u200b\uff0c\u200b\u4e0d\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u4efb\u4f55\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u3002</p> <p>\u200b\u4f46\u662f\u200b \uff0c\u200b\u7531\u4e8e\u200b\u7528\u6237\u200b\u5730\u5740\u200b\u7684\u200b\u6620\u5c04\u200b\u5e76\u672a\u200b\u5b58\u50a8\u200b\u4e8e\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u5982\u679c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5904\u7406\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u4f20\u6765\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\uff08\u200b\u6bd4\u5982\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u4f20\u5165\u200b\u7684\u200b\u6307\u9488\u200b\uff09\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5148\u200b\u627e\u5230\u200b\u7528\u6237\u200b\u9875\u8868\u200b\uff0c\u200b\u9010\u4e2a\u200b\u9875\u8868\u200b\u9879\u5730\u200b\u627e\u5230\u200b\u80fd\u591f\u200b\u7ffb\u8bd1\u200b\u5bf9\u5e94\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b\u9875\u8868\u200b\u9879\u540e\u200b\uff0c\u200b\u624d\u200b\u53ef\u4ee5\u200b\u83b7\u53d6\u200b\u5b9e\u9645\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u5e76\u200b\u8fdb\u884c\u200b\u8bbf\u95ee\u200b\uff0c\u200b\u8fd9\u200b\u53eb\u505a\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u3002\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u7684\u200b\u5b9e\u73b0\u200b\u5f88\u200b\u590d\u6742\u200b\uff0c\u200b\u540c\u65f6\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u9700\u8981\u200b\u590d\u6742\u200b\u7684\u200b\u67e5\u627e\u200b\uff0c\u200b\u8fd8\u200b\u964d\u4f4e\u200b\u4e86\u200b\u6027\u80fd\u200b\u3002</p> <p>\u200b\u6240\u4ee5\u200b\u6211\u4eec\u200b\u5c06\u200b \u200b\u7528\u6237\u200b\u9875\u8868\u200b\u4e2d\u200b\u7684\u200b\u5185\u5b58\u200b\u6620\u5c04\u200b \u200b\u548c\u200b \u200b\u539f\u6765\u200b\u5171\u4eab\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\u7684\u200b\u5185\u5b58\u200b\u6620\u5c04\u200b \u200b\u8fdb\u884c\u200b\u5408\u5e76\u200b\uff0c\u200b\u8fd9\u6837\u200b\u5185\u6838\u200b\u4e5f\u200b\u80fd\u591f\u200b\u76f4\u63a5\u200b\u5bf9\u200b\u7528\u6237\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u8fdb\u884c\u200b\u8bbf\u95ee\u200b\uff0c\u200b\u800c\u200b\u4e0d\u200b\u9700\u8981\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u3002\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u8fd9\u662f\u200b \u200b\u4efb\u52a1\u200b\u4e09\u200b\u548c\u200b\u4efb\u52a1\u200b\u4e8c\u200b\u4e00\u540c\u200b \u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b\u7684\u200b\u7ed3\u679c\u200b\uff0c\u200b\u4efb\u52a1\u200b\u4e8c\u200b\u5206\u79bb\u200b\u51fa\u200b\u72ec\u7acb\u200b\u9875\u8868\u200b\uff0c\u200b\u4efb\u52a1\u200b\u4e09\u200b\u5229\u7528\u200b\u72ec\u7acb\u200b\u9875\u8868\u200b\u53bb\u9664\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u3002</p>"},{"location":"lab4/part1/#322","title":"3.2.2 \u200b\u72ec\u7acb\u200b\u9875\u8868\u200b\u7684\u200b\u8981\u6c42","text":"<p>\u200b\u5171\u4eab\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\uff1a\u200b\u865a\u5b9e\u200b\u5730\u5740\u200b\u76f8\u540c\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u76f4\u63a5\u200b\u6620\u5c04\u200b\u3002</p> <p>\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\uff1a\u200b\u865a\u5b9e\u200b\u5730\u5740\u200b\u76f8\u540c\u200b\u7684\u200b\u6620\u5c04\u200b\u5e94\u8be5\u200b\u8981\u200b\u4fdd\u7559\u200b\uff0c \u200b\u5148\u200b\u4e0d\u200b\u9700\u8981\u200b \u200b\u52a0\u4e0a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u5728\u200b \u200b\u4efb\u52a1\u200b\u4e09\u200b \u200b\u4e2d\u200b\u518d\u200b\u52a0\u4e0a\u200b\u52a0\u4e0a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u540c\u65f6\u200b\u8fd8\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u6709\u5173\u200b\u7684\u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"lab4/part1/#323","title":"3.2.3 \u200b\u6d4b\u8bd5","text":"<p>\u200b\u9996\u5148\u200b\uff0c\u200b\u5728\u200bxv6\u200b\u8fd0\u884c\u200b <code>kvmtest</code>\uff0c\u200b\u5982\u679c\u200b\u4f60\u200b\u786e\u5b9e\u200b\u4f7f\u7528\u200b\u4e86\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u4f1a\u200b\u770b\u5230\u200b\u4ee5\u4e0b\u200b\u7ed3\u679c\u200b\uff1a</p> <p></p> <p>\u200b\u7136\u540e\u200b\uff0c\u200b\u8bf7\u200b\u5728\u200bxv6\u200b\u8fd0\u884c\u200b <code>usertests</code>\uff0c\u200b\u786e\u4fdd\u200b\u6240\u6709\u200b\u6d4b\u8bd5\u901a\u8fc7\u200b\uff08\u200b\u663e\u793a\u200b\"ALL TESTS PASSED\"\uff09\u3002</p>"},{"location":"lab4/part1/#33","title":"3.3 \u200b\u4efb\u52a1\u200b\u4e09\u200b\uff1a\u200b\u7b80\u5316\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u5730\u5740\u200b\u7ffb\u8bd1\u200b\uff08\u200b\u5f88\u96be\u200b\uff09","text":"<p>xv6\u200b\u76ee\u524d\u200b\u4f7f\u7528\u200b<code>kernel/vm.c</code>\u200b\u4e2d\u200b\u7684\u200b<code>copyin()/copyinstr()</code>\u200b\u5c06\u200b\u7528\u6237\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\u7684\u200b\u6570\u636e\u200b\u62f7\u8d1d\u200b\u81f3\u200b\u5185\u6838\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u5b83\u4eec\u200b\u901a\u8fc7\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u7684\u200b\u65b9\u5f0f\u200b\u83b7\u53d6\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u5730\u5740\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\uff0c\u200b\u7136\u540e\u200b\u8fdb\u884c\u200b\u590d\u5236\u200b\uff08\u200b\u8be6\u60c5\u200b\u89c1\u200b\u4ee3\u7801\u200b\u6ce8\u91ca\u200b\uff09\u3002</p> <p>\u200b\u4efb\u52a1\u200b\u76ee\u6807\u200b\uff1a\u200b\u4f60\u200b\u9700\u8981\u200b \u200b\u5728\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u52a0\u4e0a\u200b\u7528\u6237\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u540c\u65f6\u200b\u5c06\u200b\u51fd\u6570\u200b <code>copyin()/copyinstr()</code> \u200b\u4e2d\u200b\u7684\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u5730\u5740\u200b\u7ffb\u8bd1\u200b\u6539\u6210\u200b\u76f4\u63a5\u200b\u8bbf\u95ee\u200b \uff0c\u200b\u4f7f\u5f97\u200b\u5185\u6838\u200b\u80fd\u591f\u200b\u4e0d\u5fc5\u200b\u82b1\u8d39\u200b\u5927\u91cf\u200b\u65f6\u95f4\u200b\uff0c\u200b\u7528\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7684\u200b\u65b9\u6cd5\u200b\u4e00\u6b65\u200b\u4e00\u6b65\u200b\u904d\u5386\u200b\u9875\u8868\u200b\uff0c\u200b\u800c\u662f\u200b\u76f4\u63a5\u200b\u5229\u7528\u200b\u786c\u4ef6\u200b\u3002</p>"},{"location":"lab4/part1/#331","title":"3.3.1 \u200b\u4efb\u52a1\u200b\u8981\u6c42","text":"<ol> <li>\u200b\u8981\u6c42\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u65b0\u200b\u7684\u200b\u51fd\u6570\u200b <code>copyin_new()/copyinstr_new()</code> \uff08\u200b\u5728\u200b <code>kernel/vmcopyin.c</code>\u200b\u4e2d\u200b\u5b9a\u4e49\u200b\uff09\u3002\u200b\u4f60\u200b\u9700\u8981\u200b\u627e\u5230\u200b\u8c03\u7528\u200b <code>copyin()</code>\uff08\u200b\u5728\u200b <code>kernel/vm.c</code> \u200b\u4e2d\u200b\u5b9a\u4e49\u200b\uff09\u200b\u7684\u200b\u5730\u65b9\u200b\uff0c\u200b\u7528\u200b<code>copyin_new()</code>\u200b\u66ff\u6362\u200b\u4e4b\u200b \u3002\u200b\u540c\u6837\u200b\u5730\u200b\uff0c\u200b\u7528\u200b<code>copyinstr_new()</code>\u200b\u4ee3\u66ff\u200b <code>copyinstr()</code>\u3002</li> <li>\u200b\u5728\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u52a0\u4e0a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u4ee5\u200b\u4fdd\u8bc1\u200b\u521a\u521a\u200b\u66ff\u6362\u200b\u5730\u65b0\u200b\u51fd\u6570\u200b\u80fd\u591f\u200b\u4f7f\u7528\u200b\u3002\u200b\u4f46\u662f\u200b\u8981\u200b\u6ce8\u610f\u200b\u5730\u5740\u200b\u91cd\u5408\u200b\u95ee\u9898\u200b\uff0c\u200b\u89c1\u200b\u201c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b 3.5\u201d.</li> </ol>"},{"location":"lab4/part1/#332","title":"3.3.2 \u200b\u7ed3\u679c\u200b\u793a\u4f8b","text":"<p>\u200b\u9996\u5148\u200b\uff0c\u200b\u5728\u200bxv6\u200b\u8fd0\u884c\u200b <code>stats stats</code>\uff0c\u200b\u5982\u679c\u200b\u4f60\u200b\u6b63\u786e\u200b\u4f7f\u7528\u200b\u4e86\u200bcopyin_new\u200b\u548c\u200bcopyinstr_new\uff0c\u200b\u4f1a\u200b\u770b\u5230\u200b\u8f93\u51fa\u200b\u7684\u200b\u6570\u503c\u200b\u4e0d\u4e3a\u200b\u96f6\u200b\uff1a</p> <p></p> <p>\u200b\u7136\u540e\u200b\uff0c\u200b\u8bf7\u200b\u5728\u200bxv6\u200b\u8fd0\u884c\u200b <code>usertests</code>\uff0c\u200b\u786e\u4fdd\u200b\u6240\u6709\u200b\u6d4b\u8bd5\u901a\u8fc7\u200b\uff08\u200b\u663e\u793a\u200b\"ALL TESTS PASSED\"\uff09\u3002</p>"},{"location":"lab4/part1/#34","title":"3.4 \u200b\u6d4b\u8bc4","text":"<p>\u200b\u5f53\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u7684\u200b\u4e09\u4e2a\u200b\u5b9e\u9a8c\u200b\u540e\u200b\uff0c\u200b\u5728\u200b\u547d\u4ee4\u884c\u200b\u8f93\u5165\u200b <code>make grade</code> \u200b\u8fdb\u884c\u200b\u6d4b\u8bd5\u200b\u3002\u200b\u5982\u679c\u200b\u901a\u8fc7\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u4f1a\u200b\u663e\u793a\u200b\u5982\u4e0b\u200b\u5185\u5bb9\u200b\uff1a</p> <p></p>"},{"location":"lab4/part2/","title":"\u5b9e\u9a8c\u200b\u539f\u7406","text":""},{"location":"lab4/part2/#1","title":"1. \u200b\u865a\u62df\u5185\u5b58\u200b\u7ba1\u7406","text":"<p>\u200b\u865a\u62df\u5185\u5b58\u200b\u7ba1\u7406\u200b\u5df2\u7ecf\u200b\u5728\u200b\u7406\u8bba\u8bfe\u200b\u4e0a\u200b\u8fdb\u884c\u200b\u4e86\u200b\u5b66\u4e60\u200b\uff0c\u200b\u4e0d\u200b\u719f\u6089\u200b\u7684\u200b\u540c\u5b66\u200b\u8bf7\u200b\u53ca\u65f6\u200b\u56de\u987e\u200b\u7406\u8bba\u77e5\u8bc6\u200b\uff0c\u200b\u672c\u200b\u90e8\u5206\u200b\u4ec5\u4f9b\u200b\u56de\u987e\u200b\u3002</p>"},{"location":"lab4/part2/#11","title":"1.1 \u200b\u5730\u5740\u200b\u7a7a\u95f4","text":"<p>\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u6709\u200b\u72ec\u7acb\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u8fdb\u7a0b\u200b\u8bbf\u95ee\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u5e76\u200b\u4e0d\u662f\u200b\u771f\u6b63\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\uff0c\u200b\u4f46\u200b\u8fdb\u7a0b\u200b\u53ef\u200b\u901a\u8fc7\u200b\u81ea\u8eab\u200b\u9875\u8868\u200b\u4e2d\u200b\u865a\u62df\u5730\u5740\u200b\u4e0e\u200b\u7269\u7406\u5730\u5740\u200b\u5efa\u7acb\u200b\u7684\u200b\u6620\u5c04\u200b\u83b7\u5f97\u200b\u771f\u6b63\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u3002xv6\u200b\u4f7f\u7528\u200b\u9875\u8868\u200b\u5206\u9694\u200b\u4e0d\u540c\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u5e76\u200b\u628a\u200b\u5b83\u4eec\u200b\u591a\u8def\u590d\u7528\u200b\u5230\u200b\u5355\u4e00\u200b\u7684\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u3002</p>"},{"location":"lab4/part2/#12","title":"1.2 \u200b\u6570\u636e\u7ed3\u6784","text":"<p>\u200b\u7cfb\u7edf\u200b\u901a\u8fc7\u200b\u9875\u200b\u673a\u5236\u200b\u6765\u200b\u5b9e\u73b0\u200b\u865a\u62df\u5730\u5740\u200b\u5230\u200b\u7269\u7406\u5730\u5740\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u7528\u200b\u9875\u8868\u200b\u50a8\u5b58\u200b\u6620\u5c04\u200b\u5173\u7cfb\u200b\u3002</p> <ul> <li> <p>\u200b\u9875\u200b\uff1a \u200b\u7cfb\u7edf\u200b\u5c06\u200b\u865a\u62df\u5185\u5b58\u200b\u5206\u6210\u200b4K\u200b\u5927\u5c0f\u200b\u7684\u200b\u5757\u200b\u3002\u200b\u6bcf\u5757\u200b\u5c31\u662f\u200b\u4e00\u9875\u200b\uff0c\u200b\u4f5c\u4e3a\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u7684\u200b\u6700\u5c0f\u200b\u5355\u4f4d\u200b\u3002\u200b\u6bcf\u4e2a\u200b\u9875\u200b\u90fd\u200b\u4f1a\u200b\u6709\u200b\u4e00\u4e2a\u200b\u7f16\u53f7\u200b\uff0c\u200b\u4ece\u5c0f\u5230\u5927\u200b\u3002</p> </li> <li> <p>\u200b\u9875\u200b\u6846\u200b\uff08\u200b\u5757\u200b\uff09\uff1a \u200b\u7cfb\u7edf\u200b\u5c06\u200b\u7269\u7406\u200b\u5185\u5b58\u200b\u4e5f\u200b\u548c\u200b\u865a\u62df\u5185\u5b58\u200b\u4e00\u6837\u200b\u5206\u6210\u200b4K\u200b\u5927\u5c0f\u200b\u7684\u200b\u5757\u200b\uff0c\u200b\u6bcf\u5757\u200b\u5c31\u662f\u200b\u4e00\u4e2a\u200b\u9875\u200b\u6846\u200b\uff0c\u200b\u4e0e\u200b\u9875\u200b\u4e00\u4e00\u5bf9\u5e94\u200b\u3002</p> </li> <li> <p>\u200b\u5730\u5740\u200b\u7ed3\u6784\u200b\uff1a \u200b\u5206\u9875\u200b\u5b58\u50a8\u7ba1\u7406\u200b\u7684\u200b\u903b\u8f91\u200b\u5730\u5740\u200b\u7ed3\u6784\u200b\u5982\u56fe\u200b\u524d\u200b\u4e00\u90e8\u5206\u200b\u4e3a\u9875\u200b\u53f7\u200bP\uff0c\u200b\u540e\u200b\u4e00\u90e8\u5206\u200b\u4e3a\u9875\u200b\u5185\u200b\u504f\u79fb\u91cf\u200bW\u300232\u200b\u4f4d\u200b\u673a\u5668\u200b\u56fe\u793a\u200b\u5982\u4e0b\u200b\uff08xv6\u200b\u662f\u200b64\u200b\u4f4d\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff09\u3002</p> </li> </ul> <p> </p> <ul> <li>\u200b\u9875\u8868\u200b\uff1a \u200b\u4e3a\u4e86\u200b\u4fbf\u4e8e\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u200b\u627e\u5230\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u6bcf\u4e2a\u200b\u9875\u9762\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7269\u7406\u200b\u5757\u200b\uff0c\u200b\u7cfb\u7edf\u200b\u4e3a\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u5efa\u7acb\u200b\u4e00\u5f20\u200b\u9875\u8868\u200b\uff0c\u200b\u8bb0\u5f55\u200b\u9875\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9875\u200b\u6846\u53f7\u200b\uff0c\u200b\u9875\u8868\u200b\u4e00\u822c\u200b\u5b58\u653e\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u200b\u3002\u200b\u5728\u200b\u914d\u7f6e\u200b\u4e86\u200b\u9875\u8868\u200b\u540e\u200b\uff0c\u200b\u8fdb\u7a0b\u200b\u6267\u884c\u200b\u65f6\u200b\uff0c\u200b\u901a\u8fc7\u200b\u67e5\u627e\u200b\u8be5\u8868\u200b\uff0c\u200b\u5373\u53ef\u200b\u627e\u5230\u200b\u6bcf\u9875\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u200b\u7684\u200b\u7269\u7406\u200b\u5757\u200b\u53f7\u200b\u3002\u200b\u53ef\u89c1\u200b\uff0c\u200b\u9875\u8868\u200b\u7684\u200b\u4f5c\u7528\u200b\u662f\u200b\u5b9e\u73b0\u200b\u4ece\u9875\u200b\u53f7\u200b\u5230\u200b\u9875\u200b\u6846\u53f7\u200b\u7684\u200b\u5730\u5740\u6620\u5c04\u200b\u3002</li> </ul>"},{"location":"lab4/part2/#13","title":"1.3 \u200b\u4f7f\u7528\u200b\u65b9\u6cd5","text":"<p>\u200b\u5728\u200bRISC-V\u200b\u6307\u4ee4\u200b\u96c6\u4e2d\u200b\uff0c\u200b\u5f53\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5f00\u542f\u200b\u9875\u8868\u200b\u670d\u52a1\u200b\u65f6\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5c06\u200b\u6211\u4eec\u200b\u9884\u5148\u200b\u914d\u7f6e\u200b\u597d\u200b\u7684\u200b\u9875\u8868\u200b\u9996\u200b\u5730\u5740\u200b\u653e\u5165\u200b <code>satp</code> \u200b\u5bc4\u5b58\u5668\u200b\u4e2d\u200b\u3002\u200b\u4ece\u6b64\u200b\u4e4b\u540e\u200b\uff0c \u200b\u8ba1\u7b97\u673a\u786c\u4ef6\u200b \u200b\u5c06\u200b\u628a\u200b\u8bbf\u5b58\u200b\u7684\u200b\u5730\u5740\u200b \u200b\u5747\u200b\u89c6\u4e3a\u200b\u865a\u62df\u5730\u5740\u200b \uff0c\u200b\u90fd\u200b\u9700\u8981\u200b\u901a\u8fc7\u200b\u786c\u4ef6\u200b\u67e5\u8be2\u200b\u9875\u8868\u200b\uff0c\u200b\u5c06\u200b\u5176\u200b \u200b\u7ffb\u8bd1\u200b\u6210\u4e3a\u200b\u7269\u7406\u5730\u5740\u200b \uff0c\u200b\u7136\u540e\u200b\u5c06\u200b\u5176\u200b\u4f5c\u4e3a\u200b\u5730\u5740\u200b\u53d1\u9001\u7ed9\u200b\u5185\u5b58\u200b\u8fdb\u884c\u200b\u8bbf\u5b58\u200b\u3002</p>"},{"location":"lab4/part2/#2","title":"2. \u200b\u9875\u8868","text":"<p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u672c\u200b\u90e8\u5206\u200b\uff0c\u200b\u4f60\u200b\u5e94\u8be5\u200b\u8981\u200b\u77e5\u9053\u200b\uff1a</p> <ul> <li> <p>\u200b\u4ec0\u4e48\u200b\u662f\u200b\u9875\u8868\u200b\uff1f</p> </li> <li> <p>\u200b\u9875\u8868\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u662f\u200b\u4ec0\u4e48\u200b\uff1f</p> </li> <li> <p>\u200b\u9875\u8868\u200b\u662f\u200b\u600e\u4e48\u200b\u5de5\u4f5c\u200b\u7684\u200b\uff1f</p> </li> </ul>"},{"location":"lab4/part2/#21","title":"2.1 \u200b\u9875\u8868\u200b\u662f\u200b\u4ec0\u4e48","text":"<p>\u200b\u9875\u8868\u200b\u5c31\u662f\u200b\u5b58\u653e\u200b\u865a\u5b9e\u200b\u5730\u5740\u6620\u5c04\u200b\u7684\u200b\u8868\u683c\u200b\uff0c\u200b\u91cc\u9762\u200b\u88c5\u6ee1\u200b\u4e86\u200b\u865a\u5b9e\u200b\u5730\u5740\u200b\u7684\u200b\u6620\u5c04\u200b\u3002</p> <p>\u200b\u9875\u8868\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u548c\u200b\u7ffb\u8bd1\u200b\u7684\u200b\u6a21\u5f0f\u200b\u56fe\u793a\u200b\u5927\u81f4\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p> <p>xv6\u200b\u91c7\u7528\u200b\u7684\u200b\u6307\u4ee4\u96c6\u200b\u6807\u51c6\u200b\u4e3a\u200bRISC-V\u200b\u6807\u51c6\u200b\uff0c\u200b\u5176\u4e2d\u200b\u9875\u8868\u200b\u7684\u200b\u6807\u51c6\u200b\u4e3a\u200bSV39\u200b\u6807\u51c6\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u865a\u62df\u5730\u5740\u200b\u6700\u591a\u4e3a\u200b39\u200b\u4f4d\u200b\u3002\u200b\u4e0b\u9762\u200b\uff0c\u200b\u6211\u4eec\u200b\u6765\u200b\u4ecb\u7ecd\u200b\u8fd9\u5957\u200b\u6807\u51c6\u200b\uff0c\u200b\u4e4b\u540e\u200b\u4f60\u200b\u4f1a\u200b\u77e5\u9053\u200b\u4e3a\u4ec0\u4e48\u200b\u53eb\u200b39\u3002</p>"},{"location":"lab4/part2/#22","title":"2.2 \u200b\u9875\u8868\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u91cd\u8981\u200b\uff09","text":""},{"location":"lab4/part2/#221","title":"2.2.1 \u200b\u865a\u5b9e\u200b\u5730\u5740","text":"<p>\u200b\u84dd\u8272\u200b\u90e8\u5206\u200b\uff1a\u200b\u4ee3\u8868\u200b\u7528\u6237\u200b\u6240\u200b\u6301\u6709\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u3002\u200b\u6bd4\u5982\u200b\u6211\u4eec\u200b\u5728\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u6240\u200b\u6301\u6709\u200b\u7684\u200b\u6307\u9488\u200b\uff0c64\u200b\u4f4d\u200b\u7684\u200b\uff0c\u200b\u5c31\u957f\u200b\u8fd9\u6837\u200b\u3002\u200b\u5176\u4e2d\u200b\u4f4e\u200b39\u200b\u4f4d\u200b\u53ef\u7528\u200b\uff0839\u200b\u7684\u200b\u7531\u200b\u6765\u200b\uff09\uff0c\u200b\u5176\u4ed6\u200b\u7684\u200b\u4e3a\u200b\u62d3\u5c55\u200b\u3002\u200b\u8fd9\u200b\u4e09\u5341\u4e5d\u200b\u4f4d\u200b\u88ab\u200b\u5212\u5206\u200b\u6210\u200b\u4e86\u200b\u56db\u200b\u90e8\u5206\u200b\uff1a <code>L2 L1 L0 Offset</code>\u3002</p> <ul> <li>L2\u200b\u662f\u200b \u200b\u6839\u200b\u9875\u8868\u200b \u200b\u7684\u200b\u7d22\u5f15\u200b\uff08index\uff09\uff0c\u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b\u6b21\u200b\u9875\u8868\u200b\u7684\u200b\u57fa\u200b\u5730\u5740\u200b\u3002</li> <li>L1\u200b\u662f\u200b \u200b\u6b21\u200b\u9875\u8868\u200b \u200b\u7684\u200b\u7d22\u5f15\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u7684\u200b\u57fa\u200b\u5730\u5740\u200b\u3002</li> <li>L0\u200b\u662f\u200b \u200b\u9875\u8868\u200b\u9879\u200b \u200b\u7684\u200b\u7d22\u5f15\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b64\u200b\u4f4d\u200b\u7684\u200b\u9875\u8868\u200b\u9879\u200b\u3002</li> </ul> <p>\u200b\u6ce8\u200b\uff1a\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0cL2\u200b\u548c\u200bL1\u200b\u5bf9\u5e94\u200b\u4e8e\u200b\u7406\u8bba\u8bfe\u200b\u4e2d\u200b\u7684\u200b\u9875\u200b\u76ee\u5f55\u200b\u53f7\u200b\uff0cL0\u200b\u5bf9\u5e94\u200b\u7406\u8bba\u8bfe\u200b\u4e2d\u200b\u7684\u200b\u9875\u200b\u53f7\u200b\u3002</p> <p>\u200b\u7ea2\u8272\u200b\u90e8\u5206\u200b\uff1a\u200b\u9875\u8868\u200b\u9879\u4e2d\u200b\u6709\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200bPPN\uff0c\u200b\u52a0\u4e0a\u200b\u865a\u62df\u5730\u5740\u200b\u672c\u8eab\u200b\u542b\u6709\u200b\u7684\u200b <code>Offset</code> \u200b\u7ec4\u6210\u200b\u4e86\u200b\u7269\u7406\u5730\u5740\u200b\uff0c64\u200b\u4f4d\u200b\u5269\u4e0b\u200b\u7684\u200b\u4f4d\u6570\u200b\u4e3a\u200b\u4fdd\u7559\u200b\u4f4d\u200b\u3002\u200b\u6ce8\u610f\u200b\uff0c \u200b\u865a\u5b9e\u200b\u5730\u5740\u200b\u7684\u200bOffset\uff08\u200b\u4f4e\u200b\u5341\u4e8c\u4f4d\u200b\uff09\u200b\u5b8c\u5168\u76f8\u540c\u200b \uff0c\u200b\u4e0d\u7528\u200b\u7ffb\u8bd1\u200b\u3002</p>"},{"location":"lab4/part2/#222","title":"2.2.2 \u200b\u9875\u8868","text":"<p>SV39\u200b\u9875\u8868\u200b\u6807\u51c6\u200b\u4e0b\u200b\uff0c\u200b\u6784\u9020\u200b\u4e86\u200b\u4e09\u7ea7\u200b\u9875\u8868\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5176\u200b\u5206\u4e3a\u200b\u79f0\u4e3a\u200b\uff1a\u200b\u6839\u200b\u9875\u8868\u200b\u3001\u200b\u6b21\u200b\u9875\u8868\u200b\u3001\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u3002\u200b\u987a\u5e8f\u200b\u548c\u200b\u56fe\u200b\u4e2d\u200b\u9875\u8868\u200b\u4ece\u200b\u5de6\u5411\u53f3\u200b\u4f9d\u6b21\u200b\u5bf9\u5e94\u200b\u3002</p> <p>\u200b\u6bcf\u4e2a\u200b\u9875\u8868\u200b\u7684\u200b\u5927\u5c0f\u200b\u90fd\u200b\u662f\u200b4K\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u4e00\u4e2a\u200b\u9875\u200b\u3002\u200b\u9875\u8868\u200b\u6709\u200b512\u200b\u4e2a\u9875\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b8 bytes\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b64\u200b\u4f4d\u200b\u3002512\u200b\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u9700\u8981\u200b9\u200b\u4f4d\u200b\u7684\u200b\u7d22\u5f15\u200b\uff0c\u200b\u56e0\u6b64\u200b 2.2.1 \u200b\u865a\u5b9e\u200b\u5730\u5740\u200b \u200b\u84dd\u8272\u200b\u865a\u62df\u5730\u5740\u200b\u4e2d\u200b\u7684\u200b L2, L1, L0 \u200b\u7d22\u5f15\u200b\u90fd\u200b\u662f\u200b9\u200b\u4f4d\u200b\u7684\u200b\u3002</p> <p>\u200b\u73b0\u5728\u200b\u6765\u770b\u200b\u9875\u200b\u76ee\u5f55\u200b\u9879\u200b\u81ea\u8eab\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5927\u6982\u200b\u5206\u6210\u200b\u4e24\u4e2a\u200b\u90e8\u5206\u200b\uff1a<code>\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff08PPN\uff09</code>\u200b\u548c\u200b\u5bf9\u5e94\u200b\u7684\u200b<code>\u200b\u6807\u5fd7\u200b\u4f4d\u200b\uff08Flags\uff09</code>\uff08\u200b\u542b\u6709\u200b\u8bbf\u95ee\u200b\u6743\u9650\u200b\u3001\u200b\u8bbf\u95ee\u200b\u8bb0\u5f55\u200b\u7b49\u200b\uff09\u3002\u200b\u524d\u8005\u200b\u8868\u793a\u200b\u7269\u7406\u5730\u5740\u200b\u7684\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b 2.2.1 \u200b\u865a\u5b9e\u200b\u5730\u5740\u200b  \u200b\u7ea2\u8272\u200b\u7269\u7406\u5730\u5740\u200b\u7684\u200bPPN\u3002\u200b\u4f46\u662f\u200b\u6bcf\u200b\u4e00\u7ea7\u200b\u9875\u8868\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u7684\u200b\u610f\u4e49\u200b\u90fd\u200b\u4e0d\u540c\u200b\uff0c\u200b\u5177\u4f53\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>\u200b\u6839\u200b\u9875\u8868\u200b \u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u5305\u542b\u200b\u5bf9\u5e94\u200b \u200b\u6b21\u200b\u9875\u8868\u200b \uff08\u200b\u4e0b\u200b\u4e00\u7ea7\u200b\u9875\u8868\u200b\uff09\u200b\u7684\u200b\u57fa\u200b\u5730\u5740\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\u4ee5\u53ca\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u3002</li> <li>\u200b\u6b21\u200b\u9875\u8868\u200b \u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u5305\u542b\u200b\u5bf9\u5e94\u200b \u200b\u53f6\u5b50\u200b\u9875\u8868\u200b \uff08\u200b\u4e0b\u200b\u4e00\u7ea7\u200b\u9875\u8868\u200b\uff09\u200b\u7684\u200b\u57fa\u200b\u5730\u5740\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\u4ee5\u53ca\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u3002</li> <li>\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b \u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u5305\u542b\u200b\u5bf9\u5e94\u200b \u200b\u865a\u62df\u5730\u5740\u200b \u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\u4ee5\u53ca\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u3002</li> </ul>"},{"location":"lab4/part2/#223","title":"2.2.3 \u200b\u9875\u8868\u200b\u9879","text":"<p>\u200b\u521a\u521a\u200b\uff0c\u200b\u6211\u4eec\u200b\u628a\u200b\u76ee\u5f55\u200b\u9879\u200b\u5206\u6210\u200b\u4e86\u200b\u4e24\u4e2a\u200b\u90e8\u5206\u200b\uff1a\u200b\u7269\u7406\u5730\u5740\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\u548c\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u3002\u200b\u5177\u4f53\u200b\u7684\u200b\u7ed3\u6784\u200b\u5982\u4e0a\u56fe\u200b\u3002</p> <ul> <li>\u200b\u4fdd\u7559\u200b\u4f4d\u200b\uff1a\u200b\u7b2c\u200b<code>54-63</code>\u200b\u4f4d\u200b\uff0c\u200b\u5171\u200b<code>10</code>\u200b\u4f4d\u200b\u3002</li> <li><code>PPN</code>: \u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff0c\u200b\u7b2c\u200b<code>10-53</code>\u200b\u4f4d\u200b\uff0c\u200b\u5171\u200b<code>44</code>\u200b\u4f4d\u200b\u3002</li> <li><code>Flags</code>\uff1a\u200b\u6807\u5fd7\u200b\u4f4d\u200b\uff0c\u200b\u7b2c\u200b<code>0-9</code>\u200b\u4f4d\u200b\uff0c\u200b\u5171\u200b<code>10</code>\u200b\u4f4d\u200b\u3002\u200b\u5176\u4e2d\u200b\u7b2c\u200b<code>8-9</code>\u200b\u4f4d\u4e3a\u200b\u4fdd\u7559\u200b\u4f4d\u200b\uff0c\u200b\u6682\u200b\u4e0d\u200b\u4f7f\u7528\u200b\u3002<ul> <li>\u200b\u7b2c\u200b<code>0</code>\u200b\u4f4d\u200b <code>Valid</code>\uff1a\u200b\u8be5\u200b\u9875\u8868\u200b\u9879\u200b\u6709\u6548\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u6765\u8bf4\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u4f4d\u7f6e\u200b\u4e3a\u200b1\u200b\u8bf4\u660e\u200b\u865a\u62df\u5730\u5740\u200b\u6709\u200b\u6620\u5c04\u200b\u5230\u200b\u7269\u7406\u5730\u5740\u200b\uff0c\u200b\u5426\u5219\u200b\u8bf4\u660e\u200b\u6ca1\u6709\u200b\u8be5\u200b\u6620\u5c04\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u6b21\u200b\u9875\u8868\u200b\u6765\u8bf4\u200b\uff0c\u200b\u4e3a\u200b1\u200b\u8bf4\u660e\u200b\u6709\u200b\u5bf9\u5e94\u200b\u7684\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u6839\u200b\u9875\u8868\u200b\u8bf4\u660e\u200b\u6709\u200b\u5bf9\u5e94\u200b\u6b21\u200b\u9875\u8868\u200b\u3002</li> <li>\u200b\u7b2c\u200b<code>1-3</code>\u200b\u4f4d\u200b <code>Readable/ Writable/ Executable</code>\uff1a \u200b\u8be5\u200b\u9875\u8868\u200b\u9879\u662f\u200b\u53ef\u8bfb\u200b/\u200b\u5199\u200b/\u200b\u6267\u884c\u200b\uff08\u200b\u4f5c\u4e3a\u200b\u4ee3\u7801\u8fd0\u884c\u200b\uff09\u200b\u7684\u200b\u3002\u200b\u901a\u5e38\u200b\u6211\u4eec\u200b\u53ea\u200b\u9700\u8981\u200b\u5173\u5fc3\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u9879\u200b\u7684\u200b\u8fd9\u200b\u4e09\u4e2a\u200b\u4f4d\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u8fd9\u200b\u4ee3\u8868\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u7684\u200b\u6807\u5fd7\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u9875\u8868\u200b\u7684\u200b\u6807\u5fd7\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u6839\u200b\u9875\u8868\u200b\u548c\u200b\u6b21\u200b\u9875\u8868\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u8fd9\u200b\u4e09\u4e2a\u200b\u4f4d\u200b\u5f80\u5f80\u200b\u7f6e\u200b\u4e3a\u200b<code>0</code>\u3002</li> <li>\u200b\u7b2c\u200b<code>4</code>\u200b\u4f4d\u200b <code>User</code>\uff1a \u200b\u8be5\u200b\u9875\u8868\u200b\u9879\u200b\u6307\u5411\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u80fd\u200b\u5728\u200b\u7528\u6237\u200b\u6001\u200b\u8bbf\u95ee\u200b\u3002\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\u7684\u200b\u4ee3\u7801\u200b\u548c\u200b\u6570\u636e\u200b\u6211\u4eec\u200b\u4e0d\u4f1a\u200b\u5c06\u200b\u5176\u200b\u7ed9\u200b\u7528\u6237\u200b\u4f7f\u7528\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4f1a\u7f6e\u200b<code>0</code>\uff0c\u200b\u4f46\u662f\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u4ee3\u7801\u200b\u548c\u200b\u6570\u636e\u200b\u5e94\u8be5\u200b\u8981\u7f6e\u200b<code>1</code>\u3002\u200b\u540c\u6837\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\u7684\u200b\u9875\u8868\u200b\u9879\u200b\uff0c\u200b\u5982\u679c\u200b\u8be5\u200b\u4f4d\u7f6e\u200b<code>1</code>\uff0c\u200b\u5219\u200b\u8ba1\u7b97\u673a\u200b\u7684\u200b\u786c\u4ef6\u200b\u4e0d\u4f1a\u200b\u5141\u8bb8\u200b\u5185\u6838\u200b\u8bbf\u95ee\u200b\u5bf9\u5e94\u200b\u5730\u5740\u200b\uff0c\u200b\u4f46\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u5176\u4ed6\u200b\u7684\u200b\u624b\u6bb5\u200b\u8bbf\u95ee\u200b\uff0c\u200b\u540e\u6587\u4f1a\u200b\u4ecb\u7ecd\u200b\u3002</li> <li>\u200b\u5176\u4ed6\u200b\u7684\u200b\u4f4d\u200b\uff0c\u200b\u611f\u5174\u8da3\u200b\u7684\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u82f1\u6587\u540d\u200b\u770b\u51fa\u200b\u5176\u200b\u610f\u4e49\u200b\uff0c\u200b\u6216\u8005\u200b\u67e5\u9605\u200briscv-privileged.pdf 4.3~4.4\u200b\u5c0f\u8282\u200b\u3002</li> </ul> </li> </ul> <p>\u200b\u6ce8\u200b\uff1a\u200b\u7406\u8bba\u8bfe\u200b\u4e0a\u200b\u6211\u4eec\u200b\u5c06\u200b\u9875\u8868\u200b\u9879\u548c\u9875\u200b\u76ee\u5f55\u200b\u9879\u200b\u52a0\u4ee5\u200b\u533a\u5206\u200b\uff0c\u200b\u4f46\u662f\u200b\u5728\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u4ed6\u4eec\u200b\u662f\u200b\u5b8c\u5168\u76f8\u540c\u200b\u7684\u200b\u7ed3\u6784\u200b\uff01</p>"},{"location":"lab4/part2/#23","title":"2.3 \u200b\u865a\u5b9e\u200b\u5730\u5740\u200b\u7ffb\u8bd1\u200b\u6d41\u7a0b","text":"<p>\u200b\u73b0\u5728\u200b\u6211\u4eec\u200b\u6765\u200b\u5c06\u200b\u5176\u200b\u4e32\u8054\u200b\u8d77\u6765\u200b\uff0c\u200b\u770b\u770b\u200b\u5bf9\u5e94\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u662f\u200b\u600e\u6837\u200b\u7ffb\u8bd1\u6210\u200b\u7269\u7406\u5730\u5740\u200b\u7684\u200b\uff1a</p> <ol> <li>\u200b\u83b7\u5f97\u200b\u4e00\u4e2a\u200b\u865a\u62df\u5730\u5740\u200b\u3002\u200b\u6839\u200b\u9875\u8868\u200b\u57fa\u200b\u5730\u5740\u200b\u5df2\u7ecf\u200b\u88ab\u200b\u88c5\u586b\u200b\u81f3\u200b\u5bc4\u5b58\u5668\u200b <code>satp</code> \u200b\u4e2d\u200b\u3002</li> <li>\u200b\u901a\u8fc7\u200b <code>satp</code> \u200b\u627e\u5230\u200b\u6839\u200b\u9875\u8868\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff0c\u200b\u8f6c\u200b\u6210\u200b\u7269\u7406\u5730\u5740\u200b\uff08<code>Offset</code>\u200b\u4e3a\u200b0\uff09\uff0c\u200b\u901a\u8fc7\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b<code>L2</code>\u200b\u7d22\u5f15\u200b\uff0c\u200b\u627e\u5230\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9875\u8868\u200b\u9879\u200b\u3002</li> <li>\u200b\u901a\u8fc7\u200b\u9875\u8868\u200b\u9879\u200b\u53ef\u4ee5\u200b\u627e\u5230\u200b\u627e\u5230\u200b \u200b\u6b21\u200b\u9875\u8868\u200b \u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff0c\u200b\u8f6c\u200b\u6210\u200b\u7269\u7406\u5730\u5740\u200b\uff08<code>Offset</code>\u200b\u4e3a\u200b0\uff09\uff0c\u200b\u901a\u8fc7\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b<code>L1</code>\u200b\u7d22\u5f15\u200b\uff0c\u200b\u627e\u5230\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9875\u8868\u200b\u9879\u200b\u3002</li> <li>\u200b\u901a\u8fc7\u200b\u9875\u8868\u200b\u9879\u200b\u53ef\u4ee5\u200b\u627e\u5230\u200b\u627e\u5230\u200b \u200b\u53f6\u5b50\u200b\u9875\u8868\u200b \u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff0c\u200b\u8f6c\u200b\u6210\u200b\u7269\u7406\u5730\u5740\u200b\uff08<code>Offset</code>\u200b\u4e3a\u200b0\uff09\uff0c\u200b\u901a\u8fc7\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b<code>L0</code>\u200b\u7d22\u5f15\u200b\uff0c\u200b\u627e\u5230\u200b\u5bf9\u5e94\u200b\u7684\u200b\u9875\u8868\u200b\u9879\u200b\u3002</li> <li>\u200b\u901a\u8fc7\u200b\u9875\u8868\u200b\u9879\u200b\u53ef\u4ee5\u200b\u627e\u5230\u200b\u627e\u5230\u200b \u200b\u7269\u7406\u5730\u5740\u200b \u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u53f7\u200b\uff0c\u200b\u901a\u8fc7\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b<code>Offset</code>\uff0c\u200b\u8f6c\u200b\u6210\u200b\u7269\u7406\u5730\u5740\u200b\uff08<code>Offset</code>\u200b\u548c\u200b\u865a\u62df\u5730\u5740\u200b<code>Offset</code>\u200b\u76f8\u540c\u200b\uff09\u3002</li> </ol>"},{"location":"lab4/part2/#3-xv6","title":"3. xv6\u200b\u4e2d\u200b\u7684\u200b\u865a\u62df\u5185\u5b58\u200b\u7ba1\u7406","text":"<p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u672c\u200b\u90e8\u5206\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u7b80\u5355\u200b\u7684\u200b\u8bf4\u660e\u200bxv6\u200b\u4e2d\u200b\u4e0e\u200b\u4e4b\u524d\u200b\u4e24\u4e2a\u200b\u90e8\u5206\u200b\u76f8\u5173\u200b\u7684\u200b\u5177\u4f53\u200b\u5b9e\u73b0\u200b\u548c\u200b\u90e8\u5206\u200b\u539f\u7406\u200b\u3002\u200b\u8fd9\u90e8\u5206\u200b\u5c06\u200b \u200b\u76f4\u63a5\u200b\u53d9\u8ff0\u200b\u4e0e\u200b\u5b9e\u9a8c\u200b\u672c\u8eab\u200b\u6709\u5173\u200b \u200b\u7684\u200b\u539f\u7406\u200b\uff0c\u200b\u5e0c\u671b\u200b\u5927\u5bb6\u200b\u80fd\u591f\u200b\u7406\u89e3\u200b\u8fd9\u4e2a\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u76ee\u7684\u200b\u548c\u200b\u8981\u6c42\u200b\u5e76\u200b\u5f62\u6210\u200b\u81ea\u5df1\u200b\u7684\u200b\u89e3\u51b3\u65b9\u6848\u200b\u3002</p>"},{"location":"lab4/part2/#31","title":"3.1 \u200b\u7528\u6237\u200b\u5185\u6838\u200b\u53cc\u200b\u9875\u8868","text":"<p>\u200b\u5728\u200bxv6\u200b\u4e2d\u200b\uff0c\u200b\u7528\u6237\u200b\u7a0b\u5e8f\u8fd0\u884c\u200b\u548c\u200b\u5185\u6838\u200b\u8fd0\u884c\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f7f\u7528\u200b\u7684\u200b\u662f\u200b\u4e0d\u540c\u200b\u7684\u200b\u9875\u8868\u200b\u3002</p> <ul> <li>\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u9875\u8868\u200b \uff1a\u200b\u4ec5\u200b\u5305\u542b\u200b\u81ea\u8eab\u200b\u7684\u200b\u4ee3\u7801\u200b\u548c\u200b\u6570\u636e\u200b\u7684\u200b\u865a\u5b9e\u200b\u5730\u5740\u6620\u5c04\u200b\uff0c\u200b\u5185\u6838\u200b\u4ee3\u7801\u200b\u548c\u200b\u6570\u636e\u200b\u4e0d\u200b\u5305\u542b\u200b\u5728\u5185\u200b\u3002</li> </ul> <p></p> <p>\u200b\u4e0a\u56fe\u200b\u662f\u200bxv6\u200b\u7684\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u865a\u62df\u5730\u5740\u200b\u7a7a\u95f4\u200b\u5206\u5e03\u200b\u3002\u200b\u5176\u200b\u4ee3\u7801\u200b\u5b9e\u73b0\u200b\u5728\u200bkernel/exec.c\u200b\u4e2d\u200b\uff0c<code>exec</code>\u200b\u4f7f\u7528\u200b<code>proc_pagetable</code>\u200b\u5206\u914d\u200b\u4e86\u200bTRAMPOLINE\u200b\u548c\u200bTRAPFRAME\u200b\u7684\u200b\u9875\u8868\u200b\u6620\u5c04\u200b\uff0c\u200b\u7136\u540e\u200b\u7528\u200b<code>uvmalloc</code>\u200b\u6765\u200b\u4e3a\u200b\u6bcf\u4e2a\u200bELF\u200b\u6bb5\u200b\u5206\u914d\u5185\u5b58\u200b\u53ca\u200b\u9875\u8868\u200b\u6620\u5c04\u200b\uff0c\u200b\u5e76\u7528\u200b<code>loadseg</code>\u200b\u628a\u200b\u6bcf\u4e2a\u200bELF\u200b\u6bb5\u200b\u8f7d\u5165\u200b\u5185\u5b58\u200b\u3002</p> <p>\u200b\u5f53\u200b\u8fdb\u7a0b\u200b\u7533\u8bf7\u200b\u66f4\u200b\u591a\u200b\u5185\u5b58\u200b\u7684\u200b\u65f6\u5019\u200b\uff0cxv6\u200b\u9996\u5148\u200b\u7528\u200b<code>kalloc</code>\u200b\u5206\u914d\u200b\u4e00\u4e2a\u200b\u7269\u7406\u200b\u9875\u200b\u3002\u200b\u7136\u540e\u200b\u8c03\u7528\u200bmappages\u200b\u51fd\u6570\u200b\u628a\u200b\u8fd9\u4e2a\u200b\u7269\u7406\u200b\u9875\u200b\u7684\u200bPTE\u200b\u52a0\u200b\u5230\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u9875\u8868\u200b\u91cc\u200b\u3002xv6\u200b\u4f1a\u200b\u8bbe\u7f6e\u200b\u8be5\u200bPTE\u200b\u5bf9\u5e94\u200b\u7684\u200b\u6807\u5fd7\u200b\u4f4d\u200b(W,X,R,U,V)\u3002</p> <p>\u200b\u62d3\u5c55\u200b\u9605\u8bfb\u200b\uff1a\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u865a\u62df\u5730\u5740\u200b\u7a7a\u95f4\u200b\u5206\u5e03\u200b</p> <ul> <li>trampoline\uff1a\u200b\u7528\u6237\u200b\u6001\u200b-\u200b\u5185\u6838\u200b\u6001\u200b\u8df3\u677f\u200b\u3002</li> <li>trapframe\uff1a\u200b\u7528\u6765\u200b\u5b58\u653e\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7528\u6237\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u5185\u5b58\u7a7a\u95f4\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u60f3\u200b\u67e5\u770b\u200bxv6\u200b\u5728\u200btrapframe page\u200b\u4e2d\u200b\u5b58\u653e\u200b\u4e86\u200b\u4ec0\u4e48\u200b\uff0c\u200b\u8be6\u89c1\u200bproc.h\u200b\u7684\u200btrapframe\u200b\u7ed3\u6784\u200b\u4f53\u200b\u3002</li> <li>heap\uff1a\u200b\u5806\u200b\u3002\u200b\u7a0b\u5e8f\u200b\u521d\u59cb\u5316\u200b\u65f6\u5806\u200b\u6ca1\u6709\u200b\u5206\u914d\u200b\u4efb\u4f55\u200b\u7a7a\u95f4\u200b\u3002\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200bsbrk\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u8c03\u6574\u200b\u5806\u200b\u5206\u914d\u200b\u7684\u200b\u7a7a\u95f4\u200b\uff0c\u200b\u8fd9\u4f1a\u200b\u628a\u200b\u65b0\u200b\u5185\u5b58\u200b\u6620\u5c04\u200b\u5230\u200b\u9875\u8868\u200b\u4e2d\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u9875\u8868\u200b\u4e2d\u200b\u79fb\u9664\u200b\u6620\u5c04\u200b\uff0c\u200b\u91ca\u653e\u200b\u5185\u5b58\u200b\u3002</li> <li>stack\uff1a\u200b\u7528\u6237\u200b\u6808\u200b\u3002xv6\u200b\u7684\u200b\u7528\u6237\u200b\u6808\u200b\u53ea\u200b\u5206\u914d\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u9875\u200b\uff08PAGESIZE\uff09\uff0c\u200b\u653e\u7f6e\u200b\u5728\u200b\u6bd4\u5806\u200b\u66f4\u200b\u4f4e\u200b\u7684\u200b\u4f4d\u7f6e\u200b\u3002\u200b\u901a\u5e38\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4f1a\u200b\u628a\u200b\u7528\u6237\u200b\u6808\u200b\u653e\u7f6e\u200b\u5728\u200b\u6bd4\u5806\u200b\u66f4\u200b\u9ad8\u200b\u7684\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u8fd9\u200b\u4e5f\u200b\u662f\u200bxv6\u200b\u548c\u200b\u5e38\u89c1\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u505a\u6cd5\u200b\u4e0d\u200b\u4e00\u6837\u200b\u7684\u200b\u5730\u65b9\u200b\u3002</li> <li>guard page\uff1a\u200b\u5b88\u62a4\u200b\u9875\u200b\uff0c\u200b\u7528\u6765\u200b\u4fdd\u62a4\u200bStack\u3002\u200b\u5982\u679c\u200bstack\u200b\u8017\u5c3d\u200b\u4e86\u200b\uff0c\u200b\u5b83\u4f1a\u200b\u6ea2\u51fa\u200b\u5230\u200bGuard page\uff0c\u200b\u4f46\u662f\u200b\u56e0\u4e3a\u200bGuard page\u200b\u7684\u200bPTE\u200b\u4e2d\u200bValid\u200b\u6807\u5fd7\u200b\u4f4d\u672a\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u7acb\u5373\u200b\u89e6\u53d1\u200bpage fault\uff0c\u200b\u8fd9\u6837\u200b\u7684\u200b\u7ed3\u679c\u200b\u597d\u8fc7\u200b\u5185\u5b58\u200b\u8d8a\u754c\u200b\u4e4b\u540e\u200b\u9020\u6210\u200b\u7684\u200b\u6570\u636e\u200b\u6df7\u4e71\u200b\u3002</li> <li>data\uff1a\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u6570\u636e\u200b\u6bb5\u200b\u3002</li> <li>text\uff1a\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u4ee3\u7801\u6bb5\u200b\u3002</li> </ul> <ul> <li>\u200b\u5185\u6838\u200b\u9875\u8868\u200b \uff1a\u200b\u4ec5\u200b\u5305\u542b\u200b\u5185\u6838\u200b\u7684\u200b\u4ee3\u7801\u200b\u548c\u200b\u6570\u636e\u200b\u7684\u200b\u865a\u5b9e\u200b\u5730\u5740\u6620\u5c04\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u4ee3\u7801\u200b\u548c\u200b\u6570\u636e\u200b\u4e0d\u200b\u5305\u542b\u200b\u5728\u5185\u200b\u3002</li> </ul> <p></p> <p>\u200b\u5176\u200b\u4ee3\u7801\u200b\u5b9e\u73b0\u200b\u5728\u200bkernel/vm.c\u200b\u7684\u200bkvminit()\u200b\u51fd\u6570\u200b\u3002\u200b\u5728\u200bkvminit()\u200b\u51fd\u6570\u200b\u5185\u200b\uff0c\u200b\u5b8c\u6210\u200b\u4e86\u200bUART0\u3001VIRTIO0\u3001CLINT\u3001PLIC\u3001kernel text\u3001kernel data\u200b\u548c\u200bTRAMPOLINE\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u548c\u200b\u7269\u7406\u5730\u5740\u200b\u7684\u200b\u6620\u5c04\u200b\u3002</p> <pre><code>/*\n * create a direct-map page table for the kernel.\n */\nvoid\nkvminit()\n{\nkernel_pagetable = (pagetable_t) kalloc();\nmemset(kernel_pagetable, 0, PGSIZE);\n\n// uart registers\nkvmmap(UART0, UART0, PGSIZE, PTE_R | PTE_W);\n\n// virtio mmio disk interface\nkvmmap(VIRTIO0, VIRTIO0, PGSIZE, PTE_R | PTE_W);\n\n// CLINT\nkvmmap(CLINT, CLINT, 0x10000, PTE_R | PTE_W);\n\n// PLIC\nkvmmap(PLIC, PLIC, 0x400000, PTE_R | PTE_W);\n\n// map kernel text executable and read-only.\nkvmmap(KERNBASE, KERNBASE, (uint64)etext-KERNBASE, PTE_R | PTE_X);\n\n// map kernel data and the physical RAM we'll make use of.\nkvmmap((uint64)etext, (uint64)etext, PHYSTOP-(uint64)etext, PTE_R | PTE_W);\n\n// map the trampoline for trap entry/exit to\n// the highest virtual address in the kernel.\nkvmmap(TRAMPOLINE, (uint64)trampoline, PGSIZE, PTE_R | PTE_X);\n}\n</code></pre> <p>\u200b\u62d3\u5c55\u200b\u9605\u8bfb\u200b\uff1a\u200b\u5185\u6838\u200b\u865a\u62df\u5730\u5740\u200b\u7a7a\u95f4\u200b-\u200b\u7269\u7406\u5730\u5740\u200b\u7a7a\u95f4\u200b\u5206\u5e03\u200b</p> <p>\u200b\u53c8\u200b\u89c1\u5230\u200b\u56fe\u200bFigure3.3\u200b\u4e86\u200b: ) \u200b\u6211\u4eec\u200b\u5728\u200bLab3\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u90e8\u5206\u200b\u5df2\u7ecf\u200b\u4ecb\u7ecd\u200b\u8fc7\u200b\u4e86\u200b\u3002</p> <p>kernel/memlayout.h\u200b\u63cf\u8ff0\u200b\u4e86\u200b\u5185\u6838\u200b\u5185\u5b58\u200b\u7684\u200b\u5e03\u5c40\u200b\u3002</p> <p>QEMU\u200b\u6a21\u62df\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5305\u542b\u200bI/O\u200b\u8bbe\u5907\u200b\u7684\u200b\u8ba1\u7b97\u673a\u200b\u3002\u200b\u8bbe\u5907\u200b\u7684\u200b\u63a7\u5236\u200b\u5bc4\u5b58\u5668\u200b\u88ab\u200b\u6620\u5c04\u200b\u5230\u200b\u7269\u7406\u200b\u5185\u5b58\u200b0x0~0x80000000\u200b\u4e4b\u95f4\u200b\uff0c\u200b\u5185\u6838\u200b\u901a\u8fc7\u200b\u8bfb\u5199\u200b\u8fd9\u4e9b\u200b\u5185\u5b58\u5730\u5740\u200b\u4e8e\u200b\u8bbe\u5907\u200b\u8fdb\u884c\u200b\u4ea4\u4e92\u200b\u3002</p> <p>xv6\u200b\u5185\u6838\u200b\u7684\u200b\u5927\u90e8\u5206\u200b\u865a\u5b9e\u200b\u5730\u5740\u6620\u5c04\u200b\u662f\u200b\u6052\u7b49\u200b\u6620\u5c04\u200b\uff0c\u200b\u865a\u62df\u5730\u5740\u200b\u548c\u200b\u7269\u7406\u5730\u5740\u200b\u662f\u200b\u4e00\u6a21\u4e00\u6837\u200b\u7684\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u65e2\u200b\u8981\u200b\u8bfb\u5199\u200b\u865a\u62df\u200b\u9875\u200b\u53c8\u200b\u8981\u200b\u901a\u8fc7\u200bPTE\u200b\u7ba1\u7406\u200b\u7269\u7406\u200b\u9875\u200b\u7684\u200bxv6\u200b\u5185\u6838\u200b\u6765\u8bf4\u200b\uff0c\u200b\u8fd9\u6837\u200b\u7684\u200b\u76f4\u63a5\u200b\u6620\u5c04\u200b\u964d\u4f4e\u200b\u4e86\u200b\u590d\u6742\u6027\u200b\u3002</p> <p>\u200b\u4ece\u200bFigure3.3\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\uff0c\u200b\u6709\u200b\u4e24\u5904\u200b\u865a\u62df\u5730\u5740\u200b\u4e0d\u662f\u200b\u76f4\u63a5\u200b\u6620\u5c04\u200b\u7684\u200b\uff1a </p> <ul> <li>trampoline\u200b\u9875\u200b\uff1a\u200b\u5b83\u200b\u662f\u200b\u7528\u6237\u200b\u6001\u200b-\u200b\u5185\u6838\u200b\u6001\u200b\u8df3\u677f\u200b\uff0c\u200b\u65e2\u200b\u88ab\u200b\u6620\u5c04\u200b\u5230\u200b\u5185\u6838\u200b\u865a\u62df\u7a7a\u95f4\u200b\u7684\u200b\u9876\u7aef\u200b\uff0c\u200b\u9875\u200b\u88ab\u200b\u6620\u5c04\u200b\u5230\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u540c\u6837\u200b\u4f4d\u7f6e\u200b\u3002</li> <li>\u200b\u5185\u6838\u200b\u6808\u200b\uff1a\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u90fd\u200b\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u5185\u6838\u200b\u6808\u200b\uff0c\u200b\u5b83\u200b\u88ab\u200b\u6620\u5c04\u200b\u5230\u200b\u9ad8\u4f4d\u200b\uff0c\u200b\u8fd9\u6837\u200b\u5728\u200b\u5b83\u200b\u4e0b\u9762\u200b\u53ef\u4ee5\u200b\u4fdd\u7559\u200b\u4e00\u4e2a\u200b\u672a\u200b\u6620\u5c04\u200b\u7684\u200b\u5b88\u62a4\u200b\u9875\u200b\u3002</li> </ul> <p>\u200b\u5bf9\u6b64\u200bFigure3.3\u200b\u548c\u200bFigure3.4\uff0c\u200b\u53ef\u4ee5\u200b\u53d1\u73b0\u200b\uff0c\u200b\u7528\u6237\u200b\u865a\u62df\u5730\u5740\u200b\u7a7a\u95f4\u200b\u4e0e\u200b\u5185\u6838\u200b\u865a\u62df\u5730\u5740\u200b\u7a7a\u95f4\u200b\u7684\u200b\u8303\u56f4\u200b\u4e00\u6837\u200b\uff0c\u200b\u90fd\u200b\u662f\u4ece\u200b0\u200b\u5230\u200bMAXVA\uff08MAXVA\u200b\u7684\u200b\u5b9a\u4e49\u200b\u89c1\u200bkernel/riscv.h\uff0c\u200b\u5171\u8ba1\u200b256G\u200b\u7684\u200b\u5185\u5b58\u200b\uff082<sup>38</sup>\uff09\uff09\u3002\u200b\u8fd9\u6837\u200b\uff0c\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u56e0\u200b\u4e0d\u200b\u5305\u542b\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u7528\u6237\u200b\u5730\u5740\u200b\u5728\u200b\u5185\u6838\u200b\u4e2d\u200b\u65e0\u200b\u8bbf\u95ee\u200b\uff0c\u200b\u540c\u7406\u200b\u7528\u6237\u200b\u65e0\u6cd5\u8bbf\u95ee\u200b\u5185\u6838\u200b\u7684\u200b\u6570\u636e\u200b\u3002</p> <pre><code>// one beyond the highest possible virtual address.\n// MAXVA is actually one bit less than the max allowed by\n// Sv39, to avoid having to sign-extend virtual addresses\n// that have the high bit set.\n#define MAXVA (1L &lt;&lt; (9 + 9 + 9 + 12 - 1))\n</code></pre>"},{"location":"lab4/part2/#32","title":"3.2 \u200b\u7528\u6237\u200b\u5185\u6838\u200b\u53cc\u200b\u9875\u8868\u200b\u7684\u200b\u5207\u6362","text":"<p>\u200b\u5f53\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u9700\u8981\u200b\u8fdb\u5165\u200b\u5185\u6838\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u9700\u8981\u200b\u5207\u6362\u200b\u76f8\u5e94\u200b\u7684\u200b\u9875\u8868\u200b\uff0c\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u3002\u200b\u5185\u6838\u200b\u5207\u6362\u200b\u5230\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4e5f\u200b\u540c\u6837\u200b\u9700\u8981\u200b\u5207\u6362\u200b\u4e3a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u3002</p> <p>\u200b\u4f46\u662f\u200b\uff0cxv6\u200b\u4f7f\u7528\u200b\u4e86\u200b\u5171\u4eab\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u6240\u6709\u200b\u8fdb\u7a0b\u200b\u4f7f\u7528\u200b\u4e00\u4e2a\u200b\u9875\u8868\u200b\uff0c\u200b\u8fd9\u200b\u5c31\u200b\u610f\u5473\u7740\u200b\u5185\u6838\u200b\u8fdb\u884c\u200b \u200b\u8fdb\u7a0b\u200b\u95f4\u200b\u8c03\u5ea6\u200b \u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4e0d\u200b\u9700\u8981\u200b\u5207\u6362\u200b\u9875\u8868\u200b\u3002\u200b\u4f46\u662f\u200b\u5982\u679c\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u53d8\u6210\u200b\u72ec\u7acb\u200b\u9875\u8868\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5728\u200b\u8fdb\u7a0b\u200b\u8c03\u5ea6\u200b\uff0c\u200b\u5207\u6362\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u5c31\u200b\u9700\u8981\u200b \u200b\u5728\u200b\u9002\u5f53\u200b\u7684\u200b\u65f6\u5019\u200b\u5207\u6362\u200b\u5185\u6838\u200b\u9875\u8868\u200b \u3002</p> <p>\u200b\u4e0a\u6587\u200b\u5df2\u7ecf\u200b\u63d0\u53ca\u200b\uff0c\u200b\u4f7f\u7528\u200b\u67d0\u4e2a\u200b\u9875\u8868\u200b\u65f6\u200b\uff0c\u200b\u9875\u8868\u200b\u6240\u5728\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u5e94\u200b\u5b58\u653e\u200b\u5728\u200b<code>satp</code>\u200b\u5bc4\u5b58\u5668\u200b\u4e2d\u200b\u3002\u200b\u9875\u8868\u200b\u672a\u200b\u4f7f\u7528\u200b\u65f6\u200b\uff0c\u200b\u9875\u8868\u200b\u6240\u5728\u200b\u5730\u5740\u200b\u4e5f\u200b\u9700\u8981\u200b\u4e00\u4e2a\u200b\u4f4d\u7f6e\u200b\u4fdd\u5b58\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u800c\u8a00\u200b\uff0c\u200b\u5b83\u200b\u88ab\u200b\u4fdd\u5b58\u200b\u5728\u200b<code>struct proc</code>\u200b\u4e2d\u200b\u7684\u200b<code>pagetable_t pagetable</code>\uff1b\u200b\u5bf9\u4e8e\u200b\u5185\u6838\u200b\u800c\u8a00\u200b\uff0cxv6\u200b\u4f7f\u7528\u200b\u4e00\u4e2a\u200b\u5168\u5c40\u53d8\u91cf\u200b\u4fdd\u5b58\u200b\uff08<code>kernel/vm.c</code>\u200b\u7684\u200b<code>kernel_pagetable</code>\uff09\u3002\u200b\u4e3a\u200b\u8fdb\u7a0b\u200b\u5f15\u5165\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u540e\u200b\uff0c\u200b\u4e5f\u200b\u9700\u8981\u200b\u5b58\u50a8\u200b\u5176\u200b\u6240\u5728\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u3002</p>"},{"location":"lab4/part2/#33","title":"3.3 \u200b\u5185\u6838\u200b\u5bf9\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u8bbf\u95ee","text":"<p>\u200b\u901a\u5e38\u200b\uff0c\u200b\u8fdb\u884c\u200b\u5730\u5740\u200b\u7ffb\u8bd1\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u8ba1\u7b97\u673a\u786c\u4ef6\u200b\uff08\u200b\u5373\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u5355\u5143\u200bMMU\uff09\u200b\u90fd\u200b\u4f1a\u200b\u81ea\u52a8\u200b\u7684\u200b\u67e5\u627e\u200b\u5bf9\u5e94\u200b\u7684\u200b\u6620\u5c04\u200b\u8fdb\u884c\u200b\u7ffb\u8bd1\u200b\u3002</p> <p>\u200b\u62d3\u5c55\u200b\u9605\u8bfb\u200b\uff1aTLB\u200b\u9875\u8868\u200b\u7f13\u5b58\u200b</p> <p>\u200b\u56de\u60f3\u200b\u4e00\u4e0b\u200b\u4e0a\u8ff0\u200bpage table\u200b\u7684\u200b\u7ed3\u6784\u200b\uff0c\u200b\u5f53\u200b\u5904\u7406\u5668\u200b\u4ece\u200b\u5185\u5b58\u200b\u52a0\u8f7d\u200b\u6216\u200b\u5b58\u50a8\u200b\u6570\u636e\u200b\u65f6\u200b\uff0c\u200b\u9700\u8981\u200b\u505a\u200b3\u200b\u6b21\u200b\u5185\u5b58\u200b\u67e5\u627e\u200b\uff0c\u200b\u7b2c\u4e00\u6b21\u200b\u5728\u200b\u6700\u9ad8\u7ea7\u200b\u7684\u200b\u6839\u200b\u9875\u8868\u200b\uff0c\u200b\u7b2c\u4e8c\u6b21\u200b\u5728\u200b\u4e2d\u95f4\u7ea7\u200b\u7684\u200b\u6b21\u200b\u9875\u8868\u200b\uff0c\u200b\u6700\u540e\u200b\u4e00\u6b21\u200b\u5728\u200b\u6700\u200b\u4f4e\u7ea7\u200b\u7684\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u4e00\u4e2a\u200b\u865a\u62df\u5185\u5b58\u200b\u5730\u5740\u200b\u7684\u200b\u5bfb\u5740\u200b\uff0c\u200b\u9700\u8981\u200b\u8bfb\u200b\u4e09\u6b21\u200b\u5185\u5b58\u200b\uff0c\u200b\u4ee3\u4ef7\u200b\u786e\u5b9e\u200b\u6709\u70b9\u200b\u9ad8\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5728\u200b\u5b9e\u9645\u200b\u7684\u200b\u5904\u7406\u5668\u200b\u4e2d\u200b\uff0c\u200b\u57fa\u672c\u200b\u4f1a\u200b\u4f7f\u7528\u200bTLB\u200b\u9875\u8868\u200b\u7f13\u5b58\u200b\u6765\u200b\u7f13\u5b58\u200b\u6700\u8fd1\u200b\u4f7f\u7528\u200b\u8fc7\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200b\u7ffb\u8bd1\u200b\u7ed3\u679c\u200b\u3002</p> <p>TLB\u200b\u662f\u200b\u7531\u200b\u786c\u4ef6\u200b\u5b9e\u73b0\u200b\u7684\u200b\uff0c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e0d\u200b\u9700\u8981\u200b\u77e5\u9053\u200bTLB\u200b\u662f\u200b\u5982\u4f55\u200b\u5de5\u4f5c\u200b\u7684\u200b\u3002\u200b\u4f46\u662f\u200b\uff0c\u200b\u5982\u679c\u200b\u5207\u6362\u200b\u4e86\u200bpage table\uff0cTLB\u200b\u4e2d\u200b\u7684\u200b\u7f13\u5b58\u200b\u5c06\u200b\u4e0d\u518d\u200b\u6709\u7528\u200b\uff0c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u9700\u8981\u200b\u544a\u8bc9\u200b\u5904\u7406\u5668\u200b\u5f53\u524d\u200b\u6b63\u5728\u200b\u5207\u6362\u200bpage table\uff0c\u200b\u5904\u7406\u5668\u200b\u4f1a\u200b\u53bb\u200b\u6e05\u7a7a\u200bTLB\u3002\u200b\u5728\u200bRISC-V\u200b\u4e2d\u200b\uff0c\u200b\u6e05\u7a7a\u200bTLB\u200b\u7684\u200b\u6307\u4ee4\u200b\u662f\u200bsfence_vma\u3002</p> <p>\u200b\u7136\u800c\u200b\uff0c\u200b\u5728\u200bxv6\u200b\u5185\u6838\u200b\u9700\u8981\u200b\u7ffb\u8bd1\u200b\u7528\u6237\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u65f6\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e0d\u200b\u542b\u200b\u5bf9\u5e94\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u8ba1\u7b97\u673a\u786c\u4ef6\u200b\u4e0d\u80fd\u200b\u81ea\u52a8\u200b\u5e2e\u52a9\u200b\u5b8c\u6210\u200b\u8fd9\u4ef6\u200b\u4e8b\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5148\u200b\u627e\u5230\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u7684\u200b\u9875\u8868\u200b\uff0c\u200b\u4eff\u7167\u200b\u786c\u4ef6\u200b\u7ffb\u8bd1\u200b\u7684\u200b\u6d41\u7a0b\u200b\uff0c\u200b\u4e00\u6b65\u200b\u4e00\u6b65\u200b\u7684\u200b\u627e\u5230\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\uff0c\u200b\u518d\u200b\u5bf9\u200b\u5176\u200b\u8fdb\u884c\u200b\u8bbf\u95ee\u200b\u3002</p> <p>\u200b\u4e3e\u4e2a\u200b\u6817\u5b50\u200b\uff1aLab2\u200b\u7528\u5230\u200b\u7684\u200bcopyout()\u200b\u51fd\u6570\u200b</p> <p>\u200b\u5982\u200b3.1 \u200b\u7528\u6237\u200b\u5185\u6838\u200b\u53cc\u200b\u9875\u8868\u200b\u4e2d\u200b\u6240\u8ff0\u200b\uff0c\u200b\u5185\u6838\u200b\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u9875\u8868\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u4e5f\u200b\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u9875\u8868\u200b\u3002\u200b\u5728\u200bLab2\u200b\u7684\u200b\u4efb\u52a1\u200b\u4e8c\u4e2d\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u6307\u5411\u200bsys_info\u200b\u7ed3\u6784\u200b\u4f53\u200b\u7684\u200b\u6307\u9488\u200b\u5b58\u5728\u200b\u4e8e\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u9875\u8868\u200b\u4e2d\u200b\uff0c\u200b\u5185\u6838\u200b\u9700\u8981\u200b\u5c06\u200b\u8fd9\u4e2a\u200b\u6307\u9488\u200b\u7ffb\u8bd1\u6210\u200b\u4e00\u4e2a\u200b\u81ea\u5df1\u200b\u53ef\u4ee5\u200b\u8bfb\u5199\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\uff0c\u200b\u624d\u80fd\u200b\u53bb\u200b\u8bbf\u95ee\u200bsys_info\u200b\u7ed3\u6784\u200b\u4f53\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u611f\u5174\u8da3\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u67e5\u770b\u200bcopyout()\u200b\u51fd\u6570\u200b\u662f\u200b\u5982\u4f55\u200b\u8fdb\u884c\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u7684\u200b\u3002</p> <p>\u200b\u5f53\u200b\u6211\u4eec\u200b\u5728\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\u62e5\u6709\u200b\u4e86\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u6620\u5c04\u200b\u540e\u200b\uff0c\u200b\u5185\u6838\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u8bbf\u95ee\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u3002\u200b\u6bd4\u5982\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u89e3\u200b\u5f15\u7528\u200b\u7528\u6237\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\u4e2d\u200b\u7684\u200b\u6307\u9488\u200b\uff0c\u200b\u5c31\u200b\u80fd\u200b\u83b7\u53d6\u200b\u5230\u200b\u5bf9\u5e94\u200b\u5730\u5740\u200b\u7684\u200b\u6570\u636e\u200b\u3002\u200b\u5f88\u591a\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u6216\u8005\u200b\u5185\u6838\u200b\u7684\u200b\u4e00\u4e9b\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u90fd\u200b\u9700\u8981\u200b\u8fdb\u884c\u200b\u865a\u5b9e\u200b\u5730\u5740\u200b\u7ffb\u8bd1\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u5728\u200b\u62e5\u6709\u200b\u4e86\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5730\u5740\u6620\u5c04\u200b\u540e\u200b\uff0c\u200b\u539f\u6709\u200b\u9ebb\u70e6\u200b\u7684\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u88ab\u200b\u53bb\u9664\u200b\uff0c\u200b\u5f88\u591a\u200b\u64cd\u4f5c\u200b\u90fd\u200b\u53ef\u4ee5\u200b\u88ab\u200b\u7b80\u5316\u200b\uff0c\u200b\u6027\u80fd\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5f97\u5230\u200b\u63d0\u5347\u200b\u3002</p> <p>\u200b\u4f46\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b \uff0c\u200b\u5982\u679c\u200b\u76f4\u63a5\u200b\u628a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u5185\u5bb9\u200b\u590d\u5236\u5230\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u5373\u200b\u5176\u4e2d\u200b\u9875\u8868\u200b\u9879\u200b\u7684\u200bUser\u200b\u4f4d\u7f6e\u200b1\uff0c\u200b\u90a3\u4e48\u200b\u5185\u6838\u200b\u4f9d\u65e7\u200b\u65e0\u6cd5\u200b\u76f4\u63a5\u200b\u8bbf\u95ee\u200b\u5bf9\u5e94\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\uff08\u200b\u786c\u4ef6\u200b\u4f1a\u200b\u62d2\u7edd\u200b\u5730\u5740\u200b\u7ffb\u8bd1\u200b\uff0c\u200b\u4f46\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7ffb\u8bd1\u200b\u4f9d\u65e7\u200b\u53ef\u884c\u200b\uff09\u3002\u200b\u53ef\u4f9b\u53c2\u8003\u200b\u7684\u200b\u89e3\u51b3\u65b9\u6848\u200b\u6709\u200b\u4e24\u79cd\u200b\uff1a</p> <ul> <li>\uff081\uff09\u200b\u628a\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\u9875\u8868\u200b\u9879\u200b\u7684\u200bUser\u200b\u4f4d\u5747\u200b\u7f6e\u200b\u4e3a\u200b0\uff1b</li> <li>\uff082\uff09\u200b\u501f\u52a9\u200bRISC-V\u200b\u7684\u200b<code>sstatus</code>\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u5982\u679c\u200b\u8be5\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200bSUM\u200b\u4f4d\u200b\uff08\u200b\u7b2c\u200b18\u200b\u4f4d\u200b\uff09\u200b\u7f6e\u200b\u4e3a\u200b1\uff0c\u200b\u90a3\u4e48\u200b\u5185\u6838\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u8bbf\u95ee\u200b\u4e0a\u8ff0\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u3002\u200b\u5927\u591a\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u8be5\u200b\u4f4d\u200b\u9700\u8981\u200b\u7f6e\u200b0\u3002\uff08\u200b\u8bbf\u95ee\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200b\u51fd\u6570\u200b\u5b9a\u4e49\u200b\u4e8e\u200briscv.h\uff09\u200b\u5173\u4e8e\u200b<code>sstatus</code>\u200b\u5bc4\u5b58\u5668\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u67e5\u9605\u200briscv-privileged.pdf 4.1\u200b\u5c0f\u8282\u200b\u3002</li> </ul> <p></p>"},{"location":"lab4/part2/#34","title":"3.4 \u200b\u5185\u6838\u200b\u6808","text":"<p>\u200b\u8fdb\u7a0b\u200b\u8fdb\u5165\u200b\u5185\u6838\u200b\u540e\u200b\uff0c\u200b\u9700\u8981\u200b\u4e00\u4e2a\u200b\u4e13\u5c5e\u200b\u7684\u200b\u6808\u200b\u4ee5\u200b\u7ef4\u6301\u200b\u8fd0\u884c\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u6808\u200b\u5c31\u200b\u88ab\u200b\u79f0\u4e3a\u200b\u5185\u6838\u200b\u6808\u200b\u3002\u200b\u56e0\u4e3a\u200b\u4e0d\u540c\u200b\u8fdb\u7a0b\u200b\u5728\u200b\u5185\u6838\u200b\u4e2d\u200b\u8fd0\u884c\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0d\u200b\u4e00\u6837\u200b\uff0c\u200b\u6240\u4ee5\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u90fd\u200b\u5e94\u5f53\u200b\u62e5\u6709\u200b\u4e00\u4e2a\u200b\u5185\u6838\u200b\u6808\u200b\u3002</p> <p>\u200b\u5982\u200b3.1\u200b\u5c0f\u8282\u200b \u200b\u5185\u6838\u200b\u9875\u8868\u200b\u6240\u793a\u200b\uff0c\u200b\u5728\u200bkvminit()\u200b\u51fd\u6570\u200b\u4e2d\u200b\uff0c\u200b\u9664\u4e86\u200b\u5185\u6838\u200b\u6808\u200b\u4e4b\u5916\u200b\uff0c\u200b\u5176\u4ed6\u200b\u90e8\u4ef6\u200b\u90fd\u200b\u6620\u5c04\u200b\u5b8c\u6210\u200b\u3002\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u9875\u8868\u200b\u6620\u5c04\u200b\u662f\u200b\u5728\u200b<code>kernel/proc.c</code>\u200b\u7684\u200b <code>procinit()</code>\u200b\u4e2d\u200b\u5b9e\u73b0\u200b\uff1a</p> <pre><code>/*in kernel/proc.c procinit()*/\nfor(p = proc; p &lt; &amp;proc[NPROC]; p++) {\n...\nchar *pa = kalloc();  // \u200b\u5206\u914d\u200b\u4e00\u4e2a\u200b\u7269\u7406\u200b\u9875\u200b\uff0c\u200b\u8fd4\u56de\u200b\u5176\u9996\u200b\u5730\u5740\u200b\nif(pa == 0)           panic(\"kalloc\");\nuint64 va = KSTACK((int) (p - proc));  // \u200b\u8ba1\u7b97\u200b\u5185\u6838\u200b\u6808\u200b\u6240\u5728\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\nkvmmap(va, (uint64)pa, PGSIZE, PTE_R | PTE_W);     // \u200b\u5728\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u5efa\u7acb\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u6620\u5c04\u200b\np-&gt;kstack = va;       // \u200b\u5c06\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u5b58\u50a8\u200b\u4e8e\u200b\u8fdb\u7a0b\u200b\u63a7\u5236\u200b\u5757\u200b\n}\n</code></pre> <p><code>procinit()</code>\u200b\u5728\u200b\u7cfb\u7edf\u200b\u7684\u200b\u542f\u52a8\u200b\u9636\u6bb5\u200b\u6267\u884c\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5176\u4e3a\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\uff08\u200b\u603b\u5171\u200b\u652f\u6301\u200bNPROC\u200b\u4e2a\u200b\u8fdb\u7a0b\u200b\uff09\u200b\u90fd\u200b\u5206\u914d\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5185\u6838\u200b\u6808\u200b\u3002\u200b\u5728\u200bxv6\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u4e2d\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u662f\u200b\u56fa\u5b9a\u200b\u7684\u200b\uff0c\u200b\u56e0\u6b64\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u8ba1\u7b97\u200b\u3002</p>"},{"location":"lab4/part2/#35","title":"3.5 \u200b\u7528\u6237\u200b\u9875\u8868\u200b\u548c\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u5408\u5e76\u200b\u7684\u200b\u4e00\u4e2a\u200b\u91cd\u8981\u200b\u524d\u63d0\u200b\uff1a\u200b\u5730\u5740\u200b\u4e0d\u200b\u91cd\u5408","text":"<p>\u200b\u5176\u5b9e\u200b\uff0c\u200b\u8981\u200b\u60f3\u200b\u5728\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\uff0c\u200b\u540c\u65f6\u200b\u5305\u542b\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u548c\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u662f\u200b\u6709\u200b\u8bb2\u7a76\u200b\u7684\u200b\u3002\u200b\u5176\u4e2d\u200b\u4e00\u4e2a\u200b\u91cd\u8981\u200b\u7684\u200b\u524d\u63d0\u200b\u8981\u6c42\u200b\u662f\u200b\uff1a\u200b\u7528\u6237\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u548c\u200b\u5185\u6838\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u4e0d\u80fd\u200b\u91cd\u53e0\u200b\u3002</p> <p>\u200b\u8fd8\u597d\u200b\uff0c\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u4ece\u200b0\u200b\u5f00\u59cb\u200b\uff0c\u200b\u5185\u6838\u200b\u5219\u200b\u4ece\u200b\u4e00\u4e2a\u200b\u5f88\u200b\u9ad8\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\uff080xC000000\uff09\u200b\u5f00\u59cb\u200b\u6392\u5e03\u200b\u3002\u200b\u4f46\u662f\u200b\u4ed6\u4eec\u200b\u8fd8\u662f\u200b\u6709\u200b\u53ef\u80fd\u200b\u53d1\u751f\u200b\u91cd\u53e0\u200b\u3002\u200b\u6240\u4ee5\u200b\uff0c\u200b\u4f60\u200b\u4e00\u5b9a\u200b\u8981\u200b\u9650\u5236\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u865a\u62df\u5730\u5740\u200b\u4e0e\u200b\u5185\u6838\u200b\u5730\u5740\u200b\u91cd\u53e0\u200b\u3002</p> <p>\u200b\u5185\u6838\u200b\u5730\u5740\u200b0xC000000\uff0c\u200b\u4e3a\u200bPLIC\u200b\u5bc4\u5b58\u5668\u200b\u5730\u5740\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200b <code>kernel/memlayout.h + kernel/vm.c</code> \u200b\u4e2d\u200b <code>kvminit()</code> \u200b\u8fdb\u884c\u200b\u67e5\u9605\u200b\u3002\u200b\u4ed4\u7ec6\u9605\u8bfb\u200b <code>kvminit()</code> \uff0c\u200b\u4f60\u200b\u4f1a\u200b\u53d1\u73b0\u200b\u5176\u200b\u5bf9\u200b\u5982\u4e0b\u200b\u5730\u5740\u200b\u8303\u56f4\u200b\u8fdb\u884c\u200b\u4e86\u200b\u6620\u5c04\u200b\uff1a</p> <pre><code>  // CLINT\nkvmmap(CLINT, CLINT, 0x10000, PTE_R | PTE_W);\n\n// PLIC\nkvmmap(PLIC, PLIC, 0x400000, PTE_R | PTE_W);\n</code></pre> <p>\u200b\u90a3\u4e48\u200b\u4e3a\u4f55\u200b\u8bf4\u200b0xC000000\u200b\u662f\u200b\u5185\u6838\u200b\u5730\u5740\u200b\u7684\u200b\u5f00\u59cb\u200b\uff1f\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e0d\u662f\u200b\u4ece\u200b0\u200b\u5f00\u59cb\u200b\uff0c\u200b\u800c\u662f\u200b\u5728\u200b\u67d0\u4e9b\u200b\u7279\u5b9a\u200b\u5730\u5740\u200b\u4e0a\u200b\u6709\u200b\u7279\u5b9a\u200b\u7684\u200b\u6620\u5c04\u200b\uff08\u200b\u89c1\u200b\u4e0a\u8ff0\u200bFigure3.3\uff09\u3002\u200b\u5728\u200b <code>memlayout.h</code> \u200b\u53ef\u200b\u770b\u5230\u200bCLINT\u200b\u7684\u200b\u503c\u200b\u4e3a\u200b0x2000000L\uff0c\u200b\u8fd9\u4e2a\u200b\u503c\u6bd4\u200b0xC000000\u200b\u5c0f\u200b\uff0c0xC000000\u200b\u662f\u200bPLIC\uff08Platform-Level Interrput Controller\uff0c\u200b\u4e2d\u65ad\u200b\u63a7\u5236\u5668\u200b\uff09\u200b\u7684\u200b\u5730\u5740\u200b\uff0c\u200b\u5b9e\u9645\u4e0a\u200b\uff0cCLINT\uff08Core Local Interruptor\uff09\u200b\u5b9a\u4e49\u200b\u4e86\u200b\u672c\u5730\u200b\u4e2d\u65ad\u200b\u63a7\u5236\u5668\u200b\u7684\u200b\u5730\u5740\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ea\u4f1a\u200b\u5728\u200b\u5185\u6838\u200b\u521d\u59cb\u5316\u200b\u7684\u200b\u65f6\u5019\u200b\u7528\u5230\u200b\u8fd9\u200b\u6bb5\u200b\u5730\u5740\u200b\u3002\u200b\u6240\u4ee5\u200b\uff0c\u200b\u4e3a\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u751f\u6210\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4e0d\u5fc5\u200b\u6620\u5c04\u200b\u8fd9\u200b\u6bb5\u200b\u5730\u5740\u200b\u3002\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u662f\u4ece\u200b\u865a\u62df\u5730\u5740\u200b0\u200b\u5f00\u59cb\u200b\uff0c\u200b\u7528\u200b\u591a\u5c11\u200b\u5c31\u200b\u5efa\u200b\u591a\u5c11\u200b\uff0c\u200b\u4f46\u200b\u6700\u9ad8\u200b\u5730\u5740\u200b\u4e0d\u80fd\u200b\u8d85\u8fc7\u200b\u5185\u6838\u200b\u7684\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b\uff0c\u200b\u8fd9\u6837\u200b\u7528\u6237\u7a0b\u5e8f\u200b\u53ef\u7528\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u7a7a\u95f4\u200b\u5c31\u200b\u4e3a\u200b<code>0x0 - 0xC000000</code>\u3002</p> <p></p>"},{"location":"lab4/part3/","title":"\u5b9e\u9a8c\u200b\u5b9e\u73b0","text":"<p>\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5bf9\u200b\u4e00\u4e9b\u200b\u5b9e\u73b0\u200b\u7684\u200b\u7ec6\u8282\u200b\u505a\u200b\u4e00\u5b9a\u200b\u7684\u200b\u63d0\u9192\u200b\u3002\u200b\u4f46\u662f\u200b\u5b8c\u6574\u200b\u7684\u200b\u6d41\u7a0b\u200b\u9700\u8981\u200b\u81ea\u5df1\u200b\u628a\u63e1\u200b\uff0c\u200b\u6211\u4eec\u200b \u200b\u4e0d\u4f1a\u200b\u7ed9\u51fa\u200b\u6bcf\u200b\u4e00\u6b65\u200b\u5b9e\u73b0\u200b\u6b65\u9aa4\u200b \u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u8fd8\u662f\u200b\u9605\u8bfb\u200b \u201c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u201d \u200b\u5185\u5bb9\u200b\uff0c\u200b\u5f97\u51fa\u200b\u81ea\u5df1\u200b\u7684\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff0c\u200b\u7136\u540e\u200b\u53c2\u8003\u200b \u201d\u200b\u5b9e\u9a8c\u200b\u5b9e\u73b0\u200b\u201c \u200b\u8fd9\u90e8\u5206\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u503c\u5f97\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\uff0cxv6\u200b\u7684\u200b\u4ee3\u7801\u200b\u662f\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u7684\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u770b\u200b\u76f8\u5173\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u662f\u200b\u600e\u4e48\u200b\u5b9e\u73b0\u200b\u7684\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u63d2\u6869\u200b\uff0c\u200b\u4f7f\u7528\u200bprintf\u200b\u7b49\u200b\u65b9\u6cd5\u200b\u770b\u770b\u200b\u5177\u4f53\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u9605\u8bfb\u200b xv6 \u200b\u6307\u5bfc\u4e66\u200b\uff0c\u200b\u770b\u770b\u200b\u80cc\u540e\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u673a\u7406\u200b\u3002</p> <p>\u200b\u6e29\u99a8\u200b\u63d0\u793a\u200b</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u7684\u200b\u540e\u200b\u4e24\u4e2a\u200b\u4efb\u52a1\u200b\u975e\u5e38\u200b\u786c\u6838\u200b\uff0c\u200b\u4f46\u200b\u771f\u6b63\u200b\u51f8\u663e\u200b\u4e86\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u9b45\u529b\u200b\u3002\u200b\u867d\u7136\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u4efb\u52a1\u200b\u7684\u200b\u5206\u503c\u200b\u4e0d\u200b\u591a\u200b\uff0c\u200b\u6211\u4eec\u200b\u4f9d\u7136\u200b\u5efa\u8bae\u200b\u4f60\u200b\u52aa\u529b\u200b\u5c1d\u8bd5\u200b\uff0c\u200b\u5982\u679c\u200b\u80fd\u200b\u575a\u6301\u200b\u505a\u200b\u5b8c\u200b\uff0c\u200b\u5c31\u200b\u4e00\u5b9a\u200b\u4f1a\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b\u6709\u200b\u66f4\u200b\u9ad8\u5c42\u6b21\u200b\u7684\u200b\u8ba4\u77e5\u200b\u3002</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b \u200b\u4f60\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u7528\u5230\u200b\u5f88\u591a\u200bkernel/vm.c\u200b\u4e2d\u200b\u7684\u200b\u51fd\u6570\u200b \uff0c\u200b\u5b83\u4eec\u200b\u6709\u200b\u6bd4\u8f83\u5b8c\u5584\u200b\u7684\u200b\u6ce8\u91ca\u200b\uff0c\u200b\u8bf7\u200b\u4ed4\u7ec6\u9605\u8bfb\u200b\u7406\u89e3\u200b\u3002</p>"},{"location":"lab4/part3/#0","title":"0. \u200b\u4efb\u52a1\u200b\u96f6\u200b\uff1a\u200b\u56de\u7b54\u200b\u95ee\u9898","text":"<p>\u200b\u56de\u7b54\u200b\u95ee\u9898\u200b</p> <p>\u200b\u4efb\u52a1\u200b\u5f00\u59cb\u200b\u4e4b\u524d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5e94\u8be5\u200b\u5148\u200b\u8981\u200b\u9996\u5148\u200b\u56de\u7b54\u200b\u4e00\u4e9b\u200b\u539f\u7406\u200b\u6027\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u8fd9\u90e8\u5206\u200b\u5e94\u8be5\u200b\u88ab\u200b\u5305\u542b\u200b\u5728\u200b\u5b9e\u9a8c\u62a5\u544a\u200b\u4e2d\u200b\uff1a</p> <ol> <li> <p>\u200b\u67e5\u9605\u200b\u8d44\u6599\u200b\uff0c\u200b\u7b80\u8981\u200b\u9610\u8ff0\u200b\u9875\u8868\u200b\u673a\u5236\u200b\u4e3a\u4ec0\u4e48\u200b\u4f1a\u200b\u88ab\u200b\u53d1\u660e\u200b\uff0c\u200b\u5b83\u200b\u6709\u200b\u4ec0\u4e48\u200b\u597d\u5904\u200b\uff1f</p> </li> <li> <p>\u200b\u6309\u7167\u200b\u6b65\u9aa4\u200b\uff0c\u200b\u9610\u8ff0\u200bSV39\u200b\u6807\u51c6\u200b\u4e0b\u200b\uff0c\u200b\u7ed9\u5b9a\u200b\u4e00\u4e2a\u200b64\u200b\u4f4d\u200b\u865a\u62df\u5730\u5740\u200b\u4e3a\u200b0x123456789ABCDEF\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u662f\u200b\u5982\u4f55\u200b\u4e00\u6b65\u200b\u4e00\u6b65\u200b\u5f97\u5230\u200b\u6700\u7ec8\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u7684\u200b\uff1f\uff08\u200b\u9875\u8868\u200b\u5185\u5bb9\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u5047\u8bbe\u200b\uff09</p> </li> <li> <p>\u200b\u6211\u4eec\u200b\u6ce8\u610f\u200b\u5230\u200b\uff0c\u200b\u865a\u62df\u5730\u5740\u200b\u7684\u200bL2, L1, L0 \u200b\u5747\u200b\u4e3a\u200b9\u200b\u4f4d\u200b\u3002\u200b\u8fd9\u200b\u5b9e\u9645\u4e0a\u200b\u662f\u200b\u8bbe\u8ba1\u200b\u4e2d\u200b\u7684\u200b\u5fc5\u7136\u7ed3\u679c\u200b\uff0c\u200b\u5b83\u4eec\u200b\u53ea\u80fd\u200b\u662f\u200b9\u200b\u4f4d\u200b\uff0c\u200b\u4e0d\u80fd\u200b\u662f\u200b10\u200b\u4f4d\u200b\u6216\u8005\u200b\u662f\u200b8\u200b\u4f4d\u200b\uff0c\u200b\u4f60\u200b\u80fd\u200b\u8bf4\u51fa\u200b\u5176\u4e2d\u200b\u7684\u200b\u7406\u7531\u200b\u5417\u200b\uff1f\uff08\u200b\u63d0\u793a\u200b\uff1a\u200b\u4e00\u4e2a\u200b\u9875\u200b\u76ee\u5f55\u200b\u7684\u200b\u5927\u5c0f\u200b\u5fc5\u987b\u200b\u4e0e\u200b\u9875\u200b\u7684\u200b\u5927\u5c0f\u200b\u7b49\u200b\u5927\u200b\uff09</p> </li> <li> <p>\u200b\u5728\u200b\u201c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u201d\u200b\u90e8\u5206\u200b\uff0c\u200b\u6211\u4eec\u200b\u77e5\u9053\u200bSV39\u200b\u4e2d\u200b\u7684\u200b39\u200b\u662f\u200b\u4ec0\u4e48\u200b\u610f\u601d\u200b\u3002\u200b\u4f46\u662f\u200b\u5176\u5b9e\u200b\u8fd8\u6709\u200b\u4e00\u79cd\u200b\u6807\u51c6\u200b\uff0c\u200b\u53eb\u505a\u200bSV48\uff0c\u200b\u91c7\u7528\u200b\u4e86\u200b\u56db\u7ea7\u200b\u9875\u8868\u200b\u800c\u200b\u975e\u200b\u4e09\u7ea7\u200b\u9875\u8868\u200b\uff0c\u200b\u4f60\u200b\u80fd\u200b\u6a21\u4eff\u200b\u201c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u201d\u200b\u90e8\u5206\u200b\u793a\u610f\u56fe\u200b\uff0c\u200b\u753b\u51fa\u200bSV48\u200b\u9875\u8868\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u548c\u200b\u7ffb\u8bd1\u200b\u7684\u200b\u6a21\u5f0f\u200b\u56fe\u793a\u200b\u5417\u200b\uff1f\uff08SV39\u200b\u539f\u56fe\u200b\u5982\u4e0b\u200b\uff09</p> </li> </ol> <p></p>"},{"location":"lab4/part3/#1","title":"1. \u200b\u4efb\u52a1\u200b\u4e00\u200b \uff1a\u200b\u6253\u5370\u200b\u9875\u8868","text":"<p>\u200b\u672c\u200b\u4efb\u52a1\u200b\u4e2d\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u52a0\u5165\u200b \u200b\u9875\u8868\u200b\u6253\u5370\u200b\u529f\u80fd\u200b \uff0c\u200b\u6765\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u5728\u200b\u4e4b\u540e\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u8fdb\u884c\u200bdebug\u3002</p> <p><code>void vmprint(pagetable_t pgtbl)</code></p>"},{"location":"lab4/part3/#11","title":"1.1 \u200b\u6d41\u7a0b","text":"<p>Step 1 \uff1a\u200b\u66f4\u65b0\u200b\u672c\u5730\u200b\u4ee3\u7801\u200b\uff0c\u200b\u5207\u6362\u200b\u5230\u200bpgtbl\u200b\u5206\u652f\u200b\u3002</p> <p>Step 2 \uff1a\u200b\u7406\u89e3\u200b\u9875\u8868\u200b\u7684\u200b\u539f\u7406\u200b\u3002</p> <p>Step 3 \uff1a\u200b\u5b9e\u73b0\u200b <code>vmprint()</code> \uff0c\u200b\u5e76\u200b\u5728\u200b <code>exec()</code> \u200b\u51fd\u6570\u200b\u4e2d\u200b\u63d2\u5165\u200b\u8bed\u53e5\u200b <code>if(p-&gt;pid==1) vmprint(p-&gt;pagetable)</code>\uff0c \u200b\u8fd9\u200b\u6761\u200b\u8bed\u53e5\u200b\u63d2\u200b\u5728\u200b <code>exec.c</code> \u200b\u4e2d\u200b <code>return argc</code> \u200b\u4ee3\u7801\u200b\u4e4b\u524d\u200b\uff0c\u200b\u5373\u200b\u5728\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u542f\u52a8\u200b\u65f6\u200b\u6253\u5370\u200b\u9875\u8868\u200b\u4fe1\u606f\u200b\u3002</p> <p>\u200b\u62d3\u5c55\u200b\u9605\u8bfb\u200b\uff1axv6\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b</p> <p>\u200b\u6211\u4eec\u200b\u4ece\u200bxv6\u200b\u7684\u200b\u542f\u52a8\u200b\u6765\u200b\u5206\u6790\u200b\uff1a</p> <ul> <li>\u200b\u4e0a\u7535\u540e\u200b\uff0c\u200b\u5148\u200b\u8fd0\u884c\u200bROM\u200b\u7684\u200bbootloader\uff0cbootloader\u200b\u518d\u200b\u52a0\u8f7d\u200bxv6\u200b\u5185\u6838\u200b\u5230\u200b\u5185\u5b58\u200b0x80000000\u200b\u5904\u200b\uff0c\u200b\u7136\u540e\u200b\u4ece\u200bxv6\u200b\u5185\u6838\u200b\u7684\u200b<code>_entry</code>\u200b\u5f00\u59cb\u200b\u3002\u200b\u90a3\u200b\u4e3a\u4ec0\u4e48\u200b\u4e0d\u200b\u52a0\u8f7d\u200b\u5230\u200b0x0\u200b\u5730\u5740\u200b\u5462\u200b\uff1f\u200b\u539f\u56e0\u200b\u662f\u200b0x0~0x80000000\u200b\u4e4b\u95f4\u200b\u5305\u542b\u200b\u4e86\u200bI/O\u200b\u8bbe\u5907\u200b\uff0c\u200b\u8be6\u89c1\u200b\u300aXV6 book\u300bFigure3.3\u3002</li> <li><code>_entry</code>\u200b\u7528\u4e8e\u200b\u8bbe\u7f6e\u200bC\u200b\u4ee3\u7801\u200b\u7684\u200b\u8fd0\u884c\u200b\u6307\u5b9a\u200b\u6808\u200b\uff0c\u200b\u5b8c\u6210\u200b\u540e\u200b\u5c31\u200b\u8df3\u8f6c\u200b\u5230\u200b<code>start</code>\u200b\u51fd\u6570\u200b\u6267\u884c\u200bC\u200b\u4ee3\u7801\u200b\u3002</li> <li><code>start</code>\u200b\u51fd\u6570\u200b\u5904\u4e8e\u200b\u673a\u5668\u200b\u6a21\u5f0f\u200b\u4e0b\u200b\uff0c\u200b\u521d\u59cb\u5316\u200b\u8ba1\u65f6\u5668\u200b\u4e2d\u65ad\u200b\uff0c\u200b\u4e3a\u200b\u5207\u6362\u200b\u5230\u200b\u7ba1\u7406\u6a21\u5f0f\u200b\u505a\u597d\u200b\u51c6\u5907\u200b\uff0c\u200b\u7136\u540e\u200b\u5230\u200b<code>main</code>\u200b\u51fd\u6570\u200b\u5f00\u59cb\u200b\u6267\u884c\u200b\u3002</li> <li><code>main</code>\u200b\u51fd\u6570\u200b\u521d\u59cb\u5316\u200b\u4e00\u4e9b\u200b\u8bbe\u5907\u200b\u548c\u200b\u5b50\u7cfb\u7edf\u200b\uff0c\u200b\u8c03\u7528\u200b<code>userinit</code>\u200b\u6765\u200b\u521b\u5efa\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u3002</li> <li>\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u6267\u884c\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5c0f\u200b\u7a0b\u5e8f\u200b<code>user/initcode.S</code>\uff0c\u200b\u901a\u8fc7\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b<code>exec</code>\u200b\u6267\u884c\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u7a0b\u5e8f\u200b<code>user/init</code>\u3002</li> <li><code>user/init</code>\u200b\u521b\u5efa\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u63a7\u5236\u53f0\u200b\u8bbe\u5907\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u4f5c\u4e3a\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b0\uff0c1\uff0c2\u200b\u6765\u200b\u6253\u5f00\u200b\u5b83\u200b\u3002\u200b\u4e4b\u540e\u200b\u5728\u200bfor(;;)\u200b\u65e0\u9650\u200b\u5faa\u73af\u200b\u4e2d\u200b\u542f\u52a8\u200bshell\uff0c\u200b\u5e76\u200b\u5904\u7406\u200b\u50f5\u5c38\u200b\u8fdb\u7a0b\u200b\u3002\u200b\u8fd9\u6837\u200b\uff0c\u200b\u7cfb\u7edf\u200b\u5c31\u200b\u542f\u52a8\u200b\u4e86\u200b\u3002</li> </ul> <p>Step 4 \uff1a\u200b\u542f\u52a8\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b\u8fdb\u884c\u200b\u6d4b\u8bd5\u200b\u3002</p>"},{"location":"lab4/part3/#12","title":"1.2 \u200b\u5b9e\u73b0","text":"<ul> <li> <p>\u200b\u628a\u200b <code>vmprint()</code> \u200b\u653e\u5728\u200b <code>kernel/vm.c</code>\u3002   </p> </li> <li> <p>\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b <code>kernel/riscv.h</code> \u200b\u4e2d\u200b\u5c3e\u90e8\u200b\u7684\u200b\u5b8f\u200b\u5b9a\u4e49\u200b \uff0c\u200b\u6bd4\u5982\u200b\uff1a</p> </li> </ul> <pre><code>323  #define PGSIZE 4096 // bytes per page\n324  #define PGSHIFT 12  // bits of offset within a page\n\n329  #define PTE_V (1L &lt;&lt; 0) // valid\n330  #define PTE_R (1L &lt;&lt; 1)\n331  #define PTE_W (1L &lt;&lt; 2)\n332  #define PTE_X (1L &lt;&lt; 3)\n333  #define PTE_U (1L &lt;&lt; 4) // 1 -&gt; user can access\n334\n335  // shift a physical address to the right place for a PTE.\n336  #define PA2PTE(pa) ((((uint64)pa) &gt;&gt; 12) &lt;&lt; 10)\n337\n338  #define PTE2PA(pte) (((pte) &gt;&gt; 10) &lt;&lt; 12)\n</code></pre> <ul> <li><code>kernel/vm.c</code>\u200b\u4e2d\u200b\u7684\u200b\u51fd\u6570\u200b <code>freewalk()</code> \u200b\u80fd\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u7406\u89e3\u200b\u904d\u5386\u200b\u9875\u8868\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u3002  </li> </ul> <pre><code>// Recursively free page-table pages.\n// All leaf mappings must already have been removed.\n275 void\n276 freewalk(pagetable_t pagetable)\n277 {\n278  // there are 2^9 = 512 PTEs in a page table.\n// \u200b\u904d\u5386\u200b\u4e00\u4e2a\u200b\u9875\u8868\u200b\u9875\u200b\u7684\u200bPTE\u200b\u8868\u9879\u200b \n279  for(int i = 0; i &lt; 512; i++){\n280    pte_t pte = pagetable[i]; //\u200b\u83b7\u53d6\u200b\u7b2c\u200bi\u200b\u6761\u200bPTE \n\n/*\u200b\u5224\u65ad\u200bPTE\u200b\u7684\u200bFlag\u200b\u4f4d\u200b\uff0c\u200b\u5982\u679c\u200b\u8fd8\u6709\u200b\u4e0b\u200b\u4e00\u7ea7\u200b\u9875\u8868\u200b(\u200b\u5373\u200b\u5f53\u524d\u200b\u662f\u200b\u6839\u200b\u9875\u8868\u200b\u6216\u6b21\u200b\u9875\u8868\u200b)\uff0c\n    \u200b\u5219\u200b\u9012\u5f52\u200b\u8c03\u7528\u200bfreewalk\u200b\u91ca\u653e\u200b\u9875\u8868\u200b\u9879\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u5bf9\u5e94\u200b\u7684\u200bPTE\u200b\u6e05\u96f6\u200b*/\n281    if((pte &amp; PTE_V) &amp;&amp; (pte &amp; (PTE_R|PTE_W|PTE_X)) == 0){ 282      // this PTE points to a lower-level page table.\n283      uint64 child = PTE2PA(pte); // \u200b\u5c06\u200bPTE\u200b\u8f6c\u4e3a\u200b\u4e3a\u200b\u7269\u7406\u5730\u5740\u200b\n284      freewalk((pagetable_t)child); // \u200b\u9012\u5f52\u200b\u8c03\u7528\u200bfreewalk\n285      pagetable[i] = 0; // \u200b\u6e05\u96f6\u200b\n286    } else if(pte &amp; PTE_V){ /*\u200b\u5982\u679c\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u7684\u200b\u865a\u62df\u5730\u5740\u200b\u8fd8\u6709\u200b\u6620\u5c04\u200b\u5230\u200b\u7269\u7406\u5730\u5740\u200b\uff0c\u200b\u62a5\u9519\u200bpanic\u3002\n    \u200b\u56e0\u4e3a\u200b\u8c03\u7528\u200bfreewalk\u200b\u4e4b\u524d\u200b\u5e94\u8be5\u200b\u4f1a\u5148\u200buvmunmap\u200b\u91ca\u653e\u200b\u7269\u7406\u200b\u5185\u5b58\u200b*/    287      panic(\"freewalk: leaf\"); 288    }\n289  }\n290  kfree((void*)pagetable); // \u200b\u91ca\u653e\u200bpagetable\u200b\u6307\u5411\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\n291 }\n</code></pre> <ul> <li> <p>\u200b\u5728\u200b <code>kernel/defs.h</code> \u200b\u4e2d\u200b\u5b9a\u4e49\u200b <code>vmprint()</code> \u200b\u7684\u200b\u63a5\u53e3\u200b\uff0c\u200b\u8fd9\u6837\u200b\u4f60\u200b\u624d\u80fd\u200b\u5728\u200b <code>exec()</code> \u200b\u4e2d\u200b\u4f7f\u7528\u200b\u5b83\u200b\u3002  </p> </li> <li> <p>\u200b\u4f7f\u7528\u200b <code>printf()</code> \u200b\u6253\u5370\u200b\u9875\u8868\u200b\u6570\u636e\u200b\u4e2d\u200b\u7684\u200b\u6307\u9488\u200b\u65f6\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b <code>%p</code> \u200b\u6807\u793a\u200b\u3002  </p> </li> </ul>"},{"location":"lab4/part3/#2","title":"2  \u200b\u4efb\u52a1\u200b\u4e8c\u200b \u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868","text":"<p>\u200b\u6211\u4eec\u200b\u9700\u8981\u200b \u200b\u5c06\u200b\u5171\u4eab\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u6539\u6210\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b \uff0c\u200b\u4f7f\u5f97\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u62e5\u6709\u200b\u81ea\u5df1\u200b\u72ec\u7acb\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u3002</p>"},{"location":"lab4/part3/#21","title":"2.1 \u200b\u6d41\u7a0b","text":"<p>Step 1 \uff1a\u200b\u4fee\u6539\u200b<code>kernel/proc.h</code>\u200b\u4e2d\u200b\u7684\u200b <code>struct proc</code>\uff0c \u200b\u589e\u52a0\u200b\u4e24\u4e2a\u200b\u65b0\u200b\u6210\u5458\u200b\uff1a<code>pagetable_t k_pagetable;</code>\u200b\u548c\u200b<code>uint64 kstack_pa;</code>\uff0c\u200b\u5206\u522b\u200b\u7528\u4e8e\u200b\u7ed9\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u4e2d\u200b\u8bbe\u7f6e\u200b\u4e00\u4e2a\u200b\u5185\u6838\u200b\u72ec\u7acb\u200b\u9875\u8868\u200b\u548c\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\u3002</p> <p>Step 2 \uff1a\u200b\u4eff\u7167\u200b<code>kvminit()</code> \u200b\u51fd\u6570\u200b\u91cd\u65b0\u200b\u5199\u200b\u4e00\u4e2a\u200b\u521b\u5efa\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u51fd\u6570\u200b\u3002</p> <ul> <li>\u200b\u4e3a\u200b\u8fdb\u7a0b\u200b\u5206\u914d\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u4e00\u79cd\u200b\u89e3\u51b3\u65b9\u6848\u200b \uff1a\u200b\u4e0d\u8981\u200b\u4fee\u6539\u200b\u5168\u5c40\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff08kernel/vm.c\u200b\u4e2d\u200b\u7684\u200b<code>pagetable_t kernel_pagetable</code>\uff09\uff0c\u200b\u800c\u662f\u200b\u76f4\u63a5\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u5176\u200b\u5730\u5740\u200b<code>k_pagetable</code>\u200b\u8fd4\u56de\u200b\u3002\u200b\u5b9e\u73b0\u200b\u7684\u200b\u65f6\u5019\u200b\u4e0d\u8981\u200b\u6620\u5c04\u200bCLINT\uff0c\u200b\u5426\u5219\u200b\u4f1a\u200b\u5728\u200b\u4efb\u52a1\u200b\u4e09\u200b\u53d1\u751f\u200b\u5730\u5740\u200b\u91cd\u5408\u200b\u95ee\u9898\u200b\u3002\u200b\u5e94\u8be5\u200b\u8981\u200b\u5728\u200bStep 4 <code>allocproc()</code> \u200b\u4e2d\u200b\u8c03\u7528\u200b\u5b83\u200b\u3002</li> </ul> <p>Step 3 \uff1a\u200b\u4fee\u6539\u200bprocinit\u200b\u51fd\u6570\u200b\u3002procinit()\u200b\u662f\u200b\u5728\u200b\u7cfb\u7edf\u200b\u5f15\u5bfc\u200b\u65f6\u200b\uff08\u200b\u89c1\u200b<code>kernel/main.c</code>\u200b\u7684\u200bmain\u200b\u51fd\u6570\u200b\uff09\uff0c\u200b\u7528\u4e8e\u200b\u7ed9\u200b\u8fdb\u7a0b\u200b\u5206\u914d\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e76\u200b\u5728\u200b\u9875\u8868\u200b\u5efa\u7acb\u200b\u6620\u5c04\u200b\u3002</p> <ul> <li>\u200b\u53c2\u8003\u200b\u4f18\u5316\u200b\u65b9\u6cd5\u200b \uff1a\u200b\u628a\u200bprocinit()\u200b\u4e2d\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200bpa\u200b\u62f7\u8d1d\u5230\u200bPCB\u200b\u65b0\u589e\u200b\u7684\u200b\u6210\u5458\u200b<code>kstack_pa</code>\u200b\u4e2d\u200b\uff0c\u200b\u540c\u65f6\u200b\u8fd8\u200b\u9700\u8981\u200b\u4fdd\u7559\u200b\u5185\u6838\u200b\u6808\u200b\u5728\u200b\u5168\u5c40\u200b\u9875\u8868\u200bkernel_pagetable\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u7136\u540e\u200b\u5728\u200bStep 4 <code>allocproc()</code>\u200b\u4e2d\u200b\u518d\u200b\u628a\u200b\u5b83\u200b\u6620\u5c04\u200b\u5230\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u91cc\u200b\u3002\u200b\u5173\u4e8e\u200b\u5185\u6838\u200b\u6808\u200b\u8bf4\u660e\u200b\uff0c\u200b\u89c1\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b 3.4.</li> </ul> <p>\u200b\u4e3a\u4ec0\u4e48\u200b\u8981\u200b\u4fdd\u7559\u200b\u521d\u59cb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff1f</p> <p>\u200b\u4fdd\u7559\u200b\u539f\u6709\u200b\u7684\u200bkvminit()\u200b\u4ee5\u53ca\u200bkernel/vm.c\u200b\u4e2d\u200bkernel_pagetable\uff0c\u200b\u56e0\u4e3a\u200b\u6709\u4e9b\u200b\u65f6\u5019\u200bCPU\u200b\u53ef\u80fd\u200b\u5e76\u672a\u200b\u6267\u884c\u200b\u7528\u6237\u200b\u8fdb\u7a0b\u200b\u3002</p> <p>Step 4 \uff1a\u200b\u4fee\u6539\u200ballocproc\u200b\u51fd\u6570\u200b\u3002allocproc()\u200b\u4f1a\u200b\u5728\u200b\u7cfb\u7edf\u542f\u52a8\u200b\u65f6\u200b\u88ab\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u548c\u200bfork\u200b\u8c03\u7528\u200b\u3002\u200b\u5728\u200ballocproc\u200b\u51fd\u6570\u200b\u91cc\u200b\u8c03\u7528\u200bStep 2 \u200b\u521b\u5efa\u200b\u7684\u200b\u51fd\u6570\u200b\u8bbe\u7f6e\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u5e76\u4e14\u200b\u8c03\u7528\u200bkvmmap\u200b\u51fd\u6570\u200b\u5c06\u200bStep 3 \u200b\u8bbe\u7f6e\u200b\u7684\u200b\u5185\u6838\u200b\u6808\u200b\u6620\u5c04\u200b\u5230\u200b\u9875\u8868\u200b<code>k_pagetable</code>\u200b\u91cc\u200b\u3002</p> <p>allocproc\u200b\u51fd\u6570\u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b</p> <p>\u200b\u5728\u200b\u8fdb\u7a0b\u200b\u8868\u4e2d\u200b\u67e5\u627e\u200b\u7a7a\u95f2\u200bPCB\uff0c\u200b\u5982\u679c\u200b\u627e\u5230\u200b\uff0c\u200b\u521d\u59cb\u5316\u200b\u5728\u200b\u5185\u6838\u200b\u4e2d\u200b\u8fd0\u884c\u200b\u6240\u200b\u9700\u200b\u7684\u200b\u72b6\u6001\u200b\uff0c\u200b\u5e76\u200b\u4fdd\u6301\u200bp-&gt;lock\u200b\u8fd4\u56de\u200b\u3002\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u7a7a\u95f2\u200bPCB\uff0c\u200b\u6216\u8005\u200b\u5185\u5b58\u200b\u5206\u914d\u200b\u5931\u8d25\u200b\uff0c\u200b\u5219\u200b\u8fd4\u56de\u200b0\u3002</p> <p>\u200b\u5173\u4e8e\u200b\u5185\u6838\u200b\u6808\u200b\u6620\u5c04\u200b</p> <p>\u200b\u6ce8\u610f\u200b\uff0c\u200b\u8981\u200b\u4fdd\u8bc1\u200b\u5728\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\u6620\u5c04\u200b\u8be5\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5185\u6838\u200b\u6808\u200b\u3002xv6\u200b\u672c\u4f1a\u200b\u5728\u200b procinit() \u200b\u4e2d\u200b\u5206\u914d\u200b\u5185\u6838\u200b\u6808\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e76\u200b\u5728\u200b\u9875\u8868\u200b\u5efa\u7acb\u200b\u6620\u5c04\u200b\u3002\u200b\u4f46\u662f\u200b\u73b0\u5728\u200b\uff0c\u200b\u5e94\u8be5\u200b\u5728\u200ballocproc()\u200b\u4e2d\u200b\u5b9e\u73b0\u200b\u8be5\u200b\u529f\u80fd\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u6267\u884c\u200bprocinit()\u200b\u7684\u200b\u65f6\u5019\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u8fd8\u200b\u672a\u200b\u88ab\u200b\u521b\u5efa\u200b\u3002\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200bprocinit()\u200b\u4e2d\u200b\u53ea\u200b\u4fdd\u7559\u200b\u5185\u5b58\u200b\u7684\u200b\u5206\u914d\u200b\uff0c\u200b\u4f46\u200b\u5728\u200ballocproc()\u200b\u4e2d\u200b\u5b8c\u6210\u200b\u6620\u5c04\u200b\u3002</p> <p>Step 5 \uff1a\u200b\u4fee\u6539\u200b\u8c03\u5ea6\u200b\u5668\u200b\uff08scheduler\uff09\uff0c\u200b\u4f7f\u5f97\u200b\u5207\u6362\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u65f6\u5019\u200b\u5207\u6362\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u3002</p> <ul> <li> <p>\u200b\u53c2\u8003\u200b\u65b9\u6cd5\u200b \uff1a\u200b\u5728\u200b\u8fdb\u7a0b\u200b\u5207\u6362\u200b\u7684\u200b\u540c\u65f6\u200b\u4e5f\u200b\u8981\u200b\u5207\u6362\u200b\u9875\u8868\u200b\u5c06\u200b\u5176\u200b\u653e\u5165\u200b\u5bc4\u5b58\u5668\u200b<code>satp</code>\u200b\u4e2d\u200b\uff0c\u200b\u8bf7\u200b\u501f\u9274\u200b kvminithart()\u200b\u7684\u200b\u9875\u8868\u200b\u8f7d\u5165\u200b\u65b9\u5f0f\u200b\uff09\uff0c\u200b\u5728\u200b\u8c03\u7528\u200b w_satp() \u200b\u4e4b\u540e\u200b\u8c03\u7528\u200b sfence_vma()\uff0c\u200b\u5177\u4f53\u200b\u539f\u7406\u200b\u53ef\u200b\u67e5\u9605\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b\u7684\u200b3.3 \u200b\u5185\u6838\u200b\u5bf9\u200b\u7528\u6237\u200b\u7a7a\u95f4\u200b\u7684\u200b\u8bbf\u95ee\u200b\u3002</p> </li> <li> <p>\u200b\u65e0\u200b\u8fdb\u7a0b\u200b\u8fd0\u884c\u200b\u7684\u200b\u9002\u914d\u200b \uff1a\u200b\u5f53\u200b\u76ee\u524d\u200b\u6ca1\u6709\u200b\u8fdb\u7a0b\u200b\u8fd0\u884c\u200b\u7684\u200b\u65f6\u5019\u200b\uff0cscheduler() \u200b\u5e94\u8be5\u200b\u8981\u200bsatp\u200b\u8f7d\u5165\u200b\u5168\u5c40\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200bkernel_pagetable (kernel/vm.c)\u3002</p> </li> <li> <p>\u200b\u5173\u4e8e\u200bscheduler\u200b\u8c03\u5ea6\u200b\u5668\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200bHITSZ\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u7ec4\u200b\u8bb2\u89e3\u200bXV6\uff08\u200b\u4e09\u200b\uff09\u200b\u5185\u5b58\u200b\u7ba1\u7406\u200b</p> </li> </ul> <p></p> <p>Step 6 \uff1a\u200b\u5f53\u200b\u8fdb\u7a0b\u200b\u7ed3\u675f\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u4fee\u6539\u200bfreeproc()\u200b\u51fd\u6570\u200b\u6765\u200b\u91ca\u653e\u200b\u5bf9\u5e94\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u3002\u200b\u4f60\u200b\u9700\u8981\u200b\u627e\u5230\u200b \u200b\u91ca\u653e\u200b\u9875\u8868\u200b\u4f46\u200b\u4e0d\u200b\u91ca\u653e\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u6307\u5411\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b \u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002\u200b\u4f60\u200b\u53ef\u200b\u53c2\u8003\u200bkernel/vm.c\u200b\u4e2d\u200b\u7684\u200bfreewalk\uff0c\u200b\u5176\u200b\u7528\u4e8e\u200b\u91ca\u653e\u200b\u6574\u4e2a\u200b\u9875\u8868\u200b\uff0c\u200b\u4f46\u200b\u8981\u6c42\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u7684\u200b\u9875\u200b\u9879\u200b\u5df2\u7ecf\u200b\u88ab\u200b\u6e05\u7a7a\u200b\u3002</p> <ul> <li>\u200b\u867d\u7136\u200b\u6211\u4eec\u200b\u4e3a\u200b\u6bcf\u4e2a\u200b\u8fdb\u7a0b\u200b\u5f15\u5165\u200b\u4e86\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u4f46\u662f\u200b\u5185\u6838\u200b\u7684\u200b\u4ee3\u7801\u200b\u548c\u200b\u6570\u636e\u200b\u90fd\u200b\u8fd8\u662f\u200b\u552f\u4e00\u200b\u7684\u200b\u3002\u200b\u8fd9\u200b\u610f\u5473\u7740\u200b\uff0c\u200b\u5728\u200b\u5404\u4e2a\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u4e2d\u200b\uff0c\u200b\u9875\u8868\u200b\u9879\u200b\u6307\u5411\u200b\u4e86\u200b\u5171\u4eab\u200b\u7684\u200b\u7269\u7406\u200b\u9875\u200b\uff0c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</li> </ul> <p></p> <ul> <li>\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5728\u200b\u6211\u4eec\u200b\u91ca\u653e\u200b\u67d0\u4e2a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4e0d\u200b\u5e94\u8be5\u200b\u628a\u200b\u8fd9\u4e2a\u200b\u5171\u4eab\u200b\u7269\u7406\u200b\u9875\u200b\u5e27\u200b\u91ca\u653e\u200b\uff0c\u200b\u5426\u5219\u200b\u4f1a\u200b\u4ea7\u751f\u200b\u975e\u5e38\u200b\u4e25\u91cd\u200b\u7684\u200b\u540e\u679c\u200b\uff01 </li> </ul> <p>Step 7 \uff1a\u200b\u901a\u8fc7\u200b<code>usertests</code>\u200b\u548c\u200b<code>kvmtest</code>\u200b\u6d4b\u8bd5\u200b\u3002</p>"},{"location":"lab4/part3/#22","title":"2.2 \u200b\u5b9e\u73b0","text":"<p>\u200b\u8fd9\u91cc\u200b\u6709\u200b\u5fc5\u8981\u200b\u63d0\u9192\u200b\u4e00\u4e0b\u200b\u540c\u5b66\u200b\uff0c\u200b\u8981\u200b\u4ee5\u200b\u6700\u200b\u7b80\u5355\u200b\u7684\u200b\u65b9\u6cd5\u200b\u4ee5\u53ca\u200b\u5de5\u7a0b\u91cf\u200b\u6700\u5c0f\u200b\u7684\u200b\u65b9\u6cd5\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u6700\u597d\u200b\u4e0d\u8981\u200b\u56e0\u4e3a\u200b\u4f18\u5316\u200b\u7b49\u200b\u95ee\u9898\u200b\uff0c\u200b\u5927\u6539\u200b\u5185\u6838\u200b\u673a\u5236\u200b\u3002</p> <ul> <li>\u200b\u597d\u597d\u200b\u5229\u7528\u200b <code>vmprint()</code> \u200b\u6765\u200b\u5e2e\u52a9\u200bdebug\u3002</li> <li>\u200b\u9875\u8868\u200b\u7684\u200bbug\u200b\u901a\u5e38\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u6620\u5c04\u200b\u7f3a\u5931\u200b\u7684\u200btraps\uff0c\u200b\u8bbf\u5b58\u200b\u5931\u8d25\u200b\uff0c\u200b\u6307\u4ee4\u200b\u8fd0\u884c\u200b\u9519\u8bef\u200b\u7b49\u200b\u62a5\u9519\u200b\u3002\u200b\u5982\u679c\u200b \u200b\u5185\u6838\u200b \u200b\u7f3a\u5931\u200b\u4e86\u200b\u5730\u5740\u6620\u5c04\u200b\u9020\u6210\u200b\u4e86\u200b\u9875\u200b\u7f3a\u5931\u200b\uff08page fault\uff09\uff0c\u200b\u901a\u5e38\u200b\u4f1a\u200b\u6253\u5370\u200b\u4e2a\u200b <code>sepc=0x00000000XXXXXXXX</code> \uff0c\u200b\u8fd9\u200b\u4ee3\u8868\u200b\u7684\u200b\u662f\u200b\u51fa\u9519\u200b\u65f6\u200bpc\u200b\u7684\u200b\u503c\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u67e5\u200b<code>kernel/kernel.asm</code> \u200b\u770b\u770b\u200b \u200b\u5bf9\u5e94\u200b\u5730\u5740\u200b \u200b\u7684\u200b\u4ee3\u7801\u200b\u7684\u200b\u542b\u4e49\u200b\u3002   </li> <li>\u200b\u4f60\u200b\u7684\u200b\u5b9e\u73b0\u200b\u53ef\u4ee5\u200b\u4fee\u6539\u200b\u539f\u6709\u200b\u7684\u200b\u51fd\u6570\u200b\u6216\u8005\u200b\u662f\u200b\u65b0\u589e\u200b\u51fd\u6570\u200b\uff0c\u200b\u6700\u597d\u200b\u653e\u5728\u200b <code>kernel/vm.c +kernel/proc.c</code> \u200b\u4e2d\u200b\uff0c\u200b\u4f46\u662f\u200b \u200b\u5343\u4e07\u200b\u4e0d\u8981\u200b\u4fee\u6539\u200b <code>kernel/vmcopyin.c +kernel/stats.c + user/usertests.c + user/stats.c</code>\u3002</li> </ul>"},{"location":"lab4/part3/#3","title":"3  \u200b\u4efb\u52a1\u200b\u4e09\u200b \u200b\u7b80\u5316\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u5730\u5740\u200b\u7ffb\u8bd1","text":"<p>\u200b\u5177\u4f53\u200b\u8981\u6c42\u200b</p> <p>\u200b\u6211\u4eec\u200b\u9700\u8981\u200b \u200b\u5728\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u52a0\u4e0a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u540c\u65f6\u200b\u66ff\u6362\u200b <code>copyin()/copyinstr()</code> \u200b\u4e3a\u200b <code>copyin_new()/copyinstr_new()</code> \uff0c\u200b\u4f7f\u5f97\u200b\u5185\u6838\u200b\u80fd\u591f\u200b\u4e0d\u5fc5\u200b\u82b1\u8d39\u200b\u5927\u91cf\u200b\u65f6\u95f4\u200b\uff0c\u200b\u7528\u200b\u8f6f\u4ef6\u200b\u6a21\u62df\u200b\u7684\u200b\u65b9\u6cd5\u200b\u4e00\u6b65\u200b\u4e00\u6b65\u200b\u904d\u5386\u200b\u9875\u8868\u200b\uff0c\u200b\u800c\u662f\u200b\u76f4\u63a5\u200b\u5229\u7528\u200b\u786c\u4ef6\u200b\u3002</p>"},{"location":"lab4/part3/#31","title":"3.1 \u200b\u6d41\u7a0b","text":"<p>Step 1 \uff1a\u200b\u5199\u200b\u4e00\u4e2a\u200b<code>XXX</code>\u200b\u51fd\u6570\u200b\u628a\u200b\u8fdb\u7a0b\u200b\u7684\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u6620\u5c04\u200b\u5230\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\uff0c\u200b\u540c\u65f6\u200b\u5728\u200bdefs.h\u200b\u4e2d\u200b\u58f0\u660e\u200b\u3002</p> <ul> <li> <p>\u200b\u63a8\u8350\u200b\u4e00\u79cd\u200b\u8f83\u4e3a\u200b\u4f18\u96c5\u200b\u7684\u200b\u5b9e\u73b0\u200b\u65b9\u6cd5\u200b \uff1a\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u76f4\u63a5\u200b\u5171\u4eab\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\uff0c\u200b\u5373\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u6b21\u200b\u9875\u8868\u200b\u7684\u200b\u90e8\u5206\u200b\u76ee\u5f55\u200b\u9879\u200b\u76f4\u63a5\u200b\u6307\u5411\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u53f6\u5b50\u200b\u9875\u8868\u200b\u3002\u200b\u8fd9\u6837\u200b\u53ef\u4ee5\u200b\u4e0d\u5fc5\u200b\u5c06\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u9875\u8868\u200b\u9879\u200b\u5168\u90e8\u200b\u590d\u5236\u200b\u8fdb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\uff0c\u200b\u4e5f\u200b\u4e0d\u5fc5\u200b\u4fee\u6539\u200b\u9875\u8868\u200b\u9879\u200b\u6807\u5fd7\u200b\u4f4d\u200b\uff0c\u200b\u7b80\u5316\u200b\u5b9e\u73b0\u200b\u7684\u200b\u540c\u65f6\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u63d0\u5347\u200b\u6027\u80fd\u200b\uff0c\u200b\u4f46\u200b\u5728\u200b\u9875\u8868\u200b\u56de\u6536\u200b\u7684\u200b\u65f6\u5019\u200b\u9700\u8981\u200b\u907f\u514d\u200b\u91cd\u590d\u200b\u56de\u6536\u200b\u3002</p> </li> <li> <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u524d\u9762\u200b\u5df2\u7ecf\u200b\u63d0\u5230\u200b\u7528\u6237\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\u7684\u200b\u8303\u56f4\u200b\u4e3a\u200b0x0-0xC000000\uff0c\u200b\u89c1\u200b\u201c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b 3.5\u201d\u3002\u200b\u8bd5\u200b\u8ba1\u7b97\u200b\uff0c\u200b\u591a\u5c11\u200b\u4e2a\u200b\u6b21\u7ea7\u200b\u9875\u8868\u200b\u9879\u200b\u5c31\u200b\u80fd\u200b\u6db5\u76d6\u200b\u6574\u4e2a\u200b\u7528\u6237\u200b\u5730\u5740\u200b\u7a7a\u95f4\u200b\uff1f</p> </li> </ul> <p></p> <p>Step 2 \uff1a\u200b\u7528\u200b\u51fd\u6570\u200b <code>copyin_new()</code> \uff08\u200b\u5728\u200b <code>kernel/vmcopyin.c</code>\u200b\u4e2d\u200b\u5b9a\u4e49\u200b\uff09\u200b\u4ee3\u66ff\u200b <code>copyin()</code> \uff08\u200b\u5728\u200b <code>kernel/vm.c</code>\u200b\u4e2d\u200b\u5b9a\u4e49\u200b\uff09\u3002\u200b\u786e\u4fdd\u200b\u7a0b\u5e8f\u200b \u200b\u80fd\u200b\u8fd0\u884c\u200b \u200b\u4e4b\u540e\u200b\u518d\u7528\u200b <code>copyinstr_new()</code> \u200b\u4ee5\u200b\u4ee3\u66ff\u200b <code>copyinstr()</code>\u3002</p> <p>Step 3 \uff1a\u200b\u5728\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u52a0\u4e0a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\uff0c\u200b\u4ee5\u200b\u4fdd\u8bc1\u200b\u521a\u521a\u200b\u66ff\u6362\u200b\u5730\u65b0\u200b\u51fd\u6570\u200b\u80fd\u591f\u200b\u4f7f\u7528\u200b\u3002\u200b\u6ce8\u610f\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\u7684\u200b\u6807\u5fd7\u200b\u4f4d\u200b\u7684\u200b\u9009\u62e9\u200b\u3002\u200b\u6807\u5fd7\u200b\u4f4d\u200bUser\u200b\u4e00\u65e6\u200b\u88ab\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u5185\u6838\u200b\u5c31\u200b\u4e0d\u80fd\u200b\u8bbf\u95ee\u200b\u8be5\u200b\u865a\u62df\u5730\u5740\u200b\u4e86\u200b\u3002</p> <ul> <li>\u200b\u63a8\u8350\u200b\u65b9\u6848\u200b \uff1a\u200b\u5728\u200b\u8c03\u7528\u200bcopyin_new()/ copyinstr_new()\u200b\u4e4b\u524d\u200b\u4fee\u6539\u200bsstatus\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200bSUM\u200b\u4f4d\u200b\uff1a<code>w_sstatus(r_sstatus() | SSTATUS_SUM);</code> \u200b\u5728\u200b\u51cb\u7528\u200bcopyin_new()/ copyinstr_new()\u200b\u4e4b\u540e\u200b\u53bb\u6389\u200bsstatus\u200b\u5bc4\u5b58\u5668\u200b\u7684\u200bSUM\u200b\u4f4d\u200b\uff1a<code>w_sstatus(r_sstatus() &amp; ~SSTATUS_SUM);</code></li> </ul> <p>Step 4 \uff1a\u200b\u5728\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u52a0\u4e0a\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u6bcf\u200b\u4e00\u6b21\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u88ab\u200b\u4fee\u6539\u200b\u4e86\u200b\u6620\u5c04\u200b\u7684\u200b\u540c\u65f6\u200b\uff0c\u200b\u90fd\u200b\u8981\u200b\u4fee\u6539\u200b\u5bf9\u5e94\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u76f8\u5e94\u200b\u90e8\u5206\u200b\u4fdd\u6301\u200b\u540c\u6b65\u200b\u3002\u200b\u8fd9\u200b\u901a\u5e38\u200b\u5728\u200b fork(), exec(), sbrk()\u200b\u4e2d\u200b\u53d1\u751f\u200b\uff0c\u200b\u5176\u4e2d\u200bsbrk()\u200b\u8c03\u7528\u200bgrowproc()\u200b\u6765\u200b\u5b9e\u73b0\u200b\u5185\u5b58\u200b\u5206\u914d\u200b\u6216\u200b\u56de\u6536\u200b\u3002\u200b\u4e5f\u200b\u5c31\u662f\u200b\uff0c\u200b\u9700\u8981\u200b\u5728\u200bfork()\u3001exec()\u200b\u548c\u200bgrowproc()\u200b\u8fd9\u200b\u4e09\u4e2a\u200b\u51fd\u6570\u200b\u91cc\u200b\u5c06\u200b\u6539\u53d8\u200b\u540e\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u9875\u8868\u200b\u540c\u6b65\u200b\u5230\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\u3002</p> <p>Step 5 \uff1a\u200b\u6ce8\u610f\u200b\uff1a\u200b\u7b2c\u4e00\u4e2a\u200b\u8fdb\u7a0b\u200b\u4e5f\u200b\u9700\u8981\u200b\u5c06\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u6620\u5c04\u200b\u5230\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u4e2d\u200b\uff0c\u200b\u89c1\u200bkernel/proc.c: userinit()\u3002</p> <p>Step 6 \uff1a\u200b\u901a\u8fc7\u200b usertests, make grade\u3002</p>"},{"location":"lab4/part3/#32","title":"3.2 \u200b\u5b9e\u73b0","text":"<ul> <li> <p>\u200b\u6ce8\u610f\u200b\u72ec\u7acb\u200b\u5185\u6838\u200b\u9875\u8868\u200b\u7684\u200b\u7528\u6237\u200b\u9875\u8868\u200b\u7684\u200b\u6620\u5c04\u200b\u7684\u200b \u200b\u6807\u5fd7\u200b\u4f4d\u200b \u200b\u7684\u200b\u9009\u62e9\u200b\u3002\uff08\u200b\u6807\u5fd7\u200b\u4f4d\u200bUser\u200b\u4e00\u65e6\u200b\u88ab\u200b\u8bbe\u7f6e\u200b\uff0c\u200b\u5185\u6838\u200b\u5c31\u200b\u4e0d\u80fd\u200b\u8bbf\u95ee\u200b\u8be5\u200b\u865a\u62df\u5730\u5740\u200b\u4e86\u200b\uff09</p> </li> <li> <p>\u200b\u518d\u6b21\u200b\u63d0\u9192\u200b\u5730\u5740\u200b\u91cd\u5408\u200b\u95ee\u9898\u200b\uff0c\u200b\u89c1\u200b\u201c\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b 3.5\u201d.</p> </li> </ul>"},{"location":"lab4/part4/","title":"\u4ee3\u7801\u200b\u63d0\u4ea4","text":"<p>\u200b\u8bf7\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u4e8c\u200b\u7684\u200b\u4ee3\u7801\u200b\u63d0\u4ea4\u200b\u65b9\u5f0f\u200b\u3002</p>"},{"location":"lab5/part1/","title":"\u5b9e\u9a8c\u200b\u6982\u8ff0","text":"<p>\u200b\u6e29\u200b\uff08\u200b\u5b88\u200b\uff09\u200b\u99a8\u200b\uff08\u200b\u4f4f\u200b\uff09\u200b\u63d0\u200b\uff08\u200b\u7ea2\u200b\uff09\u200b\u793a\u200b\uff08\u200b\u7ebf\u200b\uff09</p> <p>\u200b\u672c\u200b\u8bfe\u7a0b\u200b\u5b9e\u9a8c\u200b\u5df2\u200b\u5f15\u5165\u200b\u4ee3\u7801\u200b\u81ea\u52a8\u200b\u67e5\u91cd\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u4fdd\u6301\u200b\u5b66\u672f\u200b\u8bda\u4fe1\u200b\uff01</p> <p>\u200b\u8bfe\u7a0b\u200b\u590d\u4e60\u200b\u548c\u200b\u9884\u4e60\u200b\u8981\u6c42\u200b</p> <p>\u200b\u672c\u200b\u8282\u200b\u5b9e\u9a8c\u200b\u4e0e\u200b\u7406\u8bba\u8bfe\u200b\u7684\u200b \u201c\u200b\u6587\u4ef6\u200b\u4e0e\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u201d \u200b\u548c\u200b \u201cI/O\u200b\u4e0e\u200b\u5b58\u50a8\u200b\u201d \u200b\u8fd9\u200b\u4e24\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u76f8\u5173\u200b\uff0c\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u590d\u4e60\u200b\u8fd9\u200b\u4e24\u7ae0\u200b\u8bfe\u7a0b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u5173\u4e8e\u200b\u7b2c\u4e09\u6b21\u200b\u5b9e\u9a8c\u8bfe\u200b\u8003\u6838\u200b</p> <p>\u200b\u6211\u4eec\u200b\u5c06\u200b\u5728\u200b\u7b2c\u516d\u6b21\u200b\u5b9e\u9a8c\u8bfe\u200b\u8fdb\u884c\u200b\u7b2c\u4e09\u6b21\u200b\u5b9e\u9a8c\u200b\u73b0\u573a\u200b\u9a8c\u6536\u200b\uff1a  </p> <ul> <li> <p>\u200b\u9a8c\u6536\u200b\u5185\u5bb9\u200b \uff1aLab4 \u200b\u9875\u8868\u200b\uff0cLab5 \u200b\u57fa\u4e8e\u200bFUSE\u200b\u7684\u200b\u9752\u6625\u200b\u7248\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002  </p> </li> <li> <p>\u200b\u9a8c\u6536\u200b\u76ee\u7684\u200b \uff1a\u200b\u8003\u5bdf\u200b\u540c\u5b66\u200b\u4eec\u200b\u662f\u5426\u662f\u200b\u81ea\u5df1\u200b\u5b8c\u6210\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u201c\u200b\u590d\u5236\u200b\u62f7\u8d1d\u200b\u201d\u3002</p> </li> <li> <p>\u200b\u9a8c\u6536\u200b\u5f62\u5f0f\u200b \uff1a\u200b\u52a9\u6559\u200b\u4e0e\u200b\u540c\u5b66\u200b\u4eec\u200b\u8fdb\u884c\u200b\u4e00\u5bf9\u4e00\u200b\u95ee\u7b54\u200b\uff08\ud83d\udce2  \u200b\u6ce8\u200b\uff1aLab5\u200b\u9a8c\u6536\u200b\u65f6\u200b\u9700\u8981\u200b\u73b0\u573a\u200b\u6539\u200b\u4ee3\u7801\u200b \uff09\u3002</p> <ul> <li>duck\u200b\u4e0d\u5fc5\u200b\u62c5\u5fc3\u200b\uff0c\u200b\u53ea\u662f\u200b\u4fee\u6539\u200b\u51e0\u884c\u200b\u4ee3\u7801\u200b\uff1a\uff09</li> <li>\u200b\u5982\u679c\u200b\u5b9e\u9a8c\u200b\u4ee3\u7801\u200b\u662f\u200b\u4f60\u200b\u81ea\u5df1\u200b\u5199\u200b\u7684\u200b\uff0c\u200b\u90a3\u200b\u8fd9\u200b\u5c06\u200b\u662f\u200b\u4f60\u200b\u7684\u200b\u73b0\u573a\u200b\u79c0\u200b\uff01</li> </ul> </li> </ul> <p>\u200b\u8bf7\u200b\u540c\u5b66\u200b\u4eec\u200b\u8ba4\u771f\u5bf9\u5f85\u200b\uff01</p>"},{"location":"lab5/part1/#1","title":"1.  \u200b\u5b9e\u9a8c\u200b\u76ee\u7684","text":"<p>\u200b\u4ee5\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b EXT2 \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u719f\u6089\u200b\u8be5\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5185\u90e8\u200b\u6570\u636e\u7ed3\u6784\u200b\u7684\u200b\u7ec4\u7ec7\u200b\u65b9\u5f0f\u200b\u548c\u200b\u57fa\u672c\u200b\u5904\u7406\u200b\u6d41\u7a0b\u200b\uff0c\u200b\u5e76\u200b\u57fa\u4e8e\u200b FUSE \u200b\u8bbe\u8ba1\u200b\u5e76\u200b\u5b9e\u73b0\u200b\u4e00\u4e2a\u200b\u53ef\u4ee5\u200b \u200b\u771f\u6b63\u200b\u5728\u200bLinux\u200b\u4e0a\u200b\u8dd1\u200b \u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002</p>"},{"location":"lab5/part1/#2","title":"2.  \u200b\u5b9e\u9a8c\u200b\u5b66\u65f6","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e3a\u200b8\u200b\u5b66\u65f6\u200b\u3002</p>"},{"location":"lab5/part1/#3","title":"3.  \u200b\u5b9e\u9a8c\u200b\u5185\u5bb9","text":""},{"location":"lab5/part1/#31","title":"3.1 \u200b\u5fc5\u505a\u200b\u90e8\u5206","text":""},{"location":"lab5/part1/#311-ddriver-ddriver","title":"3.1.1 \u200b\u719f\u6089\u200bDDRIVER\u200b\u9a71\u52a8\u200b \uff08\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b-DDRIVER\u200b\u865a\u62df\u200b\u78c1\u76d8\u200b\u9a71\u52a8\u200b\uff09","text":"<p>\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u901a\u8fc7\u200b ddriver\uff08disk driver\uff09 \u200b\u9a71\u52a8\u200b\u6765\u200b\u8bbf\u95ee\u200bddriver\u200b\u8bbe\u5907\u200b\uff0c\u200b\u4ece\u800c\u200b\u7b80\u5316\u200b\u78c1\u76d8\u200b\u8bbf\u95ee\u200b\u64cd\u4f5c\u200b\u3002\u200b\u6b64\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u4fbf\u200b\u53ef\u4ee5\u200b\u5229\u7528\u200bddriver\u200b\u9a71\u52a8\u200b\u6765\u200b\u7f16\u5199\u200b\u81ea\u5df1\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002\u201c \u200b\u5de5\u6b32\u5584\u5176\u4e8b\u200b\uff0c\u200b\u5fc5\u5148\u5229\u5176\u5668\u200b \u201d\uff0c\u200b\u5728\u200b\u5b9e\u9a8c\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c \u200b\u8bf7\u200b\u52a1\u5fc5\u200b\u4fdd\u8bc1\u200b\u4f60\u200b\u5df2\u7ecf\u200b\u7406\u89e3\u200btests/test_ddriver.c\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7ed9\u51fa\u200b\u7684\u200b\u6848\u4f8b\u200b \u3002</p>"},{"location":"lab5/part1/#312-fuseext2-fuseext2","title":"3.1.2  \u200b\u57fa\u4e8e\u200bFUSE\u200b\u5b9e\u73b0\u200b\u9752\u6625\u200b\u7248\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff08\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b-FUSE\u200b\u4ecb\u7ecd\u200b\u4e0e\u200bExt2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u539f\u7406\u200b\u7b80\u4ecb\u200b\uff09","text":"<p>\u200b\u7cfb\u7edf\u7ed3\u6784\u200b\u53c2\u8003\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u8981\u6c42\u200b\u5177\u6709\u200b<code>SUPER_BLOCK</code>\u3001<code>DATA_MAP</code>\u3001<code>INODE_MAP</code>\u200b\u7b49\u200b\u4e3b\u8981\u200b\u7ed3\u6784\u200b\u3002\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u57fa\u4e8e\u200bFUSE\u200b\u67b6\u6784\u200b\uff0c\u200b\u8981\u6c42\u200b\u5c06\u200b\u81ea\u5df1\u200b\u8bbe\u8ba1\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u63a5\u5165\u200bFUSE\uff0c\u200b\u4f7f\u5f97\u200b\u6211\u4eec\u200b\u80fd\u591f\u200b\u5728\u200bLinux\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u76f4\u63a5\u200b\u8bbf\u95ee\u200b\u6211\u4eec\u200b\u81ea\u5df1\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u662f\u4e0d\u662f\u200b\u5f88\u9177\u200b\u70ab\u200b\u5462\u200b\uff1f\u200b\u8a00\u5f52\u6b63\u4f20\u200b\uff0c\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u4ec5\u200b\u8981\u6c42\u200b\u5b8c\u6210\u200b\u5982\u4e0b\u200b\u51e0\u4e2a\u200b\u529f\u80fd\u200b\uff1a</p> <ul> <li>\u200b\u6302\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1b</li> <li>\u200b\u5378\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1b</li> <li>\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b/\u200b\u6587\u4ef6\u5939\u200b\uff08\u200b\u6570\u636e\u200b\u5757\u200b\u53ef\u9884\u200b\u5206\u914d\u200b\uff09\uff1b</li> <li>\u200b\u67e5\u770b\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\u7684\u200b\u6587\u4ef6\u200b\uff08\u200b\u8bfb\u53d6\u200b\u6587\u4ef6\u5939\u200b\u5185\u5bb9\u200b\uff09\uff1b</li> </ul> <p>\u200b\u4e0a\u8ff0\u200b\u529f\u80fd\u200b\u5bf9\u5e94\u200b\u7684\u200b\u547d\u4ee4\u200b\u4e3a\u200b\uff1a</p> <ul> <li><code>mount</code></li> <li><code>umount</code></li> <li><code>touch/mkdir</code></li> <li><code>ls</code></li> </ul> <p>\u200b\u4ee5\u4e0a\u200b\u672a\u200b\u63d0\u53ca\u200b\u7684\u200b\u529f\u80fd\u200b\uff08\u200b\u5982\u200b\u590d\u5236\u200b\u3001\u200b\u5220\u9664\u200b\u3001\u200b\u8bfb\u5199\u200b\u6587\u4ef6\u200b\u7b49\u200b\uff09 \u200b\u4e0d\u200b\u8981\u6c42\u200b\u5b9e\u73b0\u200b \u3002 \u200b\u5177\u4f53\u200b\u8981\u6c42\u200b\u53c2\u89c1\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b \u3002</p>"},{"location":"lab5/part1/#32","title":"3.2 \u200b\u9009\u505a\u200b\u90e8\u5206","text":"<p>\u200b\u672c\u9009\u200b\u505a\u200b\u90e8\u5206\u200b\u4ec5\u4e3a\u200b\u5b66\u6709\u200b\u4f59\u529b\u200b\u7684\u200b\u5927\u4f6c\u200b\u79c0\u200b\u64cd\u4f5c\u200b\u63d0\u4f9b\u200b\u65b9\u5411\u200b\u3002\u200b\u4e3a\u200b\u9632\u6b62\u200b\u5185\u200b\u5377\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u672c\u200b\u90e8\u5206\u200b\u4e0d\u4f1a\u200b\u5e26\u200b \u200b\u6765\u200b\u989d\u5916\u200b\u52a0\u200b\u5206\u200b\uff08\u200b\u4f46\u200b\u6216\u8bb8\u200b\u4f1a\u200b\u6709\u200b\u5176\u4ed6\u200b\u610f\u60f3\u4e0d\u5230\u200b\u7684\u200b\u60ca\u559c\u200b\uff09\uff0c\u200b\u79c0\u200b\u7ffb\u8f66\u200b\u4e86\u200b\u4e5f\u200b\u4e0d\u4f1a\u200b\u6263\u5206\u200b\u3002</p> <ul> <li> <p>EXPERT\uff1a\u200b\u5b8c\u5584\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u57fa\u672c\u64cd\u4f5c\u200b</p> <ul> <li>\u200b\u6309\u9700\u5206\u914d\u200b \u200b\u6587\u4ef6\u200b\u6570\u636e\u200b\u5757\u200b</li> <li>\u200b\u95f4\u63a5\u200b\u7d22\u5f15\u200b\u548c\u200b\u4e8c\u7ea7\u200b\u95f4\u63a5\u200b\u7d22\u5f15\u200b</li> <li>\u200b\u5220\u9664\u200b\u64cd\u4f5c\u200b\uff08<code>rm</code>\u200b\u547d\u4ee4\u200b\uff0c\u200b\u9700\u8981\u200b\u652f\u6301\u200b<code>rm -r</code>\uff09</li> <li>\u200b\u6587\u4ef6\u200b\u79fb\u52a8\u200b\uff08<code>mv</code>\u200b\u547d\u4ee4\u200b\uff09</li> <li>\u200b\u8bfb\u5199\u200b\u6587\u4ef6\u200b\uff08\u200b\u652f\u6301\u200bvim\u3001vscode\u200b\u76f4\u63a5\u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\uff09</li> <li>\u200b\u8f6f\u786c\u200b\u8fde\u63a5\u200b\uff08<code>ln</code>\u200b\u547d\u4ee4\u200b\uff09</li> </ul> </li> <li> <p>SUPERME\uff1a\u200b\u4e1d\u6ed1\u200b\u7684\u200b\u6587\u4ef6\u200b\u8bfb\u5199\u200b\u4f53\u9a8c\u200b</p> <ul> <li>\u200b\u5b9e\u73b0\u200b\u7f13\u5b58\u200b\u7ed3\u6784\u200b\uff08\u200b\u53c2\u8003\u200b \u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b-\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u7b80\u4ecb\u200b \uff09</li> </ul> </li> <li> <p>EPIC\uff1a\u200b\u8d85\u5f3a\u200b\u7684\u200b\u9c81\u68d2\u6027\u200b</p> <ul> <li>\u200b\u542f\u52a8\u200b\u65f6\u200b\u68c0\u67e5\u200b\u7cfb\u7edf\u200b\u4e00\u81f4\u6027\u200b\uff08\u200b\u5b64\u513f\u200b\u8282\u70b9\u200b\u3001\u200b\u7a7a\u95f2\u200b\u8282\u70b9\u200b\u4e0e\u200b\u4f4d\u56fe\u200b\u662f\u5426\u200b\u4e00\u81f4\u200b\u3001\u200b\u66f4\u200b\u591a\u200b\u4e00\u81f4\u6027\u200b\u68c0\u6d4b\u200b\uff09</li> <li>\u200b\u574f\u5757\u200b\u8bc6\u522b\u200b\u4e0e\u200b\u5904\u7406\u200b\uff08\u200b\u52a8\u6001\u200b\u8bc6\u522b\u200b\u574f\u5757\u200b\uff0c\u200b\u5e76\u200b\u907f\u514d\u200b\u4f7f\u7528\u200b\uff09</li> <li>\u200b\u65e5\u5fd7\u200b\uff08\u200b\u53c2\u8003\u200b \u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b-\u200b\u65e5\u5fd7\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7b80\u4ecb\u200b \uff09</li> </ul> </li> </ul>"},{"location":"lab5/part1/#4","title":"4.  \u200b\u8fd0\u884c\u200b\u5b9e\u4f8b","text":"<p>\u200b\u672c\u200b\u5c0f\u8282\u200b\u7ed9\u51fa\u200b\u4e86\u200bsfs\uff08simplefs\uff09\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u8fd0\u884c\u200b\u793a\u4f8b\u200b\u3002\u200b\u4f60\u200b\u9700\u8981\u200b\u53c2\u7167\u200b\u8fd9\u4e2a\u200b\u793a\u4f8b\u200b\u8c03\u8bd5\u200b\u8fd0\u884c\u200b\u4f60\u200b\u81ea\u5df1\u200b\u7f16\u5199\u200b\u7684\u200b\u201cnewfs\u201d\uff08\u200b\u4f60\u200b\u81ea\u5df1\u200b\u7684\u200b\u9879\u76ee\u540d\u79f0\u200b\uff09\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u8c03\u8bd5\u200b\u8fd0\u884c\u200b\u53c2\u8003\u200b\u5b9e\u9a8c\u200b\u6b65\u9aa4\u200b\u7684\u200b\u9879\u76ee\u200b\u7f16\u8bd1\u200b\u3002\u200b\u5f53\u200b\u81ea\u6d4b\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u4f60\u200b\u8fd8\u200b\u9700\u8981\u200b\u901a\u8fc7\u200b./tests/test.sh\u200b\u811a\u672c\u200b\u7684\u200b\u57fa\u7840\u200b\u529f\u80fd\u6d4b\u8bd5\u200b\uff0c\u200b\u663e\u793a\u200b\u201c\u200b\u606d\u559c\u200b\u4f60\u200b\uff0c\u200b\u901a\u8fc7\u200b\u6240\u6709\u200b\u6d4b\u8bd5\u200b\u201d\uff0c\u200b\u5373\u53ef\u200b\u5b8c\u6210\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u3002</p> <p>bilibili\u200b\u4e0a\u200b\u89c2\u770b\u200b\uff1ahttps://www.bilibili.com/video/BV1KB4y1z7f2/?spm_id_from=333.999.0.0</p> <p>\u200b\u4e3a\u4e86\u200b\u7ed9\u200b\u540c\u5b66\u200b\u4eec\u200b\u6f14\u793a\u200b\u5982\u4f55\u200b\u4e0b\u8f7d\u200b\u3001\u200b\u7f16\u8bd1\u200b\u3001\u200b\u8fd0\u884c\u200bsimplefs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u6211\u4eec\u200b\u5f55\u5236\u200b\u4e86\u200b\u4e24\u4e2a\u200b\u6f14\u793a\u200b\u89c6\u9891\u200b\uff1a\u201cHITSZ FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5b9e\u9a8c\u200b\uff08\u200b\u672c\u5730\u200b\u7248\u200b\uff09\u201d\u200b\u548c\u200b\u201cHITSZ FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff08\u200b\u8fdc\u7a0b\u200b\u8ba1\u7b97\u200b\u8282\u70b9\u200b\u7248\u200b\uff09\u201d\u3002</p> <p>\u200b\u5982\u679c\u200b\u89c6\u9891\u200b\u4e0d\u592a\u200b\u6e05\u6670\u200b\uff0c\u200b\u5efa\u8bae\u200b\u5230\u200bbilibili\u200b\u4e0a\u200b\u89c2\u770b\u200b\u3002</p> <p>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5b9e\u9a8c\u200b\uff08\u200b\u672c\u5730\u200b\u7248\u200b\uff09\uff1ahttps://www.bilibili.com/video/BV1Af4y1K7FX/</p> <p>HITSZ FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff08\u200b\u8fdc\u7a0b\u200b\u8ba1\u7b97\u200b\u8282\u70b9\u200b\u7248\u200b\uff09\uff1ahttps://www.bilibili.com/video/BV1TR4y1b7M3/</p>"},{"location":"lab5/part2/","title":"\u5b9e\u9a8c\u200b\u539f\u7406","text":""},{"location":"lab5/part2/#1-ext2","title":"1.  EXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u539f\u7406\u200b\u7b80\u4ecb","text":""},{"location":"lab5/part2/#11","title":"1.1  \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u662f\u200b\u4ec0\u4e48","text":"<p>\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u662f\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7528\u4e8e\u200b\u660e\u786e\u200b \u200b\u5b58\u50a8\u8bbe\u5907\u200b\uff08\u200b\u78c1\u76d8\u200b\uff09\u200b\u6216\u200b \u200b\u5206\u533a\u200b \u200b\u4e0a\u200b\u7684\u200b \u200b\u6587\u4ef6\u200b\uff08\u200b\u5305\u62ec\u200b\u6587\u4ef6\u200b\u3001\u200b\u76ee\u5f55\u200b\u3001\u200b\u5feb\u6377\u65b9\u5f0f\u200b\u7b49\u200b\uff09 \u200b\u7684\u200b\u65b9\u6cd5\u200b\u548c\u200b\u6570\u636e\u7ed3\u6784\u200b\uff0c\u200b\u5373\u200b \u200b\u5728\u200b\u7279\u5b9a\u200b\u5b58\u50a8\u8bbe\u5907\u200b\u4e0a\u200b\u7ec4\u7ec7\u200b\u6587\u4ef6\u200b\u7684\u200b\u65b9\u6cd5\u200b \u3002 \u200b\u7b80\u5355\u200b\u5730\u8bf4\u200b \uff0c\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5c31\u662f\u200b\u5728\u200b \u200b\u7279\u5b9a\u200b\u5b58\u50a8\u8bbe\u5907\u200b\u4e0a\u200b\u7ec4\u7ec7\u200b\u6587\u4ef6\u200b \u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002</p> <p>\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u4e3b\u8981\u200b\u4f5c\u7528\u200b \uff1a</p> <ol> <li> <p>\u200b\u7ba1\u7406\u200b\u548c\u200b\u8c03\u5ea6\u200b \u200b\u8bbe\u5907\u200b\u7684\u200b\u5b58\u50a8\u7a7a\u95f4\u200b \uff0c\u200b\u63d0\u4f9b\u200b\u6587\u4ef6\u200b\u7684\u200b\u903b\u8f91\u200b\u7ed3\u6784\u200b\u3001\u200b\u7269\u7406\u200b\u7ed3\u6784\u200b\u548c\u200b\u5b58\u50a8\u200b\u65b9\u6cd5\u200b;</p> </li> <li> <p>\u200b\u5b9e\u73b0\u200b\u6587\u4ef6\u200b \u200b\u4ece\u200b\u6807\u8bc6\u200b\u5230\u200b\u5b9e\u9645\u200b\u5730\u5740\u200b\u7684\u200b\u6620\u5c04\u200b \uff0c\u200b\u5b9e\u73b0\u200b\u6587\u4ef6\u200b\u7684\u200b\u63a7\u5236\u200b\u64cd\u4f5c\u200b\u548c\u200b\u5b58\u53d6\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u63d0\u9ad8\u200b \u200b\u4ece\u200b\u8bbe\u5907\u200b\u4e0a\u200b\u67e5\u627e\u200b\u6570\u636e\u200b \u200b\u7684\u200b\u6548\u7387\u200b\uff1b</p> </li> <li> <p>\u200b\u5b9e\u73b0\u200b\u6587\u4ef6\u200b\u4fe1\u606f\u200b\u7684\u200b\u5171\u4eab\u200b\u5e76\u200b\u63d0\u4f9b\u200b\u53ef\u9760\u200b\u7684\u200b \u200b\u6587\u4ef6\u200b\u4fdd\u5bc6\u200b\u548c\u200b\u4fdd\u62a4\u63aa\u65bd\u200b \uff0c\u200b\u63d0\u4f9b\u200b\u6587\u4ef6\u200b\u7684\u200b \u200b\u5b89\u5168\u63aa\u65bd\u200b \u3002</p> </li> <li> <p>\u200b\u4f18\u5316\u200b\u8bbe\u5907\u200b\u7a7a\u95f4\u200b\u5229\u7528\u7387\u200b\uff1b</p> </li> </ol> <p>\u200b\u76ee\u524d\u200b\u5728\u200b\u5404\u79cd\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e2d\u200b\u5b58\u5728\u200b\u7740\u200b\u5404\u79cd\u5404\u6837\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u5728\u200bWindows\u200b\u5e73\u53f0\u200b\u4e3b\u6d41\u200b\u6709\u200b\uff1a FAT\u3001FAT16\u3001FAT32\u3001NTFS \u200b\u7b49\u200b\uff1b\u200b\u5728\u200bUnix\u200b\u5e73\u53f0\u200b\u4e3b\u6d41\u200b\u7684\u200b\u6709\u200b\uff1a EXT2\u3001EXT3\u3001EXT4 \u200b\u7b49\u200b\u3002\u200b\u8fd9\u4e9b\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5728\u200b \u200b\u7ba1\u7406\u200b\u78c1\u76d8\u200b\u8bbe\u5907\u200b \u200b\u65f6\u200b\u90fd\u200b\u6709\u200b\u5404\u81ea\u200b\u7684\u200b\u4e00\u5957\u200b\u7b56\u7565\u200b\u548c\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u968f\u4e4b\u200b\u4e5f\u200b\u5e26\u6765\u200b\u4e0d\u540c\u200b\u7684\u200b\u4f18\u7f3a\u70b9\u200b\u3002 EXT2 \u200b\u662f\u200bGNU/Linux\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u6807\u51c6\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u5176\u200b\u7279\u70b9\u200b\u662f\u200b \u200b\u5b58\u53d6\u200b\u6587\u4ef6\u200b\u7684\u200b\u6027\u80fd\u200b\u8f83\u200b\u597d\u200b \uff0c\u200b\u5bf9\u4e8e\u200b\u4e2d\u5c0f\u578b\u200b\u7684\u200b\u6587\u4ef6\u200b\u66f4\u200b\u663e\u793a\u200b\u5176\u200b\u4f18\u52bf\u200b\u3002\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4ee5\u200b EXT2 \u200b\u4e3a\u200b\u6a21\u677f\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u4e00\u4e2a\u200b\u9752\u6625\u200b\u7248\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002</p>"},{"location":"lab5/part2/#12","title":"1.2  \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u57fa\u672c\u64cd\u4f5c","text":""},{"location":"lab5/part2/#121","title":"1.2.1  \u200b\u6302\u8f7d","text":"<p>\u200b\u8fd9\u91cc\u200b\u6709\u200b\u66f4\u200b\u591a\u200b\u8bb2\u89e3\u200b\u6302\u8f7d\u200b\u7684\u200b\u8d44\u6599\u200b</p> <p>\u200b\u901a\u5e38\u200b\u6765\u8bb2\u200b\uff0c\u200b\u4f7f\u7528\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u7b2c\u4e00\u6b65\u200b\u662f\u200b \u200b\u6302\u8f7d\u200b\uff08mount\uff09 \uff0c\u200b\u90a3\u4e48\u200b\uff0c\u200b\u4e3a\u4ec0\u4e48\u200b\u6211\u4eec\u200b\u5728\u200b\u4f7f\u7528\u200bLinux\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u6ca1\u6709\u200b\u8fd9\u4e2a\u200b\u6b65\u9aa4\u200b\u5462\u200b\uff1f\u200b\u8fd9\u662f\u200b\u7531\u4e8e\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u4e3a\u4e86\u200b\u7b80\u5316\u200b\u7528\u6237\u200b\u64cd\u4f5c\u200b\uff0c \u200b\u81ea\u52a8\u200b\u5e2e\u52a9\u200b \u200b\u6211\u4eec\u200b\u8fdb\u884c\u200b\u4e86\u200b\u8fd9\u4e2a\u200b\u6b65\u9aa4\u200b\u3002\u200b\u76f8\u5173\u200b\u6587\u4ef6\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>/etc/fstab</code>\u200b\u4e2d\u200b\u67e5\u770b\u200b\uff1a</p> <pre><code>[root@localhost tests]# cat /etc/fstab #\n# /etc/fstab\n# Created by anaconda on Sun Oct  3 03:53:55 2021\n#\n# Accessible filesystems, by reference, are maintained under '/dev/disk/'.\n# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.\n#\n# After editing this file, run 'systemctl daemon-reload' to update systemd\n# units generated from this file.\n#\n/dev/mapper/openeuler-root /                       ext4    defaults        1 1\nUUID=ee2c1ea8-62de-4241-8742-7cba36a7eaf9 /boot    ext4    defaults        1 2\n/dev/mapper/openeuler-swap none                    swap    defaults        0 0\n</code></pre> <p>\u200b\u8fd9\u91cc\u200b\u4ee5\u200b\u7b2c\u4e00\u200b\u884c\u4e3a\u200b\u4f8b\u200b\uff0c\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5c06\u200b\u8bbe\u5907\u200b<code>/dev/mapper/openeuler-root</code>\u200b\u4ee5\u200b EXT4 \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5f62\u5f0f\u200b\uff0c\u200b\u6302\u8f7d\u200b\u5230\u200b\u6839\u76ee\u5f55\u200b<code>/</code>\u200b\u4e0b\u200b\uff0c\u200b\u4ece\u800c\u200b\u8ba9\u200b\u6211\u4eec\u200b\u6709\u200b\u4e86\u200b\u8bbf\u95ee\u200b<code>/dev/mapper/openeuler-root</code>\u200b\u5b58\u50a8\u8bbe\u5907\u200b\u7684\u200b\u80fd\u529b\u200b\u3002</p> <p>\u200b\u7b49\u7b49\u200b \uff0c\u200b\u4ec0\u4e48\u200b\u53eb\u200b \u200b\u5c06\u200b\u8bbe\u5907\u200bxxx \u200b\u4ee5\u200b xxx\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u5f62\u5f0f\u200b\uff0c \u200b\u6302\u8f7d\u200b \u200b\u5230\u200b xxx\u200b\u76ee\u5f55\u200b \u200b\u4e0b\u200b\uff1f\u200b\u6302\u8f7d\u200b\u5230\u5e95\u200b\u662f\u200b\u4ec0\u4e48\u200b\uff1f\u200b\u6211\u4eec\u200b\u6765\u200b\u4e3e\u4e2a\u200b\u4f8b\u5b50\u200b\u4f83\u4e00\u4f83\u200b\u3002</p> <ul> <li>Step1\uff1a\u200b\u5047\u8bbe\u200b\u6211\u4eec\u200b\u73b0\u5728\u200b\u624b\u91cc\u200b\u6709\u200b\u4e00\u4e2a\u200b\u91d1\u58eb\u987f\u200bU\u200b\u76d8\u200b</li> </ul> <p> </p> <ul> <li>Step2\uff1a\u200b\u73b0\u5728\u200b\uff0c\u200b\u6211\u4eec\u200b\u5728\u200b\u4e3b\u673a\u200b\u4e0a\u200b\u63d2\u5165\u200b\u8fd9\u4e2a\u200bU\u200b\u76d8\u200b</li> </ul> <p>\u200b\u5728\u200b Windows \u200b\u7cfb\u7edf\u200b\u4e0a\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u4e0b\u9762\u200b\u7684\u200b\u663e\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u5e73\u65f6\u200b\u53ef\u80fd\u200b\u6ca1\u6709\u200b\u6ce8\u610f\u200b \uff0c\u200b\u4f46\u200b\u8fd9\u65f6\u200b\uff0c\u200b\u4f60\u200b\u53ef\u80fd\u200b\u6ce8\u610f\u200b\u5230\u200b\u4e86\u200b\u91d1\u58eb\u987f\u200bU\u200b\u76d8\u200b\u7684\u200b \u200b\u5c5e\u6027\u200b \u200b\u4e2d\u200b\uff0c\u200b\u6709\u200b\u4e00\u680f\u200b\u544a\u8bc9\u200b\u4e86\u200b\u6211\u4eec\u200b\u8fd9\u4e2a\u200bU\u200b\u76d8\u200b\u662f\u200b FAT32\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u3002</p> <p>\u200b\u4e8b\u5b9e\u4e0a\u200b \uff0c\u200b\u5f53\u200b\u6211\u4eec\u200b\u63d2\u5165\u200bU\u200b\u76d8\u540e\u200b\uff0cWindows \u200b\u81ea\u52a8\u8bc6\u522b\u200b \u200b\u51fa\u8be5\u200bU\u200b\u76d8\u200b\u4e0a\u200b\u6587\u4ef6\u200b\u5b58\u50a8\u200b\u7684\u200b\u683c\u5f0f\u200b\u662f\u200bFAT32\uff0c\u200b\u56e0\u6b64\u200b \u200b\u5b83\u200b\u81ea\u52a8\u200b\u5c06\u200b\u91d1\u58eb\u987f\u200bU\u200b\u76d8\u4ee5\u200bFAT32\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u683c\u5f0f\u200b\u6302\u8f7d\u200b\u5230\u200b\u4e86\u200bWindows\u200b\u76ee\u5f55\u200b\u7ed3\u6784\u200b \u200b\u4e2d\u200b\u3002</p> <p>\u200b\u800c\u200b\u5728\u200b Linux \u200b\u7cfb\u7edf\u200b\u4e0a\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u80fd\u200b\u5e76\u200b\u6ca1\u6709\u200b\u8fd9\u4e48\u200b\u597d\u200b\u7684\u200b\u7528\u6237\u200b\u4f53\u9a8c\u200b\uff0c\u200b\u5f53\u200b\u63d2\u5165\u200b\u91d1\u58eb\u987f\u200bU\u200b\u76d8\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ea\u200b\u53d1\u73b0\u200b\u5728\u200b<code>/dev</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u591a\u51fa\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5f02\u7c7b\u200b\uff1a</p> <p></p> <p>\u200b\u4e00\u822c\u6765\u8bf4\u200b\uff0c\u200b\u8bbe\u5907\u200b<code>sdb1</code>\u200b\u88c5\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbe\u5907\u200b\u3002\u200b\u90a3\u4e48\u200b\uff0c\u200b\u6211\u4eec\u200b \u200b\u662f\u5426\u200b\u53ef\u4ee5\u200b\u5411\u200bWindows\u200b\u90a3\u6837\u200b\uff0c\u200b\u76f4\u63a5\u200b\u5bf9\u200b\u5b83\u200b\u8bbf\u95ee\u200b\u5462\u200b \uff1f\u200b\u6765\u200b\u8bd5\u8bd5\u200b\uff1a</p> <pre><code>[root@localhost dev]# cd sdb1\nbash: cd: sdb1: Not a directory\n[root@localhost dev]# ls sdb1/\nls: cannot access 'sdb1/': Not a directory\n</code></pre> <p>\u200b\u5f88\u200b\u9057\u61be\u200b\uff0c\u200b\u5e76\u200b\u4e0d\u884c\u200b\u3002\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b U\u200b\u76d8\u200bsdb1 \u200b\u8fd8\u200b\u6ca1\u6709\u200b\u88ab\u200b \u200b\u6302\u8f7d\u200b \u200b\u5230\u200bLinux\u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u6b64\u65f6\u200bLinux\u200b\u4e0d\u200b\u77e5\u9053\u200b\u8fd9\u4e2a\u200bU\u200b\u76d8\u200b\u91cc\u9762\u200b\u7684\u200b\u6587\u4ef6\u200b\u662f\u200b\u4ec0\u4e48\u200b\uff0c\u200b\u53ea\u80fd\u200b\u77e5\u9053\u200b\u8fd9\u91cc\u200b\u8fd9\u4e2a\u200b\u6709\u4e2a\u200bU\u200b\u76d8\u200b\u8bbe\u5907\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\u8fd9\u4e2a\u200bU\u200b\u76d8\u91cc\u88c5\u200b\u7684\u200b\u662f\u200b FAT32 \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u5728\u200bLinux\u200b\u4e2d\u200b\uff0c FAT32 \u200b\u53c8\u540d\u200b VFAT \uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5c1d\u8bd5\u200b \u200b\u5c06\u200b\u8bbe\u5907\u200bsdb1 \u200b\u4ee5\u200b VFAT\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u5f62\u5f0f\u200b\uff0c \u200b\u6302\u8f7d\u200b \u200b\u5230\u200b /mnt\u200b\u76ee\u5f55\u200b \u200b\u4e0b\u200b\uff0c\u200b\u901a\u8fc7\u200b\u8bbf\u95ee\u200b /mnt \u200b\u76ee\u5f55\u200b\u6765\u200b \u200b\u67e5\u770b\u200bU\u200b\u76d8\u4e2d\u200b\u7684\u200b\u6587\u4ef6\u200b \uff1a</p> <pre><code>[root@localhost dev]# mount -t vfat sdb1 /mnt/\n[root@localhost dev]# ls /mnt/\n'???'                         '????PPT.pptx'\n'?????'                       '???????.pptx'\n'??????'                      '???_???_??_??_????.pptx'\n'???????'                      pynq_z2_v2.6.0.zip\n'????????'                     Deadpool\n</code></pre> <p>\u200b\u8fd8\u200b\u771f\u6210\u4e86\u200b\uff01</p> <ul> <li>Step3\uff1a\u200b\u73b0\u5728\u200b\uff0c\u200b\u6211\u4eec\u200b\u6765\u7f15\u200b\u4e00\u7f15\u200b\u6302\u8f7d\u200b\u7684\u200b\u903b\u8f91\u200b</li> </ul> <p>\u200b\u9996\u5148\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5c06\u200bU\u200b\u76d8\u200b\u62bd\u8c61\u200b\u770b\u4f5c\u200b\u4e00\u6bb5\u200b\u8fde\u7eed\u200b\u7684\u200b\u5b58\u50a8\u7a7a\u95f4\u200b\uff1a</p> <p></p> <p>\u200b\u8fd9\u4e2a\u200b\u7269\u7406\u200b\u5b58\u50a8\u7a7a\u95f4\u200b\u4e0a\u7528\u200b FAT32\u200b\u7c7b\u578b\u200b \u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4fdd\u5b58\u200b\u7740\u200b\u8bb8\u591a\u200b\u6587\u4ef6\u200b\uff08\u200b\u53ef\u80fd\u200bFAT32\u200b\u6587\u4ef6\u200b\u5e03\u5c40\u200b\u4e0d\u200b\u957f\u200b\u4e0b\u9762\u200b\u8fd9\u6837\u200b\uff0c \u200b\u4e0d\u8fc7\u200b\u5dee\u4e0d\u591a\u200b\u7406\u89e3\u200b\u5c31\u884c\u4e86\u200b \uff09</p> <p></p> <p>\u200b\u63a5\u7740\u200b\uff0c\u200b\u6211\u4eec\u200b\u4f7f\u7528\u200b<code>mount</code>\u200b\u547d\u4ee4\u200b\u544a\u8bc9\u200bLinux\uff0c\u200b\u8fd9\u4e2a\u200bU\u200b\u76d8\u7528\u200b\u7684\u200b\u662f\u200bFAT32\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c \u200b\u4f60\u200b\u7528\u200bFAT32\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4ee3\u7801\u200b\u89c4\u5219\u200b\u6765\u200b\u8bbf\u95ee\u200b\u5b83\u200b\u5c31\u884c\u4e86\u200b \u3002\u200b\u63a5\u7740\u200b\uff0c\u200b\u6211\u4eec\u200b\u540c\u6837\u200b\u8981\u200b\u8bf4\u660e\u200b\u6211\u4eec\u200b\u60f3\u200b \u200b\u5c06\u200b\u54ea\u4e2a\u200b\u76ee\u5f55\u200b\u4f5c\u4e3a\u200b\u8bbf\u95ee\u200bU\u200b\u76d8\u200b\u7684\u200b\u5165\u53e3\u200b \uff0c\u200b\u5c31\u200b\u5728\u200b /mnt \u200b\u76ee\u5f55\u200b\u4e0b\u200b\u5427\u200b\uff01\u200b\u4e8e\u662f\u200b\uff0c\u200b\u6211\u4eec\u200b\u4fbf\u200b\u53ef\u4ee5\u200b\u5728\u200b /mnt \u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u4ee5\u200b FAT32 \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u6765\u200b\u8bbf\u95ee\u200bU\u200b\u76d8\u4e0a\u200b\u7684\u200b\u6587\u4ef6\u200b\u4e86\u200b\u3002</p> <p>\u200b\u5728\u200b\u6211\u4eec\u200b\u7528\u6237\u200b\u6765\u770b\u200b\uff0c\u200b\u6302\u8f7d\u200b\u4e86\u200bU\u200b\u76d8\u540e\u200b\uff0cLinux\u200b\u7684\u200b\u76ee\u5f55\u200b\u6811\u200b\u5c31\u200b\u53d8\u6210\u200b\u4e0b\u9762\u200b\u8fd9\u4e2a\u200b\u6837\u5b50\u200b\u4e86\u200b\uff1a</p> <p></p>"},{"location":"lab5/part2/#122","title":"1.2.2  \u200b\u5378\u8f7d","text":"<p>\u200b\u5378\u8f7d\u200b\u64cd\u4f5c\u200b \u200b\u4e0e\u200b \u200b\u6302\u8f7d\u200b\u64cd\u4f5c\u200b \u200b\u76f8\u5bf9\u200b\u5e94\u200b\uff0c\u200b\u5728\u200bWindows\u200b\u4e0a\u200b\u6765\u8bf4\u200b\uff0c\u200b\u5c31\u200b\u7c7b\u4f3c\u200b\u4e8e\u200b \u201d\u200b\u53f3\u952e\u200bU\u200b\u76d8\u200b\uff0c\u200b\u5b89\u5168\u200b\u5f39\u200b\u51fa\u200b\u201c \u200b\u4e00\u6837\u200b\u3002\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5728\u200b\u5f00\u53d1\u200b\u7684\u200b\u65f6\u5019\u200b\u90fd\u200b\u8981\u200b\u8bbe\u8ba1\u200b\u5bf9\u5e94\u200b\u7684\u200b \u200b\u6302\u8f7d\u200b\u4e0e\u200b\u5378\u8f7d\u200b \u200b\u65b9\u6cd5\u200b\uff0c\u200b\u5b83\u4eec\u200b\u9700\u8981\u200b \u200b\u5728\u200b\u5378\u8f7d\u200b\u65f6\u200b \u200b\u4fdd\u5b58\u200b\u8bbe\u5907\u200b\u7684\u200b\u5fc5\u8981\u200b\u72b6\u6001\u200b\uff08\u200b\u6bd4\u5982\u200b \u200b\u5f53\u524d\u200b\u8bbe\u5907\u200b\u7684\u200b\u7a7a\u95f2\u200b\u5927\u5c0f\u200b \u200b\u7b49\u200b\uff09\u3002 \u200b\u4e0d\u200b\u6b63\u5e38\u200b\u7684\u200b\u5378\u8f7d\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u9c81\u68d2\u6027\u200b\u5dee\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u76f4\u63a5\u200b\u5d29\u6e83\u200b\uff0c\u200b\u4e5f\u5c31\u662f\u8bf4\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u7684\u200b\u6302\u8f7d\u200b\u5f88\u200b\u53ef\u80fd\u200b\u76f4\u63a5\u200b\u5931\u8d25\u200b</p> <p>\u200b\u5728\u200bLinux\u200b\u4e2d\u200b\uff0c\u200b\u5378\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u65b9\u5f0f\u200b\u5982\u4e0b\u200b\uff0c\u200b\u6211\u4eec\u200b\u8fd8\u662f\u200b\u4ee5\u200b\u521a\u624d\u200b\u6302\u8f7d\u200b\u7684\u200b\u91d1\u58eb\u987f\u200bU\u200b\u76d8\u4e3a\u4f8b\u200b\uff1a</p> <pre><code>[root@localhost dev]# umount /mnt/\n[root@localhost dev]# ls /mnt/\n[root@localhost dev]#\n</code></pre> <p>\u200b\u6b64\u65f6\u200b\uff0cU\u200b\u76d8\u200b\u5bf9\u5e94\u200b\u7684\u200b\u6240\u6709\u200b\u6587\u4ef6\u200b\u4ece\u200bLinux\u200b\u76ee\u5f55\u200b\u6811\u4e2d\u200b\u79fb\u9664\u200b\uff0c\u200b\u6211\u4eec\u200b\u4fbf\u200b\u53ef\u4ee5\u200b \u200b\u6b63\u5e38\u200b\u62d4\u9664\u200bU\u200b\u76d8\u200b \u200b\u4e86\u200b\u3002</p>"},{"location":"lab5/part2/#123","title":"1.2.3  \u200b\u66f4\u200b\u591a\u200b\u64cd\u4f5c","text":"<p>\u200b\u5176\u4ed6\u200b\u66f4\u200b\u591a\u200b\u76f8\u5173\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u64cd\u4f5c\u200b\u90fd\u200b\u6bd4\u8f83\u200b\u5e38\u89c1\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u5c06\u200b\u4e00\u4e9b\u200b\u5e38\u7528\u200b\u6307\u4ee4\u200b\u518d\u200b\u7b80\u5355\u200b\u63d0\u200b\u4e00\u4e0b\u200b\uff1a</p> <ul> <li><code>ls</code></li> </ul> <p><code>ls</code>\u200b\u6307\u4ee4\u200b\u662f\u200b<code>list</code>\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u5176\u200b\u529f\u80fd\u200b\u5c31\u662f\u200b \u200b\u5217\u51fa\u200b\u6307\u5b9a\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b\u6240\u6709\u200b\u6587\u4ef6\u200b/\u200b\u76ee\u5f55\u200b \uff0c\u200b\u5927\u5bb6\u200b\u5728\u200b\u5b66\u4e60\u200b xv6 \u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u4e5f\u200b\u6709\u6240\u200b\u63a5\u89e6\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u4e0d\u200b\u5728\u200b\u4ecb\u7ecd\u200b\uff1b</p> <ul> <li><code>mv</code></li> </ul> <p><code>mv</code>\u200b\u6307\u4ee4\u200b\u662f\u200b<code>move</code>\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u5176\u200b\u529f\u80fd\u200b\u662f\u200b \u200b\u526a\u5207\u200b \u200b\u67d0\u4e2a\u200b\u6587\u4ef6\u200b\u3002\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c<code>mv</code>\u200b\u6307\u4ee4\u200b\u8fd8\u200b\u5e38\u5e38\u200b\u88ab\u200b\u7528\u4e8e\u200b \u200b\u6587\u4ef6\u200b\u7684\u200b\u91cd\u547d\u540d\u200b \u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> <pre><code>[root@localhost mnt]# touch her\n[root@localhost mnt]# ls\nher\n[root@localhost mnt]# mv her me\n[root@localhost mnt]# ls\nme\n[root@localhost mnt]#\n</code></pre> <ul> <li><code>cp</code></li> </ul> <p><code>cp</code>\u200b\u6307\u4ee4\u200b\u662f\u200b<code>copy</code>\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u5176\u200b\u529f\u80fd\u200b\u662f\u200b \u200b\u590d\u5236\u200b \u200b\u67d0\u4e2a\u200b\u6587\u4ef6\u200b\uff0c<code>cp -r</code>\u200b\u53ef\u4ee5\u200b\u590d\u5236\u200b\u76ee\u5f55\u200b\uff1b</p> <ul> <li><code>rm</code></li> </ul> <p><code>rm</code>\u200b\u6307\u4ee4\u200b\u662f\u200b<code>remove</code>\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u5176\u200b\u529f\u80fd\u200b\u662f\u200b \u200b\u5220\u9664\u200b \u200b\u67d0\u4e2a\u200b\u6587\u4ef6\u200b\uff0c\u200b\u540c\u6837\u200b<code>rm -r</code>\u200b\u53ef\u4ee5\u200b\u5220\u9664\u200b\u76ee\u5f55\u200b\u3002\u200b\u5f53\u7136\u200b\uff0c\u200b\u6709\u200b\u4e00\u4e2a\u200b\u4e1a\u754c\u200b\u6897\u200b\uff1a <code>rm -rf</code> \u200b\u5220\u5e93\u200b\u8dd1\u200b\u8def\u200b \uff0c\u200b\u8fd9\u91cc\u200b<code>f</code>\u200b\u4ee3\u8868\u200b<code>force</code>\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u5f3a\u5236\u200b\u5220\u9664\u200b\u3002\u200b\u5982\u679c\u200b\u4f60\u200b\u4e00\u4e0d\u5c0f\u5fc3\u200b\u4f7f\u7528\u200b\u4e86\u200b<code>rm -rf /</code>\uff0c\u200b\u90a3\u4e48\u200b\u4f60\u200b\u7684\u200bLinux\u200b\u56de\u5929\u4e4f\u672f\u200b\u4e86\u200b\uff1b</p> <ul> <li><code>cd</code></li> </ul> <p><code>cd</code>\u200b\u6307\u4ee4\u200b\u662f\u200b<code>change directory</code>\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u6211\u4eec\u200b\u7ecf\u5e38\u200b\u4f7f\u7528\u200b<code>cd</code>\u200b\u6307\u4ee4\u200b\u6765\u200b\u8fdb\u884c\u200b\u8def\u5f84\u200b\u7684\u200b\u5207\u6362\u200b\uff1b</p> <ul> <li><code>--help</code></li> </ul> <p>\u200b\u4e0a\u9762\u200b\u8bf4\u200b\u4e86\u200b\u4e00\u5927\u5806\u200b\uff0c\u200b\u4f46\u200b\u8fdc\u8fdc\u200b\u8fd8\u200b\u6ca1\u200b\u628a\u200b\u6240\u6709\u200b\u547d\u4ee4\u200b\u90fd\u200b\u4ecb\u7ecd\u200b\u5f97\u200b\u5b8c\u6574\u200b\u3001\u200b\u6e05\u695a\u200b\uff0c\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u547d\u4ee4\u200b\u90fd\u200b\u6709\u200b\u4e2a\u200b<code>--help</code>\u200b\u53c2\u6570\u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u67e5\u770b\u200b<code>--help</code>\u200b\u53ef\u4ee5\u200b\u5f88\u5feb\u200b\u8ba9\u200b\u4f60\u200b\u77e5\u9053\u200b\u5404\u4e2a\u200b\u547d\u4ee4\u200b\u7684\u200b\u7528\u6cd5\u200b\u3001\u200b\u53c2\u6570\u200b\u7684\u200b\u610f\u4e49\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> <pre><code>[root@localhost mnt]# ln --help\nUsage: ln [OPTION]... [-T] TARGET LINK_NAME\n  or:  ln [OPTION]... TARGET\n  or:  ln [OPTION]... TARGET... DIRECTORY\n  or:  ln [OPTION]... -t DIRECTORY TARGET..\n...\n</code></pre> <ul> <li><code>ln</code></li> </ul> <p>ln\u200b\u662f\u200blink\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u4f7f\u7528\u200b\u6b64\u200b\u547d\u4ee4\u200b\u7528\u6765\u200b\u4e3a\u200b\u6587\u4ef6\u200b\u521b\u4ef6\u200b\u94fe\u63a5\u200b\uff0c\u200b\u8fde\u63a5\u200b\u7c7b\u578b\u200b\u5206\u4e3a\u200b\u786c\u200b\u94fe\u63a5\u200b\u548c\u200b\u8f6f\u200b\u94fe\u63a5\u200b\u4e24\u79cd\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u7684\u200b\u8fde\u63a5\u200b\u7c7b\u578b\u200b\u662f\u200b\u786c\u200b\u94fe\u63a5\u200b\u3002\u200b\u786c\u200b\u94fe\u63a5\u200b\u8bf4\u767d\u4e86\u200b\u662f\u200b\u4e00\u4e2a\u200b\u6307\u9488\u200b\uff0c\u200b\u6307\u5411\u200b\u6587\u4ef6\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b\uff0c\u200b\u7cfb\u7edf\u200b\u5e76\u200b\u4e0d\u200b\u4e3a\u200b\u5b83\u200b\u91cd\u65b0\u5206\u914d\u200binode\uff1b\u200b\u8f6f\u200b\u94fe\u63a5\u200b\u53c8\u200b\u53eb\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u6587\u4ef6\u200b\u5305\u542b\u200b\u4e86\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u7684\u200b\u8def\u5f84\u540d\u200b\u3002\u200b\u53ef\u4ee5\u200b\u662f\u200b\u4efb\u610f\u200b\u6587\u4ef6\u200b\u6216\u200b\u76ee\u5f55\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u94fe\u63a5\u200b\u4e0d\u540c\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u548c\u200bwin\u200b\u4e0b\u200b\u7684\u200b\u5feb\u6377\u65b9\u5f0f\u200b\u5dee\u4e0d\u591a\u200b\u3002</p>"},{"location":"lab5/part2/#13-ext2","title":"1.3  EXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u6784\u6210","text":"<p>\u200b\u4ecb\u7ecd\u200b\u5b8c\u200b\u4e86\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4ee5\u53ca\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u57fa\u672c\u64cd\u4f5c\u200b\uff0c\u200b\u6211\u4eec\u200b\u6765\u200b\u6b63\u5f0f\u200b\u770b\u770b\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002</p> <p>EXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5e38\u5e38\u200b\u88ab\u200b\u7528\u4e8e\u200b \u200b\u78c1\u76d8\u200b\u8bbe\u5907\u200b \u200b\u7684\u200b\u8bbf\u95ee\u200b\u3002\u200b\u4e00\u4e2a\u200b\u7269\u7406\u200b\u78c1\u76d8\u200b\u53ef\u4ee5\u200b\u5212\u5206\u200b\u4e3a\u200b\u591a\u4e2a\u200b\u78c1\u76d8\u5206\u533a\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u78c1\u76d8\u5206\u533a\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u903b\u8f91\u200b\u4e0a\u200b\u770b\u6210\u200b\u662f\u4ece\u200b0\u200b\u5f00\u59cb\u200b\u7f16\u53f7\u200b\u7684\u200b\u5927\u91cf\u200b\u6247\u533a\u200b\uff0c\u200b\u5404\u81ea\u200b\u53ef\u4ee5\u200b\u683c\u5f0f\u5316\u200b\u7a0b\u200b\u4e0d\u540c\u200b\u7c7b\u578b\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff08\u200b\u5982\u200bEXT2\u3001NTFS\u200b\u7b49\u200b\uff09\u3002\u200b\u5982\u679c\u200b \u200b\u683c\u5f0f\u5316\u200b \u200b\u6210\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u5219\u200b\u5176\u200b\u5185\u90e8\u200b\u6309\u7167\u200bEXT2\u200b\u7684\u200b\u89c4\u8303\u200b\uff0c\u200b\u5c06\u200b\u78c1\u76d8\u200b\u76d8\u5757\u200b\u7ec4\u7ec7\u200b\u6210\u200b \u200b\u8d85\u7ea7\u200b\u5757\u200b \u3001 \u200b\u7ec4\u200b\u63cf\u8ff0\u7b26\u200b \u200b\u548c\u200b \u200b\u4f4d\u200b\u56fe\u200b \u3001 \u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b \u3001 \u200b\u76ee\u5f55\u200b \u200b\u7b49\u200b\u7ba1\u7406\u200b\u6570\u636e\u200b\uff0c\u200b\u653e\u5728\u200b\u5206\u533a\u200b\u524d\u7aef\u200b\u79f0\u4e3a\u200b \u200b\u5143\u200b\u6570\u636e\u200b\u533a\u200b \uff0c\u200b\u5269\u4f59\u200b\u7a7a\u95f4\u200b\u7528\u4e8e\u200b \u200b\u4fdd\u5b58\u200b\u6587\u4ef6\u200b\u6570\u636e\u200b \u3002</p> <p>\u200b\u8fd9\u200b\u4e00\u6bb5\u200b\u4ecb\u7ecd\u200b\u4e2d\u200b\u51fa\u73b0\u200b\u4e86\u200b\u4e24\u4e2a\u200b\u65b0\u200b\u6982\u5ff5\u200b\uff1a \u200b\u78c1\u76d8\u5206\u533a\u200b \u200b\u4e0e\u200b \u200b\u683c\u5f0f\u5316\u200b \uff0c\u200b\u6211\u4eec\u200b\u6765\u200b\u7b80\u5355\u200b\u7406\u89e3\u200b\u4e00\u4e0b\u200b\uff1a</p> <ul> <li>\u200b\u78c1\u76d8\u5206\u533a\u200b</li> </ul> <p>\u200b\u6211\u4eec\u200b\u7684\u200b\u7b14\u8bb0\u672c\u200b\u901a\u5e38\u200b\u53ea\u6709\u200b\u4e00\u5757\u200bSATA\u200b\u78c1\u76d8\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u65b9\u4fbf\u200b\u7528\u6237\u200b\u8fdb\u884c\u200b\u6570\u636e\u7ba1\u7406\u200b\uff0c\u200b\u6bd4\u5982\u200b\uff1a\u200b\u6211\u200b\u60f3\u200b\u5212\u5206\u200b\u78c1\u76d8\u200b\u7684\u200b100\u200b\u4e2a\u200bG\u200b\u4f5c\u4e3a\u200b\u6e38\u620f\u200b\u5b58\u653e\u200b\u76d8\u200b\uff0c400\u200b\u4e2a\u200bG\u200b\u4f5c\u4e3a\u200b \u200b\u5b66\u4e60\u200b\u8d44\u6599\u200b \u3002\u200b\u6211\u200b\u60f3\u200b\u8ba9\u200b\u6e38\u620f\u200b\u76d8\u7528\u200b EXT2 \u200b\u7ba1\u7406\u200b\uff0c\u200b\u5b66\u4e60\u200b\u8d44\u6599\u200b\u7528\u200b EXT3 \u200b\u7ba1\u7406\u200b\uff0c\u200b\u90a3\u4e48\u200b\u4fbf\u200b\u6709\u200b\u4e86\u200b\u78c1\u76d8\u5206\u533a\u200b\u7684\u200b\u6982\u5ff5\u200b\uff1a</p> <p></p> <ul> <li>\u200b\u683c\u5f0f\u5316\u200b</li> </ul> <p>\u200b\u6211\u4eec\u200b\u8fd8\u662f\u200b\u4ee5\u200b\u91d1\u58eb\u987f\u200bU\u200b\u76d8\u4e3a\u4f8b\u200b\uff0cU\u200b\u76d8\u4e00\u200b\u751f\u4ea7\u200b\u51fa\u6765\u200b\u5c31\u200b\u6709\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5417\u200b\uff1f\u200b\u53ef\u80fd\u200b\u6709\u200b\uff1a\uff09\uff0c\u200b\u4f46\u662f\u200b\u5f88\u591a\u200b\u65f6\u5019\u200b\u521a\u200b\u51fa\u5382\u200b\u7684\u200bU\u200b\u76d8\u200b\u90fd\u200b\u662f\u200b \u200b\u5e72\u5e72\u51c0\u51c0\u200b \u200b\u7684\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u65f6\u5019\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u5bf9\u200b\u5176\u200b\u8fdb\u884c\u200b \u200b\u683c\u5f0f\u5316\u200b \uff0c\u200b\u4f7f\u200b\u4e4b\u200b\u5e26\u6709\u200b\u7279\u5b9a\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u7279\u5f81\u200b\u3002\u200b\u4f8b\u5982\u200b\uff0c\u200b\u6211\u4eec\u200b\u60f3\u200b\u7528\u200b EXT2 \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u6765\u200b\u8bbf\u95ee\u200b\u8fd9\u4e2a\u200bU\u200b\u76d8\u200b\uff0c\u200b\u5728\u200bLinux\u200b\u4e2d\u200b\uff0c\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\uff1a</p> <pre><code>[root@localhost mnt]# mkfs.EXT2 sdb1\n[root@localhost mnt]#\n</code></pre> <p>\u200b\u8fd9\u6837\u200b\u505a\u200b\u5c31\u200b\u628a\u200b\u6574\u4e2a\u200b\u8bbe\u5907\u200b\u7ed9\u200b\u683c\u5f0f\u5316\u200b\u4e86\u200b\uff0c\u200b\u63a5\u7740\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u7528\u200b\u4e0b\u9762\u200b\u7684\u200b\u547d\u4ee4\u200b\u6765\u200b\u6302\u8f7d\u200bU\u200b\u76d8\u200b\uff1a</p> <pre><code>[root@localhost mnt]# mount -t EXT2 sdb1 /mnt/\n[root@localhost mnt]#\n</code></pre>"},{"location":"lab5/part2/#131","title":"1.3.1  \u200b\u6574\u4f53\u200b\u5e03\u5c40","text":"<p>EXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5c06\u200b\u76d8\u5757\u200b\u5206\u6210\u200b\u4e24\u5927\u7c7b\u200b\uff1a\u200b\u4fdd\u5b58\u200b\u5143\u200b\u6570\u636e\u200b\uff08\u200b\u7ba1\u7406\u200b\u6570\u636e\u200b\uff09\u200b\u7684\u200b \u200b\u5143\u200b\u6570\u636e\u200b\u76d8\u5757\u200b\uff0c\u200b\u4ee5\u53ca\u200b\u5b58\u653e\u200b\u6587\u4ef6\u200b\u5185\u5bb9\u200b\u6570\u636e\u200b\u7684\u200b \u200b\u6570\u636e\u200b\u76d8\u5757\u200b \u3002\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u964d\u4f4e\u200b\u5b9e\u9a8c\u200b\u96be\u5ea6\u200b\uff0c\u200b\u7b80\u5316\u200b\u4e86\u200b\u5143\u200b\u6570\u636e\u200b\u533a\u200b\u7684\u200b\u7ed3\u6784\u200b\uff08\u200b\u7531\u200b\u8d85\u7ea7\u200b\u5757\u200b\u548c\u200binode\u200b\u6570\u7ec4\u200b\u6784\u6210\u200b\uff09\u3002\u200b\u7b80\u5316\u200b\u540e\u200b\u7684\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u57fa\u672c\u200b\u5e03\u5c40\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u7cfb\u7edf\u200b\u4e3b\u8981\u200b\u5305\u542b\u200b\u4ee5\u4e0b\u200b\u4e94\u4e2a\u200b\u90e8\u5206\u200b\uff1a</p> <ol> <li> <p>superblock \uff1a\u200b\u8d85\u7ea7\u200b\u5757\u200b\uff0c\u200b\u5305\u542b\u200b\u6574\u4e2a\u200b\u7cfb\u7edf\u200b\u7684\u200b\u603b\u4f53\u200b\u4fe1\u606f\u200b;</p> </li> <li> <p>\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b\u4f4d\u200b\u56fe\u200b \uff1a\u200b\u8bb0\u5f55\u200b\u7740\u200b \u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b \u200b\u8868\u200b\u7684\u200b\u4f7f\u7528\u200b\u60c5\u51b5\u200b\uff0c \u200b\u7528\u200b1\u200b\u4e2a\u200b\u6bd4\u7279\u200b \u200b\u8bb0\u5f55\u200b\u67d0\u200b\u4e00\u4e2a\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b\u662f\u5426\u200b\u88ab\u200b\u4f7f\u7528\u200b\uff1b</p> </li> <li> <p>\u200b\u6570\u636e\u200b\u5757\u200b\u4f4d\u56fe\u200b \uff1a\u200b\u8bb0\u5f55\u200b\u7740\u200b \u200b\u6570\u636e\u200b\u5757\u200b \u200b\u7684\u200b\u4f7f\u7528\u200b\u60c5\u51b5\u200b\uff0c \u200b\u7528\u200b1\u200b\u4e2a\u200b\u6bd4\u7279\u200b \u200b\u8bb0\u5f55\u200b\u67d0\u200b\u4e00\u4e2a\u200b\u6570\u636e\u200b\u5757\u200b\u662f\u5426\u200b\u88ab\u200b\u5360\u7528\u200b\uff1b</p> </li> <li> <p>\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b \uff08inode\uff09 \uff1a\u200b\u8bb0\u5f55\u200b\u7740\u200b\u6587\u4ef6\u200b\u7684\u200b\u5143\u200b\u6570\u636e\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u200b\u90fd\u200b\u4e0e\u200b\u4e00\u4e2a\u200binode\u200b\u5bf9\u5e94\u200b\uff0c\u200b\u4f46\u200b\u4e00\u4e2a\u200binode\u200b\u53ef\u80fd\u200b\u5bf9\u5e94\u200b\u591a\u4e2a\u200b\u6587\u4ef6\u200b\uff08\u200b\u786c\u200b\u94fe\u63a5\u200b\uff09\u3002\u200b\u5728\u200b \u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u53ef\u4ee5\u200b\u8ba4\u4e3a\u200b\u4e00\u4e2a\u200binode\u200b\u5bf9\u5e94\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b \u3002</p> </li> <li> <p>\u200b\u6570\u636e\u200b\u5757\u200b \uff1a\u200b\u8bb0\u5f55\u200b\u6587\u4ef6\u200b\u5185\u5bb9\u200b.</p> </li> </ol>"},{"location":"lab5/part2/#132","title":"1.3.2  \u200b\u8d85\u7ea7\u200b\u5757","text":"<p>\u200b\u8d85\u7ea7\u200b\u5757\u200b\u662f\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b \u200b\u8d77\u70b9\u200b\u7ed3\u6784\u200b \uff0c\u200b\u8bb0\u5f55\u200b\u4e86\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5168\u5c40\u6027\u200b\u7684\u200b\u4e00\u4e9b\u200b\u4fe1\u606f\u200b\u3002\u200b\u4e0b\u9762\u200b\u7ed9\u51fa\u200b\u4e00\u4e2a\u200b\u53c2\u8003\u200b\u7684\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7ed3\u6784\u200b\u4f53\u200b\u793a\u4f8b\u200b\uff1a</p> <pre><code>struct super_block_d\n{\nuint32_t           magic_num;                   // \u200b\u5e7b\u6570\u200b\n\nint                max_ino;                     // \u200b\u6700\u200b\u591a\u200b\u652f\u6301\u200b\u7684\u200b\u6587\u4ef6\u200b\u6570\u200b\n\nint                map_inode_blks;              // inode\u200b\u4f4d\u200b\u56fe\u200b\u5360\u7528\u200b\u7684\u200b\u5757\u200b\u6570\u200b\nint                map_inode_offset;            // inode\u200b\u4f4d\u56fe\u200b\u5728\u200b\u78c1\u76d8\u200b\u4e0a\u200b\u7684\u200b\u504f\u79fb\u200b\n\nint                map_data_blks;               // data\u200b\u4f4d\u200b\u56fe\u200b\u5360\u7528\u200b\u7684\u200b\u5757\u200b\u6570\u200b\nint                map_data_offset;             // data\u200b\u4f4d\u56fe\u200b\u5728\u200b\u78c1\u76d8\u200b\u4e0a\u200b\u7684\u200b\u504f\u79fb\u200b\n};\n</code></pre> <ul> <li> <p><code>magic_num</code>\uff1a\u200b\u5e7b\u6570\u200b\u3002\u200b\u7528\u4e8e\u200b\u8bc6\u522b\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002\u200b\u6bd4\u5982\u8bf4\u200b\uff0c\u200b\u5982\u679c\u200b\u5b9e\u73b0\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5e7b\u6570\u200b\u4e3a\u200b 0x52415453 \uff0c\u200b\u90a3\u4e48\u200b\u5982\u679c\u200b\u8bfb\u5230\u200b\u7684\u200b\u5e7b\u6570\u200b\u4e0d\u200b\u7b49\u4e8e\u200b 0x52415453 \uff0c\u200b\u5219\u200b\u8868\u793a\u200b\u5f53\u524d\u200b\u78c1\u76d8\u200b\u4e2d\u200b\u65e0\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u7cfb\u7edf\u200b\u635f\u574f\u200b\uff0c\u200b\u6216\u8005\u200b\u662f\u200b\u5176\u4ed6\u200b\u4e0d\u200b\u8bc6\u522b\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1b</p> </li> <li> <p><code>max_ino</code>\uff1a\u200b\u6700\u200b\u591a\u200b\u652f\u6301\u200b\u7684\u200b\u6587\u4ef6\u200b\u6570\u200b\u3002\u200b\u4e3a\u200b\u7b80\u5355\u200b\u8d77\u200b\u89c1\u200b\uff0c\u200b\u6211\u4eec\u200b\u5141\u8bb8\u200b\u8be5\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5177\u6709\u200b\u6587\u4ef6\u200b\u6570\u200b\u4e0a\u9650\u200b\uff1b</p> </li> <li> <p><code>map_inode_blks</code>\uff1ainode\u200b\u4f4d\u200b\u56fe\u200b\u5360\u7528\u200b\u7684\u200b\u5757\u200b\u6570\u200b\u3002\u200b\u6bcf\u4e2a\u200b \u200b\u5757\u200b\u7684\u200b\u5927\u5c0f\u200b\u7b49\u4e8e\u200b\u78c1\u76d8\u200b\u8bbe\u5907\u200b\u7684\u200bIO\u200b\u5927\u5c0f\u200b\uff08\u200b\u5229\u7528\u200bddriver\u200b\u7684\u200bioctl\u200b\u83b7\u53d6\u200b\uff09 \uff1b</p> </li> <li> <p><code>map_inode_offset</code>\uff1ainode\u200b\u4f4d\u56fe\u200b\u5728\u200b\u78c1\u76d8\u200b\u4e0a\u200b\u7684\u200b\u504f\u79fb\u200b\u3002\u200b\u901a\u8fc7\u200b<code>map_inode_offset</code>\u200b\u548c\u200b<code>map_inode_blks</code>\u200b\u5b57\u200b\u6bb5\u200b\uff0c\u200b\u4fbf\u200b\u53ef\u200b\u8bfb\u51fa\u200b\u6574\u4e2a\u200binode\u200b\u4f4d\u200b\u56fe\u200b\uff1b</p> </li> <li> <p><code>map_data_blks</code>\uff1a\u200b\u4e0e\u200b<code>map_inode_blks</code>\u200b\u76f8\u540c\u200b\uff0c\u200b\u4e0d\u518d\u200b\u8d58\u8ff0\u200b\uff1b</p> </li> <li> <p><code>map_data_offset</code>\uff1a\u200b\u4e0e\u200b<code>map_inode_offset</code>\u200b\u76f8\u540c\u200b\uff0c\u200b\u4e0d\u518d\u200b\u8d58\u8ff0\u200b\uff1b</p> </li> </ul> <p>\u200b\u5982\u4f55\u200b\u51b3\u5b9a\u200b\u4f4d\u200b\u56fe\u200b\u5927\u5c0f\u200b\u5462\u200b\uff1f\u200b\u8fd9\u91cc\u200b\u7ed9\u51fa\u200b\u51e0\u4e2a\u200b\u65b9\u6848\u200b\uff1a</p> <ul> <li> <p>\u200b\u5047\u8bbe\u200b\u4f30\u7b97\u200b\u3002 \u200b\u5047\u5b9a\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u200b\u5177\u6709\u200b\u56fa\u5b9a\u200b\u5927\u5c0f\u200b \uff0c\u200b\u4ece\u800c\u200b\u4f30\u7b97\u200b\u6574\u4e2a\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u53ef\u4ee5\u200b \u200b\u7ba1\u7406\u200b\u591a\u5c11\u200b\u6587\u4ef6\u200b \uff0c\u200b\u4ece\u800c\u200b\u8ba1\u7b97\u200b\u4f4d\u200b\u56fe\u200b\u5927\u5c0f\u200b\uff1b</p> </li> <li> <p>\u200b\u89c4\u5b9a\u200b\u5927\u5c0f\u200b\u3002\u200b\u4e3a\u4e86\u200b\u7b80\u5355\u200b\u8d77\u200b\u89c1\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b \u200b\u89c4\u5b9a\u200b\u4f4d\u200b\u56fe\u200b \u200b\u7684\u200b\u5927\u5c0f\u200b\uff0c\u200b\u53ea\u8981\u200b \u200b\u4fdd\u8bc1\u200b\u6307\u4ee4\u200b\u8fd0\u884c\u200b\u6210\u529f\u200b \u200b\u5373\u53ef\u200b\uff1b</p> </li> </ul>"},{"location":"lab5/part2/#133","title":"1.3.3  \u200b\u6587\u4ef6\u200b\u7684\u200b\u8868\u793a","text":"<p>\u200b\u5bf9\u4e8e\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u200b\uff0c\u200b\u90fd\u200b\u4f1a\u200b\u6709\u200b\u4e00\u4e2a\u200binode\u200b\u7ed3\u6784\u200b\u4f53\u200b\u5305\u542b\u200b\u5176\u5143\u200b\u6570\u636e\u200b\uff08\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff0c\u200b\u6587\u4ef6\u5927\u5c0f\u200b\uff09\u200b\u7b49\u200b\u3002\u200b\u4ee5\u4e0b\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7b80\u5316\u200b\u7684\u200binode\u200b\u793a\u4f8b\u200b\u3002</p> <pre><code>struct inode_d\n{\nint                ino;                // \u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u6807\u200b\nint                size;               // \u200b\u6587\u4ef6\u200b\u5df2\u200b\u5360\u7528\u200b\u7a7a\u95f4\u200b\nint                link;               // \u200b\u94fe\u63a5\u200b\u6570\u200b\nFILE_TYPE          ftype;              // \u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff08\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u3001\u200b\u666e\u901a\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff09\nint                dir_cnt;            // \u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4e0b\u9762\u200b\u6709\u200b\u51e0\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\nint                block_pointer[6];   // \u200b\u6570\u636e\u200b\u5757\u200b\u6307\u9488\u200b\uff08\u200b\u53ef\u200b\u56fa\u5b9a\u200b\u5206\u914d\u200b\uff09\n};  </code></pre> <p>\u200b\u6587\u4ef6\u200b\u7684\u200b\u5185\u5bb9\u200b\u5e76\u200b \u200b\u4e0d\u4f1a\u200b\u4fdd\u5b58\u200b \u200b\u5728\u200binode\u200b\u91cc\u200b\uff0c\u200b\u800c\u662f\u200b \u200b\u4fdd\u5b58\u200b \u200b\u5728\u200b\u53e6\u5916\u200b\u7684\u200b \u200b\u6570\u636e\u200b\u5757\u200b \u200b\u4e2d\u200b\u3002inode\u200b\u91cc\u200b \u200b\u4fdd\u5b58\u200b\u4e86\u200b\u76f8\u5e94\u200b\u6570\u636e\u200b\u5757\u200b\u7684\u200b\u7d22\u5f15\u200b\u503c\u200b \u3002\u200b\u8bfb\u5199\u200b\u6587\u4ef6\u200b\u65f6\u5219\u200b\u901a\u8fc7\u200b\u7d22\u5f15\u200b\u503c\u200b\u627e\u5230\u200b\u76f8\u5e94\u200b\u7684\u200b\u6570\u636e\u200b\u5757\u200b\u6765\u200b\u8bfb\u5199\u200b\u3002\u200b\u539f\u7406\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u6bcf\u4e2a\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b\u5185\u200b\u5305\u542b\u200b<code>block_point</code>\u200b\u6570\u7ec4\u200b\u7528\u4e8e\u200b\u8bb0\u5f55\u200b\u6587\u4ef6\u200b\u7684\u200b\u6570\u636e\u200b\u5757\u200b\u6240\u5728\u4f4d\u7f6e\u200b\uff08\u200b\u7f16\u53f7\u200b\uff09\u3002 EXT2 \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b \u200b\u6bcf\u4e2a\u200b\u6570\u636e\u200b\u5757\u200b\u5927\u5c0f\u200b\u4e3a\u200b\u4e24\u4e2a\u200b512B\u200b\u7684\u200b\u7269\u7406\u200b\u78c1\u76d8\u200b\u5757\u200b \uff08\u200b\u5373\u200b1KiB\uff09\uff0c\u200b\u90a3\u4e48\u200b\u91c7\u7528\u200b\u76f4\u63a5\u200b\u7d22\u5f15\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u4e0d\u80fd\u200b\u8d85\u8fc7\u200b 6\u200b\u4e2a\u200b\uff08\u200b\u6570\u636e\u200b\u5757\u200b\uff09 * 1KB\uff08\u200b\u6570\u636e\u200b\u5757\u200b\u5927\u5c0f\u200b\uff09= 6KB\u200b\u5927\u5c0f\u200b\uff1b\u200b\u5f53\u200b\u6587\u4ef6\u200b\u8d85\u8fc7\u200b6KB\u200b\u65f6\u200b\uff0c\u200b\u9700\u8981\u200b\u7528\u200b\u4e00\u7ea7\u200b\u95f4\u63a5\u200b\u7d22\u5f15\u200b\uff0c\u200b\u5982\u679c\u200b\u6587\u4ef6\u200b\u7ee7\u7eed\u200b\u589e\u5927\u200b\uff0c\u200b\u5c31\u200b\u9700\u8981\u200b\u4e8c\u7ea7\u200b\u6216\u200b\u4e8c\u7ea7\u200b\u4ee5\u4e0a\u200b\u95f4\u63a5\u200b\u7d22\u5f15\u200b\u3002\uff08 \u200b\u6ce8\u200b\uff1a\u200b\u95f4\u63a5\u200b\u7d22\u5f15\u200b\u5c5e\u4e8e\u200b\u9009\u505a\u200b\u529f\u80fd\u200b \uff09</p> <ul> <li> <p><code>link</code>\uff1a\u200b\u6587\u4ef6\u200b\u94fe\u63a5\u200b\u6570\u200b\uff08 \u200b\u6ce8\u200b\uff1a\u200b\u6587\u4ef6\u200b\u8f6f\u200b\u94fe\u63a5\u200b\u4e0e\u200b\u786c\u200b\u94fe\u63a5\u200b\u5c5e\u4e8e\u200b\u9009\u505a\u200b\u529f\u80fd\u200b \uff09</p> </li> <li> <p><code>ftype</code>\uff1a\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u3002\u200b\u53ef\u200b\u81ea\u5b9a\u4e49\u200b\u679a\u4e3e\u200b\u7c7b\u578b\u200b\uff0c\u200b\u65b9\u4fbf\u200b\u7f16\u7801\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> </li> </ul> <pre><code>typedef enum file_type {\nFILE,           // \u200b\u666e\u901a\u200b\u6587\u4ef6\u200b\nDIR             // \u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b\n} FILE_TYPE;\n</code></pre>"},{"location":"lab5/part2/#134","title":"1.3.4  \u200b\u6587\u4ef6\u5939\u200b\uff08\u200b\u76ee\u5f55\u200b\uff09\u200b\u7684\u200b\u8868\u793a","text":"<p>\u200b\u6587\u4ef6\u5939\u200b\uff08\u200b\u76ee\u5f55\u200b\uff09\u200b\u7528\u4e8e\u200b\u5c06\u200b\u6574\u4e2a\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u6587\u4ef6\u200b\u7ed3\u6784\u200b \u200b\u6309\u200b\u8def\u5f84\u540d\u200b\u8bbf\u95ee\u200b\u7684\u200b\u6811\u5f62\u200b\u7ec4\u7ec7\u200b\u7ed3\u6784\u200b\u6392\u5217\u200b \u3002Ext2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5e76\u200b\u6ca1\u6709\u200b\u5355\u72ec\u200b\u5f62\u6210\u200b\u7528\u4e8e\u200b\u76ee\u5f55\u200b\u6570\u636e\u200b\u7684\u200b\u6570\u636e\u200b\u5757\u200b\uff0c\u200b\u800c\u662f\u200b \u200b\u5c06\u200b\u76ee\u5f55\u200b\u4e0e\u200b\u666e\u901a\u200b\u6587\u4ef6\u200b\u4e00\u6837\u200b\u5b58\u653e\u200b\u5728\u200b\u6570\u636e\u200b\u5757\u200b\u4e2d\u200b \u3002\u200b\u4e5f\u5c31\u662f\u8bf4\u200b\uff0c \u200b\u6587\u4ef6\u5939\u200b\uff08\u200b\u76ee\u5f55\u200b\uff09\u200b\u5728\u200bExt2\u200b\u4e2d\u200b\u7684\u200b\u5b58\u50a8\u200b\u65b9\u5f0f\u200b\u4e0e\u200b\u6587\u4ef6\u200b\u4e00\u81f4\u200b \u3002\u200b\u4e0d\u540c\u4e4b\u5904\u200b\u5728\u4e8e\u200b\u76ee\u5f55\u200b\u5728\u200b\u6570\u636e\u200b\u5757\u200b\u4e2d\u200b\u7684\u200b\u5185\u5bb9\u200b\u7531\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u76f4\u63a5\u200b\u7ba1\u7406\u200b\uff0c\u200b\u7528\u6237\u200b\u5e76\u200b\u4e0d\u80fd\u200b\u50cf\u200b\u5199\u200b\u666e\u901a\u200b\u6587\u4ef6\u200b\u4e00\u6837\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b\u7f16\u8f91\u5668\u200b\u5199\u200b\u76ee\u5f55\u200b\u6570\u636e\u200b\u5757\u200b\u4e2d\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</p> <p>\u200b\u76ee\u5f55\u200b\u5728\u200b\u5b58\u50a8\u7ba1\u7406\u200b\u4e0a\u200b\u548c\u200b\u666e\u901a\u200b\u6587\u4ef6\u200b\u76f8\u540c\u200b\u2014\u2014\u200b\u4e5f\u200b\u662f\u200b \u200b\u901a\u8fc7\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b\u6765\u200b\u7ba1\u7406\u200b\u76ee\u5f55\u200b\u9879\u200b\u6570\u636e\u200b\u7684\u200b \uff0c\u200b\u53ea\u4e0d\u8fc7\u200b\u76ee\u5f55\u200b\u6570\u636e\u200b\u5757\u200b\u5185\u5bb9\u200b\u542b\u6709\u200b\u591a\u6761\u200b\u76ee\u5f55\u200b\u9879\u200b\u6570\u636e\u7ed3\u6784\u200b\uff0c\u200b\u5373\u200b\u76ee\u5f55\u200b\u6570\u636e\u200b\u5757\u200b\u4e2d\u200b\u7684\u200b\u5185\u5bb9\u200b\u662f\u200b\u76ee\u5f55\u200b\u9879\u200b\u7684\u200b\u6570\u7ec4\u200b\uff0c\u200b\u901a\u8fc7\u200b\u4e0a\u200b\u4e00\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b\u5c06\u200b\u5176\u200b\u7c7b\u578b\u200b\u6807\u8bc6\u200b\u4e3a\u200b\u201c\u200b\u76ee\u5f55\u200b\u201d\u200b\u4ee5\u200b\u533a\u5206\u200b\u666e\u901a\u200b\u6587\u4ef6\u200b\u3002</p> <p>\u200b\u6839\u76ee\u5f55\u200b\u6709\u200b\u56fa\u5b9a\u200b\u7684\u200b\u8d77\u70b9\u200b \uff08\u200b\u4f8b\u5982\u200bExt2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u6839\u76ee\u5f55\u200b\u7684\u200b\u7d22\u5f15\u200b\u53f7\u200b\u4e3a\u200b2\uff09\uff0c\u200b\u56e0\u6b64\u200b\u6839\u76ee\u5f55\u200b\u6587\u4ef6\u200b\u5c31\u200b\u4e0d\u200b\u9700\u8981\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b\u6765\u200b\u5b9a\u4f4d\u200b\u4e86\u200b\u3002</p> <p>\u200b\u4e0b\u9762\u200b\u662f\u200b\u7b80\u5316\u200b\u7684\u200b \u200b\u76ee\u5f55\u200b\u9879\u200b \u200b\u7ed3\u6784\u200b\u4f53\u200b\u793a\u4f8b\u200b\uff1a</p> <pre><code>struct dentry_d\n{\nchar               fname[MAX_FILE_NAME];          // \u200b\u6307\u5411\u200b\u7684\u200bino\u200b\u6587\u4ef6\u540d\u200b\nFILE_TYPE          ftype;                         // \u200b\u6307\u5411\u200b\u7684\u200bino\u200b\u6587\u4ef6\u7c7b\u578b\u200b\nint                ino;                           // \u200b\u6307\u5411\u200b\u7684\u200bino\u200b\u53f7\u200b\nint                valid;                         // \u200b\u8be5\u200b\u76ee\u5f55\u200b\u9879\u200b\u662f\u5426\u200b\u6709\u6548\u200b\n};  </code></pre> <p>\u200b\u5bf9\u4e8e\u200b\u76ee\u5f55\u200b\u4e2d\u200b\u7684\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u90fd\u200b\u5bf9\u5e94\u200b\u4e86\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b/\u200b\u76ee\u5f55\u200b\u3002\u200b\u5177\u4f53\u200b\u8868\u793a\u200b\u65b9\u5f0f\u200b\u89c1\u200b\u4e0b\u56fe\u200b\uff1a</p> <p></p> <p>\u200b\u56fe\u4e2d\u200b<code>/</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7b2c\u4e8c\u4e2a\u200b\u540d\u4e3a\u200b<code>JINX</code>\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u7684\u200b<code>valid</code>\u200b\u5b57\u6bb5\u200b\u88ab\u200b\u6807\u8bb0\u200b\u4e3a\u200b0\uff0c \u200b\u8868\u793a\u200b\u8fd9\u4e00\u200b\u6587\u4ef6\u200b\u5df2\u200b\u88ab\u200b\u5220\u9664\u200b \u3002\u200b\u5f53\u7136\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u5176\u4ed6\u200b\u7684\u200b\u5220\u9664\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u6bd4\u5982\u200b \u200b\u7528\u200b\u540e\u9762\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u8986\u76d6\u200b\u88ab\u200b\u5220\u9664\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b \u3002</p> <p>\u200b\u56fe\u4e2d\u200b<code>/demo/</code>\u200b\u76ee\u5f55\u200b\u6307\u5411\u200b\u7684\u200b\u6570\u636e\u200b\u5757\u200b\u6ca1\u6709\u200b\u753b\u51fa\u200b\uff0c\u200b\u5176\u200b\u539f\u7406\u200b\u4e0e\u200b\u6839\u76ee\u5f55\u200b\u4e00\u81f4\u200b\u3002</p>"},{"location":"lab5/part2/#135","title":"1.3.5  \u200b\u5185\u5bb9\u200b\u7ed3\u6784\u200b\u7684\u200b\u8868\u793a","text":"<p>\u200b\u5927\u5bb6\u200b\u53ef\u80fd\u200b\u6ce8\u610f\u200b\u5230\u200b\u6211\u4eec\u200b \u200b\u524d\u9762\u200b\u5c55\u793a\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b \u200b\u540e\u9762\u200b\u90fd\u200b\u5e26\u6709\u200b\u4e00\u4e2a\u200b<code>_d</code>\uff0c\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c\u200b\u8fd9\u200b\u4ee3\u8868\u200b\u8fd9\u4e9b\u200b\u6570\u636e\u7ed3\u6784\u200b\u662f\u200b\u5b58\u5728\u200b\u4e8e\u200b\u771f\u5b9e\u200b\u8bbe\u5907\u200b\u4e4b\u4e0a\u200b\u7684\u200b\uff0c\u200b\u5b83\u4eec\u200b\u5171\u540c\u200b\u6784\u5efa\u200b\u4e86\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u5e03\u5c40\u200b\u3002\u200b\u4f46\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u7ed3\u6784\u200b\u5e03\u5c40\u200b \u200b\u4e0e\u200b \u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u4e24\u8005\u200b\u8fd8\u662f\u200b\u6709\u200b\u4e00\u5b9a\u200b\u7684\u200b\u504f\u5dee\u200b\u3002\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e0d\u5149\u200b\u8981\u200b\u8bbe\u8ba1\u200b\u5e03\u5c40\u200b\uff0c\u200b\u8fd8\u200b\u9700\u8981\u200b \u200b\u9488\u5bf9\u200b\u5e03\u5c40\u200b \u200b\u8bbe\u8ba1\u200b\u76f8\u5e94\u200b\u7684\u200b \u200b\u5185\u5b58\u200b\u6570\u636e\u7ed3\u6784\u200b \u200b\u6765\u200b\u65b9\u4fbf\u7ba1\u7406\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u4e3e\u200b\u4e24\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200b\u4f8b\u5b50\u200b\u6765\u200b\u8bf4\u660e\u200b\u8fd9\u4e2a\u200b\u95ee\u9898\u200b\u3002</p> <ul> <li>super_block \u200b\u7684\u200b\u5185\u5b58\u200b\u8868\u793a\u200b</li> </ul> <p>\u200b\u5728\u200b\u8bbe\u5907\u200b\u4e0a\u200b\uff0c\u200b\u8d85\u7ea7\u200b\u5757\u200b\u4e2d\u200b\u4ec5\u4ec5\u200b\u4fdd\u5b58\u200b\u4e86\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u4f4d\u56fe\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u6211\u4eec\u200b\u9700\u8981\u200b \u200b\u5c06\u4f4d\u200b\u56fe\u8bfb\u200b\u5230\u200b\u5185\u5b58\u200b\u4e2d\u200b\u4ee5\u4fbf\u200b\u6211\u4eec\u200b\u8fdb\u884c\u200b\u8bbf\u95ee\u200b \uff1b\u200b\u6b64\u5916\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u65b9\u4fbf\u200b\u67e5\u627e\u200b\u6839\u76ee\u5f55\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e5f\u200b\u5b8c\u5168\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u6839\u76ee\u5f55\u200b\u7ef4\u62a4\u200b\u5728\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u5185\u5b58\u200b\u8868\u793a\u200b\u4e2d\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u6211\u4eec\u200b\u5168\u5c40\u200b\u8bbf\u95ee\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u7b80\u5355\u200b\u8bbe\u8ba1\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u5185\u5b58\u200b\u8868\u793a\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>struct super_block\n{   int                max_ino;\n\nuint8_t*           map_inode;       // inode\u200b\u4f4d\u200b\u56fe\u200b\nuint8_t*           map_data;        // data\u200b\u4f4d\u200b\u56fe\u200b\n\nstruct dentry*     root_dentry;     // \u200b\u6839\u76ee\u5f55\u200bdentry\n};\n</code></pre> <p>\u200b\u8fd9\u6837\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c31\u200b\u80fd\u200b\u65b9\u4fbf\u200b\u5730\u200b\u5bf9\u200b inode \u200b\u4f4d\u200b\u56fe\u200b \u200b\u548c\u200b data \u200b\u4f4d\u200b\u56fe\u200b \u200b\u8fdb\u884c\u200b\u7ba1\u7406\u200b\uff0c\u200b\u5e76\u200b\u80fd\u591f\u200b\u901a\u8fc7\u200b<code>root_dentry</code>\u200b\u8f7b\u677e\u200b\u8bbf\u95ee\u200b\u6839\u76ee\u5f55\u200b\uff0c\u200b\u4ece\u800c\u200b\u8fbe\u5230\u200b \u200b\u5feb\u901f\u200b\u89e3\u6790\u200b\u8def\u5f84\u200b \u200b\u7684\u200b\u76ee\u7684\u200b\u3002</p> <ul> <li>inode \u200b\u7684\u200b\u5185\u5b58\u200b\u8868\u793a\u200b</li> </ul> <p>\u200b\u5728\u200b\u78c1\u76d8\u200b\u5e03\u5c40\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u7684\u200b<code>inode</code>\u200b\u5b9a\u4e49\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>struct inode_d\n{\nint                 ino;                 // \u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u6807\u200b\nint                 size;                // \u200b\u6587\u4ef6\u200b\u5df2\u200b\u5360\u7528\u200b\u7a7a\u95f4\u200b\nint                 link;                // \u200b\u94fe\u63a5\u200b\u6570\u200b\nFILE_TYPE           ftype;               // \u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff08\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u3001\u200b\u666e\u901a\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff09\nint                 dir_cnt;             // \u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4e0b\u9762\u200b\u6709\u200b\u51e0\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\nint                 block_pointer[6];    // \u200b\u6570\u636e\u200b\u5757\u200b\u6307\u9488\u200b\uff08\u200b\u53ef\u200b\u56fa\u5b9a\u200b\u5206\u914d\u200b\uff09\n};  </code></pre> <p>\u200b\u8fd9\u4e2a\u200b\u7ed3\u6784\u200b\u96be\u4ee5\u200b\u5bf9\u200b\u6307\u5411\u200b<code>inode</code>\u200b\u7684\u200b<code>dentry</code>\u200b\u8fdb\u884c\u200b\u8bbf\u95ee\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u200b\u96be\u4ee5\u83b7\u5f97\u200b\u8be5\u200b\u6587\u4ef6\u200b\u7684\u200b\u6587\u4ef6\u540d\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u5bf9\u4e8e\u200b \u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b \u200b\u800c\u8a00\u200b\uff0c\u200b\u5b83\u200b\u7f3a\u5c11\u200b\u4e00\u79cd\u200b \u200b\u5feb\u6377\u200b\u904d\u5386\u200b\u6bcf\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b \u200b\u7684\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u7b80\u5355\u200b\u8bbe\u7f6e\u200b<code>inode</code>\u200b\u7684\u200b\u5185\u5b58\u200b\u7ed3\u6784\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>struct inode\n{\nint                 ino;                  // \u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u6807\u200b\nint                 size;                 // \u200b\u6587\u4ef6\u200b\u5df2\u200b\u5360\u7528\u200b\u7a7a\u95f4\u200b\nint                 dir_cnt;              // \u200b\u76ee\u5f55\u200b\u9879\u200b\u6570\u91cf\u200b\nstruct dentry*      dentry;               // \u200b\u6307\u5411\u200b\u8be5\u200binode\u200b\u7684\u200bdentry\nstruct dentry*      dentrys;              // \u200b\u6240\u6709\u200b\u76ee\u5f55\u200b\u9879\u200b  \nint                 block_pointer[6];     // \u200b\u6570\u636e\u200b\u5757\u200b\u6307\u9488\u200b\n};  </code></pre> <p>\u200b\u8fd9\u6837\u4e00\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u7ef4\u62a4\u200b<code>dentry</code>\u200b\u548c\u200b<code>dentrys</code>\u200b\u5c31\u200b\u80fd\u591f\u200b\u5f88\u200b\u8f7b\u677e\u200b\u5730\u200b\u89e3\u51b3\u200b\u4e0a\u8ff0\u200b\u95ee\u9898\u200b\u3002</p> <p>\u200b\u8fd9\u91cc\u200b\u7ed9\u51fa\u200b\u7684\u200b\u4f8b\u5b50\u200b\u4ec5\u8d77\u200b\u4e00\u4e2a\u200b\u629b\u7816\u5f15\u7389\u200b\u7684\u200b\u4f5c\u7528\u200b\uff0c\u200b\u4f60\u200b \u200b\u751a\u81f3\u200b\u53ef\u4ee5\u200b\u4e0d\u200b\u8bbe\u8ba1\u200b\u8fd9\u79cd\u200b\u5185\u5b58\u200b\u7ed3\u6784\u200b \uff0c\u200b\u4f8b\u5982\u200b\uff1a\u200b\u76f4\u63a5\u200b\u58f0\u660e\u200b \u200b\u4f4d\u200b\u56fe\u200b \u3001 \u200b\u6839\u76ee\u5f55\u200bdentry \u200b\u4e3a\u200b\u5168\u5c40\u53d8\u91cf\u200b\u7b49\u200b\u3002</p>"},{"location":"lab5/part2/#2-fusefilesystem-in-user-space","title":"2.  FUSE\uff08Filesystem in User SpacE\uff09\u200b\u67b6\u6784","text":"<p>\u200b\u4f20\u7edf\u200b\u7684\u200b\u3001\u200b\u57fa\u4e8e\u200bLinux\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5f00\u53d1\u200b\u90fd\u200b\u662f\u200b\u4ee5\u200b\u5185\u6838\u6a21\u5757\u200b\uff08 Kernel Module \uff09\u200b\u7684\u200b\u65b9\u5f0f\u200b\u8fdb\u884c\u200b\uff0c\u200b\u8fd9\u200b\u4f7f\u5f97\u200b\u5f00\u53d1\u200b\u8c03\u8bd5\u200b\u53d8\u5f97\u200b\u5f02\u5e38\u200b\u7e41\u7410\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u5185\u6838\u200b\u7684\u200b\u5f00\u53d1\u200b\u4e0e\u200b\u4f20\u7edf\u200bC\u200b\u7a0b\u5e8f\u5f00\u53d1\u200b\u4e0d\u540c\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u5185\u6838\u200b\u7684\u200bAPI\uff0c\u200b\u50cf\u200b<code>malloc</code>\u200b\u4e4b\u7c7b\u200b\u7684\u200b\u7528\u6237\u200b\u6001\u51fd\u6570\u200b\u5728\u200b\u5185\u6838\u200b\u5f00\u53d1\u200b\u4e2d\u200b\u5df2\u200b\u4e0d\u518d\u200b\u9002\u7528\u200b\u3002\u200b\u5982\u679c\u200b\u6709\u200b\u540c\u5b66\u200b\u5e0c\u671b\u200b\u4e86\u89e3\u200b\u66f4\u200b\u591a\u200b\u5185\u6838\u6a21\u5757\u200b\u5f00\u53d1\u200b\u76f8\u5173\u200b\u77e5\u8bc6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200bgoogle\u200b\u6216\u200b\u767e\u5ea6\u200b\u3002</p> <p>\u200b\u7531\u4e8e\u200b\u5185\u6838\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5f00\u53d1\u200b\u7684\u200b\u56f0\u96be\u200b\uff0cFUSE\u200b\u67b6\u6784\u200b\u7531\u6b64\u200b\u767b\u4e0a\u200b\u4e86\u200b\u53f0\u9762\u200b\u3002FUSE\u200b\u5168\u79f0\u200bFilesystem in User SpacE\uff0c\u200b\u5b83\u200b\u5c06\u200b \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u5b9e\u73b0\u200b\u4ece\u200b\u5185\u6838\u200b\u6001\u200b\u642c\u200b\u5230\u200b\u4e86\u200b\u7528\u6237\u200b\u6001\u200b \uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b \u200b\u5728\u200b\u7528\u6237\u200b\u6001\u200b\u5b9e\u73b0\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u3002</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u6211\u4eec\u200b\u4fbf\u662f\u200b\u57fa\u4e8e\u200bFUSE\u200b\u67b6\u6784\u200b\uff0c \u200b\u5728\u200b\u7528\u6237\u200b\u6001\u200b \u200b\u5b9e\u73b0\u200b\u6211\u4eec\u200b\u7684\u200b\u9752\u6625\u200b\u7248\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u4ece\u800c\u200b\u5b8c\u7f8e\u200b\u63a5\u5165\u200bLinux\u3002</p> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u7b80\u5355\u200b\u4ecb\u7ecd\u200b\u4e00\u4e0b\u200bFUSE\uff0c\u200b\u5f53\u7136\u200b\uff0c\u200b\u5982\u679c\u200b\u5bf9\u200bFUSE\u200b\u4e0d\u611f\u5174\u8da3\u200b\u7684\u200b\u540c\u5b66\u200b\u53ef\u4ee5\u200b\u7565\u8fc7\u200b\u8fd9\u4e00\u200b\u7ae0\u8282\u200b\u3002\u200b\u5728\u200b\u201c\u200b\u4efb\u52a1\u200b\u4e8c\u200b\u201d \u200b\u4e00\u8282\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u4f1a\u200b\u8be6\u7ec6\u200b\u4ecb\u7ecd\u200b\u5982\u4f55\u200b\u63a5\u5165\u200bFUSE\u3002</p> <p>\u200b\u4ee5\u4e0b\u5185\u5bb9\u200b\u53c2\u8003\u200b\u81ea\u200b\u7528\u6237\u200b\u6001\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u6846\u67b6\u200bFUSE\u200b\u7684\u200b\u4ecb\u7ecd\u200b\u53ca\u200b\u793a\u4f8b\u200b - \u200b\u77e5\u4e4e\u200b (zhihu.com)</p>"},{"location":"lab5/part2/#21-fuse","title":"2.1  FUSE\u200b\u57fa\u672c\u539f\u7406","text":"<p>\u200b\u7b80\u5355\u200b\u7684\u200b\u7406\u89e3\u200b\uff0c FUSE\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5bf9\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u8bbf\u95ee\u200b\u7684\u200b\u56de\u8c03\u200b \u3002FUSE\u200b\u5206\u4e3a\u200b \u200b\u5185\u6838\u200b\u6001\u200b\u7684\u200b\u6a21\u5757\u200b\u548c\u200b\u7528\u6237\u200b\u6001\u200b\u7684\u200b\u5e93\u200b \u200b\u4e24\u200b\u90e8\u5206\u200b\u3002\u200b\u5176\u4e2d\u200b \u200b\u7528\u6237\u200b\u6001\u200b\u7684\u200b\u5e93\u200b \u200b\u4e3a\u200b \u200b\u7528\u6237\u200b\u6001\u200b\u7a0b\u5e8f\u5f00\u53d1\u200b \u200b\u63d0\u4f9b\u200b\u63a5\u53e3\u200b\uff0c\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u8fd9\u4e9b\u200b\u63a5\u53e3\u200b \u200b\u5c06\u200b\u8bf7\u6c42\u200b\u5904\u7406\u200b\u529f\u80fd\u200b\u6ce8\u518c\u200b\u5230\u200bFUSE\u200b\u4e2d\u200b \u3002 \u200b\u5185\u6838\u200b\u6001\u200b\u6a21\u5757\u200b \u200b\u662f\u200b\u5177\u4f53\u200b\u7684\u200b\u6570\u636e\u200b\u6d41\u7a0b\u200b\u7684\u200b\u529f\u80fd\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u5b83\u200b \u200b\u622a\u83b7\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbf\u95ee\u200b\u8bf7\u6c42\u200b\uff0c\u200b\u7136\u540e\u200b\u8c03\u7528\u200b\u7528\u6237\u200b\u6001\u200b\u6ce8\u518c\u200b\u7684\u200b\u51fd\u6570\u200b\u8fdb\u884c\u200b\u5904\u7406\u200b \u3002</p> <p></p> <p>\u200b\u5982\u4e0a\u56fe\u200b\u6240\u793a\u200b\uff0c\u200b\u5176\u4e2d\u200b hello \u200b\u662f\u200b\u7528\u6237\u200b\u6001\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7a0b\u5e8f\u200b\uff0c \u200b\u8be5\u200b\u7a0b\u5e8f\u200b\u542f\u52a8\u200b\u7684\u200b\u65f6\u5019\u200b\u4f1a\u200b\u5c06\u200b\u81ea\u5df1\u200b\u5f00\u53d1\u200b\u7684\u200b\u63a5\u53e3\u200b\u6ce8\u518c\u200b\u5230\u200bFUSE\u200b\u4e2d\u200b \uff0c \u200b\u6bd4\u5982\u200b\u8bfb\u5199\u200b\u6587\u4ef6\u200b\u7684\u200b\u63a5\u53e3\u200b\uff0c\u200b\u904d\u5386\u200b\u76ee\u5f55\u200b\u7684\u200b\u63a5\u53e3\u200b \u200b\u7b49\u7b49\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c \u200b\u901a\u8fc7\u200b\u8be5\u200b\u7a0b\u5e8f\u200b\u5728\u200b\u7cfb\u7edf\u200b\u67d0\u4e2a\u200b\u8def\u5f84\u200b\u6302\u8f7d\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \uff0c\u200b\u6bd4\u5982\u200b<code>/tmp/fuse</code>\u3002\u200b\u6b64\u65f6\u200b \u200b\u5982\u679c\u200b\u5728\u200b\u8be5\u200b\u76ee\u5f55\u200b\u4e2d\u6709\u200b\u76f8\u5173\u200b\u64cd\u4f5c\u200b \u200b\u65f6\u200b\uff0c\u200b\u8bf7\u6c42\u200b\u4f1a\u200b\u7ecf\u8fc7\u200b Linux\u200b\u865a\u62df\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \uff08VFS\uff09\u200b\u5c42\u200b \u200b\u5230\u200bFUSE\u200b\u7684\u200b\u5185\u6838\u6a21\u5757\u200b \uff08\u200b\u5982\u200b\u8c03\u7528\u200b<code>ls</code>\u200b\u547d\u4ee4\u200b\uff0c\u200b\u5982\u4e0a\u56fe\u200b\u4e2d\u200b\u7684\u200b\u6b65\u9aa4\u200b\u2460\uff09\uff0c FUSE\u200b\u5185\u6838\u6a21\u5757\u200b\u6839\u636e\u200b\u8bf7\u6c42\u200b\u7c7b\u578b\u200b \uff0c\u200b\u8c03\u7528\u200b \u200b\u7528\u6237\u200b\u6001\u200b\u5e94\u7528\u200b\u6ce8\u518c\u200b \u200b\u7684\u200b\u51fd\u6570\u200b\uff08\u200b\u4e0a\u56fe\u200b\u4e2d\u200b\u6b65\u9aa4\u200b\u2461\uff09\uff0c\u200b\u7136\u540e\u200b \u200b\u5c06\u200b\u5904\u7406\u7ed3\u679c\u200b\u901a\u8fc7\u200bVFS\u200b\u8fd4\u56de\u200b\u7ed9\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b \uff08\u200b\u6b65\u9aa4\u200b\u2462\uff09\u3002</p>"},{"location":"lab5/part2/#22","title":"2.2  \u200b\u793a\u4f8b\u200b\u53ca\u200b\u8bf4\u660e","text":"<p>\u200b\u83b7\u53d6\u200b\u5b9e\u9a8c\u200b\u5305\u200b\u53c2\u8003\u200b\u73af\u5883\u200b\u642d\u5efa\u200b\u4e0e\u200b\u4e0a\u200b\u624b\u200b\u3002</p> <p>\u200b\u5728\u200b\u6211\u4eec\u200b\u63d0\u4f9b\u200b\u7684\u200b\u5b9e\u9a8c\u200b\u5305\u4e2d\u200b\uff0c\u200b\u5df2\u7ecf\u200b\u6709\u200b\u4e24\u4e2a\u200b\u5b8c\u5168\u200b\u642d\u5efa\u200b\u597d\u200b\u7684\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1a<code>simplefs</code>\uff08<code>fs/simplefs</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\uff09\u200b\u548c\u200b<code>myfs</code>\uff08<code>fs/samples</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\uff09\uff0c\u200b\u5176\u4e2d\u200b<code>simplefs</code>\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7c7b\u200bEXT2\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u4f46\u200b \u200b\u6ca1\u6709\u200b\u7ed9\u4e88\u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b \u200b\u7684\u200b\u5b9e\u73b0\u200b\uff1b<code>myfs</code>\u200b\u662f\u200b<code>github</code>\u200b\u4e0a\u200b\u7684\u200b\u4e00\u4e2a\u200b\u5f00\u6e90\u200b\u9879\u76ee\u200b\uff0c\u200b\u4e5f\u200b\u662f\u200b\u4e00\u4e2a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5b9e\u4f8b\u200b\u3002</p> <p>\u200b\u6b64\u5916\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u7ed9\u200b\u4e00\u4e2a\u200b\u6781\u7b80\u200b\u7684\u200bDemo\u3002\u200b\u8be5\u200bDemo\u200b\u975e\u5e38\u7b80\u5355\u200b\uff0c\u200b\u5b83\u200b\u5e76\u200b\u4e0d\u662f\u200b\u4e00\u4e2a\u200b\u771f\u6b63\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c \u200b\u4e5f\u200b\u4e0d\u4f1a\u200b\u8bbf\u95ee\u200b\u8bbe\u5907\u200b \uff0c\u200b\u800c\u662f\u200b\u5728\u200b \u200b\u8be5\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u7684\u200b\u6839\u76ee\u5f55\u200b\u4e2d\u200b \u200b\u663e\u793a\u200b\u4e00\u4e2a\u200b\u56fa\u5b9a\u200b\u7684\u200b\u6587\u4ef6\u200b \uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b<code>Hello-FUSE</code>\u200b\u6587\u4ef6\u200b\u3002</p> <pre><code>/* main.c\u200b\u6e90\u7801\u200b */\n\n#define FUSE_USE_VERSION 26\n#include &lt;stdio.h&gt;\n#include &lt;fuse.h&gt;\n\n/* \u200b\u8fd9\u91cc\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u904d\u5386\u200b\u76ee\u5f55\u200b\u7684\u200b\u529f\u80fd\u200b\uff0c\u200b\u5f53\u200b\u7528\u6237\u200b\u5728\u200b\u76ee\u5f55\u200b\u6267\u884c\u200bls\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u56de\u8c03\u200b\u5230\u200b\u8be5\u200b\u51fd\u6570\u200b\uff0c\u200b\u6211\u4eec\u200b\u8fd9\u91cc\u200b\u53ea\u662f\u200b\u8fd4\u56de\u200b\u4e00\u4e2a\u200b\u56fa\u5b9a\u200b\u7684\u200b\u6587\u4ef6\u200bHello-FUSE\u3002 */\nstatic int test_readdir(const char* path, void* buf, fuse_fill_dir_t filler, off_t offset, struct fuse_file_info* fi)\n{\n\nreturn filler(buf, \"Hello-FUSE\", NULL, 0);\n}\n\n/* \u200b\u663e\u793a\u200b\u6587\u4ef6\u5c5e\u6027\u200b */\nstatic int test_getattr(const char* path, struct stat *stbuf)\n{\nif(strcmp(path, \"/\") == 0)\nstbuf-&gt;st_mode = 0755 | S_IFDIR;            // \u200b\u8bf4\u660e\u200b\u8be5\u200b\u6587\u4ef6\u200b\u662f\u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b\nelse\nstbuf-&gt;st_mode = 0644 | S_IFREG;            // \u200b\u8bf4\u660e\u200b\u8be5\u200b\u6587\u4ef6\u200b\u662f\u200b\u666e\u901a\u200b\u6587\u4ef6\u200b\nreturn 0;\n}\n\n/*\u200b\u8fd9\u91cc\u200b\u662f\u200b\u56de\u8c03\u200b\u51fd\u6570\u200b\u96c6\u5408\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u5b9e\u73b0\u200b\u7684\u200b\u5f88\u200b\u7b80\u5355\u200b*/\nstatic struct fuse_operations ops = {\n.readdir = test_readdir,\n.getattr = test_getattr,\n};\n\nint main(int argc, char *argv[])\n{\nint ret = 0;\nret = fuse_main(argc, argv, &amp;ops, NULL);\nreturn ret;\n}\n</code></pre> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u7f16\u8bd1\u200b\u8fd0\u884c\u200b<code>main.c</code>\u200b\u6587\u4ef6\u200b</p> <pre><code>gcc -o hello main.c -D_FILE_OFFSET_BITS=64 -lfuse\n</code></pre> <p>\u200b\u5047\u8bbe\u200b\u5728\u200b<code>/tmp</code>\u200b\u76ee\u5f55\u200b\u4e0b\u9762\u200b\u6709\u200b\u4e00\u4e2a\u200b<code>fuse</code>\u200b\u76ee\u5f55\u200b\uff0c\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u53ef\u4ee5\u200b\u624b\u52a8\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u3002\u200b\u7136\u540e\u200b\u6267\u884c\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\u53ef\u4ee5\u200b\u5728\u200b\u8be5\u200b\u76ee\u5f55\u200b\u6302\u8f7d\u200b\u65b0\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u3002</p> <pre><code>[root@localhost test]# ./hello /tmp/fuse\n</code></pre> <p>\u200b\u6ce8\u610f\u200b \uff0c FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u6302\u8f7d\u200b\u4e0e\u200b\u4f20\u7edf\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u7684\u200b\u6302\u8f7d\u200b\u7565\u6709\u4e0d\u540c\u200b\uff0c\u200b\u5b83\u200b \u200b\u4e0d\u7528\u200bmount\u200b\u9009\u9879\u200b \uff0c\u200b\u76f4\u63a5\u200b\u8fd0\u884c\u200b\u4e8c\u8fdb\u5236\u200b\u6587\u4ef6\u200b\u5c31\u200b\u53ef\u200b\u5b8c\u6210\u200b\u6302\u8f7d\u200b\u3002\u200b\u4e0a\u9762\u200b\u547d\u4ee4\u200b\u7684\u200b\u610f\u601d\u200b\u662f\u200b\u5c06\u200b\u6587\u4ef6\u7cfb\u7edf\u200b<code>hello</code>\u200b\u6302\u8f7d\u200b\u5230\u200b<code>/tmp/fuse</code>\u3002</p> <p>\u200b\u6b64\u65f6\u200b\u8fd0\u884c\u200b<code>ls</code>\u200b\u547d\u4ee4\u200b\u770b\u770b\u200b\u6548\u679c\u200b\uff1a</p> <pre><code>[root@localhost tmp]# ls /fuse\nHello-FUSE\n[root@localhost tmp]# \n</code></pre> <p>\u200b\u53ef\u4ee5\u200b\u770b\u51fa\u200b\u6b63\u5f0f\u200b\u6211\u4eec\u200b\u671f\u671b\u200b\u7684\u200b\u5185\u5bb9\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b\u540d\u4e3a\u200b<code>Hello-FUSE</code>\u200b\u7684\u200b\u6587\u4ef6\u200b\u3002</p> <p>\u200b\u81f3\u4e8e\u200b\u5982\u4f55\u200b \u200b\u5229\u7528\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u6302\u8f7d\u200b\u8bbe\u5907\u200b \u3001 \u200b\u5982\u4f55\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b \uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u5728\u200b\u4efb\u52a1\u200b\u4e8c\u4e2d\u200b\u8fdb\u884c\u200b\u8be6\u7ec6\u63cf\u8ff0\u200b\u3002</p>"},{"location":"lab5/part2/#3-ddriver","title":"3.  DDRIVER\u200b\u865a\u62df\u200b\u78c1\u76d8\u200b\u9a71\u52a8","text":"<p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u865a\u62df\u200b\u78c1\u76d8\u200b\u63a5\u53e3\u200b\uff0c\u200b\u5934\u6587\u4ef6\u200b<code>ddriver.h</code>\u200b\u4e2d\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u5b8c\u5907\u200b\u7684\u200b\u6ce8\u91ca\u200b\u3002\u200b\u8be5\u200b\u63a5\u53e3\u200b\u5e95\u5c42\u200b\u5b9e\u73b0\u200b\u7b80\u5355\u200b\uff0c\u200b\u4e14\u200b\u57fa\u672c\u200b\u7b26\u5408\u200bPOSIX\u200b\u89c4\u8303\u200b\uff08\u200b\u5373\u200b\u4e0e\u200b\u6807\u51c6\u200b<code>write</code>\u3001<code>read</code>\u3001<code>lseek</code>\u3001<code>ioctl</code>\u200b\u7b49\u200b\u63a5\u53e3\u200b\u4fdd\u6301\u4e00\u81f4\u200b\uff09\u3002 \u200b\u552f\u4e00\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\u6211\u4eec\u200b\u5bf9\u200b\u5355\u6b21\u200b\u8bfb\u53d6\u200b\u3001\u200b\u5199\u5165\u200b\u7684\u200bIO\u200b\u5927\u5c0f\u200b\u505a\u51fa\u200b\u4e86\u200b\u9650\u5236\u200b\uff0c\u200b\u4fdd\u8bc1\u200b\u5176\u200b\u4e0e\u200b\u78c1\u76d8\u200b\u5757\u200b\u5927\u5c0f\u200b\u5bf9\u9f50\u200b \u3002\u200b\u5176\u4e2d\u200b\uff0cIO\u200b\u5927\u5c0f\u200b\u4e3a\u200b512B\uff0c\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b<code>ddriver_ioctl</code>\u200b\u6765\u200b\u8bf7\u6c42\u200bIO\u200b\u5927\u5c0f\u200b\uff0c\u200b\u5177\u4f53\u200b\u6211\u4eec\u200b\u5728\u200b\u4efb\u52a1\u200b\u4e8c\u4e2d\u200b\u4ecb\u7ecd\u200b\u3002</p> <p>DDRIVER\u200b\u9a71\u52a8\u200b \u200b\u6a21\u62df\u200b\u4e86\u200b \u200b\u5bf9\u200b\u4e00\u4e2a\u200b\u5bb9\u91cf\u200b\u4e3a\u200b4MiB\u200b\u7684\u200b\u78c1\u76d8\u200b \u200b\u7684\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u540c\u6837\u200b\uff0c4MiB\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b<code>ddriver_ioctl</code>\u200b\u51fd\u6570\u200b\u8bbf\u95ee\u200b\u5f97\u5230\u200b\u3002\u200b\u5176\u4e2d\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b\u7684\u200b\u662f\u200b\u5b83\u200b \u200b\u4fdd\u7559\u200b\u4e86\u200b\u78c1\u76d8\u200b\u7684\u200b\u8bbf\u95ee\u200b\u7279\u6027\u200b \uff0c\u200b\u5373\u200b \u200b\u6309\u5757\u200b\u8bbf\u95ee\u200b \uff0c\u200b\u6bcf\u6b21\u200b\u8bfb\u5199\u200b\u90fd\u200b\u9700\u8981\u200b \u200b\u8bfb\u5199\u200b\u5b8c\u6574\u200b\u7684\u200b512B \u200b\u7684\u200b\u78c1\u76d8\u200b\u5757\u200b\u3002\u200b\u8fd9\u200b\u5c06\u200b\u5f15\u8d77\u200b\u4e00\u4e9b\u200b\u5f88\u200b\u9ebb\u70e6\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u6bd4\u5982\u8bf4\u200b\u8981\u200b\u66f4\u65b0\u200b\u67d0\u4e2a\u200b\u78c1\u76d8\u200b\u5757\u200b\u4e2d\u200b\u7684\u200b\u67d0\u4e2a\u200binode\u200b\u65f6\u200b\uff0c\u200b\u9700\u8981\u200b\u5148\u200b\u628a\u200b\u6574\u4e2a\u200b\u78c1\u76d8\u200b\u5757\u200b\u8bfb\u51fa\u6765\u200b\uff0c\u200b\u66f4\u65b0\u200b\u76f8\u5e94\u200binode\uff0c\u200b\u518d\u200b\u5199\u56de\u53bb\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u76f4\u63a5\u200b\u5f80\u200b\u78c1\u76d8\u200b\u91cc\u200b\u5199\u200b\uff08\u200b\u9664\u975e\u200b\u4e00\u4e2a\u200binode\u200b\u6bd4\u200b\u4e00\u4e2a\u200b\u78c1\u76d8\u200b\u5757\u200b\u5927\u200b\uff09\u3002</p> <p>\u200b\u4ee5\u4e0b\u200b\u662f\u200bDDRIVER\u200b\u9a71\u52a8\u200b\u63d0\u4f9b\u200b\u7684\u200b\u5934\u6587\u4ef6\u200b<code>ddriver.h</code></p> <pre><code>#ifndef _DDRIVER_H_\n#define _DDRIVER_H_\n\n#include \"ddriver_ctl_user.h\"\n#include \"stdio.h\"\n\n/**\n* @brief \u200b\u6253\u5f00\u200bddriver\u200b\u8bbe\u5907\u200b\n* \n* @param path ddriver\u200b\u8bbe\u5907\u200b\u8def\u5f84\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint ddriver_open(char *path);\n\n/**\n* @brief \u200b\u79fb\u52a8\u200bddriver\u200b\u78c1\u76d8\u200b\u5934\u200b\n* \n* @param fd ddriver\u200b\u8bbe\u5907\u200bhandler\n* @param offset \u200b\u79fb\u52a8\u200b\u5230\u200b\u7684\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u6ce8\u610f\u200b\u8981\u200b\u548c\u200b\u8bbe\u5907\u200bIO\u200b\u5355\u4f4d\u200b\u5bf9\u9f50\u200b\n* @param whence SEEK_SET\u200b\u5373\u53ef\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint ddriver_seek(int fd, off_t offset, int whence);\n\n/**\n* @brief \u200b\u5199\u5165\u200b\u6570\u636e\u200b\n* \n* @param fd ddriver\u200b\u8bbe\u5907\u200bhandler\n* @param buf \u200b\u8981\u200b\u5199\u5165\u200b\u7684\u200b\u6570\u636e\u200bBuf\n* @param size \u200b\u8981\u200b\u5199\u5165\u200b\u7684\u200b\u6570\u636e\u200b\u5927\u5c0f\u200b\uff0c\u200b\u6ce8\u610f\u200b\u4e00\u5b9a\u200b\u8981\u200b\u7b49\u4e8e\u200b\u5355\u6b21\u200b\u8bbe\u5907\u200bIO\u200b\u5355\u4f4d\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint ddriver_write(int fd, char *buf, size_t size);\n\n/**\n* @brief \u200b\u8bfb\u51fa\u200b\u6570\u636e\u200b\n* \n* @param fd ddriver\u200b\u8bbe\u5907\u200bhandler\n* @param buf \u200b\u8981\u200b\u8bfb\u51fa\u200b\u7684\u200b\u6570\u636e\u200bBuf\n* @param size \u200b\u8981\u200b\u8bfb\u51fa\u200b\u7684\u200b\u6570\u636e\u200b\u5927\u5c0f\u200b\uff0c\u200b\u6ce8\u610f\u200b\u4e00\u5b9a\u200b\u8981\u200b\u7b49\u4e8e\u200b\u5355\u6b21\u200b\u8bbe\u5907\u200bIO\u200b\u5355\u4f4d\u200b\n* @return int \n*/\nint ddriver_read(int fd, char *buf, size_t size);\n\n/**\n* @brief ddriver IO\u200b\u63a7\u5236\u200b\n* \n* @param fd ddriver\u200b\u8bbe\u5907\u200bhandler\n* @param cmd \u200b\u547d\u4ee4\u200b\u53f7\u200b\uff0c\u200b\u67e5\u770b\u200bddriver_ctl_user\uff0cIOC_\u200b\u5f00\u5934\u200b\n* @param ret \u200b\u8fd4\u56de\u503c\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint ddriver_ioctl(int fd, unsigned long cmd, void *ret);\n\n/**\n* @brief \u200b\u5173\u95ed\u200bddriver\u200b\u8bbe\u5907\u200b\n* \n* @param fd ddriver\u200b\u8bbe\u5907\u200bhandler\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint ddriver_close(int fd);\n\n#endif /* _DDRIVER_H_ *\n</code></pre> <p>\u200b\u503c\u5f97\u4e00\u63d0\u7684\u662f\u200b \uff0c DDRIVER \u200b\u7684\u200b\u5b9e\u73b0\u200b\u6709\u200b\u4e24\u4e2a\u200b\u7248\u672c\u200b\uff1a \u200b\u5185\u6838\u200b\u7248\u672c\u200b \u200b\u548c\u200b \u200b\u7528\u6237\u200b\u7248\u672c\u200b \u3002\u200b\u5176\u4e2d\u200b\uff0c \u200b\u5185\u6838\u200b\u7248\u672c\u200b \u200b\u7684\u200b\u7f16\u5199\u200b\u662f\u200b\u91c7\u7528\u200b \u200b\u5185\u6838\u6a21\u5757\u200b \u200b\u7684\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b<code>user-land-filesystem/driver/kernel_ddriver</code>\u200b\u4e0b\u200b\uff0c\u200b\u7531\u4e8e\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u73af\u5883\u200b\u6240\u81f4\u200b\uff0c\u200b\u5185\u6838\u200b\u7248\u672c\u200b\u6682\u505c\u200b\u4f7f\u7528\u200b\uff0c\u200b\u5982\u679c\u200b\u5927\u5bb6\u200b\u6709\u200b\u5174\u8da3\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u53bb\u200b\u53c2\u8003\u200b\u4e00\u4e0b\u200b\u4e00\u4e2a\u200b\u5185\u6838\u6a21\u5757\u200b\u7684\u200b\u7f16\u7a0b\u200b\u65b9\u6cd5\u200b\uff1b \u200b\u7528\u6237\u200b\u7248\u672c\u200b \u200b\u4f4d\u4e8e\u200b<code>user-land-filesystem/driver/user_ddriver</code>\u200b\u4e0b\u200b\uff0c\u200b\u7528\u6237\u200b\u7248\u672c\u200b\u7684\u200b\u7f16\u8bd1\u200b\u65b9\u5f0f\u200b\u662f\u200b\u9759\u6001\u200b\u94fe\u63a5\u5e93\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4f60\u200b\u65e0\u6cd5\u200b\u76f4\u63a5\u200b\u901a\u8fc7\u200bDebug\u200b\u8c03\u8bd5\u200b\u8fdb\u5165\u200b\u5230\u200b\u4e0a\u8ff0\u200b\u63a5\u53e3\u200b\u5b9e\u73b0\u200b\u7684\u200b\u4ee3\u7801\u200b\u4e2d\u200b\uff0c \u200b\u8fd9\u200b\u4e5f\u200b\u662f\u200b\u4e3a\u4e86\u200b\u6a21\u62df\u200b\u771f\u5b9e\u200b\u9a71\u52a8\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u8003\u8651\u200b \u3002</p>"},{"location":"lab5/part3-1/","title":"\u73af\u5883\u200b\u642d\u5efa\u200b\u4e0e\u200b\u4e0a\u200b\u624b","text":""},{"location":"lab5/part3-1/#1","title":"1. \u200b\u5b9e\u9a8c\u200b\u5305\u200b\u7ed3\u6784\u200b\u4ecb\u7ecd","text":"<p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u5145\u5206\u8003\u8651\u200b\u5230\u200b\u00a0\u200b\u4e0a\u200b\u624b\u200b\u6210\u672c\u200b\u00a0\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u7f16\u5199\u200b\u4e86\u200b\u7b80\u5355\u200b\u7684\u200b\u73af\u5883\u200b\u914d\u7f6e\u200b\u811a\u672c\u200b\uff0c\u200b\u5e2e\u52a9\u200b\u5927\u5bb6\u200b\u4e00\u952e\u200b\u914d\u7f6e\u200b\u5f00\u53d1\u200b\u73af\u5883\u200b\u3002\u200b\u5b9e\u9a8c\u200b\u5305\u200b\u4ee3\u7801\u200b\u83b7\u53d6\u200b\u9014\u5f84\u200b\uff1a</p> <pre><code># git clone https://gitee.com/ftutorials/user-land-filesystem.git\n</code></pre> <p>\u200b\u5b9e\u9a8c\u200b\u5305\u200b\u7684\u200b\u7ed3\u6784\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>user-land-filesystem/\n\u251c\u2500\u2500 driver\n\u2502   \u251c\u2500\u2500 ddriver.sh\n\u2502   \u251c\u2500\u2500 kernel_ddriver\n\u2502   \u2514\u2500\u2500 user_ddriver\n\u251c\u2500\u2500 fs\n\u2502   \u251c\u2500\u2500 samples\n\u2502   \u251c\u2500\u2500 simplefs\n\u2502   \u2514\u2500\u2500 template\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 setenv.sh\n\u2514\u2500\u2500 tests\n    \u251c\u2500\u2500 README.md\n    \u2514\u2500\u2500 test_ddriver\n</code></pre> <ul> <li><code>driver</code></li> </ul> <p>\u200b\u5b58\u653e\u200b\u9a71\u52a8\u200b\u4ee3\u7801\u200b\u3002\u200b\u5176\u4e2d\u200b<code>kernel_ddriver</code>\u200b\u4e3a\u200b\u5185\u6838\u200b\u9a71\u52a8\u200b\uff0c<code>user_ddriver</code>\u200b\u4e3a\u200b\u7528\u6237\u200b\u9a71\u52a8\u200b\uff0c<code>ddriver.sh</code>\u200b\u4e3a\u200b\u63a7\u5236\u200b\u00a0ddriver\u00a0\u200b\u9a71\u52a8\u200b\u7684\u200b\u811a\u672c\u200b\u3002\u200b\u8fdb\u5165\u200buser-land-filesystem\u200b\u76ee\u5f55\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8fd0\u884c\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\u5c1d\u9c9c\u200b\uff1a</p> <pre><code>[root@localhost user-land-filesystem]# ./driver/ddriver.sh </code></pre> <ul> <li><code>fs</code></li> </ul> <p>\u200b\u5b58\u653e\u200b\u00a0\u200b\u5b9e\u73b0\u200b\u7684\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u3002\u200b\u5176\u4e2d\u200b<code>samples</code>\u200b\u4e3a\u200b<code>myfs</code>\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c<code>simplefs</code>\u200b\u4e3a\u7c7b\u200b<code>EXT2</code>\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff08\u200b\u7f3a\u5c11\u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b\uff09\uff0c<code>template</code>\u200b\u7528\u4e8e\u200b\u751f\u6210\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u4ee3\u7801\u200b\u7ed3\u6784\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\u3002</p> <ul> <li><code>LICENSE</code></li> </ul> <p>\u200b\u5f00\u6e90\u200b\u8bb8\u53ef\u200b\uff0c\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u9075\u5faa\u200b\u00a0GPL v3\u00a0\u200b\u5f00\u6e90\u200b\u8bb8\u53ef\u200b\u3002</p> <ul> <li><code>tests</code></li> </ul> <p>\u200b\u8be5\u200b\u6587\u4ef6\u5939\u200b\u5b58\u653e\u200bDDRIVER\u200b\u7528\u6237\u200b\u9a71\u52a8\u200b\u4ee3\u7801\u200b\u3002</p> <ul> <li><code>setenv.sh</code></li> </ul> <p>\u200b\u7528\u4e8e\u200b\u914d\u7f6e\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5f00\u53d1\u200b\u73af\u5883\u200b\u3002</p>"},{"location":"lab5/part3-1/#2","title":"2. \u200b\u914d\u7f6e\u200b\u5f00\u53d1\u200b\u73af\u5883","text":"<p>\u200b\u8fd0\u884c\u200b<code>./setenv.sh</code>\u200b\u540e\u200b\uff0c\u200b\u5373\u53ef\u200b\u6309\u7167\u200b\u6307\u5bfc\u200b\u4e00\u6b65\u200b\u4e00\u6b65\u200b\u6765\u200b\u5efa\u7acb\u200b\u73af\u5883\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem$ ./setenv.sh \u200b\u8bf7\u200b\u8f93\u5165\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u540d\u79f0\u200b ([\u200b\u5de5\u4f5c\u200b]\u200b\u76ee\u5f55\u200b\u5c06\u200b\u88ab\u200b\u81f3\u4e8e\u200b./fs\u200b\u76ee\u5f55\u200b\u4e0b\u200b): newfs\n...\n\u200b\u751f\u6210\u200b\u5de5\u4f5c\u200b\u8def\u5f84\u200b:  /home/guests/teststu_8/user-land-filesystem/fs/newfs\n\u200b\u8bf7\u200b\u8f93\u5165\u200b\u9879\u76ee\u540d\u79f0\u200b: newfs\n...\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u540d\u79f0\u200b\u5373\u200b\u5f00\u53d1\u200b\u8be5\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u00a0\u200b\u6587\u4ef6\u5939\u200b\u540d\u79f0\u200b\u00a0\u3002\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\uff0c\u200b\u5b83\u200b\u5728\u200b<code>fs</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u65b0\u5efa\u200b\u4e86\u200b\u4e00\u4e2a\u200b<code>newfs</code>\u200b\u76ee\u5f55\u200b\u4f5c\u4e3a\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u3002</p> <p>\u200b\u63a5\u7740\u200b\uff0c\u200b\u9879\u76ee\u540d\u79f0\u200b\u5373\u200b\u771f\u6b63\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u540d\u79f0\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u662f\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u7b80\u5199\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1anfs\uff08\u200b\u4ee3\u8868\u200bnewfs\uff09\uff0c\u200b\u8fd9\u91cc\u200b\u8981\u200b\u6ce8\u610f\u200b\u9879\u76ee\u200b\u540d\u200b\u4e0d\u80fd\u200b\u6709\u200b\u00a0\u200b\u7279\u6b8a\u7b26\u53f7\u200b\u3001\u200b\u7a7a\u683c\u200b\u00a0\u200b\u7b49\u200b\u3002</p> <p>\u200b\u9879\u76ee\u200b\u5efa\u7acb\u200b\u5b8c\u6210\u200b\u4e4b\u540e\u200b\u7684\u200b\u7ed3\u6784\u200b<code>newfs</code>\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a</p> <pre><code>./fs/newfs/\n\u251c\u2500\u2500 .vscode\n\u251c\u2500\u2500 CMake\n\u2502   \u2514\u2500\u2500 FindFUSE.cmake\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include\n\u2502    \u251c\u2500\u2500 ddriver_ctl_user.h\n\u2502    \u251c\u2500\u2500 ddriver.h\n\u2502    \u251c\u2500\u2500 fs.layout\n\u2502    \u251c\u2500\u2500 newfs.h\n\u2502    \u2514\u2500\u2500 types.h\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 SPEC.txt\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 newfs.c\n\u2514\u2500\u2500 tests\n    \u251c\u2500\u2500 checkbm\n    \u2502   \u251c\u2500\u2500 checkbm.py\n    \u2502   \u251c\u2500\u2500 golden-sfs.json\n    \u2502   \u2514\u2500\u2500 golden.json\n    \u251c\u2500\u2500 mnt\n    \u251c\u2500\u2500 stages\n    \u2502   \u251c\u2500\u2500 cp.sh\n    \u2502   \u251c\u2500\u2500 ls.sh\n    \u2502   \u251c\u2500\u2500 mkdir.sh\n    \u2502   \u251c\u2500\u2500 mount.sh\n    \u2502   \u251c\u2500\u2500 remount.sh\n    \u2502   \u251c\u2500\u2500 rw.sh\n    \u2502   \u2514\u2500\u2500 touch.sh \n    \u251c\u2500\u2500 fs_test.sh\n    \u251c\u2500\u2500 main.sh\n    \u2514\u2500\u2500 test.sh\n</code></pre> <p>\u200b\u8fd9\u4e2a\u200b\u7ed3\u6784\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u4fee\u6539\u200b\u6dfb\u52a0\u200b\uff0c\u200b\u4e0d\u8fc7\u200b\u8981\u200b\u8bb0\u5f97\u200b\u00a0\u200b\u91cd\u65b0\u914d\u7f6e\u200bCMake\u00a0\u3002\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u5f88\u200b\u7b80\u5355\u200b\uff0c\u00a0\u200b\u8dd1\u200b\u8fc7\u200b<code>tests</code>\u200b\u4e0b\u200b\u7684\u200b<code>test.sh</code>\u200b\u7684\u200b\u57fa\u7840\u200b\u529f\u80fd\u6d4b\u8bd5\u200b\u5c31\u7b97\u200b\u5b8c\u6210\u200b\u00a0\u3002</p>"},{"location":"lab5/part3-1/#3-ddriver","title":"3. DDRIVER\u200b\u811a\u672c\u200b\u7684\u200b\u8fd0\u7528","text":"<p>\u200b\u4e3a\u4e86\u200b\u65b9\u4fbf\u200b\u5bf9\u200b\u00a0ddriver\u00a0\u200b\u8bbe\u5907\u200b\u8fdb\u884c\u200b\u63a7\u5236\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200bddriver.sh\u200b\u811a\u672c\u200b\u94fe\u63a5\u200b\u5230\u200b\u4e86\u200b\u00a0Linux\u200b\u547d\u4ee4\u200b\u7cfb\u7edf\u200b\u00a0\u200b\u4e2d\u200b\uff0c\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u5927\u5bb6\u200b\u5148\u5230\u200b<code>\u200b\u4e2a\u4eba\u200b\u76ee\u5f55\u200b</code>\u200b\u4e0b\u200b\u8fd0\u884c\u200bsource ~/.bashrc\uff0c\u200b\u7136\u540e\u200b\u540c\u5b66\u200b\u4eec\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u5728\u200b\u4efb\u4f55\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8bbf\u95ee\u200b\u5230\u200bddriver.sh\u200b\u811a\u672c\u200b\u3002\u200b\u8be5\u200b\u811a\u672c\u200b\u7684\u200b\u4e3b\u8981\u7528\u9014\u200b\u5982\u4e0b\u200b\uff1a </p> <pre><code>teststu_8@OSLabExecNode0:~/$ source ~/.bashrc teststu_8@OSLabExecNode0:~/$ ddriver ====================================================================\n]]]]]]]]    ]]]]]]]]             \n]      ]]   ]      ]]   ]   ]]   ]]   ]]    ]]    ]-------]   ]   ]]   \n]       ]   ]       ]   ] ]]     ]]    ]]  ]]     ]_______/   ] ]]     \n]      ]]   ]      ]]   ]]       ]]     ]  ]      \\           ]]      \n]]]]]]]]    ]]]]]]]]    ]]       ]]      ]]        ]]]]]]]]   ]]  \n====================================================================\n\n\u200b\u7528\u6cd5\u200b: ddriver [options]\noptions: \n-i [k|u]      \u200b\u5b89\u88c5\u200bddriver: [k] - kernel / [u] - user\n-t            \u200b\u6d4b\u8bd5\u200bddriver[\u200b\u8bf7\u200b\u5ffd\u7565\u200b]\n-d            \u200b\u5bfc\u51fa\u200bddriver\u200b\u81f3\u200b\u5f53\u524d\u5de5\u4f5c\u200b\u76ee\u5f55\u200b[PWD]\n-r            \u200b\u64e6\u9664\u200bddriver\n-l            \u200b\u663e\u793a\u200bddriver\u200b\u7684\u200bLog\n-v            \u200b\u663e\u793a\u200bddriver\u200b\u7684\u200b\u7c7b\u578b\u200b[\u200b\u5185\u6838\u6a21\u5757\u200b / \u200b\u7528\u6237\u200b\u9759\u6001\u200b\u94fe\u63a5\u5e93\u200b]\n-h            \u200b\u6253\u5370\u200b\u672c\u200b\u5e2e\u52a9\u200b\u83dc\u5355\u200b\n====================================================================\n</code></pre> <p>\u200b\u5e38\u7528\u200b\u7684\u200b\u529f\u80fd\u200b\u662f\u200b<code>-v</code>\u3001<code>-d</code>\u200b\u4e0e\u200b<code>-r</code>\uff0c\u200b\u5b83\u4eec\u200b\u7684\u200b\u7528\u9014\u200b\u5206\u522b\u200b\u662f\u200b\u00a0\u200b\u67e5\u770b\u200bddriver\u200b\u8bbe\u5907\u200b\u7c7b\u578b\u200b\u53ca\u200b\u8bbe\u5907\u200b\u4f4d\u7f6e\u200b\u00a0\u3001\u00a0\u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u955c\u50cf\u200b\u5bfc\u51fa\u200b\u5230\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e0b\u200b\u00a0\u3001\u00a0\u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u64e6\u9664\u200b\u5e72\u51c0\u200b\u00a0\u3002\u200b\u7528\u6cd5\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>====================================================================\n# \u200b\u67e5\u770b\u200b\u8bbe\u5907\u200b\u4f4d\u7f6e\u200b\u548c\u200b\u7c7b\u578b\u200b\nteststu_8@OSLabExecNode0:~$ ddriver -v\n\u200b\u9759\u6001\u200b\u94fe\u63a5\u5e93\u200b\u8bbe\u5907\u200b: /home/guests/teststu_8/ddriver\nteststu_8@OSLabExecNode0:~$ \n\n====================================================================\n# \u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u5bfc\u51fa\u200b\u5230\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e0b\u200b\nteststu_8@OSLabExecNode0:~/$ ddriver -d\n[sudo] password for teststu_8: \n\u200b\u76ee\u6807\u200b\u8bbe\u5907\u200b /home/guests/teststu_8/ddriver\n8192+0 records in\n8192+0 records out\n4194304 bytes (4.2 MB, 4.0 MiB) copied, 0.094218 s, 44.5 MB/s\n\u200b\u6587\u4ef6\u200b\u5df2\u200b\u5bfc\u51fa\u200b\u81f3\u200b/home/guests/teststu_8/ddriver_dump\uff0c\u200b\u8bf7\u200b\u5b89\u88c5\u200bHexEditor\u200b\u63d2\u4ef6\u200b\u67e5\u770b\u200b\u5176\u200b\u5185\u5bb9\u200b\nteststu_8@OSLabExecNode0:~/$ ls\nddriver_dump \nteststu_8@OSLabExecNode0:~/$\n\n====================================================================\n# \u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u64e6\u9664\u200b\u5e72\u51c0\u200b\nteststu_8@OSLabExecNode0:~/$ ddriver -r\n\u200b\u76ee\u6807\u200b\u8bbe\u5907\u200b /home/guests/teststu_8/ddriver\n8192+0 records in\n8192+0 records out\n4194304 bytes (4.2 MB, 4.0 MiB) copied, 0.0506111 s, 82.9 MB/s\nteststu_8@OSLabExecNode0:~/$ cat ./ddriver_dump\nteststu_8@OSLabExecNode0:~/$\n</code></pre>"},{"location":"lab5/part3-1/#4","title":"4. \u200b\u9879\u76ee\u200b\u7f16\u8bd1","text":"<p>\u200b\u9879\u76ee\u200b\u7f16\u8bd1\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u5728\u200b\u65b0\u5efa\u200b\u9879\u76ee\u200b\u7684\u200bSPEC.txt\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u6709\u6240\u200b\u4ea4\u4ee3\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u63d0\u51fa\u200b\u6765\u8bb2\u200b\u4e00\u8bb2\u200b\uff1a</p> <ul> <li>Step 1\u00a0. SSH\u200b\u6253\u5f00\u200b<code>./fs/newfs</code>\u3002\u200b\u6253\u5f00\u200bVSCode\u200b\u8f6f\u4ef6\u200b\uff0c\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u89d2\u200b \"\u200b\u6587\u4ef6\u200b\" \u2192 \"\u200b\u6253\u5f00\u200b\u6587\u4ef6\u5939\u200b\"\uff0c\u200b\u9009\u62e9\u200b\u5b9e\u9a8c\u200b\u5305\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200bfs/newfs\u200b\u6587\u4ef6\u5939\u200b\u3002</li> </ul> <p></p> <ul> <li>Step 2\u00a0. \u200b\u5728\u200b\u8fdc\u7a0b\u200b\u5b9e\u9a8c\u200b\u5e73\u53f0\u200b\u4e0a\u200b\u5b89\u88c5\u200bCMake\u3001CMake Tools\u3001C/C++\u200b\u4e09\u4e2a\u200b\u63d2\u4ef6\u200b\u3002</li> </ul> <p></p> <p></p> <p></p> <ul> <li>Step 3 . \u200b\u6253\u5f00\u200bCMakeLists.txt\u200b\u6587\u4ef6\u200b</li> <li>Step 4\u00a0. ctrl + shift + p\u200b\u547c\u200b\u51fa\u200b\u547d\u4ee4\u200b\u83dc\u5355\u200b</li> <li>Step 5\u00a0. \u200b\u8f93\u5165\u200bCMake: Configure</li> <li>Step 6 . \u200b\u9009\u62e9\u200bX86_64\u200b\u7248\u672c\u200b\u7684\u200bGCC\uff1a</li> </ul> <p></p> <ul> <li>Step 7 . \u200b\u70b9\u51fb\u200bVSCode\u200b\u5de6\u4e0b\u89d2\u200b\u201c\u200b\u7ba1\u7406\u200b\u201d\u200b\u6309\u94ae\u200b\uff0c\u200b\u9009\u62e9\u200b\u201c\u200b\u8bbe\u7f6e\u200b\u201d\uff0c\u200b\u7136\u540e\u200b\u5728\u200b\u5f39\u51fa\u200b\u7684\u200b\u7a97\u53e3\u200b\u4e2d\u200b\u8f93\u5165\u200b<code>@ext:ms-vscode.cmake-tools generator</code>\uff0c\u200b\u518d\u200b\u70b9\u51fb\u200b\u201c\u200b\u8fdc\u7a0b\u200b[SSH:10.249.12.98]\u201d\u200b\u9009\u9879\u200b\u680f\u200b\uff0c\u200b\u5728\u200bCmake: Generator\u200b\u9009\u9879\u200b\u6846\u4e2d\u200b\u586b\u5165\u200b<code>Unix Makefiles</code>\u3002</li> </ul> <p></p> <ul> <li>Step 8\u00a0. \u200b\u518d\u6b21\u200b\u7528\u200bctrl + shift + p\u200b\u547c\u200b\u51fa\u200b\u547d\u4ee4\u200b\u83dc\u5355\u200b\uff0c\u200b\u8f93\u5165\u200bCMake: Configure\uff0c\u200b\u67e5\u770b\u200b\u8f93\u51fa\u200b\u7a97\u53e3\u200b\u662f\u5426\u200b\u6709\u200b\u201cGenerator\u201d (\u200b\u5df2\u200b\u7528\u200b!!!!!\u200b\u6807\u8bb0\u200b)</li> </ul> <p></p> <p>\u200b\u82e5\u200b\u00a0CMAKE_GENERATOR\u00a0\u200b\u4e3a\u200b\u00a0Unix Makefiles\u00a0\uff0c\u200b\u8bf7\u200b\u624b\u52a8\u200b\u4fee\u6539\u200b<code>.vscode/tasks.json</code>\u200b\u7684\u200b<code>command</code>\u200b\u4e3a\u200b<code>make</code>\uff0c\u200b\u82e5\u200b\u4e3a\u200b\u00a0Ninja\u00a0\uff0c\u200b\u8bf7\u200b\u624b\u52a8\u200b\u4fee\u6539\u200b<code>.vscode/tasks.json</code>\u200b\u7684\u200b<code>command</code>\u200b\u4e3a\u200b<code>ninja</code>\uff0c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <ul> <li> <p>Step 9\u00a0. \u200b\u5230\u200b<code>newfs/src/newfs.c</code>\u200b\u76ee\u5f55\u200b\uff0c\u200b\u6253\u65ad\u200b\u70b9\u200b</p> </li> <li> <p>Step 10\u00a0. \u200b\u6309\u4e0b\u200bF5\u200b\u8fdb\u884c\u200b\u8c03\u8bd5\u200b</p> </li> </ul> <p></p> <p>\u200b\u7f16\u8bd1\u200b\u8fd0\u884c\u200b\u539f\u7406\u200b\uff1a</p> <ul> <li>\u200b\u7f16\u8bd1\u200b\u3002\u00a0\u200b\u7f16\u8bd1\u200b\u73af\u8282\u200b\u5229\u7528\u200bCMakeLists\u200b\u5de5\u7a0b\u200b\u81ea\u52a8\u200b\u5e2e\u52a9\u200b\u6211\u4eec\u200b\u7f16\u8bd1\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u8981\u200b\u5b89\u88c5\u200bCMake Tools\u200b\u7b49\u200b\u62d3\u5c55\u200b\uff0c\u200b\u76f8\u4fe1\u200b\u5927\u5bb6\u200b\u524d\u9762\u200b\u4e5f\u200b\u88c5\u8fc7\u200b\u4e86\u200b\u3002\u200b\u5176\u4e2d\u200b\uff0c\u200b\u6309\u4e0b\u200bF5\u200b\u540e\u200b\uff0cVSCode\u200b\u4f1a\u200b\u9996\u5148\u200b\u8fd0\u884c\u200b<code>.vscode</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b<code>tasks.json</code>\u200b\u4e2d\u200b\u7684\u200b\u547d\u4ee4\u200b\uff1a</li> </ul> <p></p> <p>\u200b\u8be5\u200b\u547d\u4ee4\u200b\u6267\u884c\u200b\u7684\u200b\u64cd\u4f5c\u200b\u5c31\u662f\u200b\u5728\u200bCMakeLists\u200b\u751f\u6210\u200b\u7684\u200b<code>build</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8fd0\u884c\u200b<code>make</code>\uff0c\u200b\u7531\u6b64\u200b\u5b8c\u6210\u200b\u81ea\u52a8\u200b\u7f16\u8bd1\u200b\u3002</p> <ul> <li>\u200b\u8fd0\u884c\u200b\u3002\u00a0\u200b\u8fd0\u884c\u200b\u8fc7\u7a0b\u200b\u662f\u200b\u5728\u200b<code>.vscode</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b<code>launch.json</code>\u200b\u4e2d\u200b\u5b9a\u4e49\u200b\uff1a</li> </ul> <p></p> <p>\u200b\u628a\u200b\u8fd0\u884c\u200b\u547d\u4ee4\u200b\u5c55\u5f00\u200b\u5b9e\u9645\u4e0a\u200b\u662f\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem/fs/newfs$ ./build/newfs --device=/home/guests/teststu_8/ddriver -f -d -s ./tests/mnt/\n</code></pre> <p>\u200b\u6b63\u5982\u200b\u6211\u4eec\u200b\u524d\u9762\u200b\u00a0\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b - FUSE\u200b\u67b6\u6784\u200b\u00a0\u200b\u4e2d\u8bf4\u200b\u5230\u200b\u7684\u200b\u90a3\u6837\u200b\uff0c\u00a0FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u7684\u200b\u6302\u8f7d\u200b\u4e0d\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b<code>mount</code>\u200b\u547d\u4ee4\u200b\uff0c\u200b\u800c\u662f\u200b\u76f4\u63a5\u200b\u7528\u200b\u7f16\u8bd1\u200b\u51fa\u6765\u200b\u7684\u200b\u4e8c\u8fdb\u5236\u200b\u6587\u4ef6\u200b\u3002\u200b\u4e0a\u8ff0\u200b\u547d\u4ee4\u200b\u7684\u200b\u610f\u4e49\u200b\u4e3a\u200b\uff1a\u00a0\u200b\u5c06\u200b\u8bbe\u5907\u200b/home/guests/teststu_8/ddriver\u00a0\u200b\u4ee5\u200b\u00a0newfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u5f62\u5f0f\u200b\uff0c\u00a0\u200b\u6302\u8f7d\u200b\u00a0\u200b\u5230\u200b\u00a0./tests/mnt\u200b\u76ee\u5f55\u200b\u00a0\u200b\u4e0b\u200b\u3002</p> <p>\u200b\u8fdb\u800c\u200b\u884d\u751f\u200b\u51fa\u200b\u00a0FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u7684\u200b\u00a0\u200b\u5378\u8f7d\u200b\u00a0\uff0c\u200b\u540c\u6837\u200b\uff0c\u200b\u4e0e\u200b\u4f20\u7edf\u200b\u5185\u6838\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5378\u8f7d\u200b\u4e0d\u540c\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u5378\u8f7d\u200b\u547d\u4ee4\u200b\u4e3a\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem/fs/newfs$ fusermount -u ./tests/mnt\nteststu_8@OSLabExecNode0:~/user-land-filesystem/fs/newfs$ \n</code></pre> <p>\u200b\u8fd9\u91cc\u200b\u4f7f\u7528\u200b<code>fusermount -u</code>\u200b\u547d\u4ee4\u200b\u8fdb\u884c\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u5378\u8f7d\u200b\u3002</p>"},{"location":"lab5/part3-2/","title":"\u4efb\u52a1\u200b\u4e00\u200b\uff1a\u200b\u719f\u6089\u200bDDRIVER\u200b\u9a71\u52a8","text":"<p>\u200b\u4efb\u52a1\u200b\u4e00\u200b\u8981\u6c42\u200b\u719f\u6089\u200bDDRIVER\u200b\u9a71\u52a8\u200b\uff0c\u200b\u6211\u4eec\u200b\u8981\u6c42\u200b\u5927\u5bb6\u200b\u6839\u636e\u200b\u6ce8\u91ca\u200b\u770b\u200b\u61c2\u200b<code>user-land-filesystem/tests/test_ddriver/src/test.c</code>\u200b\u7684\u200b\u4ee3\u7801\u200b\uff0c\u200b\u5e76\u200b\u00a0\u200b\u6839\u636e\u200b\u63d0\u793a\u200b\u00a0\u200b\u4fee\u6539\u200b\u5176\u4e2d\u200b\u7684\u200b\u00a0\u200b\u4e00\u5904\u200b\u9519\u8bef\u200b\u00a0\uff1a</p> <p></p> <p>\u200b\u7f16\u8bd1\u200b\u8fd0\u884c\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b\u7684\u200b\u6b65\u9aa4\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver$ mkdir -p build teststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver$ cd build\nteststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver/build$ cmake ..\nteststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver/build$ make\nteststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver/build$ ./ddriver_test </code></pre>"},{"location":"lab5/part3-3/","title":"\u4efb\u52a1\u200b\u4e8c\u200b\uff1a\u200b\u57fa\u4e8e\u200bFUSE\u200b\u5b9e\u73b0\u200b\u9752\u6625\u200b\u7248\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u200b\u719f\u6089\u200b\u4e86\u200b\u9a71\u52a8\u200b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e5f\u200b\u5c31\u200b\u57fa\u672c\u200b\u638c\u63e1\u200b\u4e86\u200b\u8bbf\u95ee\u200b\u00a0DDRIVER\u00a0\u200b\u8bbe\u5907\u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u6211\u4eec\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u57fa\u4e8e\u200bFUSE\u200b\u6765\u200b\u6b63\u5f0f\u200b\u7f16\u5199\u200b\u00a0\u200b\u9752\u6625\u200b\u7248\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u4e86\u200b\u3002\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u5728\u200b\u00a0\u200b\u73af\u5883\u200b\u914d\u7f6e\u200b\u00a0\u200b\u9636\u6bb5\u200b\u5c31\u200b\u4e3a\u200b\u5927\u5bb6\u200b\u642d\u5efa\u200b\u597d\u200b\u4e86\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u9879\u76ee\u200b\u6846\u67b6\u200b\u3002</p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u4e24\u4e2a\u200b\u5b8c\u5168\u200b\u642d\u5efa\u200b\u597d\u200b\u7684\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1a<code>simplefs</code>\uff08<code>fs/simplefs</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\uff09\u200b\u548c\u200b<code>myfs</code>\uff08<code>fs/samples</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\uff09\uff0c\u200b\u5176\u4e2d\u200b<code>simplefs</code>\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7c7b\u200bEXT2\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u4f46\u200b\u00a0\u200b\u6ca1\u6709\u200b\u7ed9\u4e88\u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b\u00a0\u200b\u7684\u200b\u5b9e\u73b0\u200b\uff1b<code>myfs</code>\u200b\u662f\u200b<code>github</code>\u200b\u4e0a\u200b\u7684\u200b\u4e00\u4e2a\u200b\u5f00\u6e90\u200b\u9879\u76ee\u200b\uff0c\u200b\u4e5f\u200b\u662f\u200b\u4e00\u4e2a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5b9e\u4f8b\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b\uff0c\u200b\u5728\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\uff0csimplefs\u200b\u548c\u200bsfs\u200b\u90fd\u200b\u4ee3\u8868\u200bSimple File System\u3002</p>"},{"location":"lab5/part3-3/#1","title":"1. \u200b\u5b9e\u73b0\u200b\u6b65\u9aa4\u200b\u5efa\u8bae","text":"<ul> <li> <p>\u200b\u5c01\u88c5\u200b\u5bf9\u200b\u00a0ddriver\u00a0\u200b\u7684\u200b\u8bbf\u95ee\u200b\u4ee3\u7801\u200b\uff0c\u200b\u65b9\u4fbf\u200b\u8bbe\u5907\u200b\u8bfb\u5199\u200b\u3002\u200b\u6ce8\u610f\u200b\u9a71\u52a8\u200b\u8bfb\u5199\u200bIO\u200b\u4e3a\u200b512B\uff0c\u200b\u4f46\u662f\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e00\u4e2a\u200b\u5757\u200b\u5927\u5c0f\u200b\u4e3a\u200b1024B\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u4e24\u4e2a\u200bIO\u200b\u5355\u4f4d\u200b\u3002\u200b\u5728\u200bsimplefs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e2d\u200b\u4e5f\u200b\u5c01\u88c5\u200b\u4e86\u200b\u00a0ddriver\u00a0\u200b\u7684\u200b\u8bbf\u95ee\u200b\u4ee3\u7801\u200b\uff0c\u200b\u7136\u800c\u200bsimplefs\u200b\u662f\u200b\u6309\u200b\u4e00\u4e2a\u200b\u5757\u200b\u5927\u5c0f\u200b\u4e3a\u200b512B\u200b\u6765\u200b\u5c01\u88c5\u200b\u7684\u200b\uff08\u200b\u8be6\u89c1\u200bsfs_utils.c\u200b\u7684\u200bsfs_driver_read\u200b\u51fd\u6570\u200b\uff09\u3002</p> </li> <li> <p>\u200b\u8bbe\u8ba1\u200b\u4ecb\u8d28\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u4f4d\u4e8e\u200b<code>types.h</code>\uff09\uff1b</p> </li> <li> <p>\u200b\u8bbe\u8ba1\u200b\u5185\u5b58\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u53ef\u200b\u8bbe\u8ba1\u200b\u3001\u200b\u53ef\u4e0d\u200b\u8bbe\u8ba1\u200b\uff09\uff1b</p> </li> <li> <p>\u200b\u4ed4\u7ec6\u9605\u8bfb\u200b<code>include/fs.layout</code>\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u6309\u200b\u8981\u6c42\u200b\u8bbe\u8ba1\u200b\u586b\u5199\u200b\u81ea\u5df1\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5e03\u5c40\u200b\uff0c\u200b\u5728\u200b\u6d4b\u8bd5\u200bumount\u200b\u65f6\u4f1a\u200b\u5bf9\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5e03\u5c40\u200b\u8fdb\u884c\u200b\u68c0\u6d4b\u200b\uff1b</p> </li> <li> <p>\u200b\u5b8c\u6210\u200b<code>.init</code>\u200b\u94a9\u5b50\u200b\uff1a\u200b\u8bfb\u200b\u00a0\u200b\u8d85\u7ea7\u200b\u5757\u200b\u00a0\u3001\u200b\u521d\u59cb\u5316\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1b</p> </li> <li> <p>\u200b\u5b8c\u6210\u200b<code>.destroy</code>\u200b\u94a9\u5b50\u200b\uff1a\u00a0\u200b\u56de\u5199\u200b\u5fc5\u8981\u200b\u7ed3\u6784\u200b\u00a0\uff0c\u200b\u4fdd\u8bc1\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u6302\u8f7d\u200b\u6b63\u5e38\u200b\uff1b</p> </li> <li> <p>\u200b\u9a8c\u8bc1\u200b\u6302\u8f7d\u200b\u5378\u8f7d\u200b\u6d41\u7a0b\u200b\u7684\u200b\u6b63\u786e\u6027\u200b\uff08\u00a0\u200b\u4e3b\u8981\u200b\u770b\u200b\u8bfb\u5199\u200b\u662f\u5426\u200b\u6b63\u786e\u200b\u00a0\uff09\uff1b</p> </li> <li> <p>\u200b\u5b8c\u6210\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff08\u200b\u53ef\u200b\u81ea\u884c\u8bbe\u8ba1\u200b\uff09\uff1a</p> <ul> <li> <p>\u200b\u5b8c\u6210\u200b\u00a0\u200b\u5206\u914d\u200binode\u00a0\u200b\u51fd\u6570\u200b\uff1a\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200bInode\u3001\u200b\u521d\u59cb\u5316\u200b\u5176\u4e0a\u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\u3001\u200b\u4fee\u6539\u200b\u4f4d\u200b\u56fe\u200b\u7ed3\u6784\u200b\uff0c\u200b\u53ef\u80fd\u200b\u8fd8\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u8d85\u7ea7\u200b\u5757\u200b\uff1b</p> </li> <li> <p>\u200b\u5b8c\u6210\u200b\u00a0\u200b\u5206\u914d\u200bdentry\u00a0\u200b\u51fd\u6570\u200b\uff1a\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200bdentry\u3001\u200b\u521d\u59cb\u5316\u200b\u5176\u4e0a\u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\uff1b</p> </li> <li> <p>\u200b\u5b8c\u6210\u200b\u5c06\u200b\u00a0dentry\u200b\u52a0\u5165\u200b\u5230\u200binode\u00a0\u200b\u4e2d\u200b\u7684\u200b\u51fd\u6570\u200b\uff1a\u200b\u5c06\u200b\u751f\u6210\u200b\u7684\u200bdentry\u200b\u5199\u5165\u200b\u5230\u200binode\u200b\u4e2d\u200b\uff1b</p> </li> <li> <p>\u200b\u5b8c\u6210\u200b\u00a0\u200b\u8def\u5f84\u200b\u89e3\u6790\u200b\u51fd\u6570\u200b\u00a0\uff0c\u200b\u8981\u4e48\u200b\u8fd4\u56de\u200bdentry\uff0c\u200b\u8981\u4e48\u200b\u8fd4\u56de\u200binode\uff0c\u200b\u53ef\u200b\u81ea\u884c\u8bbe\u8ba1\u200b\uff1b</p> </li> </ul> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.get_attr</code>\u200b\u94a9\u5b50\u200b\uff1b</p> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.mknod</code>\u200b\u94a9\u5b50\u200b\uff1b</p> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.mkdir</code>\u200b\u94a9\u5b50\u200b\uff1b</p> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.readdir</code>\u200b\u94a9\u5b50\u200b\uff1b</p> </li> <li> <p>\u200b\u624b\u5de5\u200b\u6d4b\u8bd5\u200b<code>touch</code>\u3001<code>ls</code>\u3001\u00a0<code>mkdir</code>\u3001<code>fusermount -u</code>\u200b\u7b49\u200b\u547d\u4ee4\u200b\u7684\u200b\u6b63\u786e\u6027\u200b\uff1b</p> </li> <li> <p>\u200b\u901a\u8fc7\u200b<code>./tests/test.sh</code>\u200b\u811a\u672c\u200b\u7684\u200b\u57fa\u672c\u200b\u529f\u80fd\u6d4b\u8bd5\u200b\u3002</p> </li> </ul>"},{"location":"lab5/part3-3/#2-simplefs","title":"2. simplefs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u53c2\u8003\u200b\u5b9e\u73b0","text":"<p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u4e3a\u200b\u964d\u4f4e\u200b\u540c\u5b66\u200b\u4eec\u200b\u7684\u200b\u4e0a\u200b\u624b\u200b\u6210\u672c\u200b\uff0c\u200b\u672c\u8282\u200b\u5bf9\u200bSimple File System\u200b\u4ee3\u7801\u200b\u8fdb\u884c\u200b\u5939\u53d9\u5939\u8bae\u200b\u5730\u200b\u6df1\u5165\u5206\u6790\u200b\uff0c\u200b\u5e0c\u671b\u200b\u80fd\u200b\u5bf9\u200b\u5404\u4f4d\u200b\u540c\u5b66\u200b\u6709\u6240\u200b\u5e2e\u52a9\u200b: )</p> <p>\u200b\u6837\u4f8b\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff08SFS\uff09\u200b\u7684\u200b\u7cfb\u7edf\u200b\u5e03\u5c40\u200b\u5982\u4e0b\u200b\uff1a</p> <p></p> <p>\u200b\u8981\u200b\u63a5\u5165\u200b\u4e00\u4e2a\u200b\u6846\u67b6\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c11\u4e0d\u4e86\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\uff08\u200b\u4e5f\u200b\u53ef\u200b\u79f0\u4e3a\u200b\u00a0\u200b\u51fd\u6570\u6307\u9488\u200b\u00a0\uff09\u3002\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\u00a0\u200b\u662f\u200b\u4e00\u7cfb\u5217\u200b\u51fd\u6570\u200b\u7684\u200b\u62bd\u8c61\u200b\u00a0\uff0c\u200b\u4ece\u800c\u200b\u8ba9\u200bC\u200b\u8bed\u8a00\u200b\u5177\u6709\u200b\u591a\u6001\u200b\u7684\u200b\u6027\u8d28\u200b\u3002\u200b\u5bf9\u4e8e\u200bFUSE\u200b\u6846\u67b6\u200b\uff0c\u200b\u5176\u200b\u7ed9\u200b\u6211\u4eec\u200b\u7684\u200b\u63a5\u53e3\u200b\u00a0\u200b\u5982\u4e0b\u200b\u00a0\u3002</p> <pre><code>struct fuse_operations {\nint (*getattr) (const char *, struct stat *);\nint (*readlink) (const char *, char *, size_t);\nint (*getdir) (const char *, fuse_dirh_t, fuse_dirfil_t);\nint (*mknod) (const char *, mode_t, dev_t);\nint (*mkdir) (const char *, mode_t);\nint (*unlink) (const char *);\nint (*rmdir) (const char *);\nint (*symlink) (const char *, const char *);\nint (*rename) (const char *, const char *);\nint (*link) (const char *, const char *);\nint (*chmod) (const char *, mode_t);\nint (*chown) (const char *, uid_t, gid_t);\nint (*truncate) (const char *, off_t);\nint (*utime) (const char *, struct utimbuf *);\nint (*open) (const char *, struct fuse_file_info *);\nint (*read) (const char *, char *, size_t, off_t,\nstruct fuse_file_info *);\nint (*write) (const char *, const char *, size_t, off_t,\nstruct fuse_file_info *);\nint (*statfs) (const char *, struct statvfs *);\nint (*flush) (const char *, struct fuse_file_info *);\nint (*release) (const char *, struct fuse_file_info *);\nint (*fsync) (const char *, int, struct fuse_file_info *);\nint (*setxattr) (const char *, const char *, const char *, size_t, int);\nint (*getxattr) (const char *, const char *, char *, size_t);\nint (*listxattr) (const char *, char *, size_t);\nint (*removexattr) (const char *, const char *);\nint (*opendir) (const char *, struct fuse_file_info *);\nint (*readdir) (const char *, void *, fuse_fill_dir_t, off_t,\nstruct fuse_file_info *);\nint (*releasedir) (const char *, struct fuse_file_info *);\nint (*fsyncdir) (const char *, int, struct fuse_file_info *);\nvoid *(*init) (struct fuse_conn_info *conn);\nvoid (*destroy) (void *);\nint (*access) (const char *, int);\nint (*create) (const char *, mode_t, struct fuse_file_info *);\nint (*ftruncate) (const char *, off_t, struct fuse_file_info *);\nint (*fgetattr) (const char *, struct stat *, struct fuse_file_info *);\nint (*lock) (const char *, struct fuse_file_info *, int cmd,\nstruct flock *);\nint (*utimens) (const char *, const struct timespec tv[2]);\nint (*bmap) (const char *, size_t blocksize, uint64_t *idx);\nint (*ioctl) (const char *, int cmd, void *arg,\nstruct fuse_file_info *, unsigned int flags, void *data);\nint (*poll) (const char *, struct fuse_file_info *,\nstruct fuse_pollhandle *ph, unsigned *reventsp);\nint (*write_buf) (const char *, struct fuse_bufvec *buf, off_t off,\nstruct fuse_file_info *);\nint (*read_buf) (const char *, struct fuse_bufvec **bufp,\nsize_t size, off_t off, struct fuse_file_info *);\nint (*flock) (const char *, struct fuse_file_info *, int op);\nint (*fallocate) (const char *, int, off_t, off_t,\nstruct fuse_file_info *);\n};\n</code></pre> <p>\u200b\u4ee5\u200b\u4e0b\u9762\u200b\u4e00\u884c\u200b\u4ee3\u7801\u200b\u4e3a\u4f8b\u200b\uff1a</p> <pre><code>int (*mkdir) (const char *, mode_t);\n</code></pre> <p>\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\u00a0\u200b\u62bd\u8c61\u200b\u4e86\u200b\u6240\u6709\u200b <code>mkdir</code>\u200b\u7684\u200b\u64cd\u4f5c\u200b\uff1a\u200b\u6240\u6709\u200b<code>mkdir</code>\u200b\u90fd\u200b\u9700\u8981\u200b\u63a5\u53d7\u200b\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u4f5c\u4e3a\u200b\u00a0\u200b\u8def\u5f84\u200b\u00a0\u3001\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u4f5c\u4e3a\u200b\u00a0\u200b\u521b\u5efa\u200b\u6a21\u5f0f\u200b\u00a0\uff08\u200b\u53ea\u8bfb\u200b/\u200b\u53ea\u200b\u5199\u200b/\u200b\u53ef\u8bfb\u200b\u53ef\u200b\u5199\u200b\uff09\u3002\u200b\u4e0d\u540c\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u53ef\u4ee5\u200b\u57fa\u4e8e\u200b\u6b64\u200b\u5b9e\u73b0\u200b\u4e0d\u540c\u200b\u7684\u200b<code>mkdir</code>\u200b\u4ee3\u7801\u200b\uff0c\u200b\u4e3e\u4e2a\u200b\u4f8b\u5b50\u200b\uff1a</p> <pre><code>// \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e00\u200b\u5b9e\u73b0\u200bmkdir\nint mkdir(const char *path, mode_t mode) {\nprintf(\"\u200b\u6211\u200b\u4e0d\u200b\u7ed9\u200b\u4f60\u200b\u521b\u5efa\u200b %s\\n\", path);\nreturn 0;\n}\n\n// \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e8c\u200b\u5b9e\u73b0\u200bmkdir\nint mkdir(const char *path, mode_t mode) {\ndentry = lookup(path);          // \u200b\u67e5\u627e\u200b\u8def\u5f84\u200b\uff0c\u200b\u627e\u5230\u200b\u7236\u7ea7\u200bdentry\ninode  = new_inode();           // \u200b\u521b\u5efa\u200b\u8be5\u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b\u7684\u200binode\nnew_dentry = new_dentry();      // \u200b\u521b\u5efa\u200b\u5c5e\u4e8e\u200b\u8be5\u200binode\u200b\u7684\u200bdentry\nbond(new_dentry, inode);        // \u200b\u8ba9\u200b\u8be5\u200bdentry\u200b\u6307\u5411\u200binode\nadd(dentry, new_dentry);        // \u200b\u5c06\u200b\u65b0\u521b\u5efa\u200b\u7684\u200bdentry\u200b\u52a0\u5165\u200b\u5230\u200b\u7236\u7ea7\u200bdentry\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b\u4e2d\u200b\nreturn 0;\n}\n</code></pre> <p>FUSE\u200b\u6846\u67b6\u200b\u00a0\u200b\u901a\u8fc7\u200b\u5411\u200b<code>fuse_main</code>\u200b\u51fd\u6570\u200b\u4f20\u5165\u200b\u4e00\u4e2a\u200b\u88ab\u200b\u590d\u5236\u200b\u7684\u200b<code>fuse_operations</code>\u200b\u7ed3\u6784\u200b\u4f53\u200b\u5373\u53ef\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u7684\u200b\u6ce8\u518c\u200b\uff0c\u200b\u4ece\u800c\u200b\u4f7f\u5f97\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u80fd\u591f\u200b\u6309\u7167\u200b\u6211\u4eec\u200b\u65e2\u5b9a\u200b\u7684\u200b\u65b9\u5f0f\u200b\u6765\u200b\u5904\u7406\u200b\u547d\u4ee4\u200b\u3002\u200b\u4e0b\u56fe\u200b\u4e3a\u200b\u00a0\u200b\u5c06\u200b\u64cd\u4f5c\u200b\u63a5\u5165\u200bFUSE\u200b\u7684\u200b\u5165\u53e3\u200b\u00a0\uff1a</p> <p></p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u7531\u4e8e\u200b\u5b9e\u73b0\u200b\u7684\u200b\u529f\u80fd\u200b\u8f83\u4e3a\u7b80\u5355\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ea\u200b\u8981\u6c42\u200b\u540c\u5b66\u200b\u4eec\u200b\u5b9e\u73b0\u200b\u4ee5\u4e0b\u200b\u94a9\u5b50\u200b\uff08\u200b\u5176\u4e2d\u200b\u6807\u8bb0\u200b\u4e3a\u200b\u00a0NULL\u00a0\u200b\u7684\u200b\u5728\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u4e0d\u200b\u8981\u6c42\u200b\u5b9e\u73b0\u200b\uff09\uff1a</p> <pre><code>// Line 21 \nstatic struct fuse_operations operations = {\n.init = newfs_init,                      /* mount\u200b\u6587\u4ef6\u7cfb\u7edf\u200b */        .destroy = newfs_destroy,                /* umount\u200b\u6587\u4ef6\u7cfb\u7edf\u200b */\n.mkdir = newfs_mkdir,                    /* \u200b\u5efa\u200b\u76ee\u5f55\u200b\uff0cmkdir */\n.getattr = newfs_getattr,                /* \u200b\u83b7\u53d6\u200b\u6587\u4ef6\u5c5e\u6027\u200b\uff0c\u200b\u7c7b\u4f3c\u200bstat\uff0c\u200b\u5fc5\u987b\u200b\u5b8c\u6210\u200b */\n.readdir = newfs_readdir,                /* \u200b\u586b\u5145\u200bdentrys */\n.mknod = newfs_mknod,                    /* \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\uff0ctouch\u200b\u76f8\u5173\u200b */\n.write = NULL,                           /* \u200b\u5199\u5165\u200b\u6587\u4ef6\u200b */\n.read = NULL,                            /* \u200b\u8bfb\u200b\u6587\u4ef6\u200b */\n.utimens = newfs_utimens,                /* \u200b\u4fee\u6539\u200b\u65f6\u95f4\u200b\uff0c\u200b\u5ffd\u7565\u200b\uff0c\u200b\u907f\u514d\u200btouch\u200b\u62a5\u9519\u200b */\n.truncate = NULL,                        /* \u200b\u6539\u53d8\u200b\u6587\u4ef6\u5927\u5c0f\u200b */\n.unlink = NULL,                          /* \u200b\u5220\u9664\u200b\u6587\u4ef6\u200b */\n.rmdir  = NULL,                          /* \u200b\u5220\u9664\u200b\u76ee\u5f55\u200b\uff0c rm -r */\n.rename = NULL,                          /* \u200b\u91cd\u547d\u540d\u200b\uff0cmv */\n\n.open = NULL,                           .opendir = NULL,\n.access = NULL\n};\n</code></pre> <p>\u200b\u5148\u200b\u6765\u770b\u200b\u4e00\u4e0b\u200bsfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7ed9\u51fa\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u5b9a\u4e49\u200b\uff1a</p> <pre><code>struct custom_options {\nconst char*        device;//\u200b\u9a71\u52a8\u200b\u7684\u200b\u8def\u5f84\u200b\nboolean            show_help;\n};\n\nstruct sfs_inode /*\u200b\u5185\u5b58\u200b\u4e2d\u200binode\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b*/\n{\nint                ino;                           /* \u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u6807\u200b */\nint                size;                          /* \u200b\u6587\u4ef6\u200b\u5df2\u200b\u5360\u7528\u200b\u7a7a\u95f4\u200b */\nint                dir_cnt;\nstruct sfs_dentry* dentry;                        /* \u200b\u6307\u5411\u200b\u8be5\u200binode\u200b\u7684\u200bdentry */\nstruct sfs_dentry* dentrys;                       /* \u200b\u6240\u6709\u200b\u76ee\u5f55\u200b\u9879\u200b */\nuint8_t*           data;           };  struct sfs_dentry/*\u200b\u5185\u5b58\u200b\u4e2d\u200b\u76ee\u5f55\u200b\u9879\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b*/\n{\nchar               fname[SFS_MAX_FILE_NAME];\nstruct sfs_dentry* parent;                        /* \u200b\u7236\u4eb2\u200bInode\u200b\u7684\u200bdentry */\nstruct sfs_dentry* brother;                       /* \u200b\u5144\u5f1f\u200b */\nint                ino;\nstruct sfs_inode*  inode;                         /* \u200b\u6307\u5411\u200binode */\nSFS_FILE_TYPE      ftype;\n};\n\nstruct sfs_super/*\u200b\u5185\u5b58\u200b\u4e2d\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b*/\n{\nint                driver_fd;\n\nint                sz_io;/*inode\u200b\u7684\u200b\u5927\u5c0f\u200b*/\nint                sz_disk;/*\u200b\u78c1\u76d8\u200b\u5927\u5c0f\u200b*/\nint                sz_usage;\n\nint                max_ino;/*inode\u200b\u7684\u200b\u6570\u76ee\u200b*/\nuint8_t*           map_inode;/*inode\u200b\u4f4d\u200b\u56fe\u200b*/\nint                map_inode_blks;/*inode\u200b\u4f4d\u56fe\u200b\u6240\u200b\u5360\u200b\u7684\u200b\u6570\u636e\u200b\u5757\u200b*/\nint                map_inode_offset;/*inode\u200b\u4f4d\u56fe\u200b\u7684\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b*/\n\nint                data_offset;/*\u200b\u6570\u636e\u200b\u5757\u200b\u7684\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b*/\n\nboolean            is_mounted;\n\nstruct sfs_dentry* root_dentry;/*\u200b\u6839\u76ee\u5f55\u200b*/\n};\n\n/******************************************************************************\n* \u200b\u78c1\u76d8\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\n*******************************************************************************/\nstruct sfs_super_d\n{\nuint32_t           magic_num;\nint                sz_usage;\n\nint                max_ino;\nint                map_inode_blks;\nint                map_inode_offset;\nint                data_offset;\n};\n\nstruct sfs_inode_d\n{\nint                ino;                           /* \u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u6807\u200b */\nint                size;                          /* \u200b\u6587\u4ef6\u200b\u5df2\u200b\u5360\u7528\u200b\u7a7a\u95f4\u200b */\nint                dir_cnt;\nSFS_FILE_TYPE      ftype;   };  struct sfs_dentry_d\n{\nchar               fname[SFS_MAX_FILE_NAME];\nSFS_FILE_TYPE      ftype;\nint                ino;                           /* \u200b\u6307\u5411\u200b\u7684\u200bino\u200b\u53f7\u200b */\n};  </code></pre> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u518d\u200b\u5206\u522b\u200b\u4ecb\u7ecd\u200b\u5404\u4e2a\u200b\u64cd\u4f5c\u200b\u5b9e\u73b0\u200b\u8981\u200b\u7ecf\u8fc7\u200b\u7684\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u8ba9\u200b\u540c\u5b66\u200b\u4eec\u200b\u6709\u200b\u4e2a\u200b\u66f4\u200b\u76f4\u89c2\u200b\u7684\u200b\u7406\u89e3\u200b\u3002</p>"},{"location":"lab5/part3-3/#21-mount","title":"2.1 \u200b\u5b9e\u73b0\u200bmount","text":"<p>\u200b\u5f53\u200b\u6302\u8f7d\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.init</code>\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>.init</code>\u200b\u94a9\u5b50\u200b\u4e2d\u200b\u5b8c\u6210\u200b\u00a0\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u8bfb\u53d6\u200b\u00a0\u3001\u00a0\u200b\u4f4d\u56fe\u200b\u7684\u200b\u5efa\u7acb\u200b\u00a0\u3001\u00a0\u200b\u9a71\u52a8\u200b\u7684\u200b\u521d\u59cb\u5316\u200b\u00a0\u200b\u7b49\u200b\u64cd\u4f5c\u200b\uff1a</p> <p><pre><code>/**\n* @brief \u200b\u6302\u8f7d\u200b\uff08mount\uff09\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\n* \n* @param conn_info \u200b\u53ef\u200b\u5ffd\u7565\u200b\uff0c\u200b\u4e00\u4e9b\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u76f8\u5173\u200b\u7684\u200b\u4fe1\u606f\u200b \n* @return void*\n*/\nvoid* newfs_init(struct fuse_conn_info * conn_info) {\n/* TODO: \u200b\u5728\u200b\u8fd9\u91cc\u200b\u8fdb\u884c\u200b\u6302\u8f7d\u200b */\n\n/* \u200b\u4e0b\u9762\u200b\u662f\u200b\u4e00\u4e2a\u200b\u63a7\u5236\u200b\u8bbe\u5907\u200b\u7684\u200b\u793a\u4f8b\u200b */\nsuper.fd = ddriver_open(newfs_options.device);\n\nreturn NULL;\n}\n</code></pre> \u200b\u4e0a\u9762\u200b\u7684\u200b\u793a\u4f8b\u200b\u662f\u200b\u521d\u59cb\u5316\u200b\u9a71\u52a8\u200b\u8bbe\u5907\u200b\uff0c\u200b\u5176\u4e2d\u200b<code>newfs_options</code>\u200b\u4e3a\u200b\u81ea\u5b9a\u4e49\u200b\u53c2\u6570\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u4e0d\u200b\u5bf9\u200b\u00a0\u200b\u81ea\u5b9a\u4e49\u200b\u53c2\u6570\u200b\u00a0\u200b\u505a\u200b\u66f4\u200b\u591a\u200b\u7684\u200b\u4ecb\u7ecd\u200b\uff0c\u200b\u5927\u5bb6\u200b\u4f1a\u200b\u7528\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u64cd\u4f5c\u200b\u6765\u200b\u5b9e\u73b0\u200bsfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u6302\u8f7d\u200b\u529f\u80fd\u200b\uff08sfs_mount\u200b\u51fd\u6570\u200b\uff09\uff1a</p> <ul> <li>Step 1\u00a0. \u200b\u9996\u5148\u200b\u5b9a\u4e49\u200b\u5185\u5b58\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u3002</li> </ul> <pre><code>    /*\u200b\u5b9a\u4e49\u200b\u78c1\u76d8\u200b\u5404\u200b\u90e8\u5206\u200b\u7ed3\u6784\u200b*/\nint                 ret = SFS_ERROR_NONE;\nint                 driver_fd;\nstruct sfs_super_d  sfs_super_d; struct sfs_dentry*  root_dentry;\nstruct sfs_inode*   root_inode;\n\nint                 inode_num;\nint                 map_inode_blks;\n\nint                 super_blks;\nboolean             is_init = FALSE;\n\nsfs_super.is_mounted = FALSE;\n</code></pre> <ul> <li>Step 2\u00a0. \u200b\u6253\u5f00\u200b\u9a71\u52a8\u200b\u3002</li> </ul> <pre><code>    driver_fd = ddriver_open(options.device);/*\u200b\u6253\u5f00\u200b\u9a71\u52a8\u200b*/\n\nif (driver_fd &lt; 0) {\nreturn driver_fd;\n}\n</code></pre> <ul> <li>Step 3\u00a0. \u200b\u5411\u200b\u5185\u5b58\u200b\u8d85\u7ea7\u200b\u5757\u200b\u4e2d\u200b\u6807\u8bb0\u200b\u9a71\u52a8\u200b\u5e76\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u5927\u5c0f\u200b\u548c\u200b\u5355\u6b21\u200bIO\u200b\u5927\u5c0f\u200b\u3002</li> </ul> <pre><code>    sfs_super.driver_fd = driver_fd;\nddriver_ioctl(SFS_DRIVER(), IOC_REQ_DEVICE_SIZE,  &amp;sfs_super.sz_disk);\nddriver_ioctl(SFS_DRIVER(), IOC_REQ_DEVICE_IO_SZ, &amp;sfs_super.sz_io);\n</code></pre> <ul> <li>Step 4\u00a0. \u200b\u521b\u5efa\u200b\u6839\u76ee\u5f55\u200b\u9879\u200b\u5e76\u200b\u8bfb\u53d6\u200b\u78c1\u76d8\u200b\u8d85\u7ea7\u200b\u5757\u200b\u5230\u200b\u5185\u5b58\u200b\u3002</li> </ul> <pre><code>    root_dentry = new_dentry(\"/\", SFS_DIR);\n\nif (sfs_driver_read(SFS_SUPER_OFS, (uint8_t *)(&amp;sfs_super_d), sizeof(struct sfs_super_d)) != SFS_ERROR_NONE) {\nreturn -SFS_ERROR_IO;\n}  </code></pre> <ul> <li>Step 5\u00a0. \u200b\u6839\u636e\u200b\u8d85\u7ea7\u200b\u5757\u200b\u5e7b\u6570\u200b\u5224\u65ad\u200b\u662f\u5426\u200b\u4e3a\u200b\u7b2c\u4e00\u6b21\u200b\u542f\u52a8\u200b\u78c1\u76d8\u200b\uff0c\u200b\u5982\u679c\u200b\u662f\u200b\u7b2c\u4e00\u6b21\u200b\u542f\u52a8\u200b\u78c1\u76d8\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u5efa\u7acb\u200b\u78c1\u76d8\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u5e03\u5c40\u200b\u3002</li> </ul> <pre><code>    if (sfs_super_d.magic_num != SFS_MAGIC_NUM) {     /* \u200b\u5e7b\u6570\u200b\u65e0\u200b */\n/* \u200b\u4f30\u7b97\u200b\u5404\u200b\u90e8\u5206\u200b\u5927\u5c0f\u200b */\nsuper_blks = SFS_ROUND_UP(sizeof(struct sfs_super_d), SFS_IO_SZ()) / SFS_IO_SZ();\n\ninode_num  =  SFS_DISK_SZ() / ((SFS_DATA_PER_FILE + SFS_INODE_PER_FILE) * SFS_IO_SZ());\n\nmap_inode_blks = SFS_ROUND_UP(SFS_ROUND_UP(inode_num, UINT32_BITS), SFS_IO_SZ()) / SFS_IO_SZ();\n\n/* \u200b\u5e03\u5c40\u200blayout */\nsfs_super.max_ino = (inode_num - super_blks - map_inode_blks); sfs_super_d.map_inode_offset = SFS_SUPER_OFS + SFS_BLKS_SZ(super_blks);\nsfs_super_d.data_offset = sfs_super_d.map_inode_offset + SFS_BLKS_SZ(map_inode_blks);\nsfs_super_d.map_inode_blks  = map_inode_blks;\nsfs_super_d.sz_usage    = 0;\nSFS_DBG(\"inode map blocks: %d\\n\", map_inode_blks);\nis_init = TRUE;\n}\n</code></pre> <ul> <li>Step 6\u00a0. \u200b\u521d\u59cb\u5316\u200b\u5185\u5b58\u200b\u4e2d\u200b\u7684\u200b\u8d85\u7ea7\u200b\u5757\u200b\uff0c\u200b\u548c\u200b\u6839\u76ee\u5f55\u200b\u9879\u200b\u3002</li> </ul> <pre><code>    sfs_super.sz_usage   = sfs_super_d.sz_usage;      /* \u200b\u5efa\u7acb\u200b in-memory \u200b\u7ed3\u6784\u200b */\n\nsfs_super.map_inode = (uint8_t *)malloc(SFS_BLKS_SZ(sfs_super_d.map_inode_blks));\nsfs_super.map_inode_blks = sfs_super_d.map_inode_blks;\nsfs_super.map_inode_offset = sfs_super_d.map_inode_offset;\nsfs_super.data_offset = sfs_super_d.data_offset;\n\nif (sfs_driver_read(sfs_super_d.map_inode_offset, (uint8_t *)(sfs_super.map_inode), SFS_BLKS_SZ(sfs_super_d.map_inode_blks)) != SFS_ERROR_NONE) {\nreturn -SFS_ERROR_IO;\n}\n\nif (is_init) {                                    /* \u200b\u5206\u914d\u200b\u6839\u200b\u8282\u70b9\u200b */\nroot_inode = sfs_alloc_inode(root_dentry);\nsfs_sync_inode(root_inode);\n}\n\nroot_inode            = sfs_read_inode(root_dentry, SFS_ROOT_INO);\nroot_dentry-&gt;inode    = root_inode;\nsfs_super.root_dentry = root_dentry;\nsfs_super.is_mounted  = TRUE;\n\nsfs_dump_map();\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c\u200b\u5728\u200bStep 4\u200b\u4e2d\u200b\u7528\u5230\u200b\u7684\u200b <code>new_dentry</code>\u200b\u51fd\u6570\u200b\uff0c\u200b\u5176\u200b\u4f5c\u7528\u200b\u662f\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u539f\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>static inline struct sfs_dentry* new_dentry(char * fname, SFS_FILE_TYPE ftype) {\nstruct sfs_dentry * dentry = (struct sfs_dentry *)malloc(sizeof(struct sfs_dentry));\nmemset(dentry, 0, sizeof(struct sfs_dentry));\nSFS_ASSIGN_FNAME(dentry, fname);\ndentry-&gt;ftype   = ftype;\ndentry-&gt;ino     = -1;\ndentry-&gt;inode   = NULL;\ndentry-&gt;parent  = NULL;\ndentry-&gt;brother = NULL;                                            }\n</code></pre> <p>\u200b\u5728\u200bStep 6\u200b\u4e2d\u200b\u7684\u200b<code>sfs_alloc_inode</code>\uff0c\u200b\u5176\u200b\u4f5c\u7528\u200b\u662f\u200b\u4e3a\u200b\u76ee\u5f55\u200b\u9879\u200b\u521b\u5efa\u200binode\u200b\u8282\u70b9\u200b\uff0c\u200b\u5177\u4f53\u6b65\u9aa4\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b\u4ee5\u4e0b\u200b\u51e0\u6b65\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e0a\u200b\u5bfb\u627e\u200b\u672a\u200b\u4f7f\u7528\u200b\u7684\u200binode\u200b\u8282\u70b9\u200b\u3002</p> <pre><code>    for (byte_cursor = 0; byte_cursor &lt; SFS_BLKS_SZ(sfs_super.map_inode_blks); byte_cursor++)/*\u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e0a\u200b\u5bfb\u627e\u200b\u672a\u200b\u4f7f\u7528\u200b\u7684\u200binode*/\n{\nfor (bit_cursor = 0; bit_cursor &lt; UINT8_BITS; bit_cursor++) {\nif((sfs_super.map_inode[byte_cursor] &amp; (0x1 &lt;&lt; bit_cursor)) == 0) {    /* \u200b\u5f53\u524d\u200bino_cursor\u200b\u4f4d\u7f6e\u200b\u7a7a\u95f2\u200b */\nsfs_super.map_inode[byte_cursor] |= (0x1 &lt;&lt; bit_cursor);\nis_find_free_entry = TRUE;           break;\n}\nino_cursor++;\n}\nif (is_find_free_entry) {\nbreak;\n}\n}\n</code></pre> <p>\u200b   \u2461\u200b\u4e3a\u200b\u76ee\u5f55\u200b\u9879\u200b\u5206\u914d\u200binode\u200b\u8282\u70b9\u200b\u5e76\u200b\u5efa\u7acb\u200b\u4ed6\u4eec\u200b\u4e4b\u95f4\u200b\u7684\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>    if (!is_find_free_entry || ino_cursor == sfs_super.max_ino)\nreturn -SFS_ERROR_NOSPACE;\n\ninode = (struct sfs_inode*)malloc(sizeof(struct sfs_inode));\ninode-&gt;ino  = ino_cursor; inode-&gt;size = 0;\n/* dentry\u200b\u6307\u5411\u200binode */\ndentry-&gt;inode = inode;\ndentry-&gt;ino   = inode-&gt;ino;\n/* inode\u200b\u6307\u200b\u56de\u200bdentry */\ninode-&gt;dentry = dentry;\n\ninode-&gt;dir_cnt = 0;\ninode-&gt;dentrys = NULL;\n\nif (SFS_IS_REG(inode)) {\ninode-&gt;data = (uint8_t *)malloc(SFS_BLKS_SZ(SFS_DATA_PER_FILE));\n}\n</code></pre> <p>\u200b\u800c\u200b\u5728\u200bStep 6\u200b\u4e2d\u200b\u7684\u200bsfs_read_inode\u200b\u51fd\u6570\u200b\u4f5c\u7528\u200b\u662f\u4ece\u200b\u78c1\u76d8\u200b\u4e2d\u200b\u8bfb\u53d6\u200binode\u200b\u8282\u70b9\u200b\uff0c\u200b\u5177\u4f53\u6b65\u9aa4\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u901a\u8fc7\u200b\u78c1\u76d8\u200b\u9a71\u52a8\u200b\u6765\u200b\u5c06\u200b\u78c1\u76d8\u200b\u4e2d\u200bino\u200b\u53f7\u200b\u7684\u200binode\u200b\u8bfb\u5165\u200b\u5185\u5b58\u200b\u3002</p> <pre><code>    if (sfs_driver_read(SFS_INO_OFS(ino), (uint8_t *)&amp;inode_d, sizeof(struct sfs_inode_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn NULL;                    }\ninode-&gt;dir_cnt = 0;\ninode-&gt;ino = inode_d.ino;\ninode-&gt;size = inode_d.size;\ninode-&gt;dentry = dentry;\n</code></pre> <p>\u200b   \u2461 \u200b\u5224\u65ad\u200binode\u200b\u7684\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff0c\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u5219\u200b\u9700\u8981\u200b\u8bfb\u53d6\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u5e76\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>  /*\u200b\u5224\u65ad\u200biNode\u200b\u8282\u70b9\u200b\u7684\u200b\u6587\u4ef6\u7c7b\u578b\u200b*/\nif (SFS_IS_DIR(inode)) {/*\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7684\u8bdd\u200b\u9700\u8981\u200b\u5c06\u200b\u76ee\u5f55\u200b\u9879\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b*/\ndir_cnt = inode_d.dir_cnt;\nfor (i = 0; i &lt; dir_cnt; i++)\n{\nif (sfs_driver_read(SFS_DATA_OFS(ino) + i * sizeof(struct sfs_dentry_d), (uint8_t *)&amp;dentry_d, sizeof(struct sfs_dentry_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn NULL;                    }\nsub_dentry = new_dentry(dentry_d.fname, dentry_d.ftype);\nsub_dentry-&gt;parent = inode-&gt;dentry;\nsub_dentry-&gt;ino    = dentry_d.ino; sfs_alloc_dentry(inode, sub_dentry);\n}\n}\n</code></pre> <p>\u200b   \u2462\u200b\u5982\u679c\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u76f4\u63a5\u200b\u8bfb\u53d6\u6570\u636e\u200b\u5373\u53ef\u200b\u3002</p> <pre><code>    else if (SFS_IS_REG(inode)) {/*\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u76f4\u63a5\u200b\u8bfb\u53d6\u6570\u636e\u200b\u5373\u53ef\u200b*/\ninode-&gt;data = (uint8_t *)malloc(SFS_BLKS_SZ(SFS_DATA_PER_FILE));\nif (sfs_driver_read(SFS_DATA_OFS(ino), (uint8_t *)inode-&gt;data, SFS_BLKS_SZ(SFS_DATA_PER_FILE)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn NULL;                    }\n}\n</code></pre>"},{"location":"lab5/part3-3/#22-mkdirtouch","title":"2.2 \u200b\u5b9e\u73b0\u200bmkdir+touch","text":""},{"location":"lab5/part3-3/#221","title":"2.2.1 \u200b\u83b7\u53d6\u200b\u6587\u4ef6\u5c5e\u6027","text":"<p>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u4e86\u200b\u83b7\u5f97\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u200b\u7684\u200b\u72b6\u6001\u200b\u00a0\uff0c\u200b\u8981\u200b\u4e0d\u65ad\u200b\u8c03\u7528\u200b<code>getattr</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\u7c7b\u4f3c\u200b\u4e8e\u200b\u00a0xv6\u00a0\u200b\u91cc\u200b\u7684\u200b\u00a0fstat\u00a0\u3002\u200b\u5b9e\u73b0\u200b<code>ls</code>\u3001<code>mkdir</code>\u3001<code>touch</code>\u200b\u7b49\u200b\u64cd\u4f5c\u200b\u7684\u200b\u524d\u63d0\u200b\u5c31\u662f\u200b\u5b8c\u6210\u200b<code>getattr</code>\u200b\u94a9\u5b50\u200b\u7684\u200b\u7f16\u5199\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u7ed9\u200b\u4e2a\u200b\u4f8b\u5b50\u200b\uff08\u200b\u8be6\u89c1\u200bsfs_getattr\u200b\u51fd\u6570\u200b\uff09\uff1a</p> <p>\u200b   \u2460\u200b\u9996\u5148\u200b\u627e\u5230\u200b\u8def\u5f84\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <pre><code>    struct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\nif (is_find == FALSE) {\nreturn -SFS_ERROR_NOTFOUND;\n}\n</code></pre> <p>\u200b   \u2461\u200b\u5224\u65ad\u200b\u76ee\u5f55\u200b\u9879\u200b\u7684\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u5e76\u200b\u5bf9\u200b\u72b6\u6001\u200b\u8fdb\u884c\u200b\u7f16\u5199\u200b\u3002</p> <pre><code>    if (SFS_IS_DIR(dentry-&gt;inode)) {//\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\nsfs_stat-&gt;st_mode = S_IFDIR | SFS_DEFAULT_PERM;\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;dir_cnt * sizeof(struct sfs_dentry_d);\n}\nelse if (SFS_IS_REG(dentry-&gt;inode)) {//\u200b\u5982\u679c\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\nsfs_stat-&gt;st_mode = S_IFREG | SFS_DEFAULT_PERM;\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;size;\n}\n\nsfs_stat-&gt;st_nlink = 1;\nsfs_stat-&gt;st_uid     = getuid();\nsfs_stat-&gt;st_gid     = getgid();\nsfs_stat-&gt;st_atime   = time(NULL);\nsfs_stat-&gt;st_mtime   = time(NULL);\nsfs_stat-&gt;st_blksize = SFS_IO_SZ();\n\nif (is_root) {\nsfs_stat-&gt;st_size   = sfs_super.sz_usage; sfs_stat-&gt;st_blocks = SFS_DISK_SZ() / SFS_IO_SZ();\nsfs_stat-&gt;st_nlink  = 2;        /* !\u200b\u7279\u6b8a\u200b\uff0c\u200b\u6839\u76ee\u5f55\u200blink\u200b\u6570\u4e3a\u200b2 */\n}\nreturn SFS_ERROR_NONE;\n}\n</code></pre> <p><code>getattr</code>\u200b\u7684\u200b\u5b9e\u73b0\u200b\u9996\u5148\u200b\u662f\u200b\u00a0\u200b\u89e3\u6790\u200b\u8def\u5f84\u200b\u00a0\uff0c\u200b\u4ece\u800c\u200b\u83b7\u53d6\u200b\u76f8\u5e94\u200b\u6587\u4ef6\u200b\u7684\u200b\u00a0inode\u200b\u6216\u200bdentry\u00a0\uff0c\u200b\u63a5\u7740\u200b\u586b\u5199\u200b<code>struct stat*</code>\u200b\u7ed3\u6784\u200b\u4f53\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u5176\u4e2d\u200b<code>sfs_lookup</code>\u200b\u51fd\u6570\u200b\u5f88\u200b\u91cd\u8981\u200b\uff0c\u200b\u8bb8\u591a\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b\u7684\u200b\u94a9\u5b50\u200b\u90fd\u200b\u9700\u8981\u200b\u7528\u5230\u200b\u5b83\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u4f5c\u7528\u200b\u662f\u200b\u627e\u5230\u200b\u8def\u5f84\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u6216\u8005\u200b\u8fd4\u56de\u200b\u4e0a\u200b\u4e00\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u539f\u578b\u200b\u5982\u4e0b\u200b\uff08\u200b\u8be6\u89c1\u200bsfs_lookup\u200b\u51fd\u6570\u200b\uff09\uff1a</p> <p>\u200b   \u2460\u200b\u9996\u5148\u200b\u8ba1\u7b97\u200b\u8def\u5f84\u200b\u7684\u200b\u7ea7\u6570\u200b\uff0c\u200b\u5982\u679c\u200b\u4e3a\u200b0\u200b\u8bf4\u660e\u200b\u662f\u200b\u6839\u76ee\u5f55\u200b\u3002</p> <pre><code>    int   total_lvl = sfs_calc_lvl(path);/*\u200b\u8ba1\u7b97\u200b\u8def\u5f84\u200b\u7ea7\u6570\u200b*/\n...\n\nif (total_lvl == 0) {                           /* \u200b\u6839\u76ee\u5f55\u200b */\n*is_find = TRUE;\n*is_root = TRUE;\ndentry_ret = sfs_super.root_dentry;\n}\n</code></pre> <p>\u200b   \u2461\u200b\u4e0d\u200b\u4e3a\u200b0\u200b\u5219\u200b\u9700\u8981\u200b\u4ece\u200b\u6839\u76ee\u5f55\u200b\u5f00\u59cb\u200b\uff0c\u200b\u4f9d\u6b21\u200b\u5339\u914d\u200b\u8def\u5f84\u200b\u4e2d\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u76f4\u5230\u200b\u627e\u5230\u200b\u6587\u4ef6\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <p>\u200b   \u2462\u200b\u5982\u679c\u200b\u6ca1\u200b\u627e\u5230\u200b\u5219\u200b\u8fd4\u56de\u200b\u6700\u540e\u200b\u4e00\u6b21\u200b\u5339\u914d\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <pre><code> fname = strtok(path_cpy, \"/\"); /*\u200b\u5206\u6790\u200b\u8def\u5f84\u200b\u51fd\u6570\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u200b\u4e00\u4e0b\u200b\u5b83\u200b\u7684\u200b\u7528\u6cd5\u200b*/      while (fname)\n{   lvl++;\nif (dentry_cursor-&gt;inode == NULL) {           /* Cache\u200b\u673a\u5236\u200b */\nsfs_read_inode(dentry_cursor, dentry_cursor-&gt;ino);\n}\n\ninode = dentry_cursor-&gt;inode;\n\nif (SFS_IS_REG(inode) &amp;&amp; lvl &lt; total_lvl) {\nSFS_DBG(\"[%s] not a dir\\n\", __func__);\ndentry_ret = inode-&gt;dentry;\nbreak;\n}\nif (SFS_IS_DIR(inode)) {/*\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u7684\u200b\u6587\u4ef6\u200b\u9700\u8981\u200b\u5c06\u200b\u76ee\u5f55\u200b\u9879\u200b\u548c\u200b\u8def\u5f84\u540d\u200b\u8fdb\u884c\u200b\u6bd4\u8f83\u200b*/\ndentry_cursor = inode-&gt;dentrys;\nis_hit        = FALSE;\n\nwhile (dentry_cursor)\n{\nif (memcmp(dentry_cursor-&gt;fname, fname, strlen(fname)) == 0) {\nis_hit = TRUE;\nbreak;\n}\ndentry_cursor = dentry_cursor-&gt;brother;\n}\n\nif (!is_hit) {\n*is_find = FALSE;\nSFS_DBG(\"[%s] not found %s\\n\", __func__, fname);\ndentry_ret = inode-&gt;dentry;\nbreak;\n}\n\nif (is_hit &amp;&amp; lvl == total_lvl) {\n*is_find = TRUE;\ndentry_ret = dentry_cursor;\nbreak;\n}\n}\nfname = strtok(NULL, \"/\"); }\n\nif (dentry_ret-&gt;inode == NULL) {\ndentry_ret-&gt;inode = sfs_read_inode(dentry_ret, dentry_ret-&gt;ino);\n}\n\nreturn dentry_ret;\n</code></pre>"},{"location":"lab5/part3-3/#222","title":"2.2.2 \u200b\u5efa\u7acb\u200b\u76ee\u5f55","text":"<p>\u200b\u5f53\u4e3a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.mkdir</code>\uff08\u200b\u8be6\u89c1\u200bsfs_mkdir\u200b\u51fd\u6570\u200b\uff09\uff1a</p> <p>\u200b   \u2460\u200b\u5bfb\u627e\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <p>\u200b   \u2461\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u5e76\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6a21\u5f0f\u200b\uff08\u200b\u53ea\u8bfb\u200b\uff1f\u200b\u53ea\u200b\u5199\u200b\uff1f\uff09\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint sfs_mkdir(const char* path, mode_t mode) {\n(void)mode;\nboolean is_find, is_root;\nchar* fname;\nstruct sfs_dentry* last_dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);//\u200b\u5bfb\u627e\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b\nstruct sfs_dentry* dentry;\nstruct sfs_inode*  inode;\n\nif (is_find) {//\u200b\u76ee\u5f55\u200b\u5b58\u5728\u200b\nreturn -SFS_ERROR_EXISTS;\n}\n\nif (SFS_IS_REG(last_dentry-&gt;inode)) {\nreturn -SFS_ERROR_UNSUPPORTED;\n}\n\nfname  = sfs_get_fname(path);\ndentry = new_dentry(fname, SFS_DIR); dentry-&gt;parent = last_dentry;\ninode  = sfs_alloc_inode(dentry);\nsfs_alloc_dentry(last_dentry-&gt;inode, dentry);\n\nreturn SFS_ERROR_NONE;\n}\n</code></pre>"},{"location":"lab5/part3-3/#23-mknodls","title":"2.3 \u200b\u5b9e\u73b0\u200bmknod+ls","text":""},{"location":"lab5/part3-3/#231","title":"2.3.1 \u200b\u5efa\u7acb\u200b\u6587\u4ef6","text":"<p>\u200b\u5f53\u4e3a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.mknod</code>\uff0c\u200b\u5728\u200b\u6211\u4eec\u200b\u7ed9\u200b\u7684\u200b\u6846\u67b6\u200b\u4e2d\u200b\uff0c\u200b\u7ed9\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200b\u601d\u8def\u200b\uff1a</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u7684\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @param dev \u200b\u8bbe\u5907\u200b\u7c7b\u578b\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint newfs_mknod(const char* path, mode_t mode, dev_t dev) {\n/* TODO: \u200b\u89e3\u6790\u200b\u8def\u5f84\u200b\uff0c\u200b\u5e76\u200b\u521b\u5efa\u200b\u76f8\u5e94\u200b\u7684\u200b\u6587\u4ef6\u200b */\nreturn 0;\n}\n</code></pre> <p>\u200b\u800c\u200b\u5728\u200bsfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e2d\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u7684\u200b\u5177\u4f53\u200b\u5b9e\u73b0\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u627e\u5230\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u8def\u5f84\u200b\u4e2d\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <p>\u200b   \u2461\u200b\u5982\u679c\u200b\u6587\u4ef6\u200b\u5b58\u5728\u200b\u5219\u200b\u8fd4\u56de\u200b\u9519\u8bef\u200b\u3002</p> <p>\u200b   \u2462\u200b\u6587\u4ef6\u200b\u4e0d\u200b\u5b58\u5728\u200b\u5219\u200b\u5728\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u9879\u200b\u548c\u200b\u5bf9\u5e94\u200b\u7684\u200binode\uff0c\u200b\u5e76\u200b\u548c\u200b\u7236\u200b\u76ee\u5f55\u200b\u9879\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u7684\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @param dev \u200b\u8bbe\u5907\u200b\u7c7b\u578b\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint sfs_mknod(const char* path, mode_t mode, dev_t dev) {\nboolean is_find, is_root;\n\nstruct sfs_dentry* last_dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);//\u200b\u627e\u5230\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u6240\u5728\u200b\u7684\u200b\u76ee\u5f55\u200b\nstruct sfs_dentry* dentry;\nstruct sfs_inode* inode;\nchar* fname;\n\nif (is_find == TRUE) {//\u200b\u6587\u4ef6\u200b\u5b58\u5728\u200b\nreturn -SFS_ERROR_EXISTS;\n}\n\nfname = sfs_get_fname(path);//\u200b\u83b7\u53d6\u200b\u6587\u4ef6\u200b\u540d\u5b57\u200b\n\nif (S_ISREG(mode)) {\ndentry = new_dentry(fname, SFS_REG_FILE);\n}\nelse if (S_ISDIR(mode)) {\ndentry = new_dentry(fname, SFS_DIR);\n}\ndentry-&gt;parent = last_dentry;\ninode = sfs_alloc_inode(dentry);\nsfs_alloc_dentry(last_dentry-&gt;inode, dentry);\n\nreturn SFS_ERROR_NONE;\n}\n</code></pre> <p>\u200b\u4f46\u200b\u4ec5\u4ec5\u200b\u5b9e\u73b0\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b<code>touch</code>\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u4ecd\u7136\u200b\u4f1a\u200b\u62a5\u9519\u200b\uff0c\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b<code>touch</code>\u200b\u8981\u6c42\u200b\u4e0d\u4ec5\u4ec5\u200b\u662f\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8fd8\u200b\u8981\u6c42\u200b\u53ef\u4ee5\u200b\u00a0\u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbf\u95ee\u200b\u65f6\u95f4\u200b\u00a0\uff08\u200b\u96be\u602a\u200b\u53eb\u200b<code>touch</code>\uff0c\u200b\u6478\u200b\u4e00\u4e0b\u200b\uff09\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u8fd8\u8981\u200b\u5b9e\u73b0\u200b<code>utimens</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u7528\u4e8e\u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbf\u95ee\u200b\u65f6\u95f4\u200b\uff08\u200b\u5176\u5b9e\u200b\u53ea\u200b\u9700\u8981\u200b\u8fd4\u56de\u200b0\u200b\u5c31\u200b\u597d\u200b\uff09\u3002\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u53ef\u4ee5\u200b\u8fdb\u4e00\u6b65\u200b\u5b8c\u5584\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4e0d\u200b\u5b8c\u5584\u200b\u3002</p> <pre><code>/**\n* @brief \u200b\u4fee\u6539\u200b\u65f6\u95f4\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u4e0d\u8ba9\u200btouch\u200b\u62a5\u9519\u200b \n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param tv \u200b\u5b9e\u8df5\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint newfs_utimens(const char* path, const struct timespec tv[2]) {\n(void)path;\nreturn 0;\n}\n</code></pre>"},{"location":"lab5/part3-3/#232","title":"2.3.2 \u200b\u8bfb\u53d6\u200b\u76ee\u5f55\u200b\u9879","text":"<p>\u200b\u5f53\u200b\u00a0\u200b\u5728\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u4e0b\u200b\u8c03\u7528\u200b<code>ls</code>\u200b\u65f6\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u89e6\u53d1\u200b<code>readdir</code>\u200b\u94a9\u5b50\u200b\uff0c\u00a0readdir\u00a0\u200b\u5728\u200b<code>ls</code>\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u6bcf\u6b21\u200b\u00a0\u200b\u4ec5\u4f1a\u200b\u8fd4\u56de\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u00a0\uff0c\u200b\u5176\u4e2d\u200b<code>offset</code>\u200b\u53c2\u6570\u200b\u8bb0\u5f55\u200b\u7740\u200b\u5f53\u524d\u200b\u5e94\u8be5\u200b\u8fd4\u56de\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff1a <pre><code>/**\n * @brief \n * \n * @param path \n * @param buf \n * @param filler \u200b\u53c2\u6570\u200b\u8bb2\u89e3\u200b:\n * \n * typedef int (*fuse_fill_dir_t) (void *buf, const char *name,\n *              const struct stat *stbuf, off_t off)\n * buf: name\u200b\u4f1a\u200b\u88ab\u200b\u590d\u5236\u5230\u200bbuf\u200b\u4e2d\u200b\n * name: dentry\u200b\u540d\u5b57\u200b\n * stbuf: \u200b\u6587\u4ef6\u200b\u72b6\u6001\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n * off: \u200b\u4e0b\u200b\u4e00\u6b21\u200boffset\u200b\u4ece\u200b\u54ea\u91cc\u200b\u5f00\u59cb\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u53ef\u4ee5\u200b\u7406\u89e3\u200b\u4e3a\u200b\u7b2c\u51e0\u4e2a\u200bdentry\n * \n * @param offset \n * @param fi \n * @return int \n */\nint sfs_readdir(const char * path, void * buf, fuse_fill_dir_t filler, off_t offset,\nstruct fuse_file_info * fi) {\nboolean is_find, is_root;\nint     cur_dir = offset;\n\nstruct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\nstruct sfs_dentry* sub_dentry;\nstruct sfs_inode* inode;\nif (is_find) {\ninode = dentry-&gt;inode;\nsub_dentry = sfs_get_dentry(inode, cur_dir);\nif (sub_dentry) {\nfiller(buf, sub_dentry-&gt;fname, NULL, ++offset);\n}\nreturn SFS_ERROR_NONE;\n}\nreturn -SFS_ERROR_NOTFOUND;\n}\n</code></pre> \u200b\u5176\u4e2d\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u00a0filler\u00a0\u200b\u51fd\u6570\u200b\uff0c\u00a0filler\u00a0\u200b\u51fd\u6570\u200b\u539f\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <p><code>typedef int (*fuse_fill_dir_t) (void *buf, const char *name, const struct stat *stbuf, off_t off)</code> \u200b\u5bf9\u200b\u5404\u4e2a\u200b\u53c2\u6570\u200b\u505a\u200b\u5982\u4e0b\u200b\u89e3\u91ca\u200b\uff1a</p> <ul> <li> <p><code>buf</code>\uff1aname\u200b\u4f1a\u200b\u88ab\u200b\u590d\u5236\u5230\u200bbuf\u200b\u4e2d\u200b\uff1b</p> </li> <li> <p><code>name</code>\uff1adentry \u200b\u540d\u5b57\u200b\uff1b</p> </li> <li> <p><code>stbuf</code>\uff1a\u200b\u6587\u4ef6\u200b\u72b6\u6001\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\uff1b</p> </li> <li> <p><code>off</code>\uff1a \u200b\u4e0b\u200b\u4e00\u6b21\u200boffset\u200b\u4ece\u200b\u54ea\u91cc\u200b\u5f00\u59cb\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u53ef\u4ee5\u200b\u7406\u89e3\u200b\u4e3a\u200b\u7b2c\u51e0\u4e2a\u200bdentry\uff1b</p> </li> </ul> <p>\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5728\u200b\u4e0a\u8ff0\u200b\u4ee3\u7801\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u8c03\u7528\u200b<code>filler(buf, fname, NULL, ++offset)</code>\u200b\u8868\u793a\u200b\u5c06\u200b<code>fname</code>\u200b\u653e\u5165\u200b<code>buf</code>\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u200b\u4f7f\u200b\u76ee\u5f55\u200b\u9879\u200b\u504f\u79fb\u200b\u52a0\u4e00\u200b\uff0c\u200b\u4ee3\u8868\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u8bbf\u95ee\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p>"},{"location":"lab5/part3-3/#_1","title":"\u8865\u5145\u200b\u601d\u8003\u200b \uff1a\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5b9e\u73b0","text":""},{"location":"lab5/part3-3/#_2","title":"\u80cc\u666f","text":"<ul> <li>\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\uff08Symbolic Link\uff09\uff0c\u200b\u53c8\u79f0\u200b\u8f6f\u200b\u94fe\u63a5\u200b\uff08Soft Link\uff09\uff0c\u200b\u5b83\u200b\u5305\u542b\u200b\u4e86\u200b\u5230\u200b\u539f\u6587\u4ef6\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\uff0c\u200b\u62e5\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b\uff08inode\uff09\u200b\u53ca\u200b\u6587\u4ef6\u5c5e\u6027\u200b\u53ca\u200b\u6743\u9650\u200b\u3002</li> <li>\u200b\u786c\u200b\u94fe\u63a5\u200b\uff08Hard Link\uff09\uff0c\u200b\u662f\u200b\u5bf9\u200b\u539f\u6587\u4ef6\u200b\u8d77\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u522b\u540d\u200b\u3002\u200b\u6587\u4ef6\u200b\u6709\u200b\u76f8\u540c\u200b\u7684\u200b inode \u200b\u53ca\u200b data block\u3002</li> </ul> <p>\u200b\u8be6\u7ec6\u200b\u533a\u522b\u200b\u8bf7\u200b\u81ea\u884c\u200b\u67e5\u9605\u200b\u8d44\u6599\u200b</p>"},{"location":"lab5/part3-3/#_3","title":"\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f","text":"<p>\u200b\u7531\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u539f\u7406\u200b\u53ef\u200b\u5f97\u200b\uff0c\u200b\u5efa\u7acb\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5173\u952e\u200b\u662f\u200b\u5b58\u50a8\u200b\u94fe\u63a5\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u3002</p> <p>\u200b\u7531\u6b64\u200b\u5f15\u51fa\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u4e24\u79cd\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f\u200b\uff1a</p> <ol> <li>\u200b\u5c06\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u5728\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b</li> <li>\u200b\u5c06\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u5728\u200bdata block\u200b\u4e2d\u200b</li> </ol> <p>\u200b\u6837\u4f8b\u200bSimpleFS\u200b\u4e2d\u200b\u7684\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u5c06\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u4e8e\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u5b58\u50a8\u200b\u5728\u200bdata block\u200b\u4e2d\u200b\u7684\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u81ea\u8003\u200b\u5e76\u200b\u5b9e\u73b0\u200b\u3002</p>"},{"location":"lab5/part3-3/#_4","title":"\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5b9e\u73b0\u200b\u7ec6\u8282","text":"<ol> <li>\u200b\u7531\u4e8e\u200b\u6837\u4f8b\u200b\u662f\u200b\u5c06\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u4e8e\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b\uff0c\u200b\u6545\u200b\u9700\u8981\u200b\u9996\u5148\u200b\u4fee\u6539\u200b<code>struct inode</code>\u200b\u548c\u200b<code>struct inode_d</code></li> </ol> <pre><code># \u200b\u6dfb\u52a0\u200btarget_path\u200b\u7528\u4e8e\u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\nchar               target_path[SFS_MAX_FILE_NAME];\n</code></pre> <p>\u200b\u5e76\u200b\u7531\u6b64\u200b\u9700\u8981\u200b\u589e\u52a0\u200b<code>sfs_utils.c</code>\u200b\u4e2d\u200b\uff0c<code>sfs_sync_inode() \u200b\u53ca\u200b  sfs_read_inode()</code>\uff0c\u200b\u5bf9\u200b\u5185\u5b58\u200binode\u200b\u53ca\u200b\u78c1\u76d8\u200binode\u200b\u95f4\u200b\u62f7\u8d1d\u200b\u64cd\u4f5c\u200b\u65f6\u200b\u7684\u200b\u8865\u5145\u200b\u62f7\u8d1d\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u5728\u200b\u6587\u4ef6\u7c7b\u578b\u200b<code>enum sfs_file_type</code>\u200b\u4e2d\u200b\u589e\u52a0\u200b<code>SFS_SYM_LINK</code>\u3002</p> <p>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u200b\u652f\u6301\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\uff0c\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b<code>symlink</code>\u200b\u94a9\u5b50\u200b.\u200b\u9996\u5148\u200b\uff0c\u200b\u7531\u4e8e\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u672c\u8d28\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7279\u6b8a\u200b\u7c7b\u578b\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u9700\u8981\u200b\u8c03\u7528\u200b<code>mknod()</code>\u200b\u521b\u5efa\u200b\u65b0\u200b\u7684\u200b\u8282\u70b9\u200b\uff0c\u200b\u5c06\u200b\u6b64\u200bdentry / inode\u200b\u8282\u70b9\u200b\u6807\u8bb0\u200b\u4f4d\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u578b\u200b\u8282\u70b9\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u94fe\u63a5\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u62f7\u8d1d\u200b\u81f3\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b\u3002</p> <pre><code>/**\n * @brief \n * \n * @param path - Where the link points\n * @param link - The link itself\n * @return int \n */\nint sfs_symlink(const char* path, const char* link){\nint ret = SFS_ERROR_NONE;\nboolean is_find, is_root;\nret = sfs_mknod(link, S_IFREG, NULL);\nstruct sfs_dentry* dentry = sfs_lookup(link, &amp;is_find, &amp;is_root);\nif (is_find == FALSE) {\nreturn -SFS_ERROR_NOTFOUND;\n}\ndentry-&gt;ftype = SFS_SYM_LINK;\nstruct sfs_inode* inode = dentry-&gt;inode;\nmemcpy(inode-&gt;target_path, path, SFS_MAX_FILE_NAME);\nreturn ret;\n}\n</code></pre> <p>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u200b\u652f\u6301\u200b\u94fe\u63a5\u200b\uff0c\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b<code>readlink</code>\u200b\u94a9\u5b50\u200b\u3002<code>readlink</code>\u200b\u5373\u5c06\u200bpath\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u578b\u200b\u6587\u4ef6\u200b\u6240\u200b\u6307\u5411\u200b\u7684\u200b\u94fe\u63a5\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u62f7\u8d1d\u200b\u81f3\u200bbuf\u200b\u4e2d\u200b\uff0c\u200b\u4ee5\u200b\u5b9e\u73b0\u200b\u5bf9\u200b\u5bf9\u5e94\u200b\u94fe\u63a5\u200b\u6587\u4ef6\u200b\u7684\u200b\u4e00\u7cfb\u5217\u200b\u64cd\u4f5c\u200b\u3002</p> <pre><code>/**\n * @brief \n * \n * @param path \n * @param buf\n * @param size \n * @return int \n */\nint sfs_readlink (const char *path, char *buf, size_t size){\n/* SFS \u200b\u6682\u672a\u200b\u5b9e\u73b0\u200b\u786c\u200b\u94fe\u63a5\u200b\uff0c\u200b\u53ea\u200b\u652f\u6301\u200b\u8f6f\u200b\u94fe\u63a5\u200b */\nboolean is_find, is_root;\nssize_t llen;\nstruct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\nif (is_find == FALSE) {\nreturn -SFS_ERROR_NOTFOUND;\n}\nif (dentry-&gt;ftype != SFS_SYM_LINK){\nreturn -SFS_ERROR_INVAL;\n}\nstruct sfs_inode* inode = dentry-&gt;inode;\nllen = strlen(inode-&gt;target_path);\nif(size &lt; 0){\nreturn -SFS_ERROR_INVAL;\n}else{\nif(llen &gt; size){\nstrncpy(buf, inode-&gt;target_path, size);\nbuf[size] = '\\0';\n}else{\nstrncpy(buf, inode-&gt;target_path, llen);\nbuf[llen] = '\\0';\n}\n}\nreturn SFS_ERROR_NONE;\n}\n</code></pre> <p>\u200b\u4e3a\u4e86\u200b\u80fd\u200b\u6210\u529f\u200b\u8bfb\u53d6\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u578b\u200b\u6587\u4ef6\u200b\u7684\u200b\u72b6\u6001\u200b\u548c\u200b\u6743\u9650\u200b\uff0c\u200b\u8fd8\u200b\u9700\u8981\u200b\u4fee\u6539\u200b<code>sfs_getattr()</code>\u3002</p> <pre><code># \u200b\u6dfb\u52a0\u200b\u5982\u4e0b\u200b\u5206\u652f\u200b\u5224\u65ad\u200b\nelse if (SFS_IS_SYM_LINK(dentry-&gt;inode)) {\nsfs_stat-&gt;st_mode = S_IFLNK | SFS_DEFAULT_PERM;\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;size;\n}\n</code></pre>"},{"location":"lab5/part3-3/#24-unmount","title":"2.4 \u200b\u5b9e\u73b0\u200bunmount","text":"<p>\u200b\u5f53\u200b\u5378\u8f7d\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.destroy</code>\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>.destroy</code>\u200b\u94a9\u5b50\u200b\u4e2d\u200b\u5b8c\u6210\u200b\u00a0\u200b\u8d85\u7ea7\u200b\u5757\u200b\u56de\u5199\u200b\u8bbe\u5907\u200b\u00a0\u3001\u00a0\u200b\u9a71\u52a8\u200b\u7684\u200b\u5173\u95ed\u200b\u00a0\u3001\u00a0\u200b\u66f4\u200b\u591a\u200b\u5fc5\u8981\u200b\u7ed3\u6784\u200b\u7684\u200b\u56de\u5199\u200b\u00a0\u200b\u7b49\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4ee5\u200b\u4fdd\u8bc1\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u6302\u8f7d\u200b\u80fd\u591f\u200b\u00a0\u200b\u6062\u590d\u200bddriver\u200b\u8bbe\u5907\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u200b\u00a0\uff1a</p> <pre><code>/**\n* @brief \u200b\u5378\u8f7d\u200b\uff08umount\uff09\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\n* \n* @param p \u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return void\n*/\nvoid newfs_destroy(void* p) {\n/* TODO: \u200b\u5728\u200b\u8fd9\u91cc\u200b\u8fdb\u884c\u200b\u5378\u8f7d\u200b */\n\nddriver_close(super.fd);\n\nreturn;\n}\n</code></pre> <p>\u200b\u4e0a\u9762\u200b\u7684\u200b\u793a\u4f8b\u200b\u662f\u200b\u5173\u95ed\u200b\u9a71\u52a8\u200b\u8bbe\u5907\u200b\u3002</p> <p>\u200b\u4e0b\u9762\u200b\u6211\u4eec\u200b\u6765\u200b\u770b\u770b\u200bsfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e2d\u200b\u5bf9\u4e8e\u200b\u5378\u8f7d\u200b\u7684\u200b\u5177\u4f53\u200b\u5b9e\u73b0\u200b\u6b65\u9aa4\u200b\uff08\u200b\u8be6\u89c1\u200bsfs_umount\u200b\u51fd\u6570\u200b\uff09\uff1a</p> <p>\u200b   \u2460\u200b\u4ece\u6839\u200b\u8282\u70b9\u200b\u9012\u5f52\u200b\u5f80\u200b\u4e0b\u200b\u5237\u5199\u200b\u6839\u200b\u8282\u70b9\u200b\u3002</p> <pre><code> sfs_sync_inode(sfs_super.root_dentry-&gt;inode);     /* \u200b\u4ece\u6839\u200b\u8282\u70b9\u200b\u5411\u4e0b\u200b\u5237\u5199\u200b\u8282\u70b9\u200b */\n</code></pre> <p>\u200b   \u2461\u200b\u5c06\u200b\u5185\u5b58\u200b\u8d85\u7ea7\u200b\u5757\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u78c1\u76d8\u200b\u8d85\u7ea7\u200b\u5757\u200b\u5e76\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    sfs_super_d.magic_num           = SFS_MAGIC_NUM;\nsfs_super_d.map_inode_blks      = sfs_super.map_inode_blks;\nsfs_super_d.map_inode_offset    = sfs_super.map_inode_offset;\nsfs_super_d.data_offset         = sfs_super.data_offset;\nsfs_super_d.sz_usage            = sfs_super.sz_usage;\n\nif (sfs_driver_write(SFS_SUPER_OFS, (uint8_t *)&amp;sfs_super_d, sizeof(struct sfs_super_d)) != SFS_ERROR_NONE) {\nreturn -SFS_ERROR_IO;\n}\n</code></pre> <p>\u200b   \u2462\u200b\u5c06\u200binode\u200b\u4f4d\u200b\u56fe\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    if (sfs_driver_write(sfs_super_d.map_inode_offset, (uint8_t *)(sfs_super.map_inode), SFS_BLKS_SZ(sfs_super_d.map_inode_blks)) != SFS_ERROR_NONE) {\nreturn -SFS_ERROR_IO;\n}\nfree(sfs_super.map_inode);\n</code></pre> <p>\u200b   \u2463\u200b\u5173\u95ed\u200b\u9a71\u52a8\u200b\u3002</p> <pre><code>    ddriver_close(SFS_DRIVER());\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u51fd\u6570\u200b\u662f\u200b<code>sfs_sync_inode</code>\uff0c\u200b\u5176\u200b\u4f5c\u7528\u200b\u662f\u200b\u5c06\u200b\u5185\u5b58\u200binode\u200b\u53ca\u5176\u200b\u4e0b\u65b9\u200b\u7ed3\u6784\u200b\u5168\u90e8\u200b\u5237\u200b\u56de\u200b\u78c1\u76d8\u200b\uff0c\u200b\u64cd\u4f5c\u200b\u6d41\u7a0b\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u9996\u5148\u200b\u5c06\u200binode\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    if (sfs_driver_write(SFS_INO_OFS(ino), (uint8_t *)&amp;inode_d, sizeof(struct sfs_inode_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn -SFS_ERROR_IO;\n}\n</code></pre> <p>\u200b   \u2461\u200b\u5224\u65ad\u200binode\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u3002</p> <p>\u200b   \u2462\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u5219\u200b\u9700\u8981\u200b\u9996\u5148\u200b\u5c06\u200b\u76ee\u5f55\u200b\u9879\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\uff0c\u200b\u518d\u200b\u9012\u5f52\u200b\u5237\u5199\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200binode\u200b\u8282\u70b9\u200b\u3002</p> <pre><code>                                                      /* Cycle 1: \u200b\u5199\u200b INODE */\n/* Cycle 2: \u200b\u5199\u200b \u200b\u6570\u636e\u200b */\nif (SFS_IS_DIR(inode)) {                          dentry_cursor = inode-&gt;dentrys;\noffset        = SFS_DATA_OFS(ino);\nwhile (dentry_cursor != NULL)\n{\nmemcpy(dentry_d.fname, dentry_cursor-&gt;fname, SFS_MAX_FILE_NAME);\ndentry_d.ftype = dentry_cursor-&gt;ftype;\ndentry_d.ino = dentry_cursor-&gt;ino;\nif (sfs_driver_write(offset, (uint8_t *)&amp;dentry_d, sizeof(struct sfs_dentry_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn -SFS_ERROR_IO;                     }\n\nif (dentry_cursor-&gt;inode != NULL) {/*\u200b\u9012\u5f52\u200b\u5237\u5199\u200b\u8282\u70b9\u200b*/\nsfs_sync_inode(dentry_cursor-&gt;inode);\n}\n\ndentry_cursor = dentry_cursor-&gt;brother;\noffset += sizeof(struct sfs_dentry_d);\n}\n}\n</code></pre> <p>\u200b       \u2463\u200b\u5982\u679c\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff0c\u200b\u5219\u200b\u5c06\u200binode\u200b\u6240\u200b\u6307\u5411\u200b\u7684\u200b\u6570\u636e\u200b\u76f4\u63a5\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    else if (SFS_IS_REG(inode)) {\nif (sfs_driver_write(SFS_DATA_OFS(ino), inode-&gt;data, SFS_BLKS_SZ(SFS_DATA_PER_FILE)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn -SFS_ERROR_IO;\n}\n}\n</code></pre>"},{"location":"lab5/part3-3/#25-readwrite","title":"2.5 \u200b\u5b9e\u73b0\u200bread+write\uff08\u200b\u9009\u505a\u200b\uff09","text":""},{"location":"lab5/part3-3/#251","title":"2.5.1 \u200b\u6587\u4ef6\u200b\u8bfb","text":"<p>\u200b\u5f53\u200b\u8bfb\u53d6\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u7528\u5230\u200b<code>read</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u5728\u200b\u590d\u5236\u200b\u6587\u4ef6\u200b\u65f6\u200b\u4e5f\u200b\u4f1a\u200b\u7528\u5230\u200b\uff0c\u200b\u5b83\u200b\u901a\u8fc7\u200b\u4e0b\u9762\u200b\u7684\u200b\u6b65\u9aa4\u200b\u6765\u200b\u5b8c\u6210\u200b\u4e00\u6b21\u200b\u5bf9\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bfb\u53d6\u200b\uff08\u200b\u8be6\u89c1\u200bsfs_read\u200b\u51fd\u6570\u200b\uff09\uff1a</p> <p>\u2460\u200b\u9996\u5148\u200b\u627e\u5230\u200b\u6587\u4ef6\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff1a</p> <pre><code>    struct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\n</code></pre> <p>\u2461\u200b\u627e\u5230\u200b\u76ee\u5f55\u200b\u9879\u200b\u4e4b\u540e\u200b\u5224\u65ad\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff0c\u200b\u4fdd\u8bc1\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u5e76\u4e14\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u8981\u200b\u5927\u4e8e\u200b\u6240\u200b\u8981\u200b\u8bfb\u53d6\u200b\u7684\u200b\u504f\u79fb\u91cf\u200b\uff1a</p> <pre><code>    if (SFS_IS_DIR(inode)) {\nreturn -SFS_ERROR_ISDIR;    }\n\nif (inode-&gt;size &lt; offset) {\nreturn -SFS_ERROR_SEEK;\n}\n</code></pre> <p>\u2462\u200b\u4e4b\u540e\u200b\u5c06\u200b\u6570\u636e\u200b\u8bfb\u5165\u200b\u5185\u5b58\u200b\u5757\u200b\u5373\u53ef\u200b\uff1a</p> <pre><code>    memcpy(buf, inode-&gt;data + offset, size);\n</code></pre>"},{"location":"lab5/part3-3/#252","title":"2.5.2 \u200b\u6587\u4ef6\u200b\u5199","text":"<p>\u200b\u5199\u200b\u6587\u4ef6\u200b\u662f\u200b\uff0c\u200b\u7528\u5230\u200b<code>write</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u5b83\u200b\u5411\u200b\u6587\u4ef6\u200b\u6240\u5728\u200b\u7684\u200b\u78c1\u76d8\u200b\u4f4d\u7f6e\u200b\u4e2d\u200b\u5199\u5165\u200b\u6570\u636e\u200b\uff08\u200b\u8be6\u89c1\u200bsfs_write\u200b\u51fd\u6570\u200b\uff09\uff1a</p> <p>\u2460\u200b\u548c\u200b\u8bfb\u200b\u6587\u4ef6\u200b\u4e00\u6837\u200b\uff0c\u200b\u9996\u5148\u200b\u627e\u5230\u200b\u8def\u5f84\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff1a</p> <pre><code>    struct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\n</code></pre> <p>\u2461\u200b\u4e4b\u540e\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u4e0d\u662f\u200b\u76ee\u5f55\u200b\u4ee5\u53ca\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u5927\u4e8e\u200b\u504f\u79fb\u91cf\u200b\uff1a</p> <pre><code>    if (SFS_IS_DIR(inode)) {\nreturn -SFS_ERROR_ISDIR;    }\n\nif (inode-&gt;size &lt; offset) {\nreturn -SFS_ERROR_SEEK;\n}\n</code></pre> <p>\u2462\u200b\u5c06\u200b\u5185\u5b58\u200b\u4e2d\u200b\u6570\u636e\u200b\u590d\u5236\u5230\u200b\u5bf9\u5e94\u200b\u4f4d\u7f6e\u200b\u5373\u53ef\u200b\uff0c\u200b\u5e76\u200b\u6539\u5199\u200biNode\u200b\u8282\u70b9\u200b\u7684\u200b\u5927\u5c0f\u200b\uff1a</p> <pre><code>    memcpy(inode-&gt;data + offset, buf, size);\ninode-&gt;size = offset + size &gt; inode-&gt;size ? offset + size : inode-&gt;size;\n</code></pre> <p>\u200b    </p> <p>\u200b    </p>"},{"location":"lab5/part3-4/","title":"\u9009\u505a\u200b\u4efb\u52a1","text":""},{"location":"lab5/part3-4/#1","title":"1.  \u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\uff08\u200b\u9009\u505a\u200b\u4efb\u52a1\u200b\uff09","text":""},{"location":"lab5/part3-4/#11","title":"1.1 \u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u7b80\u4ecb","text":"<p>\u200b\u78c1\u76d8\u200b\u7684\u200b\u8bbf\u95ee\u901f\u5ea6\u200b\u8fdc\u200b\u5c0f\u4e8e\u200b\u5185\u5b58\u200b\u7684\u200b\u8bbf\u95ee\u901f\u5ea6\u200b \uff0c\u200b\u800c\u200b\u73b0\u5b9e\u200b\u4e2d\u200b\u78c1\u76d8\u200b\u7684\u200b\u5bb9\u91cf\u200b\u4e5f\u200b\u8fdc\u5927\u4e8e\u200b\u5185\u5b58\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4e3a\u4e86\u200b\u63d0\u901f\u200b \u200b\u628a\u200b\u6574\u4e2a\u200b\u78c1\u76d8\u200b\u5185\u5bb9\u200b\u8bfb\u200b\u5230\u200b\u5185\u5b58\u200b\u4e2d\u662f\u200b\u4e0d\u200b\u73b0\u5b9e\u200b\u7684\u200b \u3002\u200b\u4f46\u662f\u200b\uff0c\u200b\u6211\u4eec\u200b\u8fd8\u662f\u200b\u6709\u200b\u4e00\u4e9b\u200b\u624b\u6bb5\u200b\u63d0\u9ad8\u200b\u5bf9\u200b\u78c1\u76d8\u200b\u7684\u200b\u8bbf\u95ee\u901f\u5ea6\u200b\u3002 \u200b\u6839\u636e\u200b\u5c40\u90e8\u6027\u200b\u539f\u7406\u200b \uff0c\u200b\u6700\u8fd1\u200b\u88ab\u200b\u8bbf\u95ee\u200b\u8fc7\u200b\u7684\u200b\u7a7a\u95f4\u200b\u63a5\u4e0b\u6765\u200b\u4e5f\u200b\u5f88\u200b\u53ef\u80fd\u200b\u88ab\u200b\u8bbf\u95ee\u200b\u5230\u200b\uff0c\u200b\u6240\u4ee5\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u505a\u200b \u200b\u4e00\u4e9b\u200b\u7f13\u5b58\u200b\u5757\u200b \uff0c\u200b\u628a\u200b \u200b\u6700\u8fd1\u200b\u6700\u5e38\u200b\u88ab\u200b\u8bbf\u95ee\u200b\u7684\u200b\u6570\u636e\u200b\u653e\u5165\u200b\u7f13\u5b58\u200b\u5757\u200b\u4e2d\u200b \u3002\u200b\u5982\u4f55\u200b\u7ba1\u7406\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u91c7\u53d6\u200b\u600e\u6837\u200b\u7684\u200b \u200b\u66ff\u6362\u200b\u7b56\u7565\u200b \uff0c\u200b\u4ee5\u53ca\u200b\u5728\u200b\u4ec0\u4e48\u200b\u65f6\u673a\u200b\u4e0b\u200b \u200b\u5199\u56de\u200b \uff0c\u200b\u5982\u4f55\u200b\u4fdd\u8bc1\u200b \u200b\u4e00\u81f4\u6027\u200b \uff0c\u200b\u8fd9\u4e9b\u200b\u90fd\u200b\u662f\u200b\u78c1\u76d8\u200b\u7f13\u5b58\u200b\u9700\u8981\u200b\u8003\u8651\u200b\u7684\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"lab5/part3-4/#12","title":"1.2 \u200b\u5b9e\u73b0\u200b\u6307\u5357","text":"<p>SFS\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u79cd\u200b\u7b80\u5355\u200b\u7684\u200b\u7f13\u5b58\u200b\u65b9\u6848\u200b\u3002</p> <ul> <li>\u200b\u7f13\u5b58\u200b\u5757\u200b\u5206\u914d\u200b\uff1a\u200b\u5229\u7528\u200b\u5185\u5b58\u200b\u7ed3\u6784\u200b\u67e5\u627e\u200b\u7f13\u5b58\u200b\u4e2d\u200b\u7b2c\u4e00\u4e2a\u200b\u7a7a\u95f2\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u82e5\u200b\u65e0\u200b\u7a7a\u95f2\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u5219\u200b\u91c7\u7528\u200b\u540e\u200b\u8ff0\u200b\u66ff\u6362\u200b\u7b56\u7565\u200b\u91ca\u653e\u200b\u7f13\u5b58\u200b\u5757\u200b\u3002</li> <li>\u200b\u7f13\u5b58\u200b\u5757\u200b\u66ff\u6362\u200b\uff1a\u200b\u88ab\u200b\u66ff\u6362\u200b\u7f13\u5b58\u200b\u5757\u200b\u7684\u200b\u6311\u9009\u200b\u91c7\u7528\u200b\u4e00\u79cd\u200b\u8f83\u4e3a\u7b80\u5355\u200b\u7684\u200b \u200b\u8fd1\u4f3c\u200b\u5148\u5165\u200b\u5148\u51fa\u200b \u200b\u65b9\u6cd5\u200b\u3002\u200b\u5047\u8bbe\u200b\u7f13\u5b58\u200b\u5757\u200b\u603b\u5171\u200b\u6709\u200b<code>n</code>\u200b\u5757\u200b\uff0c\u200b\u6211\u4eec\u200b\u603b\u662f\u200b\u8bb0\u5f55\u200b\u4e0a\u200b\u4e00\u6b21\u200b\u88ab\u200b\u66ff\u6362\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b<code>i</code>\uff0c\u200b\u5219\u200b\u672c\u6b21\u200b\u5c06\u8981\u200b\u88ab\u200b\u66ff\u6362\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b<code>j = (i + 1) mod n</code>\u3002</li> <li>\u200b\u7f13\u5b58\u200b\u5757\u200b\u547d\u4e2d\u200b\uff1a\u200b\u6211\u4eec\u200b\u4e3a\u200b\u6bcf\u4e2a\u200b\u7f13\u5b58\u200b\u5757\u200b\u90fd\u200b\u4f1a\u200b\u7ef4\u62a4\u200b\u4e00\u4e2a\u200b\u5143\u200b\u6570\u636e\u200b\uff0c\u200b\u5143\u200b\u6570\u636e\u200b\u8bb0\u5f55\u200b\u4e86\u200b\u8be5\u200b\u7f13\u5b58\u200b\u5757\u200b\u5bf9\u5e94\u200b\u4ecb\u8d28\u200b\u4e0a\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b\uff0c\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u68c0\u67e5\u200b\u7269\u7406\u5730\u5740\u200b\u662f\u5426\u200b\u91cd\u5408\u200b\u6765\u200b\u5224\u65ad\u200b\u7f13\u5b58\u200b\u5757\u200b\u662f\u5426\u200b\u547d\u4e2d\u200b\u3002</li> <li>\u200b\u7f13\u5b58\u200b\u5757\u200b\u7d22\u5f15\u200b\uff1aSFS\u200b\u4f7f\u7528\u200b\u4f4d\u56fe\u200b\u5bf9\u200b\u7f13\u5b58\u200b\u5757\u200b\u7684\u200b\u5206\u914d\u60c5\u51b5\u200b\u8fdb\u884c\u200b\u7ba1\u7406\u200b\u3002\u200b\u4f46\u662f\u200b\u4f4d\u200b\u56fe\u200b\u9762\u4e34\u200b\u7684\u200b\u641c\u7d22\u200b\u65f6\u95f4\u200b\u4e3a\u200bO(N)\u3002SFS\u200b\u5c06\u4f4d\u200b\u56fe\u200b\u5212\u5206\u200b\u4e3a\u200b\u591a\u4e2a\u200b\u5b50\u4f4d\u200b\u56fe\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u5b50\u4f4d\u200b\u56fe\u200b\u7531\u200b\u4e00\u4e2a\u200b\u5143\u200b\u6570\u636e\u200b\u8282\u70b9\u200b\u7ba1\u7406\u200b\uff0c\u200b\u7edf\u8ba1\u200b\u8be5\u5b50\u200b\u4f4d\u56fe\u200b\u7684\u200b\u5206\u914d\u60c5\u51b5\u200b\u3002\u200b\u6211\u4eec\u200b\u5728\u200b\u540e\u9762\u200b\u8fdb\u884c\u200b\u66f4\u4e3a\u200b\u8be6\u7ec6\u200b\u7684\u200b\u4ecb\u7ecd\u200b\u3002</li> <li>\u200b\u7f13\u5b58\u200b\u5757\u200b\u56de\u5199\u200b\u65b9\u5f0f\u200b\uff1aWrite-Back\u200b\u6a21\u5f0f\u200b</li> </ul> <p>SFS\u200b\u53ef\u4ee5\u200b\u5f88\u200b\u5bb9\u6613\u200b\u5730\u200b\u5b9e\u73b0\u200b\u5bf9\u200b\u6587\u4ef6\u200b\u6570\u636e\u200b\u7684\u200b\u7f13\u5b58\u200b\uff0c\u200b\u5176\u4f2a\u200b\u4ee3\u7801\u200b\u53ef\u200b\u8868\u793a\u200b\u5982\u4e0b\u200b\uff1a</p> <ul> <li>\u200b\u8bfb\u6570\u636e\u200b\uff1a</li> </ul> <pre><code>if not hit_cache(offset):\nread_into_cache(offset)\nread_from_cache(offset)\n</code></pre> <ul> <li>\u200b\u5199\u200b\u6570\u636e\u200b\uff1a</li> </ul> <pre><code>if not hit_cache(offset):\nread_into_cache(offset)\nwrite_to_cache(offset)\n</code></pre>"},{"location":"lab5/part3-4/#121-sfs","title":"1.2.1 SFS\u200b\u7f13\u5b58\u200b\u5b9e\u73b0","text":"<p>\u200b\u9996\u5148\u200b\u5207\u6362\u200b\u5230\u200b<code>buf</code>\u200b\u5206\u652f\u200b\u4ee5\u200b\u5b8c\u6210\u200b\u5b9e\u9a8c\u200b\uff1a</p> <pre><code>git checkout buf\n</code></pre> <p>\u200b\u503c\u5f97\u200b\u8bf4\u660e\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u66f4\u597d\u200b\u5730\u200b\u6a21\u62df\u200b\u78c1\u76d8\u200b\u5ef6\u65f6\u200b\uff0c\u200b\u6211\u4eec\u200b\u5411\u200b<code>user_ddriver</code>\u200b\u4e2d\u200b\u4eba\u4e3a\u200b\u63d2\u5165\u200b\u4e86\u200b\u5ef6\u8fdf\u200b\u51fd\u6570\u200b\uff0c\u200b\u76f8\u5173\u200b\u4ee3\u7801\u200b\u53ef\u200b\u9605\u8bfb\u200b<code>buf</code>\u200b\u5206\u652f\u200b\u4e0b\u200b\u7684\u200b<code>ddriver.c</code>\u3002</p>"},{"location":"lab5/part3-4/#122","title":"1.2.2 \u200b\u6570\u636e\u7ed3\u6784","text":"<pre><code>struct sfs_bm_node { int       avai;                                   /* \u200b\u8be5\u4f4d\u200b\u56fe\u200b\u5269\u4f59\u200b\u7684\u200b\u8bb0\u5f55\u200b\u6570\u200b */                 uint8_t   bm_indicators[SFS_CACHE_BMID_N];        /* \u200b\u5143\u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b */           uint8_t   bm[SFS_CACHE_BMND_N];                   /* \u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b */\n};\n</code></pre> <p><code>sfs_bm_node</code>\u200b\u4f4d\u4e8e\u200b\u5185\u5b58\u200b\u4e2d\u200b\uff0c\u200b\u7528\u4e8e\u200b\u7f13\u5b58\u200b\u5757\u200b\u7ba1\u7406\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u7406\u89e3\u200b\u4e3a\u200b\u4e00\u4e2a\u200b\u5b50\u4f4d\u200b\u56fe\u200b\u7ed3\u6784\u200b\uff0c\u200b\u5176\u4e2d\u200b<code>bm</code>\u200b\u5b57\u200b\u6bb5\u200b\u4ee3\u8868\u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b\uff0c<code>bm_indicators</code>\u200b\u8fdb\u800c\u200b\u8bb0\u5f55\u200b<code>bm</code>\u200b\u4e2d\u200b\u6bcf\u200b8\u200b\u4f4d\u200b\u7684\u200b\u5206\u914d\u60c5\u51b5\u200b\uff1a\u200b\u5982\u679c\u200b\u4e3a\u200b0\uff0c\u200b\u4ee3\u8868\u200b\u8be5\u200b8\u200b\u4f4d\u4e2d\u200b\u65e0\u200b\u6709\u6548\u200b\uff08\u200b\u88ab\u200b\u5206\u914d\u200b\uff09\u200b\u4f4d\u200b\uff1b\u200b\u4e3a\u200b1\u200b\u4ee3\u8868\u200b\u8be5\u200b8\u200b\u4f4d\u4e2d\u200b\u6709\u200b\u6709\u6548\u200b\u4f4d\u200b\u3002\u200b\u503c\u5f97\u200b\u8bf4\u660e\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u5982\u679c\u200b\u4ec5\u200b\u8bb0\u5f55\u200b\u6bcf\u200b8\u200b\u4f4d\u200b\u4e00\u7ec4\u200b\uff0c\u200b\u5b8c\u5168\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b&amp;0xFF\u200b\u64cd\u4f5c\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u63a8\u5e7f\u200b\u5230\u200b\u8bb0\u5f55\u200b\u6bcf\u200b128\u200b\u4f4d\u200b\u751a\u81f3\u200b\u66f4\u200b\u9ad8\u200b\u7684\u200b\u60c5\u51b5\u200b\u3002\u200b\u6700\u540e\u200b\uff0c<code>avai</code>\u200b\u5b57\u200b\u6bb5\u200b\u8bb0\u5f55\u200b\u6539\u4e3a\u200b\u56fe\u200b\u5269\u4f59\u200b\u7684\u200b\u8bb0\u5f55\u200b\u6570\u200b\uff0c\u200b\u975e\u200b0\u200b\u4ee3\u8868\u200b\u8fd8\u6709\u200b\u7a7a\u95f2\u200b\u5757\u200b\uff0c0\u200b\u4ee3\u8868\u200b\u65e0\u200b\u7a7a\u95f2\u200b\u5757\u200b\u3002\u200b\u56e0\u6b64\u200b\u5355\u4e2a\u200b<code>sfs_bm_node</code>\u200b\u8282\u70b9\u200b\u53ef\u4ee5\u200b\u753b\u56fe\u200b\u8868\u793a\u200b\u4e3a\u200b\uff1a</p> <p></p> <pre><code>struct __attribute__((packed)) sfs_cnode_hdr\n{\nint                phys_ofs;\nint                flags;\n};\n\nstruct __attribute__((packed)) sfs_cnode\n{ struct sfs_cnode_hdr hdr;\nunsigned char        data[];\n};\n</code></pre> <p><code>sfs_cnode</code>\u200b\u4ee3\u8868\u200b\u4e00\u4e2a\u200b\u7f13\u5b58\u200b\u5757\u200b\u8282\u70b9\u200b\uff0c\u200b\u5176\u200b\u5305\u542b\u200b\u4e00\u4e2a\u200b\u5143\u200b\u6570\u636e\u200b\u5934\u200b\u4e0d\u200b<code>hdr</code>\u200b\u4e0e\u200b\u7f13\u5b58\u200b\u7684\u200b\u6570\u636e\u200b<code>data</code>\uff0c<code>hdr</code>\u200b\u4e2d\u200b\u8bb0\u5f55\u200b\u4e86\u200b\u7f13\u5b58\u200b\u5757\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7269\u7406\u5730\u5740\u200b<code>phys_ofs</code>\u200b\u4e0e\u200b\u4e00\u4e9b\u200b\u6807\u5fd7\u200b\u4f4d\u200b<code>flags</code>\uff08\u200b\u662f\u5426\u200b\u5199\u810f\u200b\uff09\u3002\u200b\u6ce8\u610f\u200b\uff0c\u200b\u5728\u200bSFS\u200b\u4e2d\u200b\uff0c\u200b\u7f13\u5b58\u200b\u5757\u200b\u5927\u5c0f\u200b\u9ed8\u8ba4\u200b\u4e0e\u200bIO\u200b\u5757\u200b\u5927\u5c0f\u200b\u5bf9\u9f50\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4e0d\u200b\u8bb0\u5f55\u200b\u5757\u200b\u5927\u5c0f\u200b\u3002\u200b\u5f53\u7136\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u66f4\u200b\u7c97\u7c92\u5ea6\u200b\u5730\u53bb\u200b\u7ba1\u7406\u200b\u4e00\u4e2a\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u4f8b\u5982\u200b2\u200b\u4e2a\u200bIO\u200b\u5757\u200b\u5927\u5c0f\u200b\u7b49\u200b\u3002<code>sfs_cnode</code>\u200b\u7684\u200b\u96c6\u5408\u200b\u6784\u6210\u200b\u4e86\u200bSFS\u200b\u7f13\u5b58\u200bBuffer\uff0c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <pre><code>struct sfs_cache\n{\nint                     sz_blk;                   /* \u200b\u6bcf\u4e2a\u200b\u7f13\u5b58\u6570\u636e\u200b\u5757\u200b\u5927\u5c0f\u200b = io_sz */\nint                     num_blk;                  /* \u200b\u7f13\u5b58\u200b\u7684\u200b\u6570\u636e\u200b\u5757\u6570\u200b */  struct sfs_bm_node      *bms;                     /* Cache\u200b\u5206\u914d\u200b\u4f4d\u200b\u56fe\u200b */\nint                     num_bms;                  /* \u200b\u5206\u914d\u200b\u4f4d\u56fe\u200b\u7684\u200b\u4e2a\u6570\u200b */\nint                     last_evicted;             /* \u200b\u4e0a\u200b\u4e00\u6b21\u200b\u9a71\u9010\u200b\u5757\u200b */\nunsigned char           *buf;                     /* Cnode\u200b\u5b58\u653e\u200b\u533a\u200b */\n\nint                     cache_hit;\nint                     cache_miss;\nint                     cache_wb;\nint                     cache_ld;\n};\n</code></pre> <p><code>sfs_cache</code>\u200b\u4ee3\u8868\u200b\u6574\u4e2a\u200b\u7f13\u5b58\u200b\u7ed3\u6784\u200b\uff0c\u200b\u76f8\u5173\u200b\u53d8\u91cf\u200b\u5b9a\u4e49\u200b\u4e0d\u518d\u200b\u8d58\u8ff0\u200b\u3002\u200b\u5176\u4e2d\u200b\uff0c<code>cache_</code>\u200b\u5f00\u5934\u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\u4ee3\u8868\u200b\u7f13\u5b58\u200b\u7684\u200b\u547d\u4e2d\u200b\u3001\u200b\u56de\u5199\u200b\u3001\u200b\u52a0\u8f7d\u200b\u4fe1\u606f\u200b\u3002\u200b\u8fdb\u800c\u200b\uff0c\u200b\u6211\u4eec\u200b\u7528\u200b\u4e0b\u56fe\u200b\u6765\u200b\u63cf\u8ff0\u200b\u7f13\u5b58\u200b\u7684\u200b\u6574\u4f53\u200b\u7ed3\u6784\u200b\uff1a</p> <p></p> <p>\u200b\u503c\u5f97\u200b\u8bf4\u660e\u200b\u7684\u200b\u662f\u200b\uff0cSFS\u200b\u4e2d\u200b\u7684\u200b\u7f13\u5b58\u200b\u7ed3\u6784\u200b\u5b8c\u5168\u200b\u88ab\u200b\u90e8\u7f72\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u975e\u200b\u786c\u4ef6\u200bCache\u3002</p>"},{"location":"lab5/part3-4/#123","title":"1.2.3 \u200b\u5173\u952e\u200b\u65b9\u6cd5","text":"<ul> <li>\u200b\u547d\u4e2d\u200b\u6216\u200b\u7533\u8bf7\u200b\u5206\u914d\u200b\u7f13\u5b58\u200b\u5757\u200b\uff1a</li> </ul> <p>\u200b\u51fd\u6570\u200b\u4ecb\u7ecd\u200b\uff1a</p> <p>\u200b\u8be5\u200b\u65b9\u6cd5\u200b\u505a\u200b\u4e24\u4e2a\u200b\u4e8b\u60c5\u200b\uff1a</p> <ol> <li>\u200b\u6839\u636e\u200b\u4f20\u5165\u200b\u53c2\u6570\u200b<code>phys_ofs</code>\u200b\u5224\u65ad\u200b\u662f\u5426\u200b\u547d\u4e2d\u200bCache\uff0c\u200b\u82e5\u200b\u672a\u200b\u547d\u4e2d\u200bCache\uff0c\u200b\u5219\u200b\u6267\u884c\u200b\u6b65\u9aa4\u200b\u4e8c\u200b</li> <li>\u200b\u5206\u914d\u200b\u4e00\u4e2a\u200b\u7a7a\u95f2\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u82e5\u200b\u6ca1\u6709\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u5219\u200b\u6309\u200b\u524d\u8ff0\u200b\u66ff\u6362\u7b97\u6cd5\u200b\u8fdb\u884c\u200b\u7f13\u5b58\u200b\u5757\u200b\u66ff\u6362\u200b\u91ca\u653e\u200b</li> </ol> <p>\u200b\u8fd4\u56de\u503c\u200b\uff1a\u200b\u8be5\u200b\u65b9\u6cd5\u200b\u8fd4\u56de\u200b phys_ofs\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u5757\u200b\u53f7\u200b</p> <p>\u200b\u51fd\u6570\u200b\u5b9e\u73b0\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>int sfs_cache_hit_or_alloc_blk(struct sfs_cache *cache, int phys_ofs) {\nint blk = -1;\nint bm_id, line, i;\nint num_bms = cache-&gt;num_bms;\nint bm_lines = SFS_CACHE_BMND_N;\nint free_blk = -1;\nint evict_blk = -1;\nstruct sfs_bm_node *bm_node;\nstruct sfs_cnode   *cnode;\n\nfor (bm_id = 0; bm_id &lt; num_bms; bm_id++) {        /* \u200b\u904d\u5386\u200b\u6240\u6709\u200b\u4e3a\u4f4d\u200b\u56fe\u200b\uff0c\u200b\u67e5\u770b\u200bCache\u200b\u547d\u4e2d\u200b\u548c\u200b\u7a7a\u95f2\u200b\u5757\u200b */   bm_node = &amp;cache-&gt;bms[bm_id];\nif (bm_node-&gt;avai != SFS_CACHE_BMND_N * UINT8_BITS) {\nfor (line = 0; line &lt; bm_lines; line++) { if (bm_test(bm_node-&gt;bm_indicators, line)) {\nblk = bm_id * SFS_CACHE_BMND_N * UINT8_BITS + line * UINT8_BITS;\nfor (i = 0; i &lt; UINT8_BITS; i++) {\nif (bm_test(bm_node-&gt;bm, blk + i)) {\ncnode = GET_CNODE(cache, blk + i);\nif (cnode-&gt;hdr.phys_ofs == phys_ofs) {\ncache-&gt;cache_hit += 1;\nreturn blk + i;\n}\n}\nelse {\nif (free_blk == -1) {\nfree_blk = blk + i;\n}        }\n}\n}\nelse {\nif (free_blk == -1) {\nblk = bm_id * SFS_CACHE_BMND_N * UINT8_BITS + line * UINT8_BITS;\nfree_blk = blk;\n}\n}\n}\n}\nelse {\nblk = bm_id * SFS_CACHE_BMND_N * UINT8_BITS;\nfree_blk = blk;\n}\n}\n\ncache-&gt;cache_miss += 1;\n\nif (free_blk == -1 || free_blk &gt; cache-&gt;num_blk - 1) { /* \u200b\u9a71\u9010\u200b\u7f13\u5b58\u200b\u884c\u200b */\nevict_blk = (cache-&gt;last_evicted + 1) % cache-&gt;num_blk;\nsfs_cache_rls_blk(cache, evict_blk);\ncache-&gt;last_evicted = evict_blk;\nfree_blk = evict_blk;\n}\n\nblk = free_blk;\n\nsfs_cache_alloc_blk(cache, blk, phys_ofs);\n\nreturn blk;\n}\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c\u200b\u4e0b\u8ff0\u200b\u4ee3\u7801\u200b\u4e3b\u8981\u200b\u5b8c\u6210\u200b\u4f4d\u56fe\u200b\u7684\u200b\u904d\u5386\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u6bcf\u200b\u4e00\u4e2a\u200b<code>sfs_bm_node</code>\uff0c\u200b\u4e25\u683c\u200b\u6309\u7167\u200b\u987a\u5e8f\u200b\u68c0\u67e5\u200b\uff1a<code>avai</code>\u2192<code>bm_indicators</code>\u2192<code>bm</code>\u3002\u200b\u5728\u200b\u904d\u5386\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u8bb0\u5f55\u200b\u4e0b\u200b\u7b2c\u4e00\u4e2a\u200b\u7a7a\u95f2\u200b\u5757\u200b<code>free_blk</code>\uff0c\u200b\u4fbf\u4e8e\u200b\u7f13\u5b58\u200b\u672a\u200b\u547d\u4e2d\u200b\u65f6\u200b\u8fd4\u56de\u200b\u3002</p> <pre><code>for (bm_id = 0; bm_id &lt; num_bms; bm_id++) {        /* \u200b\u904d\u5386\u200b\u6240\u6709\u200b\u4e3a\u4f4d\u200b\u56fe\u200b\uff0c\u200b\u67e5\u770b\u200bCache\u200b\u547d\u4e2d\u200b\u548c\u200b\u7a7a\u95f2\u200b\u5757\u200b */   bm_node = &amp;cache-&gt;bms[bm_id];\nif (bm_node-&gt;avai != SFS_CACHE_BMND_N * UINT8_BITS) {\nfor (line = 0; line &lt; bm_lines; line++) { if (bm_test(bm_node-&gt;bm_indicators, line)) {\nblk = bm_id * SFS_CACHE_BMND_N * UINT8_BITS + line * UINT8_BITS;\nfor (i = 0; i &lt; UINT8_BITS; i++) {\nif (bm_test(bm_node-&gt;bm, blk + i)) {\n...\n}\n...\n}\n}\n...\n}\n}\nelse {\n...\n}\n}\n</code></pre> <p>\u200b\u4ee5\u4e0b\u200b\u4ee3\u7801\u200b\u7528\u4e8e\u200b\u68c0\u6d4b\u200b\u662f\u5426\u200b\u547d\u4e2d\u200b\u3002\u200b\u9996\u5148\u200b\u83b7\u53d6\u200b\u76ee\u6807\u200b\u7f13\u5b58\u200b\u5757\u200b<code>sfs_cnode</code>\uff0c\u200b\u518d\u200b\u6bd4\u200b\u5bf9\u200b<code>phys_ofs</code>\u200b\u5373\u53ef\u200b\u3002</p> <pre><code>cnode = GET_CNODE(cache, blk + i);\nif (cnode-&gt;hdr.phys_ofs == phys_ofs) {\ncache-&gt;cache_hit += 1;\nreturn blk + i;\n}\n</code></pre> <p>\u200b\u5982\u679c\u200b\u53d1\u73b0\u200b\u65e2\u200b\u672a\u200b\u547d\u4e2d\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u53c8\u200b\u6ca1\u6709\u200b<code>free_blk</code>\uff0c\u200b\u5219\u200b\u89e6\u53d1\u200b\u7f13\u5b58\u200b\u66ff\u6362\u200b\uff0c\u200b\u88ab\u200b\u66ff\u6362\u200b\u7684\u200b\u5757\u200b\u4f5c\u4e3a\u200b\u65b0\u200b\u7684\u200b\u7a7a\u95f2\u200b\u5757\u200b\u88ab\u200b\u5206\u914d\u200b\u3002\u200b\u5176\u4e2d\u200b\uff0c\u200b\u9700\u8981\u200b\u8bf4\u660e\u200b\u4e24\u4e2a\u200b\u51fd\u6570\u200b\uff1a</p> <ul> <li><code>sfs_cache_rls_blk</code>\uff1a\u200b\u8be5\u200b\u51fd\u6570\u200b\u7528\u4e8e\u200b\u5c06\u200b\u7f13\u5b58\u200b\u5757\u200b\u7684\u200b\u5185\u5bb9\u200b\u8c03\u7528\u200b \u200b\u9a71\u52a8\u200b\u5199\u200b \u200b\u56de\u5199\u200b\u5230\u200b\u4ecb\u8d28\u200b\u4e0a\u200b\uff0c\u200b\u5e76\u200b\u66f4\u65b0\u200b\u76f8\u5e94\u200b\u7684\u200b\u4f4d\u56fe\u200b\u7d22\u5f15\u200b\u7ed3\u6784\u200b</li> <li><code>sfs_cache_alloc_blk</code>\uff1a\u200b\u8be5\u200b\u51fd\u6570\u200b\u7528\u4e8e\u200b\u5c06\u200b\u5bf9\u5e94\u200bphys_ofs\u200b\u7684\u200b\u5185\u5bb9\u200b\u8c03\u7528\u200b \u200b\u9a71\u52a8\u200b\u8bfb\u200b \u200b\u8bfb\u53d6\u200b\u5230\u200b\u76f8\u5e94\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u200b\u66f4\u65b0\u200b\u7f13\u5b58\u200b\u5757\u200b\u5143\u200b\u6570\u636e\u200b<code>hdr</code>\uff0c\u200b\u66f4\u65b0\u200b\u76f8\u5e94\u200b\u7684\u200b\u4f4d\u56fe\u200b\u7d22\u5f15\u200b\u7ed3\u6784\u200b</li> </ul> <pre><code>int sfs_cache_hit_or_alloc_blk(struct sfs_cache *cache, int phys_ofs) {\n...\n\ncache-&gt;cache_miss += 1;\n\nif (free_blk == -1 || free_blk &gt; cache-&gt;num_blk - 1) { /* \u200b\u9a71\u9010\u200b\u7f13\u5b58\u200b\u884c\u200b */\nevict_blk = (cache-&gt;last_evicted + 1) % cache-&gt;num_blk;\nsfs_cache_rls_blk(cache, evict_blk);\ncache-&gt;last_evicted = evict_blk;\nfree_blk = evict_blk;\n}\n\nblk = free_blk;\n\nsfs_cache_alloc_blk(cache, blk, phys_ofs);\n\nreturn blk;\n}\n</code></pre> <ul> <li>\u200b\u8bfb\u5199\u200b\u65b9\u6cd5\u200b</li> </ul> <p>\u200b\u8bfb\u200b\u65b9\u6cd5\u200b\u4e3a\u200b<code>sfs_try_cache_read</code>\uff0c\u200b\u5199\u200b\u65b9\u6cd5\u200b\u4e3a\u200b<code>sfs_try_cache_write</code>\u3002\u200b\u4e3b\u8981\u200b\u601d\u8def\u200b\u51e0\u4e4e\u200b\u4e00\u81f4\u200b\uff0c\u200b\u9996\u5148\u200b\u901a\u8fc7\u200b\u8c03\u7528\u200b<code>sfs_cache_hit_or_alloc_blk</code>\u200b\u83b7\u53d6\u200b<code>offset</code>\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7f13\u5b58\u200b\u5757\u200b\uff0c\u200b\u7136\u540e\u200b\u5bf9\u200b\u7f13\u5b58\u200b\u5757\u200b\u8fdb\u884c\u200b\u8bfb\u53d6\u200b\u6216\u200b\u5199\u5165\u200b\u5373\u53ef\u200b\u3002</p> <pre><code>int sfs_try_cache_read(struct sfs_cache *cache, int offset, uint8_t *out_content, int size) {\n...\nif (IS_CACHE_ENABLE(cache)) {\nblk = sfs_cache_hit_or_alloc_blk(cache, offset);\ncnode = GET_CNODE(cache, blk);\n\nmemcpy(out_content, cnode-&gt;data, size);\n...\n}\n...\n}\n\nint sfs_try_cache_write(struct sfs_cache *cache, int offset, uint8_t *in_content, int size) {\n...\nif (IS_CACHE_ENABLE(cache)) {\nblk = sfs_cache_hit_or_alloc_blk(cache, offset);\ncnode = GET_CNODE(cache, blk);\n\nmemcpy(cnode-&gt;data, in_content, size);\n...\n}\n...\n}\n</code></pre> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u4fee\u6539\u200bSFS\u200b\u5c01\u88c5\u200b\u7684\u200b<code>sfs_driver_read</code>\u200b\u548c\u200b<code>sfs_driver_write</code>\u200b\u5373\u53ef\u200b\uff0c\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u51fd\u6570\u200b\u539f\u672c\u200b\u7684\u200b\u76ee\u7684\u200b\u662f\u200b\u4e3a\u4e86\u200b\u9002\u914d\u200b\u4efb\u610f\u200b<code>offset</code>\u200b\u4e0e\u200b<code>size</code>\uff0c\u200b\u8ba9\u200b\u4fee\u6539\u200b\u7b26\u5408\u200bIO\u200b\u5757\u200b\u5927\u5c0f\u200b\u3002\u200b\u4fee\u6539\u200b\u65b9\u5f0f\u200b\u5f88\u200b\u7b80\u5355\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u5c06\u200b\u539f\u6765\u200b\u7684\u200b<code>ddriver_seek</code> + <code>ddriver_read</code>\u200b\u6216\u200b<code>ddriver_write</code>\u200b\u66f4\u6362\u200b\u4e3a\u200b<code>sfs_try_cache_read</code>\u200b\u6216\u200b<code>sfs_try_cache_write</code>\u200b\u5373\u53ef\u200b\uff0c\u200b\u76f8\u5173\u200b\u4ee3\u7801\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a</p> <pre><code>/* sfs_utils.c */\n\nint sfs_driver_read(int offset, uint8_t *out_content, int size) {\n...\n// lseek(SFS_DRIVER(), offset_aligned, SEEK_SET);\n// ddriver_seek(SFS_DRIVER(), offset_aligned, SEEK_SET);\nwhile (size_aligned != 0)\n{\n// read(SFS_DRIVER(), cur, SFS_IO_SZ());\n// ddriver_read(SFS_DRIVER(), cur, SFS_IO_SZ());\nsfs_try_cache_read(SFS_CACHE(), offset_aligned, cur, SFS_IO_SZ());\ncur          += SFS_IO_SZ();\nsize_aligned -= SFS_IO_SZ();   offset_aligned += SFS_IO_SZ();\n}\nmemcpy(out_content, temp_content + bias, size);\n...\n}\n\nint sfs_driver_write(int offset, uint8_t *in_content, int size) {\n...\n// lseek(SFS_DRIVER(), offset_aligned, SEEK_SET);\n// ddriver_seek(SFS_DRIVER(), offset_aligned, SEEK_SET);\nwhile (size_aligned != 0)\n{\n// write(SFS_DRIVER(), cur, SFS_IO_SZ());\nsfs_try_cache_write(SFS_CACHE(), offset_aligned, cur, SFS_IO_SZ());\ncur          += SFS_IO_SZ();\nsize_aligned -= SFS_IO_SZ();   offset_aligned += SFS_IO_SZ();\n}\n...\n}\n</code></pre> <p>\u200b\u6b64\u5916\u200b\uff0c\u200b\u5728\u200b\u539f\u6765\u200b\u7684\u200bSFS\u200b\u8bbe\u8ba1\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5b9e\u73b0\u200b\u7684\u200b<code>sfs_write</code>\u200b\u548c\u200b<code>sfs_read</code>\u200b\u76f4\u63a5\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u200b\u8fdb\u884c\u200b\uff0c\u200b\u8fd9\u6837\u4e00\u6765\u200b\u5e76\u200b\u4e0d\u80fd\u200b\u4f53\u73b0\u200b\u7f13\u5b58\u200b\u7684\u200b\u4f5c\u7528\u200b\uff0c\u200b\u4e8e\u662f\u200b\u66f4\u6362\u200b\u4e86\u200b\u8bfb\u5199\u200b\u6570\u636e\u200b\u51fd\u6570\u200b\u5982\u4e0b\u200b\uff08\u200b\u5c06\u200b<code>memcpy</code>\u200b\u66f4\u6362\u200b\u4e3a\u200b<code>sfs_driver_read</code>\u200b\u4e0e\u200b<code>sfs_driver_write</code>\uff09\uff1a</p> <pre><code>int sfs_write(const char* path, const char* buf, size_t size, off_t offset,\nstruct fuse_file_info* fi) {\n...\n// memcpy(inode-&gt;data + offset, buf, size);\nsfs_driver_write(SFS_DATA_OFS((inode-&gt;ino)) + offset, buf, size);\n...\n}\n\nint sfs_read(const char* path, char* buf, size_t size, off_t offset,\nstruct fuse_file_info* fi) {\n...\n// memcpy(buf, inode-&gt;data + offset, size);\nsfs_driver_read(SFS_DATA_OFS((inode-&gt;ino)) + offset, buf, size);\n...            }\n</code></pre>"},{"location":"lab5/part3-4/#13-sfs","title":"1.3 SFS\u200b\u7f13\u5b58\u200b\u6d4b\u8bd5","text":"<p>\u200b\u4e3a\u4e86\u200b\u9a8c\u8bc1\u200bSFS\u200b\u7f13\u5b58\u200b\u6709\u6548\u6027\u200b\uff0c\u200b\u7f16\u5199\u200b\u5982\u4e0b\u200b\u811a\u672c\u200b\u6d4b\u8bd5\u200b\uff1a</p> <pre><code>import os\nimport sys\nimport time\n\ndef process(loop, cblks):\n    ...\n    work_set_sz = 16 * 512                                # 8KB\n    iter_sz = 512                                         # 512B\n    num_iters = work_set_sz // iter_sz\n    ...\n    tot_sz = loop * work_set_sz     # B\n    start = time.time()\n    with open(f_path, 'w+') as f:\n        content = 'a' * work_set_sz\n        for i in range(loop):\n            f.seek(0)\n            for j in range(num_iters):\n                # print(\"Iter: \" + str(j))\n                f.write(content[j * iter_sz : (j + 1) * iter_sz])\n\n        f.seek(0)\n        data = f.read(work_set_sz)\n        if data != content:\n            print('buf: read data is not equal to written data')\n            sys.exit(1)\n\n    os.system('umount {}'.format(mnt_point))\n    end = time.time()\n    print('Time: {}ms BW: {}MB/s'.format(1000 * (end - start), tot_sz / 1024 / 1024 / (end - start)))\n\nloop = 1000000\nprint(\"Cache Blks: 512\")\nprocess(loop, 512)\nprint(\"Cache Blks: 0\")\nprocess(loop, 0) \n</code></pre> <p>\u200b\u8be5\u200b\u811a\u672c\u200b\u4ee5\u200b512B\u200b\u4e3a\u200b\u5355\u4f4d\u200b\u5199\u6ee1\u200bSFS\u200b\u6587\u4ef6\u200b\uff08\u200b\u5927\u5c0f\u200b\u4e3a\u200b512B * 16\uff091000000\u200b\u6b21\u200b\uff0c\u200b\u7136\u540e\u200b\u8ba1\u7b97\u200b\u5199\u5165\u200b\u5e26\u5bbd\u200b\u3002\u200b\u6d4b\u8bd5\u200b\u5bf9\u8c61\u200b\u662f\u200b \u200b\u65e0\u200b\u7f13\u5b58\u200b\u5757\u200b \u200b\u4e0e\u200b\u6709\u200b 512\u200b\u4e2a\u200b\u7f13\u5b58\u200b\u5757\u200b \u200b\u4e24\u7c7b\u200b\uff0c\u200b\u6d4b\u8bd5\u200b\u7ed3\u679c\u200b\u5982\u4e0b\u200b\u8868\u200b\u6240\u793a\u200b\uff1a</p> \u200b\u65e0\u200b\u7f13\u5b58\u200b\u5757\u200b 512\u200b\u4e2a\u200b\u7f13\u5b58\u200b\u5757\u200b 84.38797875936444MB/s 101.79038122398883MB/s <p>\u200b\u7531\u4e8e\u200b\u5728\u200b\u865a\u62df\u673a\u200b\u4e0a\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u7ed3\u679c\u200b\u96be\u514d\u200b\u4e0d\u51c6\u200b\uff0c\u200b\u4f46\u200b\u6709\u200b\u7f13\u5b58\u200b\u5757\u200b\u7684\u200b\u65f6\u95f4\u200b\u5f00\u9500\u200b\u4e00\u822c\u6765\u8bf4\u200b\u6bd4\u200b\u65e0\u200b\u7f13\u5b58\u200b\u5757\u200b\u5c0f\u200b\uff0c\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u5b66\u751f\u200b\u901a\u8fc7\u200b\u81ea\u5df1\u200b\u8bbe\u8ba1\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u6700\u7ec8\u200b\u7ed3\u679c\u200b\u80fd\u591f\u200b\u4f53\u73b0\u200b\u51fa\u200b\u52a0\u5165\u200b\u7f13\u5b58\u200b\u7684\u200b\u4f18\u52bf\u200b\u5373\u53ef\u200b</p>"},{"location":"lab5/part3-4/#14","title":"1.4 \u200b\u5b9e\u9a8c\u200b\u8981\u6c42","text":"<p>\u200b\u7531\u4e8e\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4ec5\u200b\u8981\u6c42\u200b\u5728\u200b\u865a\u62df\u673a\u200b\u4e0a\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u56e0\u6b64\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u4ec5\u200b\u8981\u6c42\u200b\u5b66\u751f\u200b\u901a\u8fc7\u200b\u81ea\u5df1\u200b\u8bbe\u8ba1\u200b\u5b9e\u9a8c\u200b\uff0c\u200b\u6700\u7ec8\u200b\u7ed3\u679c\u200b\u80fd\u591f\u200b\u4f53\u73b0\u200b\u51fa\u200b\u52a0\u5165\u200b\u7f13\u5b58\u200b\u7684\u200b\u4f18\u52bf\u200b\u5373\u53ef\u200b\u3002\u200b\u5b66\u751f\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u4fee\u6539\u200b<code>driver/user_ddriver/ddriver.c</code>\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u8ff0\u200b\u7ed3\u6784\u200b\u4f53\u4e2d\u200b\u7684\u200b\u5bf9\u5e94\u200b\u5b57\u6bb5\u200b\u6765\u200b\u8fdb\u4e00\u6b65\u200b\u8c03\u6574\u200b\u5ef6\u8fdf\u200b\uff1a</p> <pre><code>struct ddriver disk = {\n...\n.read_lat    = 2,       /* 2ms */       .write_lat   = 1,       /* 1ms */\n.seek_lat    = 4,       /* 4.17ms per 360 degree */\n...\n};\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c<code>read_lat</code>\u200b\u4ee3\u8868\u200b\u4e3a\u200b<code>ddriver_read</code>\u200b\u63d2\u5165\u200b\u5ef6\u8fdf\u200b\uff0c<code>write_lat</code>\u200b\u4ee3\u8868\u200b\u4e3a\u200b<code>ddriver_write</code>\u200b\u63d2\u5165\u200b\u5ef6\u8fdf\u200b\uff0c<code>seek_lat</code>\u200b\u7528\u4e8e\u200b\u6a21\u62df\u200b\u78c1\u76d8\u200b\u65cb\u8f6c\u200b\uff0c\u200b\u4e00\u822c\u6765\u8bf4\u200b\u6307\u200b\u65cb\u8f6c\u200b360\u00b0\u200b\u8017\u65f6\u200b\uff0c\u200b\u5355\u4f4d\u200b\u90fd\u200b\u662f\u200b<code>ms</code>\u3002</p> <p>\u200b\u4fee\u6539\u200b<code>user_ddriver</code>\u200b\u540e\u200b\uff0c\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b<code>make</code>\u200b\u7f16\u8bd1\u200b\uff0c\u200b\u4ece\u800c\u200b\u4f7f\u200b\u4fee\u6539\u200b\u751f\u6548\u200b\uff1a</p> <pre><code>[root@localhost user_ddriver]# pwd\n/user-land-filesystem/driver/user_ddriver\n[root@localhost user_ddriver]# make\ngcc  -Wall -O -g  -c ddriver.c\n</code></pre>"},{"location":"lab5/part3-4/#2","title":"2.  \u200b\u65e5\u5fd7\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7b80\u4ecb\u200b\uff08\u200b\u9009\u505a\u200b\u4efb\u52a1\u200b\uff09","text":"<p>\u200b\u65e5\u5fd7\u200b\u673a\u5236\u200b\u662f\u200b\u63d0\u9ad8\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u9c81\u68d2\u6027\u200b\u7684\u200b\u4e00\u4e2a\u200b\u91cd\u8981\u200b\u673a\u5236\u200b\u3002\u200b\u6211\u4eec\u200b\u77e5\u9053\u200b\uff0c \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u5f88\u591a\u200b\u64cd\u4f5c\u200b\u5f80\u5f80\u200b\u4e0d\u6b62\u200b\u4e00\u4e2a\u200b\u6b65\u9aa4\u200b \uff0c\u200b\u4ee5\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u4e3a\u4f8b\u200b\uff0c\u200b\u5b83\u200b\u8981\u200b\u7ecf\u8fc7\u200b\uff1a \u200b\u5199\u200b\u6587\u4ef6\u200binode \u3001 \u200b\u5199\u200b\u76ee\u5f55\u200b\u9879\u200b \u3001 \u200b\u66f4\u65b0\u200b\u4f4d\u200b\u56fe\u200b \u200b\u4e09\u4e2a\u200b\u6b65\u9aa4\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u5728\u200b\u5199\u200b\u5b8c\u200b\u76ee\u5f55\u200b\u9879\u200b\u4f46\u200b\u6ca1\u200b\u5f00\u59cb\u200b\u5199\u200b\u8d85\u7ea7\u200b\u5757\u200b\u65f6\u200b\u53d1\u751f\u200b\u4e86\u200b \u200b\u7cfb\u7edf\u200b\u5d29\u6e83\u200b\u6216\u8005\u200b\u505c\u7535\u200b\u7b49\u200b\u56e0\u7d20\u200b\u5bfc\u81f4\u200b\u5b95\u673a\u200b \uff0c\u200b\u90a3\u4e48\u200b\u7b2c\u4e00\u6b65\u200b\u88ab\u200b\u5206\u914d\u200b\u51fa\u53bb\u200b\u7684\u200binode\u200b\u5c31\u200b\u65e0\u6cd5\u200b\u88ab\u200b\u8bb0\u5f55\u200b\u4e3a\u200b\u5df2\u200b\u5206\u914d\u200b\uff0c\u200b\u91cd\u542f\u200b\u7cfb\u7edf\u200b\u540e\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u6709\u200b\u53ef\u80fd\u200b\u628a\u200b\u8fd9\u200b\u4e00\u200binode\u200b\u5206\u914d\u200b\u7ed9\u200b\u5176\u4ed6\u200b\u6587\u4ef6\u200b\u3002</p> <p>\u200b\u4e3a\u4e86\u200b\u4fdd\u8bc1\u200b\u6574\u4e2a\u200b\u8fc7\u7a0b\u200b\u7684\u200b \u200b\u539f\u5b50\u200b\u6027\u200b \uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u52a0\u5165\u200b\u65e5\u5fd7\u200b\u673a\u5236\u200b\u3002\u200b\u5728\u200b\u78c1\u76d8\u200b\u4e2d\u200b\u5212\u51fa\u200b\u4e00\u5757\u200b\u533a\u57df\u200b\u8bb0\u200b\u4e3a\u200b\u65e5\u5fd7\u200b\u533a\u200b\u3002\u200b\u4e00\u200b\u5f00\u59cb\u200b\u4e0d\u200b\u628a\u200b\u66f4\u65b0\u200b\u540e\u200b\u7684\u200b\u6570\u636e\u200b\u5199\u5165\u200b\u6570\u636e\u200b\u533a\u200b\uff0c\u200b\u800c\u662f\u200b\u628a\u200b\u65e5\u5fd7\u200b\u533a\u200b\u72b6\u6001\u200b\u8bb0\u200b\u4e3a\u200b\u8bb0\u5f55\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u200b\u628a\u200b\u66f4\u6539\u200b\u5199\u5165\u200b\u65e5\u5fd7\u200b\u533a\u200b\u3002\u200b\u5199\u5165\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u628a\u200b\u65e5\u5fd7\u200b\u533a\u200b\u72b6\u6001\u200b\u6539\u4e3a\u200b\u5199\u5165\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u200b\u628a\u200b\u65e5\u5fd7\u200b\u533a\u200b\u7684\u200b\u66f4\u6539\u200b\u66f4\u65b0\u200b\u5230\u200b\u6570\u636e\u200b\u533a\u200b\u3002\u200b\u5168\u90e8\u200b\u66f4\u65b0\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u628a\u200b\u65e5\u5fd7\u200b\u533a\u200b\u72b6\u6001\u200b\u8bb0\u200b\u4e3a\u200b\u7a7a\u95f2\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u5728\u200b\u8bb0\u5f55\u200b\u65f6\u200b\u7cfb\u7edf\u200b\u5d29\u6e83\u200b\uff0c\u200b\u5728\u200b\u91cd\u542f\u200b\u540e\u200b\u4f1a\u200b\u53d1\u73b0\u200b\u65e5\u5fd7\u200b\u533a\u200b\u72b6\u6001\u200b\u4e3a\u200b\u8bb0\u5f55\u200b\u4e2d\u200b\u3002\u200b\u6b64\u65f6\u200b\u53ea\u200b\u9700\u200b\u7b80\u5355\u200b\u5730\u200b\u4e22\u5f03\u200b\u65e5\u5fd7\u200b\u5185\u5bb9\u200b\uff0c\u200b\u6539\u200b\u72b6\u6001\u200b\u4e3a\u200b\u7a7a\u95f2\u200b\uff0c\u200b\u5373\u53ef\u200b\u3002\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u6587\u4ef6\u521b\u5efa\u200b\u5c31\u200b\u597d\u50cf\u200b\u4ece\u672a\u200b\u53d1\u751f\u200b\u8fc7\u200b\u4e00\u6837\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u5728\u200b\u5199\u5165\u200b\u65f6\u200b\u7cfb\u7edf\u200b\u5d29\u6e83\u200b\uff0c\u200b\u5728\u200b\u91cd\u542f\u200b\u540e\u200b\u4f1a\u200b\u53d1\u73b0\u200b\u65e5\u5fd7\u200b\u533a\u200b\u72b6\u6001\u200b\u4e3a\u200b\u5199\u5165\u200b\u4e2d\u200b\u3002\u200b\u6b64\u65f6\u200b\u65e5\u5fd7\u200b\u533a\u200b\u7684\u200b\u66f4\u65b0\u200b\u4fe1\u606f\u200b\u662f\u200b\u5b8c\u6574\u200b\u7684\u200b\uff0c\u200b\u53ea\u662f\u200b\u4e0d\u200b\u77e5\u9053\u200b\u5d29\u6e83\u200b\u524d\u5199\u200b\u5230\u200b\u4e86\u200b\u54ea\u200b\u4e00\u6b65\u200b\u3002\u200b\u6b64\u65f6\u200b\u53ea\u8981\u200b\u628a\u200b\u65e5\u5fd7\u200b\u533a\u200b\u7684\u200b\u4fe1\u606f\u200b\u5168\u90e8\u200b\u91cd\u65b0\u200b\u5199\u5165\u200b\u5230\u200b\u6570\u636e\u200b\u533a\u200b\uff0c\u200b\u518d\u200b\u628a\u200b\u72b6\u6001\u200b\u8bb0\u200b\u4e3a\u200b\u7a7a\u95f2\u200b\uff0c\u200b\u5373\u53ef\u200b\u6062\u590d\u200b\u88ab\u200b\u6253\u65ad\u200b\u7684\u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"lab5/part3/","title":"\u5b9e\u9a8c\u200b\u6b65\u9aa4","text":""},{"location":"lab5/part3/#1","title":"1. \u200b\u73af\u5883\u200b\u642d\u5efa\u200b\u4e0e\u200b\u4e0a\u200b\u624b","text":""},{"location":"lab5/part3/#11","title":"1.1 \u200b\u5b9e\u9a8c\u200b\u5305\u200b\u7ed3\u6784\u200b\u4ecb\u7ecd","text":"<p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u5145\u5206\u8003\u8651\u200b\u5230\u200b\u00a0\u200b\u4e0a\u200b\u624b\u200b\u6210\u672c\u200b\u00a0\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u7f16\u5199\u200b\u4e86\u200b\u7b80\u5355\u200b\u7684\u200b\u73af\u5883\u200b\u914d\u7f6e\u200b\u811a\u672c\u200b\uff0c\u200b\u5e2e\u52a9\u200b\u5927\u5bb6\u200b\u4e00\u952e\u200b\u914d\u7f6e\u200b\u5f00\u53d1\u200b\u73af\u5883\u200b\u3002\u200b\u5b9e\u9a8c\u200b\u5305\u200b\u4ee3\u7801\u200b\u83b7\u53d6\u200b\u9014\u5f84\u200b\uff1a</p> <pre><code># git clone https://gitee.com/ftutorials/user-land-filesystem.git\n</code></pre> <p>\u200b\u5b9e\u9a8c\u200b\u5305\u200b\u7684\u200b\u7ed3\u6784\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>user-land-filesystem/\n\u251c\u2500\u2500 driver\n\u2502   \u251c\u2500\u2500 ddriver.sh\n\u2502   \u251c\u2500\u2500 kernel_ddriver\n\u2502   \u2514\u2500\u2500 user_ddriver\n\u251c\u2500\u2500 fs\n\u2502   \u251c\u2500\u2500 samples\n\u2502   \u251c\u2500\u2500 simplefs\n\u2502   \u2514\u2500\u2500 template\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 setenv.sh\n\u2514\u2500\u2500 tests\n    \u251c\u2500\u2500 README.md\n    \u2514\u2500\u2500 test_ddriver\n</code></pre> <ul> <li><code>driver</code></li> </ul> <p>\u200b\u5b58\u653e\u200b\u9a71\u52a8\u200b\u4ee3\u7801\u200b\u3002\u200b\u5176\u4e2d\u200b<code>kernel_ddriver</code>\u200b\u4e3a\u200b\u5185\u6838\u200b\u9a71\u52a8\u200b\uff0c<code>user_ddriver</code>\u200b\u4e3a\u200b\u7528\u6237\u200b\u9a71\u52a8\u200b\uff0c<code>ddriver.sh</code>\u200b\u4e3a\u200b\u63a7\u5236\u200b\u00a0ddriver\u00a0\u200b\u9a71\u52a8\u200b\u7684\u200b\u811a\u672c\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8fd0\u884c\u200b\u5982\u4e0b\u200b\u547d\u4ee4\u200b\u5c1d\u9c9c\u200b\uff1a</p> <pre><code>[root@localhost user-land-filesystem]# ./driver/ddriver.sh </code></pre> <ul> <li><code>fs</code></li> </ul> <p>\u200b\u5b58\u653e\u200b\u00a0\u200b\u5b9e\u73b0\u200b\u7684\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u3002\u200b\u5176\u4e2d\u200b<code>samples</code>\u200b\u4e3a\u200b<code>myfs</code>\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c<code>simplefs</code>\u200b\u4e3a\u7c7b\u200b<code>EXT2</code>\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff08\u200b\u7f3a\u5c11\u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b\uff09\uff0c<code>template</code>\u200b\u7528\u4e8e\u200b\u751f\u6210\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u4ee3\u7801\u200b\u7ed3\u6784\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\u3002</p> <ul> <li><code>LICENSE</code></li> </ul> <p>\u200b\u5f00\u6e90\u200b\u8bb8\u53ef\u200b\uff0c\u200b\u672c\u200b\u5b9e\u9a8c\u200b\u9075\u5faa\u200b\u00a0GPL v3\u00a0\u200b\u5f00\u6e90\u200b\u8bb8\u53ef\u200b\u3002</p> <ul> <li><code>tests</code></li> </ul> <p>\u200b\u8be5\u200b\u6587\u4ef6\u5939\u200b\u5b58\u653e\u200bDDRIVER\u200b\u7528\u6237\u200b\u9a71\u52a8\u200b\u4ee3\u7801\u200b\u3002</p> <ul> <li><code>setenv.sh</code></li> </ul> <p>\u200b\u7528\u4e8e\u200b\u914d\u7f6e\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5f00\u53d1\u200b\u73af\u5883\u200b\u3002</p>"},{"location":"lab5/part3/#12","title":"1.2 \u200b\u914d\u7f6e\u200b\u5f00\u53d1\u200b\u73af\u5883","text":"<p>\u200b\u8fd0\u884c\u200b<code>./setenv.sh</code>\u200b\u540e\u200b\uff0c\u200b\u5373\u53ef\u200b\u6309\u7167\u200b\u6307\u5bfc\u200b\u4e00\u6b65\u200b\u4e00\u6b65\u200b\u6765\u200b\u5efa\u7acb\u200b\u73af\u5883\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem$ ./setenv.sh \u200b\u8bf7\u200b\u8f93\u5165\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u540d\u79f0\u200b ([\u200b\u5de5\u4f5c\u200b]\u200b\u76ee\u5f55\u200b\u5c06\u200b\u88ab\u200b\u81f3\u4e8e\u200b./fs\u200b\u76ee\u5f55\u200b\u4e0b\u200b): newfs\n...\n\u200b\u751f\u6210\u200b\u5de5\u4f5c\u200b\u8def\u5f84\u200b:  /home/guests/teststu_8/user-land-filesystem/fs/newfs\n\u200b\u8bf7\u200b\u8f93\u5165\u200b\u9879\u76ee\u540d\u79f0\u200b: newfs\n...\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\uff0c\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u540d\u79f0\u200b\u5373\u200b\u5f00\u53d1\u200b\u8be5\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u00a0\u200b\u6587\u4ef6\u5939\u200b\u540d\u79f0\u200b\u00a0\u3002\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\uff0c\u200b\u5b83\u200b\u5728\u200b<code>fs</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u65b0\u5efa\u200b\u4e86\u200b\u4e00\u4e2a\u200b<code>newfs</code>\u200b\u76ee\u5f55\u200b\u4f5c\u4e3a\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u3002</p> <p>\u200b\u63a5\u7740\u200b\uff0c\u200b\u9879\u76ee\u540d\u79f0\u200b\u5373\u200b\u771f\u6b63\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u540d\u79f0\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u662f\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u7b80\u5199\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1anfs\uff08\u200b\u4ee3\u8868\u200bnewfs\uff09\uff0c\u200b\u8fd9\u91cc\u200b\u8981\u200b\u6ce8\u610f\u200b\u9879\u76ee\u200b\u540d\u200b\u4e0d\u80fd\u200b\u6709\u200b\u00a0\u200b\u7279\u6b8a\u7b26\u53f7\u200b\u3001\u200b\u7a7a\u683c\u200b\u00a0\u200b\u7b49\u200b\u3002</p> <p>\u200b\u9879\u76ee\u200b\u5efa\u7acb\u200b\u5b8c\u6210\u200b\u4e4b\u540e\u200b\u7684\u200b\u7ed3\u6784\u200b<code>newfs</code>\u200b\u5982\u4e0b\u200b\u6240\u793a\u200b\uff1a</p> <pre><code>./fs/newfs/\n\u251c\u2500\u2500 .vscode\n\u251c\u2500\u2500 CMake\n\u2502   \u2514\u2500\u2500 FindFUSE.cmake\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include\n\u2502    \u251c\u2500\u2500 ddriver_ctl_user.h\n\u2502    \u251c\u2500\u2500 ddriver.h\n\u2502    \u251c\u2500\u2500 newfs.h\n\u2502    \u2514\u2500\u2500 types.h\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 SPEC.txt\n\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 newfs.c\n\u2514\u2500\u2500 tests\n    \u2514\u2500\u2500 fs_test.sh\n</code></pre> <p>\u200b\u8fd9\u4e2a\u200b\u7ed3\u6784\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u4fee\u6539\u200b\u6dfb\u52a0\u200b\uff0c\u200b\u4e0d\u8fc7\u200b\u8981\u200b\u8bb0\u5f97\u200b\u00a0\u200b\u91cd\u65b0\u914d\u7f6e\u200bCMake\u00a0\u3002\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u8981\u6c42\u200b\u5f88\u200b\u7b80\u5355\u200b\uff0c\u00a0\u200b\u8dd1\u200b\u8fc7\u200b<code>tests</code>\u200b\u4e0b\u200b\u7684\u200b<code>fs_test.sh</code>\u200b\u5c31\u7b97\u200b\u5b8c\u6210\u200b\u00a0\u3002</p>"},{"location":"lab5/part3/#13-ddriver","title":"1.3 DDRIVER\u200b\u811a\u672c\u200b\u7684\u200b\u8fd0\u7528","text":"<p>\u200b\u4e3a\u4e86\u200b\u65b9\u4fbf\u200b\u5bf9\u200b\u00a0ddriver\u00a0\u200b\u8bbe\u5907\u200b\u8fdb\u884c\u200b\u63a7\u5236\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200bddriver.sh\u200b\u811a\u672c\u200b\u94fe\u63a5\u200b\u5230\u200b\u4e86\u200b\u00a0Linux\u200b\u547d\u4ee4\u200b\u7cfb\u7edf\u200b\u00a0\u200b\u4e2d\u200b\uff0c\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u5927\u5bb6\u200b\u5148\u200b\u8fd0\u884c\u200bsource ~/.bashrc\uff0c\u200b\u7136\u540e\u200b\u540c\u5b66\u200b\u4eec\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u5728\u200b\u4efb\u4f55\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8bbf\u95ee\u200b\u5230\u200bddriver.sh\u200b\u811a\u672c\u200b\u3002\u200b\u8be5\u200b\u811a\u672c\u200b\u7684\u200b\u4e3b\u8981\u7528\u9014\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/$ source ~/.bashrc teststu_8@OSLabExecNode0:~/$ ddriver ====================================================================\n]]]]]]]]    ]]]]]]]]             \n]      ]]   ]      ]]   ]   ]]   ]]   ]]    ]]    ]-------]   ]   ]]   \n]       ]   ]       ]   ] ]]     ]]    ]]  ]]     ]_______/   ] ]]     \n]      ]]   ]      ]]   ]]       ]]     ]  ]      \\           ]]      \n]]]]]]]]    ]]]]]]]]    ]]       ]]      ]]        ]]]]]]]]   ]]  \n====================================================================\n\n\u200b\u7528\u6cd5\u200b: ddriver [options]\noptions: \n-i [k|u]      \u200b\u5b89\u88c5\u200bddriver: [k] - kernel / [u] - user\n-t            \u200b\u6d4b\u8bd5\u200bddriver[\u200b\u8bf7\u200b\u5ffd\u7565\u200b]\n-d            \u200b\u5bfc\u51fa\u200bddriver\u200b\u81f3\u200b\u5f53\u524d\u5de5\u4f5c\u200b\u76ee\u5f55\u200b[PWD]\n-r            \u200b\u64e6\u9664\u200bddriver\n-l            \u200b\u663e\u793a\u200bddriver\u200b\u7684\u200bLog\n-v            \u200b\u663e\u793a\u200bddriver\u200b\u7684\u200b\u7c7b\u578b\u200b[\u200b\u5185\u6838\u6a21\u5757\u200b / \u200b\u7528\u6237\u200b\u9759\u6001\u200b\u94fe\u63a5\u5e93\u200b]\n-h            \u200b\u6253\u5370\u200b\u672c\u200b\u5e2e\u52a9\u200b\u83dc\u5355\u200b\n====================================================================\n</code></pre> <p>\u200b\u5e38\u7528\u200b\u7684\u200b\u529f\u80fd\u200b\u662f\u200b<code>-v</code>\u3001<code>-d</code>\u200b\u4e0e\u200b<code>-r</code>\uff0c\u200b\u5b83\u4eec\u200b\u7684\u200b\u7528\u9014\u200b\u5206\u522b\u200b\u662f\u200b\u00a0\u200b\u67e5\u770b\u200bddriver\u200b\u8bbe\u5907\u200b\u7c7b\u578b\u200b\u53ca\u200b\u8bbe\u5907\u200b\u4f4d\u7f6e\u200b\u00a0\u3001\u00a0\u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u955c\u50cf\u200b\u5bfc\u51fa\u200b\u5230\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e0b\u200b\u00a0\u3001\u00a0\u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u64e6\u9664\u200b\u5e72\u51c0\u200b\u00a0\u3002\u200b\u7528\u6cd5\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>====================================================================\n# \u200b\u67e5\u770b\u200b\u8bbe\u5907\u200b\u4f4d\u7f6e\u200b\u548c\u200b\u7c7b\u578b\u200b\nteststu_8@OSLabExecNode0:~$ ddriver -v\n\u200b\u9759\u6001\u200b\u94fe\u63a5\u5e93\u200b\u8bbe\u5907\u200b: /home/guests/teststu_8/ddriver\nteststu_8@OSLabExecNode0:~$ \n\n====================================================================\n# \u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u5bfc\u51fa\u200b\u5230\u200b\u5f53\u524d\u76ee\u5f55\u200b\u4e0b\u200b\nteststu_8@OSLabExecNode0:~/$ ddriver -d\n[sudo] password for teststu_8: \n\u200b\u76ee\u6807\u200b\u8bbe\u5907\u200b /home/guests/teststu_8/ddriver\n8192+0 records in\n8192+0 records out\n4194304 bytes (4.2 MB, 4.0 MiB) copied, 0.094218 s, 44.5 MB/s\n\u200b\u6587\u4ef6\u200b\u5df2\u200b\u5bfc\u51fa\u200b\u81f3\u200b/home/guests/teststu_8/ddriver_dump\uff0c\u200b\u8bf7\u200b\u5b89\u88c5\u200bHexEditor\u200b\u63d2\u4ef6\u200b\u67e5\u770b\u200b\u5176\u200b\u5185\u5bb9\u200b\nteststu_8@OSLabExecNode0:~/$ ls\nddriver_dump \nteststu_8@OSLabExecNode0:~/$\n\n====================================================================\n# \u200b\u5c06\u200bddriver\u200b\u8bbe\u5907\u200b\u64e6\u9664\u200b\u5e72\u51c0\u200b\nteststu_8@OSLabExecNode0:~/$ ddriver -r\n\u200b\u76ee\u6807\u200b\u8bbe\u5907\u200b /home/guests/teststu_8/ddriver\n8192+0 records in\n8192+0 records out\n4194304 bytes (4.2 MB, 4.0 MiB) copied, 0.0506111 s, 82.9 MB/s\nteststu_8@OSLabExecNode0:~/$ cat ./ddriver_dump\nteststu_8@OSLabExecNode0:~/$\n</code></pre>"},{"location":"lab5/part3/#14","title":"1.4 \u200b\u9879\u76ee\u200b\u7f16\u8bd1","text":"<p>\u200b\u9879\u76ee\u200b\u7f16\u8bd1\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u5728\u200b\u65b0\u5efa\u200b\u9879\u76ee\u200b\u7684\u200bSPEC.txt\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u6709\u6240\u200b\u4ea4\u4ee3\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u63d0\u51fa\u200b\u6765\u8bb2\u200b\u4e00\u8bb2\u200b\uff1a</p> <ul> <li>Step 1\u00a0. SSH\u200b\u6253\u5f00\u200b<code>./fs/newfs</code>\u3002\u200b\u6253\u5f00\u200bVSCode\u200b\u8f6f\u4ef6\u200b\uff0c\u200b\u70b9\u51fb\u200b\u5de6\u4e0a\u89d2\u200b \"\u200b\u6587\u4ef6\u200b\" \u2192 \"\u200b\u6253\u5f00\u200b\u6587\u4ef6\u5939\u200b\"\uff0c\u200b\u9009\u62e9\u200b\u5b9e\u9a8c\u200b\u5305\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200bfs/newfs\u200b\u6587\u4ef6\u5939\u200b\u3002</li> </ul> <p></p> <ul> <li> <p>Step 2\u00a0. \u200b\u6253\u5f00\u200bCMakeLists.txt\u200b\u6587\u4ef6\u200b</p> </li> <li> <p>Step 3\u00a0. ctrl + shift + p\u200b\u547c\u200b\u51fa\u200b\u547d\u4ee4\u200b\u83dc\u5355\u200b</p> </li> <li> <p>Step 4\u00a0. \u200b\u8f93\u5165\u200bCMake: Configure</p> </li> <li> <p>Step 5\u00a0. \u200b\u67e5\u770b\u200bGenerator (\u200b\u5df2\u200b\u7528\u200b!!!!!\u200b\u6807\u8bb0\u200b)</p> </li> </ul> <p></p> <p>\u200b\u82e5\u200b\u00a0CMAKE_GENERATOR\u00a0\u200b\u4e3a\u200b\u00a0Unix Makefiles\u00a0\uff0c\u200b\u8bf7\u200b\u624b\u52a8\u200b\u4fee\u6539\u200b<code>.vscode/tasks.json</code>\u200b\u7684\u200b<code>command</code>\u200b\u4e3a\u200b<code>make</code>\uff0c\u200b\u82e5\u200b\u4e3a\u200b\u00a0Ninja\u00a0\uff0c\u200b\u8bf7\u200b\u624b\u52a8\u200b\u4fee\u6539\u200b<code>.vscode/tasks.json</code>\u200b\u7684\u200b<code>command</code>\u200b\u4e3a\u200b<code>ninja</code>\uff0c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <ul> <li> <p>Step 6\u00a0. \u200b\u5230\u200b<code>newfs/src/newfs.c</code>\u200b\u76ee\u5f55\u200b\uff0c\u200b\u6253\u65ad\u200b\u70b9\u200b</p> </li> <li> <p>Step 7\u00a0. \u200b\u6309\u4e0b\u200bF5\u200b\u8fdb\u884c\u200b\u8c03\u8bd5\u200b</p> </li> </ul> <p></p> <p>\u200b\u7f16\u8bd1\u200b\u8fd0\u884c\u200b\u539f\u7406\u200b\uff1a</p> <ul> <li>\u200b\u7f16\u8bd1\u200b\u3002\u00a0\u200b\u7f16\u8bd1\u200b\u73af\u8282\u200b\u5229\u7528\u200bCMakeLists\u200b\u5de5\u7a0b\u200b\u81ea\u52a8\u200b\u5e2e\u52a9\u200b\u6211\u4eec\u200b\u7f16\u8bd1\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u8981\u200b\u5b89\u88c5\u200bCMake Tools\u200b\u7b49\u200b\u62d3\u5c55\u200b\uff0c\u200b\u76f8\u4fe1\u200b\u5927\u5bb6\u200b\u524d\u9762\u200b\u4e5f\u200b\u88c5\u8fc7\u200b\u4e86\u200b\u3002\u200b\u5176\u4e2d\u200b\uff0c\u200b\u6309\u4e0b\u200bF5\u200b\u540e\u200b\uff0cVSCode\u200b\u4f1a\u200b\u9996\u5148\u200b\u8fd0\u884c\u200b<code>.vscode</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b<code>tasks.json</code>\u200b\u4e2d\u200b\u7684\u200b\u547d\u4ee4\u200b\uff1a</li> </ul> <p></p> <p>\u200b\u8be5\u200b\u547d\u4ee4\u200b\u6267\u884c\u200b\u7684\u200b\u64cd\u4f5c\u200b\u5c31\u662f\u200b\u5728\u200bCMakeLists\u200b\u751f\u6210\u200b\u7684\u200b<code>build</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8fd0\u884c\u200b<code>make</code>\uff0c\u200b\u7531\u6b64\u200b\u5b8c\u6210\u200b\u81ea\u52a8\u200b\u7f16\u8bd1\u200b\u3002</p> <ul> <li>\u200b\u8fd0\u884c\u200b\u3002\u00a0\u200b\u8fd0\u884c\u200b\u8fc7\u7a0b\u200b\u662f\u200b\u5728\u200b<code>.vscode</code>\u200b\u76ee\u5f55\u200b\u4e0b\u200b<code>launch.json</code>\u200b\u4e2d\u200b\u5b9a\u4e49\u200b\uff1a</li> </ul> <p></p> <p>\u200b\u628a\u200b\u8fd0\u884c\u200b\u547d\u4ee4\u200b\u5c55\u5f00\u200b\u5b9e\u9645\u4e0a\u200b\u662f\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem/fs/newfs$ ./build/newfs --device=/home/guests/teststu_8/ddriver -f -d -s ./tests/mnt/\n</code></pre> <p>\u200b\u6b63\u5982\u200b\u6211\u4eec\u200b\u524d\u9762\u200b\u00a0\u200b\u5b9e\u9a8c\u200b\u539f\u7406\u200b - FUSE\u200b\u67b6\u6784\u200b\u00a0\u200b\u4e2d\u8bf4\u200b\u5230\u200b\u7684\u200b\u90a3\u6837\u200b\uff0c\u00a0FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u7684\u200b\u6302\u8f7d\u200b\u4e0d\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b<code>mount</code>\u200b\u547d\u4ee4\u200b\uff0c\u200b\u800c\u662f\u200b\u76f4\u63a5\u200b\u7528\u200b\u7f16\u8bd1\u200b\u51fa\u6765\u200b\u7684\u200b\u4e8c\u8fdb\u5236\u200b\u6587\u4ef6\u200b\u3002\u200b\u4e0a\u8ff0\u200b\u547d\u4ee4\u200b\u7684\u200b\u610f\u4e49\u200b\u4e3a\u200b\uff1a\u00a0\u200b\u5c06\u200b\u8bbe\u5907\u200b/home/guests/teststu_8/ddriver\u00a0\u200b\u4ee5\u200b\u00a0newfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u5f62\u5f0f\u200b\uff0c\u00a0\u200b\u6302\u8f7d\u200b\u00a0\u200b\u5230\u200b\u00a0./tests/mnt\u200b\u76ee\u5f55\u200b\u00a0\u200b\u4e0b\u200b\u3002</p> <p>\u200b\u8fdb\u800c\u200b\u884d\u751f\u200b\u51fa\u200b\u00a0FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u7684\u200b\u00a0\u200b\u5378\u8f7d\u200b\u00a0\uff0c\u200b\u540c\u6837\u200b\uff0c\u200b\u4e0e\u200b\u4f20\u7edf\u200b\u5185\u6838\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5378\u8f7d\u200b\u4e0d\u540c\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u5378\u8f7d\u200b\u547d\u4ee4\u200b\u4e3a\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem/fs/newfs$ fusermount -u ./tests/mnt\nteststu_8@OSLabExecNode0:~/user-land-filesystem/fs/newfs$ \n</code></pre> <p>\u200b\u8fd9\u91cc\u200b\u4f7f\u7528\u200b<code>fusermount -u</code>\u200b\u547d\u4ee4\u200b\u8fdb\u884c\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u5378\u8f7d\u200b\u3002</p>"},{"location":"lab5/part3/#2-ddriver","title":"2. \u200b\u4efb\u52a1\u200b\u4e00\u200b\uff1a\u200b\u719f\u6089\u200bDDRIVER\u200b\u9a71\u52a8","text":"<p>\u200b\u4efb\u52a1\u200b\u4e00\u200b\u8981\u6c42\u200b\u719f\u6089\u200bDDRIVER\u200b\u9a71\u52a8\u200b\uff0c\u200b\u6211\u4eec\u200b\u8981\u6c42\u200b\u5927\u5bb6\u200b\u6839\u636e\u200b\u6ce8\u91ca\u200b\u770b\u200b\u61c2\u200b<code>user-land-filesystem/tests/test_ddriver/src/test.c</code>\u200b\u7684\u200b\u4ee3\u7801\u200b\uff0c\u200b\u5e76\u200b\u00a0\u200b\u6839\u636e\u200b\u63d0\u793a\u200b\u00a0\u200b\u4fee\u6539\u200b\u5176\u4e2d\u200b\u7684\u200b\u00a0\u200b\u4e00\u5904\u200b\u9519\u8bef\u200b\u00a0\uff1a</p> <p></p> <p>\u200b\u7f16\u8bd1\u200b\u8fd0\u884c\u200b\u6d4b\u8bd5\u7a0b\u5e8f\u200b\u7684\u200b\u6b65\u9aa4\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver$ cmake CMakeLists.txt ...\nteststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver$ make\n...\nteststu_8@OSLabExecNode0:~/user-land-filesystem/tests/test_ddriver$ ./ddriver_test </code></pre>"},{"location":"lab5/part3/#3-fuseext2","title":"3. \u200b\u4efb\u52a1\u200b\u4e8c\u200b\uff1a\u200b\u57fa\u4e8e\u200bFUSE\u200b\u5b9e\u73b0\u200b\u9752\u6625\u200b\u7248\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u200b\u719f\u6089\u200b\u4e86\u200b\u9a71\u52a8\u200b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u4e5f\u200b\u5c31\u200b\u57fa\u672c\u200b\u638c\u63e1\u200b\u4e86\u200b\u8bbf\u95ee\u200b\u00a0DDRIVER\u00a0\u200b\u8bbe\u5907\u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u6211\u4eec\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u57fa\u4e8e\u200bFUSE\u200b\u6765\u200b\u6b63\u5f0f\u200b\u7f16\u5199\u200b\u00a0\u200b\u9752\u6625\u200b\u7248\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u4e86\u200b\u3002\u200b\u6211\u4eec\u200b\u5df2\u7ecf\u200b\u5728\u200b\u00a0\u200b\u73af\u5883\u200b\u914d\u7f6e\u200b\u00a0\u200b\u9636\u6bb5\u200b\u5c31\u200b\u4e3a\u200b\u5927\u5bb6\u200b\u642d\u5efa\u200b\u597d\u200b\u4e86\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u9879\u76ee\u200b\u6846\u67b6\u200b\u3002</p> <p>\u200b\u8981\u200b\u63a5\u5165\u200b\u4e00\u4e2a\u200b\u6846\u67b6\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c11\u4e0d\u4e86\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\uff08\u200b\u4e5f\u200b\u53ef\u200b\u79f0\u4e3a\u200b\u00a0\u200b\u51fd\u6570\u6307\u9488\u200b\u00a0\uff09\u3002\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\u00a0\u200b\u662f\u200b\u4e00\u7cfb\u5217\u200b\u51fd\u6570\u200b\u7684\u200b\u62bd\u8c61\u200b\u00a0\uff0c\u200b\u4ece\u800c\u200b\u8ba9\u200bC\u200b\u8bed\u8a00\u200b\u5177\u6709\u200b\u591a\u6001\u200b\u7684\u200b\u6027\u8d28\u200b\u3002\u200b\u5bf9\u4e8e\u200bFUSE\u200b\u6846\u67b6\u200b\uff0c\u200b\u5176\u200b\u7ed9\u200b\u6211\u4eec\u200b\u7684\u200b\u63a5\u53e3\u200b\u00a0\u200b\u5982\u4e0b\u200b\u00a0\u3002 <pre><code>struct fuse_operations {\nint (*getattr) (const char *, struct stat *);\nint (*readlink) (const char *, char *, size_t);\nint (*getdir) (const char *, fuse_dirh_t, fuse_dirfil_t);\nint (*mknod) (const char *, mode_t, dev_t);\nint (*mkdir) (const char *, mode_t);\nint (*unlink) (const char *);\nint (*rmdir) (const char *);\nint (*symlink) (const char *, const char *);\nint (*rename) (const char *, const char *);\nint (*link) (const char *, const char *);\nint (*chmod) (const char *, mode_t);\nint (*chown) (const char *, uid_t, gid_t);\nint (*truncate) (const char *, off_t);\nint (*utime) (const char *, struct utimbuf *);\nint (*open) (const char *, struct fuse_file_info *);\nint (*read) (const char *, char *, size_t, off_t,\nstruct fuse_file_info *);\nint (*write) (const char *, const char *, size_t, off_t,\nstruct fuse_file_info *);\nint (*statfs) (const char *, struct statvfs *);\nint (*flush) (const char *, struct fuse_file_info *);\nint (*release) (const char *, struct fuse_file_info *);\nint (*fsync) (const char *, int, struct fuse_file_info *);\nint (*setxattr) (const char *, const char *, const char *, size_t, int);\nint (*getxattr) (const char *, const char *, char *, size_t);\nint (*listxattr) (const char *, char *, size_t);\nint (*removexattr) (const char *, const char *);\nint (*opendir) (const char *, struct fuse_file_info *);\nint (*readdir) (const char *, void *, fuse_fill_dir_t, off_t,\nstruct fuse_file_info *);\nint (*releasedir) (const char *, struct fuse_file_info *);\nint (*fsyncdir) (const char *, int, struct fuse_file_info *);\nvoid *(*init) (struct fuse_conn_info *conn);\nvoid (*destroy) (void *);\nint (*access) (const char *, int);\nint (*create) (const char *, mode_t, struct fuse_file_info *);\nint (*ftruncate) (const char *, off_t, struct fuse_file_info *);\nint (*fgetattr) (const char *, struct stat *, struct fuse_file_info *);\nint (*lock) (const char *, struct fuse_file_info *, int cmd,\nstruct flock *);\nint (*utimens) (const char *, const struct timespec tv[2]);\nint (*bmap) (const char *, size_t blocksize, uint64_t *idx);\nint (*ioctl) (const char *, int cmd, void *arg,\nstruct fuse_file_info *, unsigned int flags, void *data);\nint (*poll) (const char *, struct fuse_file_info *,\nstruct fuse_pollhandle *ph, unsigned *reventsp);\nint (*write_buf) (const char *, struct fuse_bufvec *buf, off_t off,\nstruct fuse_file_info *);\nint (*read_buf) (const char *, struct fuse_bufvec **bufp,\nsize_t size, off_t off, struct fuse_file_info *);\nint (*flock) (const char *, struct fuse_file_info *, int op);\nint (*fallocate) (const char *, int, off_t, off_t,\nstruct fuse_file_info *);\n};\n</code></pre></p> <p>\u200b\u4ee5\u200b\u4e0b\u9762\u200b\u4e00\u884c\u200b\u4ee3\u7801\u200b\u4e3a\u4f8b\u200b\uff1a</p> <pre><code>int (*mkdir) (const char *, mode_t);\n</code></pre> <p>\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\u00a0\u200b\u62bd\u8c61\u200b\u4e86\u200b\u6240\u6709\u200b <code>mkdir</code>\u200b\u7684\u200b\u64cd\u4f5c\u200b\uff1a\u200b\u6240\u6709\u200b<code>mkdir</code>\u200b\u90fd\u200b\u9700\u8981\u200b\u63a5\u53d7\u200b\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u4f5c\u4e3a\u200b\u00a0\u200b\u8def\u5f84\u200b\u00a0\u3001\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u4f5c\u4e3a\u200b\u00a0\u200b\u521b\u5efa\u200b\u6a21\u5f0f\u200b\u00a0\uff08\u200b\u53ea\u8bfb\u200b/\u200b\u53ea\u200b\u5199\u200b/\u200b\u53ef\u8bfb\u200b\u53ef\u200b\u5199\u200b\uff09\u3002\u200b\u4e0d\u540c\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u53ef\u4ee5\u200b\u57fa\u4e8e\u200b\u6b64\u200b\u5b9e\u73b0\u200b\u4e0d\u540c\u200b\u7684\u200b<code>mkdir</code>\u200b\u4ee3\u7801\u200b\uff0c\u200b\u4e3e\u4e2a\u200b\u4f8b\u5b50\u200b\uff1a</p> <pre><code>// \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e00\u200b\u5b9e\u73b0\u200bmkdir\nint mkdir(const char *path, mode_t mode) {\nprintf(\"\u200b\u6211\u200b\u4e0d\u200b\u7ed9\u200b\u4f60\u200b\u521b\u5efa\u200b %s\\n\", path);\nreturn 0;\n}\n\n// \u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e8c\u200b\u5b9e\u73b0\u200bmkdir\nint mkdir(const char *path, mode_t mode) {\ndentry = lookup(path);          // \u200b\u67e5\u627e\u200b\u8def\u5f84\u200b\uff0c\u200b\u627e\u5230\u200b\u7236\u7ea7\u200bdentry\ninode  = new_inode();           // \u200b\u521b\u5efa\u200b\u8be5\u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b\u7684\u200binode\nnew_dentry = new_dentry();      // \u200b\u521b\u5efa\u200b\u5c5e\u4e8e\u200b\u8be5\u200binode\u200b\u7684\u200bdentry\nbond(new_dentry, inode);        // \u200b\u8ba9\u200b\u8be5\u200bdentry\u200b\u6307\u5411\u200binode\nadd(dentry, new_dentry);        // \u200b\u5c06\u200b\u65b0\u521b\u5efa\u200b\u7684\u200bdentry\u200b\u52a0\u5165\u200b\u5230\u200b\u7236\u7ea7\u200bdentry\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u6587\u4ef6\u200b\u4e2d\u200b\nreturn 0;\n}\n</code></pre> <p>FUSE\u200b\u6846\u67b6\u200b\u00a0\u200b\u901a\u8fc7\u200b\u5411\u200b<code>fuse_main</code>\u200b\u51fd\u6570\u200b\u4f20\u5165\u200b\u4e00\u4e2a\u200b\u88ab\u200b\u590d\u5236\u200b\u7684\u200b<code>fuse_operations</code>\u200b\u7ed3\u6784\u200b\u4f53\u200b\u5373\u53ef\u200b\u5b8c\u6210\u200b\u64cd\u4f5c\u200b\u7684\u200b\u6ce8\u518c\u200b\uff0c\u200b\u4ece\u800c\u200b\u4f7f\u5f97\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u80fd\u591f\u200b\u6309\u7167\u200b\u6211\u4eec\u200b\u65e2\u5b9a\u200b\u7684\u200b\u65b9\u5f0f\u200b\u6765\u200b\u5904\u7406\u200b\u547d\u4ee4\u200b\u3002\u200b\u4e0b\u56fe\u200b\u4e3a\u200b\u00a0\u200b\u5c06\u200b\u64cd\u4f5c\u200b\u63a5\u5165\u200bFUSE\u200b\u7684\u200b\u5165\u53e3\u200b\u00a0\uff1a</p> <p></p> <p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u7531\u4e8e\u200b\u5b9e\u73b0\u200b\u7684\u200b\u529f\u80fd\u200b\u8f83\u4e3a\u7b80\u5355\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ea\u200b\u8981\u6c42\u200b\u540c\u5b66\u200b\u4eec\u200b\u5b9e\u73b0\u200b\u4ee5\u4e0b\u200b\u94a9\u5b50\u200b\uff08\u200b\u5176\u4e2d\u200b\u6807\u8bb0\u200b\u4e3a\u200b\u00a0NULL\u00a0\u200b\u7684\u200b\u5728\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u4e2d\u200b\u4e0d\u200b\u8981\u6c42\u200b\u5b9e\u73b0\u200b\uff09\uff1a</p> <pre><code>// Line 21 \nstatic struct fuse_operations operations = {\n.init = newfs_init,                      /* mount\u200b\u6587\u4ef6\u7cfb\u7edf\u200b */        .destroy = newfs_destroy,                /* umount\u200b\u6587\u4ef6\u7cfb\u7edf\u200b */\n.mkdir = newfs_mkdir,                    /* \u200b\u5efa\u200b\u76ee\u5f55\u200b\uff0cmkdir */\n.getattr = newfs_getattr,                /* \u200b\u83b7\u53d6\u200b\u6587\u4ef6\u5c5e\u6027\u200b\uff0c\u200b\u7c7b\u4f3c\u200bstat\uff0c\u200b\u5fc5\u987b\u200b\u5b8c\u6210\u200b */\n.readdir = newfs_readdir,                /* \u200b\u586b\u5145\u200bdentrys */\n.mknod = newfs_mknod,                    /* \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\uff0ctouch\u200b\u76f8\u5173\u200b */\n.write = NULL,                           /* \u200b\u5199\u5165\u200b\u6587\u4ef6\u200b */\n.read = NULL,                            /* \u200b\u8bfb\u200b\u6587\u4ef6\u200b */\n.utimens = newfs_utimens,                /* \u200b\u4fee\u6539\u200b\u65f6\u95f4\u200b\uff0c\u200b\u5ffd\u7565\u200b\uff0c\u200b\u907f\u514d\u200btouch\u200b\u62a5\u9519\u200b */\n.truncate = NULL,                        /* \u200b\u6539\u53d8\u200b\u6587\u4ef6\u5927\u5c0f\u200b */\n.unlink = NULL,                          /* \u200b\u5220\u9664\u200b\u6587\u4ef6\u200b */\n.rmdir  = NULL,                          /* \u200b\u5220\u9664\u200b\u76ee\u5f55\u200b\uff0c rm -r */\n.rename = NULL,                          /* \u200b\u91cd\u547d\u540d\u200b\uff0cmv */\n\n.open = NULL,                           .opendir = NULL,\n.access = NULL\n};\n</code></pre> <p>\u200b\u5148\u200b\u6765\u770b\u200b\u4e00\u4e0b\u200bsfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7ed9\u51fa\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u5b9a\u4e49\u200b\uff1a</p> <pre><code>struct custom_options {\nconst char*        device;//\u200b\u9a71\u52a8\u200b\u7684\u200b\u8def\u5f84\u200b\nboolean            show_help;\n};\n\nstruct sfs_inode /*\u200b\u5185\u5b58\u200b\u4e2d\u200binode\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b*/\n{\nint                ino;                           /* \u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u6807\u200b */\nint                size;                          /* \u200b\u6587\u4ef6\u200b\u5df2\u200b\u5360\u7528\u200b\u7a7a\u95f4\u200b */\nint                dir_cnt;\nstruct sfs_dentry* dentry;                        /* \u200b\u6307\u5411\u200b\u8be5\u200binode\u200b\u7684\u200bdentry */\nstruct sfs_dentry* dentrys;                       /* \u200b\u6240\u6709\u200b\u76ee\u5f55\u200b\u9879\u200b */\nuint8_t*           data;           };  struct sfs_dentry/*\u200b\u5185\u5b58\u200b\u4e2d\u200b\u76ee\u5f55\u200b\u9879\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b*/\n{\nchar               fname[SFS_MAX_FILE_NAME];\nstruct sfs_dentry* parent;                        /* \u200b\u7236\u4eb2\u200bInode\u200b\u7684\u200bdentry */\nstruct sfs_dentry* brother;                       /* \u200b\u5144\u5f1f\u200b */\nint                ino;\nstruct sfs_inode*  inode;                         /* \u200b\u6307\u5411\u200binode */\nSFS_FILE_TYPE      ftype;\n};\n\nstruct sfs_super/*\u200b\u5185\u5b58\u200b\u4e2d\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b*/\n{\nint                driver_fd;\n\nint                sz_io;/*inode\u200b\u7684\u200b\u5927\u5c0f\u200b*/\nint                sz_disk;/*\u200b\u78c1\u76d8\u200b\u5927\u5c0f\u200b*/\nint                sz_usage;\n\nint                max_ino;/*inode\u200b\u7684\u200b\u6570\u76ee\u200b*/\nuint8_t*           map_inode;/*inode\u200b\u4f4d\u200b\u56fe\u200b*/\nint                map_inode_blks;/*inode\u200b\u4f4d\u56fe\u200b\u6240\u200b\u5360\u200b\u7684\u200b\u6570\u636e\u200b\u5757\u200b*/\nint                map_inode_offset;/*inode\u200b\u4f4d\u56fe\u200b\u7684\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b*/\n\nint                data_offset;/*\u200b\u6570\u636e\u200b\u5757\u200b\u7684\u200b\u8d77\u59cb\u200b\u5730\u5740\u200b*/\n\nboolean            is_mounted;\n\nstruct sfs_dentry* root_dentry;/*\u200b\u6839\u76ee\u5f55\u200b*/\n};\n\n/******************************************************************************\n* \u200b\u78c1\u76d8\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\n*******************************************************************************/\nstruct sfs_super_d\n{\nuint32_t           magic_num;\nint                sz_usage;\n\nint                max_ino;\nint                map_inode_blks;\nint                map_inode_offset;\nint                data_offset;\n};\n\nstruct sfs_inode_d\n{\nint                ino;                           /* \u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e2d\u200b\u7684\u200b\u4e0b\u6807\u200b */\nint                size;                          /* \u200b\u6587\u4ef6\u200b\u5df2\u200b\u5360\u7528\u200b\u7a7a\u95f4\u200b */\nint                dir_cnt;\nSFS_FILE_TYPE      ftype;   };  struct sfs_dentry_d\n{\nchar               fname[SFS_MAX_FILE_NAME];\nSFS_FILE_TYPE      ftype;\nint                ino;                           /* \u200b\u6307\u5411\u200b\u7684\u200bino\u200b\u53f7\u200b */\n};  </code></pre> <p>\u200b\u63a5\u4e0b\u6765\u200b\uff0c\u200b\u6211\u4eec\u200b\u518d\u200b\u5206\u522b\u200b\u4ecb\u7ecd\u200b\u5404\u4e2a\u200b\u64cd\u4f5c\u200b\u5b9e\u73b0\u200b\u8981\u200b\u7ecf\u8fc7\u200b\u7684\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u8ba9\u200b\u540c\u5b66\u200b\u4eec\u200b\u6709\u200b\u4e2a\u200b\u66f4\u200b\u76f4\u89c2\u200b\u7684\u200b\u7406\u89e3\u200b\u3002</p>"},{"location":"lab5/part3/#31","title":"3.1 \u200b\u6302\u8f7d","text":"<p>\u200b\u5f53\u200b\u6302\u8f7d\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.init</code>\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>.init</code>\u200b\u94a9\u5b50\u200b\u4e2d\u200b\u5b8c\u6210\u200b\u00a0\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u8bfb\u53d6\u200b\u00a0\u3001\u00a0\u200b\u4f4d\u56fe\u200b\u7684\u200b\u5efa\u7acb\u200b\u00a0\u3001\u00a0\u200b\u9a71\u52a8\u200b\u7684\u200b\u521d\u59cb\u5316\u200b\u00a0\u200b\u7b49\u200b\u64cd\u4f5c\u200b\uff1a</p> <p><pre><code>/**\n* @brief \u200b\u6302\u8f7d\u200b\uff08mount\uff09\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\n* \n* @param conn_info \u200b\u53ef\u200b\u5ffd\u7565\u200b\uff0c\u200b\u4e00\u4e9b\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u76f8\u5173\u200b\u7684\u200b\u4fe1\u606f\u200b \n* @return void*\n*/\nvoid* newfs_init(struct fuse_conn_info * conn_info) {\n/* TODO: \u200b\u5728\u200b\u8fd9\u91cc\u200b\u8fdb\u884c\u200b\u6302\u8f7d\u200b */\n\n/* \u200b\u4e0b\u9762\u200b\u662f\u200b\u4e00\u4e2a\u200b\u63a7\u5236\u200b\u8bbe\u5907\u200b\u7684\u200b\u793a\u4f8b\u200b */\nsuper.fd = ddriver_open(newfs_options.device);\n\nreturn NULL;\n}\n</code></pre> \u200b\u4e0a\u9762\u200b\u7684\u200b\u793a\u4f8b\u200b\u662f\u200b\u521d\u59cb\u5316\u200b\u9a71\u52a8\u200b\u8bbe\u5907\u200b\uff0c\u200b\u5176\u4e2d\u200b<code>newfs_options</code>\u200b\u4e3a\u200b\u81ea\u5b9a\u4e49\u200b\u53c2\u6570\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u6211\u4eec\u200b\u4e0d\u200b\u5bf9\u200b\u00a0\u200b\u81ea\u5b9a\u4e49\u200b\u53c2\u6570\u200b\u00a0\u200b\u505a\u200b\u66f4\u200b\u591a\u200b\u7684\u200b\u4ecb\u7ecd\u200b\uff0c\u200b\u5927\u5bb6\u200b\u4f1a\u200b\u7528\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u64cd\u4f5c\u200b\u6765\u200b\u5b9e\u73b0\u200b\u6302\u8f7d\u200b\u529f\u80fd\u200b\uff1a</p> <ul> <li>Step 1\u00a0. \u200b\u9996\u5148\u200b\u5b9a\u4e49\u200b\u5185\u5b58\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\u3002</li> </ul> <pre><code>    /*\u200b\u5b9a\u4e49\u200b\u78c1\u76d8\u200b\u5404\u200b\u90e8\u5206\u200b\u7ed3\u6784\u200b*/\nint                 ret = SFS_ERROR_NONE;\nint                 driver_fd;\nstruct sfs_super_d  sfs_super_d; struct sfs_dentry*  root_dentry;\nstruct sfs_inode*   root_inode;\n\nint                 inode_num;\nint                 map_inode_blks;\n\nint                 super_blks;\nboolean             is_init = FALSE;\n\nsfs_super.is_mounted = FALSE;\n</code></pre> <ul> <li>Step 2\u00a0. \u200b\u6253\u5f00\u200b\u9a71\u52a8\u200b\u3002</li> </ul> <pre><code>    driver_fd = ddriver_open(options.device);/*\u200b\u6253\u5f00\u200b\u9a71\u52a8\u200b*/\n\nif (driver_fd &lt; 0) {\nreturn driver_fd;\n}\n</code></pre> <ul> <li>Step 3\u00a0. \u200b\u5411\u200b\u5185\u5b58\u200b\u8d85\u7ea7\u200b\u5757\u200b\u4e2d\u200b\u6807\u8bb0\u200b\u9a71\u52a8\u200b\u5e76\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u5927\u5c0f\u200b\u548c\u200b\u5355\u6b21\u200bIO\u200b\u5927\u5c0f\u200b\u3002</li> </ul> <pre><code>    sfs_super.driver_fd = driver_fd;\nddriver_ioctl(SFS_DRIVER(), IOC_REQ_DEVICE_SIZE,  &amp;sfs_super.sz_disk);\nddriver_ioctl(SFS_DRIVER(), IOC_REQ_DEVICE_IO_SZ, &amp;sfs_super.sz_io);\n</code></pre> <ul> <li>Step 4\u00a0. \u200b\u521b\u5efa\u200b\u6839\u76ee\u5f55\u200b\u9879\u200b\u5e76\u200b\u8bfb\u53d6\u200b\u78c1\u76d8\u200b\u8d85\u7ea7\u200b\u5757\u200b\u5230\u200b\u5185\u5b58\u200b\u3002</li> </ul> <pre><code>    if (driver_fd &lt; 0) {\nreturn driver_fd;\n}\n</code></pre> <ul> <li>Step 5\u00a0. \u200b\u6839\u636e\u200b\u8d85\u7ea7\u200b\u5757\u200b\u5e7b\u6570\u200b\u5224\u65ad\u200b\u662f\u5426\u200b\u4e3a\u200b\u7b2c\u4e00\u6b21\u200b\u542f\u52a8\u200b\u78c1\u76d8\u200b\uff0c\u200b\u5982\u679c\u200b\u662f\u200b\u7b2c\u4e00\u6b21\u200b\u542f\u52a8\u200b\u78c1\u76d8\u200b\uff0c\u200b\u5219\u200b\u9700\u8981\u200b\u5efa\u7acb\u200b\u78c1\u76d8\u200b\u8d85\u7ea7\u200b\u5757\u200b\u7684\u200b\u5e03\u5c40\u200b\u3002</li> </ul> <pre><code>    if (sfs_super_d.magic_num != SFS_MAGIC_NUM) {     /* \u200b\u5e7b\u6570\u200b\u65e0\u200b */\n/* \u200b\u4f30\u7b97\u200b\u5404\u200b\u90e8\u5206\u200b\u5927\u5c0f\u200b */\nsuper_blks = SFS_ROUND_UP(sizeof(struct sfs_super_d), SFS_IO_SZ()) / SFS_IO_SZ();\n\ninode_num  =  SFS_DISK_SZ() / ((SFS_DATA_PER_FILE + SFS_INODE_PER_FILE) * SFS_IO_SZ());\n\nmap_inode_blks = SFS_ROUND_UP(SFS_ROUND_UP(inode_num, UINT32_BITS), SFS_IO_SZ()) / SFS_IO_SZ();\n\n/* \u200b\u5e03\u5c40\u200blayout */\nsfs_super.max_ino = (inode_num - super_blks - map_inode_blks); sfs_super_d.map_inode_offset = SFS_SUPER_OFS + SFS_BLKS_SZ(super_blks);\nsfs_super_d.data_offset = sfs_super_d.map_inode_offset + SFS_BLKS_SZ(map_inode_blks);\nsfs_super_d.map_inode_blks  = map_inode_blks;\nsfs_super_d.sz_usage    = 0;\nSFS_DBG(\"inode map blocks: %d\\n\", map_inode_blks);\nis_init = TRUE;\n}\n</code></pre> <ul> <li>Step 6\u00a0. \u200b\u521d\u59cb\u5316\u200b\u5185\u5b58\u200b\u4e2d\u200b\u7684\u200b\u8d85\u7ea7\u200b\u5757\u200b\uff0c\u200b\u548c\u200b\u6839\u76ee\u5f55\u200b\u9879\u200b\u3002</li> </ul> <pre><code>    sfs_super.sz_usage   = sfs_super_d.sz_usage;      /* \u200b\u5efa\u7acb\u200b in-memory \u200b\u7ed3\u6784\u200b */\n\nsfs_super.map_inode = (uint8_t *)malloc(SFS_BLKS_SZ(sfs_super_d.map_inode_blks));\nsfs_super.map_inode_blks = sfs_super_d.map_inode_blks;\nsfs_super.map_inode_offset = sfs_super_d.map_inode_offset;\nsfs_super.data_offset = sfs_super_d.data_offset;\n\nif (sfs_driver_read(sfs_super_d.map_inode_offset, (uint8_t *)(sfs_super.map_inode), SFS_BLKS_SZ(sfs_super_d.map_inode_blks)) != SFS_ERROR_NONE) {\nreturn -SFS_ERROR_IO;\n}\n\nif (is_init) {                                    /* \u200b\u5206\u914d\u200b\u6839\u200b\u8282\u70b9\u200b */\nroot_inode = sfs_alloc_inode(root_dentry);\nsfs_sync_inode(root_inode);\n}\n\nroot_inode            = sfs_read_inode(root_dentry, SFS_ROOT_INO);\nroot_dentry-&gt;inode    = root_inode;\nsfs_super.root_dentry = root_dentry;\nsfs_super.is_mounted  = TRUE;\n\nsfs_dump_map();\n</code></pre> <p>\u200b\u5176\u4e2d\u200b<code>newz_dentry</code>\u200b\u51fd\u6570\u200b\u7684\u200b\u4f5c\u7528\u200b\u662f\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u539f\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>static inline struct sfs_dentry* new_dentry(char * fname, SFS_FILE_TYPE ftype) {\nstruct sfs_dentry * dentry = (struct sfs_dentry *)malloc(sizeof(struct sfs_dentry));\nmemset(dentry, 0, sizeof(struct sfs_dentry));\nSFS_ASSIGN_FNAME(dentry, fname);\ndentry-&gt;ftype   = ftype;\ndentry-&gt;ino     = -1;\ndentry-&gt;inode   = NULL;\ndentry-&gt;parent  = NULL;\ndentry-&gt;brother = NULL;                                            }\n</code></pre> <p>\u200b\u5176\u4e2d\u200b<code>sfs_alloc_inode</code>\u200b\u4f5c\u7528\u200b\u662f\u200b\u4e3a\u200b\u76ee\u5f55\u200b\u9879\u200b\u521b\u5efa\u200binode\u200b\u8282\u70b9\u200b\uff0c\u200b\u5177\u4f53\u6b65\u9aa4\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b\u4ee5\u4e0b\u200b\u51e0\u6b65\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e0a\u200b\u5bfb\u627e\u200b\u672a\u200b\u4f7f\u7528\u200b\u7684\u200binode\u200b\u8282\u70b9\u200b\u3002</p> <pre><code>    for (byte_cursor = 0; byte_cursor &lt; SFS_BLKS_SZ(sfs_super.map_inode_blks); byte_cursor++)/*\u200b\u5728\u200binode\u200b\u4f4d\u56fe\u200b\u4e0a\u200b\u5bfb\u627e\u200b\u672a\u200b\u4f7f\u7528\u200b\u7684\u200binode*/\n{\nfor (bit_cursor = 0; bit_cursor &lt; UINT8_BITS; bit_cursor++) {\nif((sfs_super.map_inode[byte_cursor] &amp; (0x1 &lt;&lt; bit_cursor)) == 0) {    /* \u200b\u5f53\u524d\u200bino_cursor\u200b\u4f4d\u7f6e\u200b\u7a7a\u95f2\u200b */\nsfs_super.map_inode[byte_cursor] |= (0x1 &lt;&lt; bit_cursor);\nis_find_free_entry = TRUE;           break;\n}\nino_cursor++;\n}\nif (is_find_free_entry) {\nbreak;\n}\n}\n</code></pre> <p>\u200b   \u2461\u200b\u4e3a\u200b\u76ee\u5f55\u200b\u9879\u200b\u5206\u914d\u200binode\u200b\u8282\u70b9\u200b\u5e76\u200b\u5efa\u7acb\u200b\u4ed6\u4eec\u200b\u4e4b\u95f4\u200b\u7684\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>    if (!is_find_free_entry || ino_cursor == sfs_super.max_ino)\nreturn -SFS_ERROR_NOSPACE;\n\ninode = (struct sfs_inode*)malloc(sizeof(struct sfs_inode));\ninode-&gt;ino  = ino_cursor; inode-&gt;size = 0;\n/* dentry\u200b\u6307\u5411\u200binode */\ndentry-&gt;inode = inode;\ndentry-&gt;ino   = inode-&gt;ino;\n/* inode\u200b\u6307\u200b\u56de\u200bdentry */\ninode-&gt;dentry = dentry;\n\ninode-&gt;dir_cnt = 0;\ninode-&gt;dentrys = NULL;\n\nif (SFS_IS_REG(inode)) {\ninode-&gt;data = (uint8_t *)malloc(SFS_BLKS_SZ(SFS_DATA_PER_FILE));\n}\n</code></pre> <p>\u200b\u800c\u200bsfs_read_inode\u200b\u51fd\u6570\u200b\u4f5c\u7528\u200b\u662f\u4ece\u200b\u78c1\u76d8\u200b\u4e2d\u200b\u8bfb\u53d6\u200binode\u200b\u8282\u70b9\u200b\uff0c\u200b\u5177\u4f53\u6b65\u9aa4\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u901a\u8fc7\u200b\u78c1\u76d8\u200b\u9a71\u52a8\u200b\u6765\u200b\u5c06\u200b\u78c1\u76d8\u200b\u4e2d\u200bino\u200b\u53f7\u200b\u7684\u200binode\u200b\u8bfb\u5165\u200b\u5185\u5b58\u200b\u3002</p> <pre><code>    if (sfs_driver_read(SFS_INO_OFS(ino), (uint8_t *)&amp;inode_d, sizeof(struct sfs_inode_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn NULL;                    }\ninode-&gt;dir_cnt = 0;\ninode-&gt;ino = inode_d.ino;\ninode-&gt;size = inode_d.size;\ninode-&gt;dentry = dentry;\n</code></pre> <p>\u200b   \u2461 \u200b\u5224\u65ad\u200binode\u200b\u7684\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff0c\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u5219\u200b\u9700\u8981\u200b\u8bfb\u53d6\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u5e76\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>  /*\u200b\u5224\u65ad\u200biNode\u200b\u8282\u70b9\u200b\u7684\u200b\u6587\u4ef6\u7c7b\u578b\u200b*/\nif (SFS_IS_DIR(inode)) {/*\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7684\u8bdd\u200b\u9700\u8981\u200b\u5c06\u200b\u76ee\u5f55\u200b\u9879\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b*/\ndir_cnt = inode_d.dir_cnt;\nfor (i = 0; i &lt; dir_cnt; i++)\n{\nif (sfs_driver_read(SFS_DATA_OFS(ino) + i * sizeof(struct sfs_dentry_d), (uint8_t *)&amp;dentry_d, sizeof(struct sfs_dentry_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn NULL;                    }\nsub_dentry = new_dentry(dentry_d.fname, dentry_d.ftype);\nsub_dentry-&gt;parent = inode-&gt;dentry;\nsub_dentry-&gt;ino    = dentry_d.ino; sfs_alloc_dentry(inode, sub_dentry);\n}\n}\n</code></pre> <p>\u200b   \u2462\u200b\u5982\u679c\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u76f4\u63a5\u200b\u8bfb\u53d6\u6570\u636e\u200b\u5373\u53ef\u200b\u3002</p> <pre><code>    else if (SFS_IS_REG(inode)) {/*\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u76f4\u63a5\u200b\u8bfb\u53d6\u6570\u636e\u200b\u5373\u53ef\u200b*/\ninode-&gt;data = (uint8_t *)malloc(SFS_BLKS_SZ(SFS_DATA_PER_FILE));\nif (sfs_driver_read(SFS_DATA_OFS(ino), (uint8_t *)inode-&gt;data, SFS_BLKS_SZ(SFS_DATA_PER_FILE)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn NULL;                    }\n}\n</code></pre>"},{"location":"lab5/part3/#32","title":"3.2 \u200b\u83b7\u53d6\u200b\u6587\u4ef6\u5c5e\u6027","text":"<p>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u4e86\u200b\u83b7\u5f97\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u200b\u7684\u200b\u72b6\u6001\u200b\u00a0\uff0c\u200b\u8981\u200b\u4e0d\u65ad\u200b\u8c03\u7528\u200b<code>getattr</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\u7c7b\u4f3c\u200b\u4e8e\u200b\u00a0xv6\u00a0\u200b\u91cc\u200b\u7684\u200b\u00a0fstat\u00a0\u3002\u200b\u5b9e\u73b0\u200b<code>ls</code>\u3001<code>mkdir</code>\u3001<code>touch</code>\u200b\u7b49\u200b\u64cd\u4f5c\u200b\u7684\u200b\u524d\u63d0\u200b\u5c31\u662f\u200b\u5b8c\u6210\u200b<code>getattr</code>\u200b\u94a9\u5b50\u200b\u7684\u200b\u7f16\u5199\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u7ed9\u200b\u4e2a\u200b\u4f8b\u5b50\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u9996\u5148\u200b\u627e\u5230\u200b\u8def\u5f84\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <pre><code>    struct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\nif (is_find == FALSE) {\nreturn -SFS_ERROR_NOTFOUND;\n}\n</code></pre> <p>\u200b   \u2461\u200b\u5224\u65ad\u200b\u76ee\u5f55\u200b\u9879\u200b\u7684\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u5e76\u200b\u5bf9\u200b\u72b6\u6001\u200b\u8fdb\u884c\u200b\u7f16\u5199\u200b\u3002</p> <pre><code>    if (SFS_IS_DIR(dentry-&gt;inode)) {//\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\nsfs_stat-&gt;st_mode = S_IFDIR | SFS_DEFAULT_PERM;\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;dir_cnt * sizeof(struct sfs_dentry_d);\n}\nelse if (SFS_IS_REG(dentry-&gt;inode)) {//\u200b\u5982\u679c\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\nsfs_stat-&gt;st_mode = S_IFREG | SFS_DEFAULT_PERM;\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;size;\n}\n\nsfs_stat-&gt;st_nlink = 1;\nsfs_stat-&gt;st_uid     = getuid();\nsfs_stat-&gt;st_gid     = getgid();\nsfs_stat-&gt;st_atime   = time(NULL);\nsfs_stat-&gt;st_mtime   = time(NULL);\nsfs_stat-&gt;st_blksize = SFS_IO_SZ();\n\nif (is_root) {\nsfs_stat-&gt;st_size   = sfs_super.sz_usage; sfs_stat-&gt;st_blocks = SFS_DISK_SZ() / SFS_IO_SZ();\nsfs_stat-&gt;st_nlink  = 2;        /* !\u200b\u7279\u6b8a\u200b\uff0c\u200b\u6839\u76ee\u5f55\u200blink\u200b\u6570\u4e3a\u200b2 */\n}\nreturn SFS_ERROR_NONE;\n}\n</code></pre> <p><code>getattr</code>\u200b\u7684\u200b\u5b9e\u73b0\u200b\u9996\u5148\u200b\u662f\u200b\u00a0\u200b\u89e3\u6790\u200b\u8def\u5f84\u200b\u00a0\uff0c\u200b\u4ece\u800c\u200b\u83b7\u53d6\u200b\u76f8\u5e94\u200b\u6587\u4ef6\u200b\u7684\u200b\u00a0inode\u200b\u6216\u200bdentry\u00a0\uff0c\u200b\u63a5\u7740\u200b\u586b\u5199\u200b<code>struct stat*</code>\u200b\u7ed3\u6784\u200b\u4f53\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u5176\u4e2d\u200b<code>sfs_lookup</code>\u200b\u51fd\u6570\u200b\u5f88\u200b\u91cd\u8981\u200b\uff0c\u200b\u8bb8\u591a\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b\u7684\u200b\u94a9\u5b50\u200b\u90fd\u200b\u9700\u8981\u200b\u7528\u5230\u200b\u5b83\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u4f5c\u7528\u200b\u662f\u200b\u627e\u5230\u200b\u8def\u5f84\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u6216\u8005\u200b\u8fd4\u56de\u200b\u4e0a\u200b\u4e00\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u539f\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u9996\u5148\u200b\u8ba1\u7b97\u200b\u8def\u5f84\u200b\u7684\u200b\u7ea7\u6570\u200b\uff0c\u200b\u5982\u679c\u200b\u4e3a\u200b0\u200b\u8bf4\u660e\u200b\u662f\u200b\u6839\u76ee\u5f55\u200b\u3002</p> <pre><code>    int   total_lvl = sfs_calc_lvl(path);/*\u200b\u8ba1\u7b97\u200b\u8def\u5f84\u200b\u7ea7\u6570\u200b*/\n...\n\nif (total_lvl == 0) {                           /* \u200b\u6839\u76ee\u5f55\u200b */\n*is_find = TRUE;\n*is_root = TRUE;\ndentry_ret = sfs_super.root_dentry;\n}\n</code></pre> <p>\u200b   \u2461\u200b\u4e0d\u200b\u4e3a\u200b0\u200b\u5219\u200b\u9700\u8981\u200b\u4ece\u200b\u6839\u76ee\u5f55\u200b\u5f00\u59cb\u200b\uff0c\u200b\u4f9d\u6b21\u200b\u5339\u914d\u200b\u8def\u5f84\u200b\u4e2d\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff0c\u200b\u76f4\u5230\u200b\u627e\u5230\u200b\u6587\u4ef6\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <p>\u200b   \u2462\u200b\u5982\u679c\u200b\u6ca1\u200b\u627e\u5230\u200b\u5219\u200b\u8fd4\u56de\u200b\u6700\u540e\u200b\u4e00\u6b21\u200b\u5339\u914d\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <pre><code> fname = strtok(path_cpy, \"/\"); /*\u200b\u5206\u6790\u200b\u8def\u5f84\u200b\u51fd\u6570\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u770b\u200b\u4e00\u4e0b\u200b\u5b83\u200b\u7684\u200b\u7528\u6cd5\u200b*/      while (fname)\n{   lvl++;\nif (dentry_cursor-&gt;inode == NULL) {           /* Cache\u200b\u673a\u5236\u200b */\nsfs_read_inode(dentry_cursor, dentry_cursor-&gt;ino);\n}\n\ninode = dentry_cursor-&gt;inode;\n\nif (SFS_IS_REG(inode) &amp;&amp; lvl &lt; total_lvl) {\nSFS_DBG(\"[%s] not a dir\\n\", __func__);\ndentry_ret = inode-&gt;dentry;\nbreak;\n}\nif (SFS_IS_DIR(inode)) {/*\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u7684\u200b\u6587\u4ef6\u200b\u9700\u8981\u200b\u5c06\u200b\u76ee\u5f55\u200b\u9879\u200b\u548c\u200b\u8def\u5f84\u540d\u200b\u8fdb\u884c\u200b\u6bd4\u8f83\u200b*/\ndentry_cursor = inode-&gt;dentrys;\nis_hit        = FALSE;\n\nwhile (dentry_cursor)\n{\nif (memcmp(dentry_cursor-&gt;fname, fname, strlen(fname)) == 0) {\nis_hit = TRUE;\nbreak;\n}\ndentry_cursor = dentry_cursor-&gt;brother;\n}\n\nif (!is_hit) {\n*is_find = FALSE;\nSFS_DBG(\"[%s] not found %s\\n\", __func__, fname);\ndentry_ret = inode-&gt;dentry;\nbreak;\n}\n\nif (is_hit &amp;&amp; lvl == total_lvl) {\n*is_find = TRUE;\ndentry_ret = dentry_cursor;\nbreak;\n}\n}\nfname = strtok(NULL, \"/\"); }\n\nif (dentry_ret-&gt;inode == NULL) {\ndentry_ret-&gt;inode = sfs_read_inode(dentry_ret, dentry_ret-&gt;ino);\n}\n\nreturn dentry_ret;\n</code></pre>"},{"location":"lab5/part3/#33","title":"3.3 \u200b\u5efa\u7acb\u200b\u76ee\u5f55","text":"<p>\u200b\u5f53\u4e3a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.mkdir</code>\uff1a</p> <p>\u200b   \u2460\u200b\u5bfb\u627e\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <p>\u200b   \u2461\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u5e76\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6a21\u5f0f\u200b\uff08\u200b\u53ea\u8bfb\u200b\uff1f\u200b\u53ea\u200b\u5199\u200b\uff1f\uff09\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint sfs_mkdir(const char* path, mode_t mode) {\n(void)mode;\nboolean is_find, is_root;\nchar* fname;\nstruct sfs_dentry* last_dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);//\u200b\u5bfb\u627e\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b\nstruct sfs_dentry* dentry;\nstruct sfs_inode*  inode;\n\nif (is_find) {//\u200b\u76ee\u5f55\u200b\u5b58\u5728\u200b\nreturn -SFS_ERROR_EXISTS;\n}\n\nif (SFS_IS_REG(last_dentry-&gt;inode)) {\nreturn -SFS_ERROR_UNSUPPORTED;\n}\n\nfname  = sfs_get_fname(path);\ndentry = new_dentry(fname, SFS_DIR); dentry-&gt;parent = last_dentry;\ninode  = sfs_alloc_inode(dentry);\nsfs_alloc_dentry(last_dentry-&gt;inode, dentry);\n\nreturn SFS_ERROR_NONE;\n}\n</code></pre>"},{"location":"lab5/part3/#34","title":"3.4 \u200b\u5efa\u7acb\u200b\u6587\u4ef6","text":"<p>\u200b\u5f53\u4e3a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.mknod</code>\uff0c\u200b\u5728\u200b\u6211\u4eec\u200b\u7ed9\u200b\u7684\u200b\u6846\u67b6\u200b\u4e2d\u200b\uff0c\u200b\u7ed9\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200b\u601d\u8def\u200b\uff1a</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u7684\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @param dev \u200b\u8bbe\u5907\u200b\u7c7b\u578b\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint newfs_mknod(const char* path, mode_t mode, dev_t dev) {\n/* TODO: \u200b\u89e3\u6790\u200b\u8def\u5f84\u200b\uff0c\u200b\u5e76\u200b\u521b\u5efa\u200b\u76f8\u5e94\u200b\u7684\u200b\u6587\u4ef6\u200b */\nreturn 0;\n}\n</code></pre> <p>\u200b\u800c\u200b\u5728\u200bsfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e2d\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u7684\u200b\u5177\u4f53\u200b\u5b9e\u73b0\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u627e\u5230\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u8def\u5f84\u200b\u4e2d\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p> <p>\u200b   \u2461\u200b\u5982\u679c\u200b\u6587\u4ef6\u200b\u5b58\u5728\u200b\u5219\u200b\u8fd4\u56de\u200b\u9519\u8bef\u200b\u3002</p> <p>\u200b   \u2462\u200b\u6587\u4ef6\u200b\u4e0d\u200b\u5b58\u5728\u200b\u5219\u200b\u5728\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u9879\u200b\u548c\u200b\u5bf9\u5e94\u200b\u7684\u200binode\uff0c\u200b\u5e76\u200b\u548c\u200b\u7236\u200b\u76ee\u5f55\u200b\u9879\u200b\u5efa\u7acb\u200b\u8fde\u63a5\u200b\u3002</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u7684\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @param dev \u200b\u8bbe\u5907\u200b\u7c7b\u578b\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint sfs_mknod(const char* path, mode_t mode, dev_t dev) {\nboolean is_find, is_root;\n\nstruct sfs_dentry* last_dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);//\u200b\u627e\u5230\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u6240\u5728\u200b\u7684\u200b\u76ee\u5f55\u200b\nstruct sfs_dentry* dentry;\nstruct sfs_inode* inode;\nchar* fname;\n\nif (is_find == TRUE) {//\u200b\u6587\u4ef6\u200b\u5b58\u5728\u200b\nreturn -SFS_ERROR_EXISTS;\n}\n\nfname = sfs_get_fname(path);//\u200b\u83b7\u53d6\u200b\u6587\u4ef6\u200b\u540d\u5b57\u200b\n\nif (S_ISREG(mode)) {\ndentry = new_dentry(fname, SFS_REG_FILE);\n}\nelse if (S_ISDIR(mode)) {\ndentry = new_dentry(fname, SFS_DIR);\n}\ndentry-&gt;parent = last_dentry;\ninode = sfs_alloc_inode(dentry);\nsfs_alloc_dentry(last_dentry-&gt;inode, dentry);\n\nreturn SFS_ERROR_NONE;\n}\n</code></pre> <p>\u200b\u4f46\u200b\u4ec5\u4ec5\u200b\u5b9e\u73b0\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b<code>touch</code>\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u4ecd\u7136\u200b\u4f1a\u200b\u62a5\u9519\u200b\uff0c\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b<code>touch</code>\u200b\u8981\u6c42\u200b\u4e0d\u4ec5\u4ec5\u200b\u662f\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8fd8\u200b\u8981\u6c42\u200b\u53ef\u4ee5\u200b\u00a0\u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbf\u95ee\u200b\u65f6\u95f4\u200b\u00a0\uff08\u200b\u96be\u602a\u200b\u53eb\u200b<code>touch</code>\uff0c\u200b\u6478\u200b\u4e00\u4e0b\u200b\uff09\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u8fd8\u8981\u200b\u5b9e\u73b0\u200b<code>utimens</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u7528\u4e8e\u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbf\u95ee\u200b\u65f6\u95f4\u200b\uff08\u200b\u5176\u5b9e\u200b\u53ea\u200b\u9700\u8981\u200b\u8fd4\u56de\u200b0\u200b\u5c31\u200b\u597d\u200b\uff09\u3002\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u53ef\u4ee5\u200b\u8fdb\u4e00\u6b65\u200b\u5b8c\u5584\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4e0d\u200b\u5b8c\u5584\u200b\u3002</p> <pre><code>/**\n* @brief \u200b\u4fee\u6539\u200b\u65f6\u95f4\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u4e0d\u8ba9\u200btouch\u200b\u62a5\u9519\u200b \n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param tv \u200b\u5b9e\u8df5\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint newfs_utimens(const char* path, const struct timespec tv[2]) {\n(void)path;\nreturn 0;\n}\n</code></pre>"},{"location":"lab5/part3/#35","title":"3.5 \u200b\u8bfb\u53d6\u200b\u76ee\u5f55\u200b\u9879","text":"<p>\u200b\u5f53\u200b\u00a0\u200b\u5728\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u00a0\u200b\u4e0b\u200b\u8c03\u7528\u200b<code>ls</code>\u200b\u65f6\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u89e6\u53d1\u200b<code>readdir</code>\u200b\u94a9\u5b50\u200b\uff0c\u00a0readdir\u00a0\u200b\u5728\u200b<code>ls</code>\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u6bcf\u6b21\u200b\u00a0\u200b\u4ec5\u4f1a\u200b\u8fd4\u56de\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u00a0\uff0c\u200b\u5176\u4e2d\u200b<code>offset</code>\u200b\u53c2\u6570\u200b\u8bb0\u5f55\u200b\u7740\u200b\u5f53\u524d\u200b\u5e94\u8be5\u200b\u8fd4\u56de\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff1a <pre><code>/**\n * @brief \n * \n * @param path \n * @param buf \n * @param filler \u200b\u53c2\u6570\u200b\u8bb2\u89e3\u200b:\n * \n * typedef int (*fuse_fill_dir_t) (void *buf, const char *name,\n *              const struct stat *stbuf, off_t off)\n * buf: name\u200b\u4f1a\u200b\u88ab\u200b\u590d\u5236\u5230\u200bbuf\u200b\u4e2d\u200b\n * name: dentry\u200b\u540d\u5b57\u200b\n * stbuf: \u200b\u6587\u4ef6\u200b\u72b6\u6001\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n * off: \u200b\u4e0b\u200b\u4e00\u6b21\u200boffset\u200b\u4ece\u200b\u54ea\u91cc\u200b\u5f00\u59cb\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u53ef\u4ee5\u200b\u7406\u89e3\u200b\u4e3a\u200b\u7b2c\u51e0\u4e2a\u200bdentry\n * \n * @param offset \n * @param fi \n * @return int \n */\nint sfs_readdir(const char * path, void * buf, fuse_fill_dir_t filler, off_t offset,\nstruct fuse_file_info * fi) {\nboolean is_find, is_root;\nint     cur_dir = offset;\n\nstruct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\nstruct sfs_dentry* sub_dentry;\nstruct sfs_inode* inode;\nif (is_find) {\ninode = dentry-&gt;inode;\nsub_dentry = sfs_get_dentry(inode, cur_dir);\nif (sub_dentry) {\nfiller(buf, sub_dentry-&gt;fname, NULL, ++offset);\n}\nreturn SFS_ERROR_NONE;\n}\nreturn -SFS_ERROR_NOTFOUND;\n}\n</code></pre> \u200b\u5176\u4e2d\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u00a0filler\u00a0\u200b\u51fd\u6570\u200b\uff0c\u00a0filler\u00a0\u200b\u51fd\u6570\u200b\u539f\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <p><code>typedef int (*fuse_fill_dir_t) (void *buf, const char *name, const struct stat *stbuf, off_t off)</code> \u200b\u5bf9\u200b\u5404\u4e2a\u200b\u53c2\u6570\u200b\u505a\u200b\u5982\u4e0b\u200b\u89e3\u91ca\u200b\uff1a</p> <ul> <li> <p><code>buf</code>\uff1aname\u200b\u4f1a\u200b\u88ab\u200b\u590d\u5236\u5230\u200bbuf\u200b\u4e2d\u200b\uff1b</p> </li> <li> <p>xxxxxxxxxx\u00a0/*** @brief \u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b* * @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b* @param mode \u200b\u521b\u5efa\u200b\u6a21\u5f0f\u200b\uff08\u200b\u53ea\u8bfb\u200b\uff1f\u200b\u53ea\u200b\u5199\u200b\uff1f\uff09\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b*/int sfs_mkdir(const char* path, mode_t mode) {    (void)mode;    boolean is_find, is_root;    char* fname;    struct sfs_dentry* last_dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);//\u200b\u5bfb\u627e\u200b\u4e0a\u7ea7\u200b\u76ee\u5f55\u200b\u9879\u200b    struct sfs_dentry* dentry;    struct sfs_inode* \u00a0inode;\u200b    if (is_find) {//\u200b\u76ee\u5f55\u200b\u5b58\u5728\u200b        return -SFS_ERROR_EXISTS;    }\u200b    if (SFS_IS_REG(last_dentry-&gt;inode)) {        return -SFS_ERROR_UNSUPPORTED;    }\u200b    fname \u00a0= sfs_get_fname(path);    dentry = new_dentry(fname, SFS_DIR);     dentry-&gt;parent = last_dentry;    inode \u00a0= sfs_alloc_inode(dentry);    sfs_alloc_dentry(last_dentry-&gt;inode, dentry);        return SFS_ERROR_NONE;}c</p> </li> <li> <p><code>stbuf</code>\uff1a\u200b\u6587\u4ef6\u200b\u72b6\u6001\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\uff1b</p> </li> <li> <p><code>off</code>\uff1a \u200b\u4e0b\u200b\u4e00\u6b21\u200boffset\u200b\u4ece\u200b\u54ea\u91cc\u200b\u5f00\u59cb\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u53ef\u4ee5\u200b\u7406\u89e3\u200b\u4e3a\u200b\u7b2c\u51e0\u4e2a\u200bdentry\uff1b</p> </li> </ul> <p>\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5728\u200b\u4e0a\u8ff0\u200b\u4ee3\u7801\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u8c03\u7528\u200b<code>filler(buf, fname, NULL, ++offset)</code>\u200b\u8868\u793a\u200b\u5c06\u200b<code>fname</code>\u200b\u653e\u5165\u200b<code>buf</code>\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u200b\u4f7f\u200b\u76ee\u5f55\u200b\u9879\u200b\u504f\u79fb\u200b\u52a0\u4e00\u200b\uff0c\u200b\u4ee3\u8868\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u8bbf\u95ee\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p>"},{"location":"lab5/part3/#_2","title":"*\u200b\u8865\u5145\u200b\u601d\u8003\u200b\uff1a\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5b9e\u73b0","text":""},{"location":"lab5/part3/#_3","title":"\u80cc\u666f","text":"<ul> <li>\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\uff08Symbolic Link\uff09\uff0c\u200b\u53c8\u79f0\u200b\u8f6f\u200b\u94fe\u63a5\u200b\uff08Soft Link\uff09\uff0c\u200b\u5b83\u200b\u5305\u542b\u200b\u4e86\u200b\u5230\u200b\u539f\u6587\u4ef6\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\uff0c\u200b\u62e5\u6709\u200b\u81ea\u5df1\u200b\u7684\u200b\u7d22\u5f15\u200b\u8282\u70b9\u200b\uff08inode\uff09\u200b\u53ca\u200b\u6587\u4ef6\u5c5e\u6027\u200b\u53ca\u200b\u6743\u9650\u200b\u3002</li> <li>\u200b\u786c\u200b\u94fe\u63a5\u200b\uff08Hard Link\uff09\uff0c\u200b\u662f\u200b\u5bf9\u200b\u539f\u6587\u4ef6\u200b\u8d77\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u522b\u540d\u200b\u3002\u200b\u6587\u4ef6\u200b\u6709\u200b\u76f8\u540c\u200b\u7684\u200b inode \u200b\u53ca\u200b data block\u3002</li> </ul> <p>\u200b\u8be6\u7ec6\u200b\u533a\u522b\u200b\u8bf7\u200b\u81ea\u884c\u200b\u67e5\u9605\u200b\u8d44\u6599\u200b</p>"},{"location":"lab5/part3/#_4","title":"\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f","text":"<p>\u200b\u7531\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u539f\u7406\u200b\u53ef\u200b\u5f97\u200b\uff0c\u200b\u5efa\u7acb\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5173\u952e\u200b\u662f\u200b\u5b58\u50a8\u200b\u94fe\u63a5\u200b\u76ee\u6807\u200b\u6587\u4ef6\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u3002</p> <p>\u200b\u7531\u6b64\u200b\u5f15\u51fa\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u4e24\u79cd\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f\u200b\uff1a</p> <ol> <li>\u200b\u5c06\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u5728\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b</li> <li>\u200b\u5c06\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u5728\u200bdata block\u200b\u4e2d\u200b</li> </ol> <p>\u200b\u6837\u4f8b\u200bSimpleFS\u200b\u4e2d\u200b\u7684\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u5c06\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u4e8e\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u5b58\u50a8\u200b\u5728\u200bdata block\u200b\u4e2d\u200b\u7684\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u81ea\u8003\u200b\u5e76\u200b\u5b9e\u73b0\u200b\u3002</p>"},{"location":"lab5/part3/#_5","title":"\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u5b9e\u73b0\u200b\u7ec6\u8282","text":"<ol> <li>\u200b\u7531\u4e8e\u200b\u6837\u4f8b\u200b\u662f\u200b\u5c06\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u4e8e\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b\uff0c\u200b\u6545\u200b\u9700\u8981\u200b\u9996\u5148\u200b\u4fee\u6539\u200b<code>struct inode</code>\u200b\u548c\u200b<code>struct inode_d</code></li> </ol> <pre><code># \u200b\u6dfb\u52a0\u200btarget_path\u200b\u7528\u4e8e\u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\nchar               target_path[SFS_MAX_FILE_NAME];\n</code></pre> <p>\u200b\u5e76\u200b\u7531\u6b64\u200b\u9700\u8981\u200b\u589e\u52a0\u200b<code>sfs_utils.c</code>\u200b\u4e2d\u200b\uff0c<code>sfs_sync_inode() \u200b\u53ca\u200b  sfs_read_inode()</code>\uff0c\u200b\u5bf9\u200b\u5185\u5b58\u200binode\u200b\u53ca\u200b\u78c1\u76d8\u200binode\u200b\u95f4\u200b\u62f7\u8d1d\u200b\u64cd\u4f5c\u200b\u65f6\u200b\u7684\u200b\u8865\u5145\u200b\u62f7\u8d1d\u200b\u3002</p> <p>\u200b\u540c\u65f6\u200b\uff0c\u200b\u5728\u200b\u6587\u4ef6\u7c7b\u578b\u200b<code>enum sfs_file_type</code>\u200b\u4e2d\u200b\u589e\u52a0\u200b<code>SFS_SYM_LINK</code></p> <ol> <li>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u200b\u652f\u6301\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\uff0c\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b**<code>symlink</code>**\u200b\u94a9\u5b50\u200b</li> </ol> <p>\u200b\u9996\u5148\u200b\uff0c\u200b\u7531\u4e8e\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u672c\u8d28\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7279\u6b8a\u200b\u7c7b\u578b\u200b\u7684\u200b\u6587\u4ef6\u200b\uff0c\u200b\u9700\u8981\u200b\u8c03\u7528\u200b<code>mknod()</code>\u200b\u521b\u5efa\u200b\u65b0\u200b\u7684\u200b\u8282\u70b9\u200b\uff0c\u200b\u5c06\u200b\u6b64\u200bdentry / inode\u200b\u8282\u70b9\u200b\u6807\u8bb0\u200b\u4f4d\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u578b\u200b\u8282\u70b9\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u94fe\u63a5\u200b\u7684\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u62f7\u8d1d\u200b\u81f3\u200binode\u200b\u8282\u70b9\u200b\u4e2d\u200b\u3002</p> <pre><code>/**\n * @brief \n * \n * @param path - Where the link points\n * @param link - The link itself\n * @return int \n */\nint sfs_symlink(const char* path, const char* link){\nint ret = SFS_ERROR_NONE;\nboolean is_find, is_root;\nret = sfs_mknod(link, S_IFREG, NULL);\nstruct sfs_dentry* dentry = sfs_lookup(link, &amp;is_find, &amp;is_root);\nif (is_find == FALSE) {\nreturn -SFS_ERROR_NOTFOUND;\n}\ndentry-&gt;ftype = SFS_SYM_LINK;\nstruct sfs_inode* inode = dentry-&gt;inode;\nmemcpy(inode-&gt;target_path, path, SFS_MAX_FILE_NAME);\nreturn ret;\n}\n</code></pre> <ol> <li>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u200b\u652f\u6301\u200b\u94fe\u63a5\u200b\uff0c\u200b\u9700\u8981\u200b\u5b9e\u73b0\u200b**<code>readlink</code>**\u200b\u94a9\u5b50\u200b</li> </ol> <p><code>readlink</code>\u200b\u5373\u5c06\u200bpath\u200b\u5bf9\u5e94\u200b\u7684\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u578b\u200b\u6587\u4ef6\u200b\u6240\u200b\u6307\u5411\u200b\u7684\u200b\u94fe\u63a5\u200b\u8def\u5f84\u200b\u4fe1\u606f\u200b\u62f7\u8d1d\u200b\u81f3\u200bbuf\u200b\u4e2d\u200b\uff0c\u200b\u4ee5\u200b\u5b9e\u73b0\u200b\u5bf9\u200b\u5bf9\u5e94\u200b\u94fe\u63a5\u200b\u6587\u4ef6\u200b\u7684\u200b\u4e00\u7cfb\u5217\u200b\u64cd\u4f5c\u200b\u3002</p> <pre><code>/**\n * @brief \n * \n * @param path \n * @param buf\n * @param size \n * @return int \n */\nint sfs_readlink (const char *path, char *buf, size_t size){\n/* SFS \u200b\u6682\u672a\u200b\u5b9e\u73b0\u200b\u786c\u200b\u94fe\u63a5\u200b\uff0c\u200b\u53ea\u200b\u652f\u6301\u200b\u8f6f\u200b\u94fe\u63a5\u200b */\nboolean is_find, is_root;\nssize_t llen;\nstruct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\nif (is_find == FALSE) {\nreturn -SFS_ERROR_NOTFOUND;\n}\nif (dentry-&gt;ftype != SFS_SYM_LINK){\nreturn -SFS_ERROR_INVAL;\n}\nstruct sfs_inode* inode = dentry-&gt;inode;\nllen = strlen(inode-&gt;target_path);\nif(size &lt; 0){\nreturn -SFS_ERROR_INVAL;\n}else{\nif(llen &gt; size){\nstrncpy(buf, inode-&gt;target_path, size);\nbuf[size] = '\\0';\n}else{\nstrncpy(buf, inode-&gt;target_path, llen);\nbuf[llen] = '\\0';\n}\n}\nreturn SFS_ERROR_NONE;\n}\n</code></pre> <ol> <li>\u200b\u4e3a\u4e86\u200b\u80fd\u200b\u6210\u529f\u200b\u8bfb\u53d6\u200b\u7b26\u53f7\u200b\u94fe\u63a5\u200b\u578b\u200b\u6587\u4ef6\u200b\u7684\u200b\u72b6\u6001\u200b\u548c\u200b\u6743\u9650\u200b\uff0c\u200b\u8fd8\u200b\u9700\u8981\u200b\u4fee\u6539\u200b<code>sfs_getattr()</code></li> </ol> <pre><code># \u200b\u6dfb\u52a0\u200b\u5982\u4e0b\u200b\u5206\u652f\u200b\u5224\u65ad\u200b\nelse if (SFS_IS_SYM_LINK(dentry-&gt;inode)) {\nsfs_stat-&gt;st_mode = S_IFLNK | SFS_DEFAULT_PERM;\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;size;\n}\n</code></pre>"},{"location":"lab5/part3/#36","title":"3.6 \u200b\u5378\u8f7d","text":"<p>\u200b\u5f53\u200b\u5378\u8f7d\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u00a0\u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b\u00a0\u200b\u662f\u200b<code>.destroy</code>\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>.destroy</code>\u200b\u94a9\u5b50\u200b\u4e2d\u200b\u5b8c\u6210\u200b\u00a0\u200b\u8d85\u7ea7\u200b\u5757\u200b\u56de\u5199\u200b\u8bbe\u5907\u200b\u00a0\u3001\u00a0\u200b\u9a71\u52a8\u200b\u7684\u200b\u5173\u95ed\u200b\u00a0\u3001\u00a0\u200b\u66f4\u200b\u591a\u200b\u5fc5\u8981\u200b\u7ed3\u6784\u200b\u7684\u200b\u56de\u5199\u200b\u00a0\u200b\u7b49\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4ee5\u200b\u4fdd\u8bc1\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u6302\u8f7d\u200b\u80fd\u591f\u200b\u00a0\u200b\u6062\u590d\u200bddriver\u200b\u8bbe\u5907\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u200b\u00a0\uff1a</p> <pre><code>/**\n* @brief \u200b\u5378\u8f7d\u200b\uff08umount\uff09\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\n* \n* @param p \u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return void\n*/\nvoid newfs_destroy(void* p) {\n/* TODO: \u200b\u5728\u200b\u8fd9\u91cc\u200b\u8fdb\u884c\u200b\u5378\u8f7d\u200b */\n\nddriver_close(super.fd);\n\nreturn;\n}\n</code></pre> <p>\u200b\u4e0a\u9762\u200b\u7684\u200b\u793a\u4f8b\u200b\u662f\u200b\u5173\u95ed\u200b\u9a71\u52a8\u200b\u8bbe\u5907\u200b\u3002</p> <p>\u200b\u4e0b\u9762\u200b\u6211\u4eec\u200b\u6765\u200b\u770b\u770b\u200bsfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e2d\u200b\u5bf9\u4e8e\u200b\u5378\u8f7d\u200b\u7684\u200b\u5177\u4f53\u200b\u5b9e\u73b0\u200b\u6b65\u9aa4\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u4ece\u6839\u200b\u8282\u70b9\u200b\u9012\u5f52\u200b\u5f80\u200b\u4e0b\u200b\u5237\u5199\u200b\u6839\u200b\u8282\u70b9\u200b\u3002</p> <pre><code> sfs_sync_inode(sfs_super.root_dentry-&gt;inode);     /* \u200b\u4ece\u6839\u200b\u8282\u70b9\u200b\u5411\u4e0b\u200b\u5237\u5199\u200b\u8282\u70b9\u200b */\n</code></pre> <p>\u200b   \u2461\u200b\u5c06\u200b\u5185\u5b58\u200b\u8d85\u7ea7\u200b\u5757\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u78c1\u76d8\u200b\u8d85\u7ea7\u200b\u5757\u200b\u5e76\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    sfs_super_d.magic_num           = SFS_MAGIC_NUM;\nsfs_super_d.map_inode_blks      = sfs_super.map_inode_blks;\nsfs_super_d.map_inode_offset    = sfs_super.map_inode_offset;\nsfs_super_d.data_offset         = sfs_super.data_offset;\nsfs_super_d.sz_usage            = sfs_super.sz_usage;\n\nif (sfs_driver_write(SFS_SUPER_OFS, (uint8_t *)&amp;sfs_super_d, sizeof(struct sfs_super_d)) != SFS_ERROR_NONE) {\nreturn -SFS_ERROR_IO;\n}\n</code></pre> <p>\u200b   \u2462\u200b\u5c06\u200binode\u200b\u4f4d\u200b\u56fe\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    if (sfs_driver_write(sfs_super_d.map_inode_offset, (uint8_t *)(sfs_super.map_inode), SFS_BLKS_SZ(sfs_super_d.map_inode_blks)) != SFS_ERROR_NONE) {\nreturn -SFS_ERROR_IO;\n}\nfree(sfs_super.map_inode);\n</code></pre> <p>\u200b   \u2463\u200b\u5173\u95ed\u200b\u9a71\u52a8\u200b\u3002</p> <pre><code>    ddriver_close(SFS_DRIVER());\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u51fd\u6570\u200b\u662f\u200b<code>sfs_sync_inode</code>\uff0c\u200b\u5176\u200b\u4f5c\u7528\u200b\u662f\u200b\u5c06\u200b\u5185\u5b58\u200binode\u200b\u53ca\u5176\u200b\u4e0b\u65b9\u200b\u7ed3\u6784\u200b\u5168\u90e8\u200b\u5237\u200b\u56de\u200b\u78c1\u76d8\u200b\uff0c\u200b\u64cd\u4f5c\u200b\u6d41\u7a0b\u200b\u5982\u4e0b\u200b\uff1a</p> <p>\u200b   \u2460\u200b\u9996\u5148\u200b\u5c06\u200binode\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    if (sfs_driver_write(SFS_INO_OFS(ino), (uint8_t *)&amp;inode_d, sizeof(struct sfs_inode_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn -SFS_ERROR_IO;\n}\n</code></pre> <p>\u200b   \u2461\u200b\u5224\u65ad\u200binode\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u3002</p> <p>\u200b   \u2462\u200b\u5982\u679c\u200b\u662f\u200b\u76ee\u5f55\u200b\u7c7b\u578b\u200b\u5219\u200b\u9700\u8981\u200b\u9996\u5148\u200b\u5c06\u200b\u76ee\u5f55\u200b\u9879\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\uff0c\u200b\u518d\u200b\u9012\u5f52\u200b\u5237\u5199\u200b\u6bcf\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200binode\u200b\u8282\u70b9\u200b\u3002</p> <pre><code>                                                      /* Cycle 1: \u200b\u5199\u200b INODE */\n/* Cycle 2: \u200b\u5199\u200b \u200b\u6570\u636e\u200b */\nif (SFS_IS_DIR(inode)) {                          dentry_cursor = inode-&gt;dentrys;\noffset        = SFS_DATA_OFS(ino);\nwhile (dentry_cursor != NULL)\n{\nmemcpy(dentry_d.fname, dentry_cursor-&gt;fname, SFS_MAX_FILE_NAME);\ndentry_d.ftype = dentry_cursor-&gt;ftype;\ndentry_d.ino = dentry_cursor-&gt;ino;\nif (sfs_driver_write(offset, (uint8_t *)&amp;dentry_d, sizeof(struct sfs_dentry_d)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn -SFS_ERROR_IO;                     }\n\nif (dentry_cursor-&gt;inode != NULL) {/*\u200b\u9012\u5f52\u200b\u5237\u5199\u200b\u8282\u70b9\u200b*/\nsfs_sync_inode(dentry_cursor-&gt;inode);\n}\n\ndentry_cursor = dentry_cursor-&gt;brother;\noffset += sizeof(struct sfs_dentry_d);\n}\n}\n</code></pre> <p>\u200b       \u2463\u200b\u5982\u679c\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff0c\u200b\u5219\u200b\u5c06\u200binode\u200b\u6240\u200b\u6307\u5411\u200b\u7684\u200b\u6570\u636e\u200b\u76f4\u63a5\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\u3002</p> <pre><code>    else if (SFS_IS_REG(inode)) {\nif (sfs_driver_write(SFS_DATA_OFS(ino), inode-&gt;data, SFS_BLKS_SZ(SFS_DATA_PER_FILE)) != SFS_ERROR_NONE) {\nSFS_DBG(\"[%s] io error\\n\", __func__);\nreturn -SFS_ERROR_IO;\n}\n}\n</code></pre>"},{"location":"lab5/part3/#37","title":"3.7 \u200b\u6587\u4ef6\u200b\u8bfb","text":"<p>\u200b\u5f53\u200b\u8bfb\u53d6\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u7528\u5230\u200b<code>read</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u5728\u200b\u590d\u5236\u200b\u6587\u4ef6\u200b\u65f6\u200b\u4e5f\u200b\u4f1a\u200b\u7528\u5230\u200b\uff0c\u200b\u4ed6\u200b\u901a\u8fc7\u200b\u4e0b\u9762\u200b\u7684\u200b\u6b65\u9aa4\u200b\u6765\u200b\u5b8c\u6210\u200b\u4e00\u6b21\u200b\u5bf9\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bfb\u53d6\u200b\uff1a</p> <p>\u2460\u200b\u9996\u5148\u200b\u627e\u5230\u200b\u6587\u4ef6\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff1a</p> <pre><code>    struct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\n</code></pre> <p>\u2461\u200b\u627e\u5230\u200b\u76ee\u5f55\u200b\u9879\u200b\u4e4b\u540e\u200b\u5224\u65ad\u200b\u6587\u4ef6\u7c7b\u578b\u200b\uff0c\u200b\u4fdd\u8bc1\u200b\u662f\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u5e76\u4e14\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u8981\u200b\u5927\u4e8e\u200b\u6240\u200b\u8981\u200b\u8bfb\u53d6\u200b\u7684\u200b\u504f\u79fb\u91cf\u200b\uff1a</p> <pre><code>    if (SFS_IS_DIR(inode)) {\nreturn -SFS_ERROR_ISDIR;    }\n\nif (inode-&gt;size &lt; offset) {\nreturn -SFS_ERROR_SEEK;\n}\n</code></pre> <p>\u2462\u200b\u4e4b\u540e\u200b\u5c06\u200b\u6570\u636e\u200b\u8bfb\u5165\u200b\u5185\u5b58\u200b\u5757\u200b\u5373\u53ef\u200b\uff1a</p> <pre><code>    memcpy(buf, inode-&gt;data + offset, size);\n</code></pre>"},{"location":"lab5/part3/#38","title":"3.8 \u200b\u6587\u4ef6\u200b\u5199","text":"<p>\u200b\u5199\u200b\u6587\u4ef6\u200b\u662f\u200b\uff0c\u200b\u7528\u5230\u200b<code>write</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u5b83\u200b\u5411\u200b\u6587\u4ef6\u200b\u6240\u5728\u200b\u7684\u200b\u78c1\u76d8\u200b\u4f4d\u7f6e\u200b\u4e2d\u200b\u5199\u5165\u200b\u6570\u636e\u200b\uff1a</p> <p>\u2460\u200b\u548c\u200b\u8bfb\u200b\u6587\u4ef6\u200b\u4e00\u6837\u200b\uff0c\u200b\u9996\u5148\u200b\u627e\u5230\u200b\u8def\u5f84\u200b\u6240\u200b\u5bf9\u5e94\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff1a</p> <pre><code>    struct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\n</code></pre> <p>\u2461\u200b\u4e4b\u540e\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u7c7b\u578b\u200b\u4e0d\u662f\u200b\u76ee\u5f55\u200b\u4ee5\u53ca\u200b\u4fdd\u8bc1\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u5927\u4e8e\u200b\u504f\u79fb\u91cf\u200b\uff1a</p> <pre><code>    if (SFS_IS_DIR(inode)) {\nreturn -SFS_ERROR_ISDIR;    }\n\nif (inode-&gt;size &lt; offset) {\nreturn -SFS_ERROR_SEEK;\n}\n</code></pre> <p>\u2462\u200b\u5c06\u200b\u5185\u5b58\u200b\u4e2d\u200b\u6570\u636e\u200b\u590d\u5236\u5230\u200b\u5bf9\u5e94\u200b\u4f4d\u7f6e\u200b\u5373\u53ef\u200b\uff0c\u200b\u5e76\u200b\u6539\u5199\u200biNode\u200b\u8282\u70b9\u200b\u7684\u200b\u5927\u5c0f\u200b\uff1a</p> <pre><code>    memcpy(inode-&gt;data + offset, buf, size);\ninode-&gt;size = offset + size &gt; inode-&gt;size ? offset + size : inode-&gt;size;\n</code></pre>"},{"location":"lab5/part3/#32_1","title":"3.2 \u200b\u5378\u8f7d","text":"<p>\u200b\u5f53\u200b\u5378\u8f7d\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b \u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b \u200b\u662f\u200b<code>.destroy</code>\uff0c\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b<code>.destroy</code>\u200b\u94a9\u5b50\u200b\u4e2d\u200b\u5b8c\u6210\u200b \u200b\u8d85\u7ea7\u200b\u5757\u200b\u56de\u5199\u200b\u8bbe\u5907\u200b \u3001 \u200b\u9a71\u52a8\u200b\u7684\u200b\u5173\u95ed\u200b \u3001 \u200b\u66f4\u200b\u591a\u200b\u5fc5\u8981\u200b\u7ed3\u6784\u200b\u7684\u200b\u56de\u5199\u200b \u200b\u7b49\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4ee5\u200b\u4fdd\u8bc1\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u6302\u8f7d\u200b\u80fd\u591f\u200b \u200b\u6062\u590d\u200bddriver\u200b\u8bbe\u5907\u200b\u4e2d\u200b\u7684\u200b\u6570\u636e\u200b \uff1a</p> <pre><code>/**\n* @brief \u200b\u5378\u8f7d\u200b\uff08umount\uff09\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\n* \n* @param p \u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return void\n*/\nvoid newfs_destroy(void* p) {\n/* TODO: \u200b\u5728\u200b\u8fd9\u91cc\u200b\u8fdb\u884c\u200b\u5378\u8f7d\u200b */\n\nddriver_close(super.fd);\n\nreturn;\n}\n</code></pre> <p>\u200b\u4e0a\u9762\u200b\u7684\u200b\u793a\u4f8b\u200b\u662f\u200b\u5173\u95ed\u200b\u9a71\u52a8\u200b\u8bbe\u5907\u200b\u3002</p>"},{"location":"lab5/part3/#33_1","title":"3.3 \u200b\u83b7\u53d6\u200b\u6587\u4ef6\u5c5e\u6027","text":"<p>FUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u4e86\u200b\u83b7\u5f97\u200b\u6bcf\u4e2a\u200b\u6587\u4ef6\u200b\u7684\u200b\u72b6\u6001\u200b \uff0c\u200b\u8981\u200b\u4e0d\u65ad\u200b\u8c03\u7528\u200b<code>getattr</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u51fd\u6570\u200b\u7c7b\u4f3c\u200b\u4e8e\u200b xv6 \u200b\u91cc\u200b\u7684\u200b fstat \u3002\u200b\u5b9e\u73b0\u200b<code>ls</code>\u3001<code>mkdir</code>\u3001<code>touch</code>\u200b\u7b49\u200b\u64cd\u4f5c\u200b\u7684\u200b\u524d\u63d0\u200b\u5c31\u662f\u200b\u5b8c\u6210\u200b<code>getattr</code>\u200b\u94a9\u5b50\u200b\u7684\u200b\u7f16\u5199\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u7ed9\u200b\u4e2a\u200b\u4f8b\u5b50\u200b\uff1a</p> <pre><code>/**\n* @brief \u200b\u83b7\u53d6\u200b\u6587\u4ef6\u5c5e\u6027\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param sfs_stat \u200b\u8fd4\u56de\u200b\u72b6\u6001\u200b\n* @return int \n*/\nint sfs_getattr(const char* path, struct stat * sfs_stat) {\nboolean is_find, is_root;\nstruct sfs_dentry* dentry = sfs_lookup(path, &amp;is_find, &amp;is_root);\n...\n\nif (SFS_IS_DIR(dentry-&gt;inode)) {\nsfs_stat-&gt;st_mode = S_IFDIR | SFS_DEFAULT_PERM;\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;dir_cnt * sizeof(struct sfs_dentry_d);\n}\nelse if (SFS_IS_REG(dentry-&gt;inode)) {\nsfs_stat-&gt;st_mode = S_IFREG | SFS_DEFAULT_PERM;     /* SFS_DEFAULT_PERM 0777 */\nsfs_stat-&gt;st_size = dentry-&gt;inode-&gt;size;\n}\n\nsfs_stat-&gt;st_nlink = 1;\nsfs_stat-&gt;st_uid     = getuid();\nsfs_stat-&gt;st_gid     = getgid();\nsfs_stat-&gt;st_atime   = time(NULL);\nsfs_stat-&gt;st_mtime   = time(NULL);\nsfs_stat-&gt;st_blksize = SFS_IO_SZ();\n\nif (is_root) {\nsfs_stat-&gt;st_size   = sfs_super.sz_usage; sfs_stat-&gt;st_blocks = SFS_DISK_SZ() / SFS_IO_SZ();\nsfs_stat-&gt;st_nlink  = 2;        /* !\u200b\u7279\u6b8a\u200b\uff0c\u200b\u6839\u76ee\u5f55\u200blink\u200b\u6570\u4e3a\u200b2 */\n}\nreturn SFS_ERROR_NONE;\n}\n</code></pre> <p><code>getattr</code>\u200b\u7684\u200b\u5b9e\u73b0\u200b\u9996\u5148\u200b\u662f\u200b \u200b\u89e3\u6790\u200b\u8def\u5f84\u200b \uff0c\u200b\u4ece\u800c\u200b\u83b7\u53d6\u200b\u76f8\u5e94\u200b\u6587\u4ef6\u200b\u7684\u200b inode\u200b\u6216\u200bdentry \uff0c\u200b\u63a5\u7740\u200b\u586b\u5199\u200b<code>struct stat*</code>\u200b\u7ed3\u6784\u200b\u4f53\u200b\u5373\u53ef\u200b\u3002</p>"},{"location":"lab5/part3/#34_1","title":"3.4 \u200b\u5efa\u7acb\u200b\u6587\u4ef6","text":"<p>\u200b\u5f53\u4e3a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b \u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b \u200b\u662f\u200b<code>.mknod</code>\uff0c\u200b\u5728\u200b\u6211\u4eec\u200b\u7ed9\u200b\u7684\u200b\u6846\u67b6\u200b\u4e2d\u200b\uff0c\u200b\u7ed9\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200b\u601d\u8def\u200b\uff1a</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\u7684\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @param dev \u200b\u8bbe\u5907\u200b\u7c7b\u578b\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint newfs_mknod(const char* path, mode_t mode, dev_t dev) {\n/* TODO: \u200b\u89e3\u6790\u200b\u8def\u5f84\u200b\uff0c\u200b\u5e76\u200b\u521b\u5efa\u200b\u76f8\u5e94\u200b\u7684\u200b\u6587\u4ef6\u200b */\nreturn 0;\n}\n</code></pre> <p>\u200b\u4f46\u200b\u4ec5\u4ec5\u200b\u5b9e\u73b0\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b<code>touch</code>\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u4ecd\u7136\u200b\u4f1a\u200b\u62a5\u9519\u200b\uff0c\u200b\u8fd9\u200b\u662f\u56e0\u4e3a\u200b<code>touch</code>\u200b\u8981\u6c42\u200b\u4e0d\u4ec5\u4ec5\u200b\u662f\u200b\u521b\u5efa\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8fd8\u200b\u8981\u6c42\u200b\u53ef\u4ee5\u200b \u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbf\u95ee\u200b\u65f6\u95f4\u200b \uff08\u200b\u96be\u602a\u200b\u53eb\u200b<code>touch</code>\uff0c\u200b\u6478\u200b\u4e00\u4e0b\u200b\uff09\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u8fd8\u8981\u200b\u5b9e\u73b0\u200b<code>utimens</code>\u200b\u94a9\u5b50\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u94a9\u5b50\u200b\u7528\u4e8e\u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u7684\u200b\u8bbf\u95ee\u200b\u65f6\u95f4\u200b\uff08\u200b\u5176\u5b9e\u200b\u53ea\u200b\u9700\u8981\u200b\u8fd4\u56de\u200b0\u200b\u5c31\u200b\u597d\u200b\uff09\u3002\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u53ef\u4ee5\u200b\u8fdb\u4e00\u6b65\u200b\u5b8c\u5584\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4e0d\u200b\u5b8c\u5584\u200b\u3002</p> <pre><code>/**\n* @brief \u200b\u4fee\u6539\u200b\u65f6\u95f4\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u4e0d\u8ba9\u200btouch\u200b\u62a5\u9519\u200b \n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param tv \u200b\u5b9e\u8df5\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint newfs_utimens(const char* path, const struct timespec tv[2]) {\n(void)path;\nreturn 0;\n}\n</code></pre>"},{"location":"lab5/part3/#35_1","title":"3.5 \u200b\u5efa\u7acb\u200b\u76ee\u5f55","text":"<p>\u200b\u5f53\u4e3a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b \u200b\u6267\u884c\u200b\u7684\u200b\u94a9\u5b50\u200b \u200b\u662f\u200b<code>.mkdir</code>\uff1a</p> <pre><code>/**\n* @brief \u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b\n* \n* @param path \u200b\u76f8\u5bf9\u200b\u4e8e\u200b\u6302\u8f7d\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\n* @param mode \u200b\u521b\u5efa\u200b\u6a21\u5f0f\u200b\uff08\u200b\u53ea\u8bfb\u200b\uff1f\u200b\u53ea\u200b\u5199\u200b\uff1f\uff09\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\n* @return int 0\u200b\u6210\u529f\u200b\uff0c\u200b\u5426\u5219\u200b\u5931\u8d25\u200b\n*/\nint newfs_mkdir(const char* path, mode_t mode) {\n/* TODO: \u200b\u89e3\u6790\u200b\u8def\u5f84\u200b\uff0c\u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b */\nreturn 0;\n}\n</code></pre>"},{"location":"lab5/part3/#36_1","title":"3.6 \u200b\u8bfb\u53d6\u200b\u76ee\u5f55\u200b\u9879","text":"<p>\u200b\u5f53\u200b \u200b\u5728\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u4e0b\u200b\u8c03\u7528\u200b<code>ls</code>\u200b\u65f6\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u89e6\u53d1\u200b<code>readdir</code>\u200b\u94a9\u5b50\u200b\uff0c readdir \u200b\u5728\u200b<code>ls</code>\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u6bcf\u6b21\u200b \u200b\u4ec5\u4f1a\u200b\u8fd4\u56de\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b \uff0c\u200b\u5176\u4e2d\u200b<code>offset</code>\u200b\u53c2\u6570\u200b\u8bb0\u5f55\u200b\u7740\u200b\u5f53\u524d\u200b\u5e94\u8be5\u200b\u8fd4\u56de\u200b\u7684\u200b\u76ee\u5f55\u200b\u9879\u200b\uff1a</p> <pre><code>int sfs_readdir(const char * path, void * buf, fuse_fill_dir_t filler, off_t offset,\nstruct fuse_file_info * fi) {\nboolean is_find, is_root;\nint     cur_dir = offset;\n...\nif (is_find) {\n...\ndentry = sfs_get_dentry(inode, cur_dir);\nif (dentry) {\nfiller(buf, fname, NULL, ++offset);\n}\nreturn SFS_ERROR_NONE;\n}\nreturn -SFS_ERROR_NOTFOUND;\n}\n</code></pre> <p>\u200b\u5176\u4e2d\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b filler \u200b\u51fd\u6570\u200b\uff0c filler \u200b\u51fd\u6570\u200b\u539f\u578b\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>typedef int (*fuse_fill_dir_t) (void *buf, const char *name, const struct stat *stbuf, off_t off)\n</code></pre> <p>\u200b\u5bf9\u200b\u5404\u4e2a\u200b\u53c2\u6570\u200b\u505a\u200b\u5982\u4e0b\u200b\u89e3\u91ca\u200b\uff1a</p> <ul> <li><code>buf</code>\uff1aname\u200b\u4f1a\u200b\u88ab\u200b\u590d\u5236\u5230\u200bbuf\u200b\u4e2d\u200b\uff1b</li> <li><code>name</code>\uff1adentry\u200b\u540d\u5b57\u200b\uff1b</li> <li><code>stbuf</code>\uff1a\u200b\u6587\u4ef6\u200b\u72b6\u6001\u200b\uff0c\u200b\u53ef\u200b\u5ffd\u7565\u200b\uff1b</li> <li><code>off</code>\uff1a \u200b\u4e0b\u200b\u4e00\u6b21\u200boffset\u200b\u4ece\u200b\u54ea\u91cc\u200b\u5f00\u59cb\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u53ef\u4ee5\u200b\u7406\u89e3\u200b\u4e3a\u200b\u7b2c\u51e0\u4e2a\u200bdentry\uff1b</li> </ul> <p>\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5728\u200b\u4e0a\u8ff0\u200b\u4ee3\u7801\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u8c03\u7528\u200b<code>filler(buf, fname, NULL, ++offset)</code>\u200b\u8868\u793a\u200b\u5c06\u200b<code>fname</code>\u200b\u653e\u5165\u200b<code>buf</code>\u200b\u4e2d\u200b\uff0c\u200b\u5e76\u200b\u4f7f\u200b\u76ee\u5f55\u200b\u9879\u200b\u504f\u79fb\u200b\u52a0\u4e00\u200b\uff0c\u200b\u4ee3\u8868\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u8bbf\u95ee\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u76ee\u5f55\u200b\u9879\u200b\u3002</p>"},{"location":"lab5/part3/#4","title":"4. \u200b\u5b9e\u73b0\u200b\u5efa\u8bae","text":""},{"location":"lab5/part3/#41","title":"4.1 \u200b\u53c2\u8003\u200b\u4ee3\u7801","text":"<p>\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u4e24\u4e2a\u200b\u5b8c\u5168\u200b\u642d\u5efa\u200b\u597d\u200b\u7684\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1a<code>simplefs</code>\uff08<code>fs/simplefs</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\uff09\u200b\u548c\u200b<code>myfs</code>\uff08<code>fs/samples</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\uff09\uff0c\u200b\u5176\u4e2d\u200b<code>simplefs</code>\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7c7b\u200bEXT2\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u4f46\u200b \u200b\u6ca1\u6709\u200b\u7ed9\u4e88\u200b\u6570\u636e\u4f4d\u200b\u56fe\u200b \u200b\u7684\u200b\u5b9e\u73b0\u200b\uff1b<code>myfs</code>\u200b\u662f\u200b<code>github</code>\u200b\u4e0a\u200b\u7684\u200b\u4e00\u4e2a\u200b\u5f00\u6e90\u200b\u9879\u76ee\u200b\uff0c\u200b\u4e5f\u200b\u662f\u200b\u4e00\u4e2a\u200bFUSE\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5b9e\u4f8b\u200b\u3002</p>"},{"location":"lab5/part3/#42","title":"4.2 \u200b\u5b9e\u73b0\u200b\u6b65\u9aa4\u200b\u5efa\u8bae","text":"<ul> <li> <p>\u200b\u5c01\u88c5\u200b\u5bf9\u200b ddriver \u200b\u7684\u200b\u8bbf\u95ee\u200b\u4ee3\u7801\u200b\uff0c\u200b\u65b9\u4fbf\u200b\u8bbe\u5907\u200b\u8bfb\u5199\u200b\uff1b\uff08\u200b\u6ce8\u610f\u200b\u9a71\u52a8\u200b\u8bfb\u5199\u200bIO\u200b\u4e3a\u200b512B\uff0c\u200b\u4f46\u662f\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e00\u4e2a\u200b\u5757\u200b\u5927\u5c0f\u200b\u4e3a\u200b1024B\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u4e24\u4e2a\u200bIO\u200b\u5355\u4f4d\u200b\uff09  </p> </li> <li> <p>\u200b\u8bbe\u8ba1\u200b\u4ecb\u8d28\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u4f4d\u4e8e\u200b<code>types.h</code>\uff09\uff1b  </p> </li> <li> <p>\u200b\u8bbe\u8ba1\u200b\u5185\u5b58\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u53ef\u200b\u8bbe\u8ba1\u200b\u3001\u200b\u53ef\u4e0d\u200b\u8bbe\u8ba1\u200b\uff09\uff1b  </p> </li> <li> <p>\u200b\u5b8c\u6210\u200b<code>.init</code>\u200b\u94a9\u5b50\u200b\uff1a\u200b\u8bfb\u200b \u200b\u8d85\u7ea7\u200b\u5757\u200b \u3001\u200b\u521d\u59cb\u5316\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff1b  </p> </li> <li> <p>\u200b\u5b8c\u6210\u200b<code>.destroy</code>\u200b\u94a9\u5b50\u200b\uff1a \u200b\u56de\u5199\u200b\u5fc5\u8981\u200b\u7ed3\u6784\u200b \uff0c\u200b\u4fdd\u8bc1\u200b\u4e0b\u200b\u4e00\u6b21\u200b\u6302\u8f7d\u200b\u6b63\u5e38\u200b\uff1b  </p> </li> <li> <p>\u200b\u9a8c\u8bc1\u200b\u6302\u8f7d\u200b\u5378\u8f7d\u200b\u6d41\u7a0b\u200b\u7684\u200b\u6b63\u786e\u6027\u200b\uff08 \u200b\u4e3b\u8981\u200b\u770b\u200b\u8bfb\u5199\u200b\u662f\u5426\u200b\u6b63\u786e\u200b \uff09\uff1b  </p> </li> <li> <p>\u200b\u5b8c\u6210\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff08\u200b\u53ef\u200b\u81ea\u884c\u8bbe\u8ba1\u200b\uff09\uff1a  </p> <ul> <li>\u200b\u5b8c\u6210\u200b \u200b\u5206\u914d\u200binode \u200b\u51fd\u6570\u200b\uff1a\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200bInode\u3001\u200b\u521d\u59cb\u5316\u200b\u5176\u4e0a\u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\u3001\u200b\u4fee\u6539\u200b\u4f4d\u200b\u56fe\u200b\u7ed3\u6784\u200b\uff0c\u200b\u53ef\u80fd\u200b\u8fd8\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u8d85\u7ea7\u200b\u5757\u200b\uff1b  </li> <li>\u200b\u5b8c\u6210\u200b \u200b\u5206\u914d\u200bdentry \u200b\u51fd\u6570\u200b\uff1a\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200bdentry\u3001\u200b\u521d\u59cb\u5316\u200b\u5176\u4e0a\u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\uff1b  </li> <li>\u200b\u5b8c\u6210\u200b\u5c06\u200b dentry\u200b\u52a0\u5165\u200b\u5230\u200binode \u200b\u4e2d\u200b\u7684\u200b\u51fd\u6570\u200b\uff1a\u200b\u5c06\u200b\u751f\u6210\u200b\u7684\u200bdentry\u200b\u5199\u5165\u200b\u5230\u200binode\u200b\u4e2d\u200b\uff1b  </li> <li>\u200b\u5b8c\u6210\u200b \u200b\u8def\u5f84\u200b\u89e3\u6790\u200b\u51fd\u6570\u200b \uff0c\u200b\u8981\u4e48\u200b\u8fd4\u56de\u200bdentry\uff0c\u200b\u8981\u4e48\u200b\u8fd4\u56de\u200binode\uff0c\u200b\u53ef\u200b\u81ea\u884c\u8bbe\u8ba1\u200b\uff1b  </li> </ul> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.get_attr</code>\u200b\u94a9\u5b50\u200b\uff1b  </p> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.mknod</code>\u200b\u94a9\u5b50\u200b\uff1b </p> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.mkdir</code>\u200b\u94a9\u5b50\u200b\uff1b  </p> </li> <li> <p>\u200b\u6839\u636e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b8c\u6210\u200b<code>.readdir</code>\u200b\u94a9\u5b50\u200b\uff1b  </p> </li> <li> <p>\u200b\u624b\u5de5\u200b\u6d4b\u8bd5\u200b<code>touch</code>\u3001<code>ls</code>\u3001 <code>mkdir</code>\u3001<code>fusermount -u</code>\u200b\u7b49\u200b\u547d\u4ee4\u200b\u7684\u200b\u6b63\u786e\u6027\u200b\uff1b  </p> </li> <li> <p>\u200b\u901a\u8fc7\u200b<code>./tests/fs_test.sh</code>\u200b\u811a\u672c\u200b  </p> </li> </ul>"},{"location":"lab5/part3/#5","title":"5. \u200b\u5e38\u89c1\u95ee\u9898","text":""},{"location":"lab5/part3/#51","title":"5.1 \u200b\u5982\u4f55\u200b\u8c03\u8bd5\u200b\uff1f","text":"<p>\u200b\u5e38\u89c1\u95ee\u9898\u200b1: \u200b\u5982\u4f55\u200b\u8c03\u8bd5\u200b\uff1f</p> <p>\u200b\u6309\u4e0b\u200b<code>F5</code>\u200b\u540e\u200b\uff0c\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u8fd0\u884c\u200b\u4e3a\u200b\u524d\u53f0\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5982\u4f55\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\u5462\u200b\uff1f\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c\u200b\u53ef\u4ee5\u200b<code>ctrl + shift +\uff40</code>\u200b\u547c\u51fa\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u7136\u540e\u200b\u5728\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u7ec8\u7aef\u200b\u64cd\u4f5c\u200b\u3002</p> <p></p> <p>\u200b\u53e6\u5916\u200b\uff0c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u6309\u200b\u8fd9\u4e2a\u200b \u200b\u62c6\u5206\u200b\u952e\u200b \uff0c\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u540c\u65f6\u200b\u663e\u793a\u200b\u4e24\u4e2a\u200b\u7ec8\u7aef\u200b\u4e86\u200b\u3002</p> <p></p>"},{"location":"lab5/part3/#52","title":"5.2 \u200b\u6302\u8f7d\u200b\u5931\u8d25\u200b\uff1f","text":"<p>\u200b\u5e38\u89c1\u95ee\u9898\u200b2: \u200b\u6302\u8f7d\u200b\u5931\u8d25\u200b\uff1ffuse: bad mount point</p> <p>\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u5c31\u662f\u200b\u4e0d\u200b\u6b63\u5e38\u200b\u7684\u200b\u5378\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u6211\u4eec\u200b\u663e\u5f0f\u200b\u5730\u200b\u8c03\u7528\u200b \u200b\u5378\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u5373\u53ef\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/pyq/user-land-filesystem/fs/newfs$ fusermount -u ./tests/mnt\nteststu_8@OSLabExecNode0:~/pyq/user-land-filesystem/fs/newfs$ </code></pre>"},{"location":"lab5/part3/#53","title":"5.3 \u200b\u6302\u8f7d\u200b\u70b9\u4e0d\u7a7a\u200b\uff1f","text":"<p>\u200b\u5e38\u89c1\u95ee\u9898\u200b3: \u200b\u6302\u8f7d\u200b\u70b9\u4e0d\u7a7a\u200b\uff1fmountpoint is not empty</p> <p>\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u5c31\u662f\u200b\u5728\u200b\u6d4b\u8bd5\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4e0d\u200b\u5c0f\u5fc3\u200b\u7ed9\u200b<code>mnt</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\u521b\u5efa\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u9519\u8bef\u200b\u53d1\u751f\u200b\uff0c\u200b\u628a\u200b \u200b\u6587\u4ef6\u200b\u5220\u9664\u200b \u200b\u5c31\u884c\u200b\u3002</p>"},{"location":"lab5/part4/","title":"\u4ee3\u7801\u200b\u63d0\u4ea4","text":"<p>\u200b\u8bf7\u200b\u5c06\u200b\u672c\u6b21\u200b\u5b9e\u9a8c\u200b\u7684\u200b \u200b\u6240\u6709\u200b\u4ee3\u7801\u200b \u200b\u548c\u200b \u200b\u5b9e\u9a8c\u62a5\u544a\u200b \u200b\u6253\u5305\u200b\u63d0\u4ea4\u200b\u5230\u200b\u4f5c\u4e1a\u200b\u5e73\u53f0\u200b\uff01</p>"},{"location":"lab5/part4/#_2","title":"\u5b9e\u9a8c\u200b\u9a8c\u6536\u200b\u6307\u5357","text":"<p>\u200b\u4ee5\u4e0b\u200b\u4e24\u70b9\u200b\u4e8c\u9009\u200b\u4e00\u200b\u5373\u53ef\u200b</p> <ol> <li> <p>\u200b\u5b8c\u6210\u200btest.sh\u200b\u7684\u200b\u57fa\u7840\u200b\u529f\u80fd\u6d4b\u8bd5\u200b</p> </li> <li> <p>\u200b\u6709\u4e9b\u200b\u540c\u5b66\u200b\u9047\u5230\u200b \u200b\u811a\u672c\u200b \u200b\u65e0\u6cd5\u200b\u901a\u8fc7\u200b\u60c5\u51b5\u200b\uff0c\u200b\u53ef\u80fd\u200b\u662f\u200b FUSE\u200b\u672c\u8eab\u200b\u7684\u200bBUG \uff0c\u200b\u8fd9\u91cc\u200b\u540c\u5b66\u200b\u53ea\u8981\u200b\u80fd\u591f\u200b\u8fdb\u884c\u200b \u200b\u6b63\u786e\u200b\u7684\u200b\u5e8f\u5217\u200b\u6f14\u793a\u200b \u200b\u5373\u53ef\u200b\uff0c\u200b\u6b63\u786e\u200b\u7684\u200b\u5e8f\u5217\u200b\u5982\u4e0b\u200b\uff08\u200b\u57fa\u7840\u200b\u5206\u200b30\u200b\u5206\u200b\uff09\uff1a</p> <ul> <li> <p>F5\u200b\u6302\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff081\u200b\u5206\u200b\uff09</p> </li> <li> <p>mkdir\u200b\u6d4b\u8bd5\u200b\uff084\u200b\u5206\u200b\uff09</p> </li> </ul> <pre><code>mkdir ./tests/mnt/dir0\nmkdir ./tests/mnt/dir0/dir0\nmkdir ./tests/mnt/dir0/dir0/dir0\nmkdir ./tests/mnt/dir1\n</code></pre> <ul> <li>touch\u200b\u6d4b\u8bd5\u200b\uff085\u200b\u5206\u200b\uff09</li> </ul> <pre><code>touch ./tests/mnt/file0\ntouch ./tests/mnt/dir0/file0\ntouch ./tests/mnt/dir0/dir0/file0\ntouch ./tests/mnt/dir0/dir0/dir0/file0\ntouch ./tests/mnt/dir1/file0\n</code></pre> <ul> <li>ls\u200b\u6d4b\u8bd5\u200b\uff084\u200b\u5206\u200b\uff09</li> </ul> <pre><code>mkdir ./tests/mnt/dir0\ntouch ./tests/mnt/file0\nmkdir ./tests/mnt/dir0/dir1\nmkdir ./tests/mnt/dir0/dir1/dir2\ntouch ./tests/mnt/dir0/dir1/dir2/file4\ntouch ./tests/mnt/dir0/dir1/dir2/file5\ntouch ./tests/mnt/dir0/dir1/dir2/file6\ntouch ./tests/mnt/dir0/dir1/file3\ntouch ./tests/mnt/dir0/file1\n--------------\nls ./tests/mnt\nls ./tests/mnt/dir0\nls ./tests/mnt/dir0/dir1\nls ./tests/mnt/dir0/dir1/dir2\n</code></pre> <ul> <li>remount\u200b\u6d4b\u8bd5\u200b\uff0816\u200b\u5206\u200b\uff09</li> </ul> <pre><code>fusermount -u ./tests/mnt\nddriver -r\n# F5\u200b\u518d\u6b21\u200b\u6302\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\nmkdir ./tests/mnt/hello\nls ./tests/mnt\nfusermount -u ./tests/mnt\npython3 ./tests/checkbm/checkbm.py -l ./include/fs.layout -r ./tests/checkbm/golden.json\n</code></pre> </li> </ol> <p>\u200b\u4ee5\u4e0a\u200b\u547d\u4ee4\u200b\u5747\u200b\u6d4b\u8bd5\u200b\u6210\u529f\u200b\uff08ls\u200b\u8f93\u51fa\u200b\u6b63\u5e38\u200b\uff09\uff0c\u200b\u5219\u200b\u6d4b\u8bd5\u901a\u8fc7\u200b\u3002</p>"},{"location":"lab5/part5/","title":"\u5b9e\u9a8c\u200b\u63d0\u793a","text":""},{"location":"lab5/part5/#1","title":"1. \u200b\u5982\u4f55\u200b\u8c03\u8bd5\u200b\uff1f","text":"<p>\u200b\u6309\u4e0b\u200bF5\u200b\u540e\u200b\uff0c\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u8fd0\u884c\u200b\u4e3a\u200b\u524d\u53f0\u200b\u6a21\u5f0f\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5982\u4f55\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\u5462\u200b\uff1f\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c\u200b\u53ef\u4ee5\u200bctrl + shift +\uff40\u200b\u547c\u51fa\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u7136\u540e\u200b\u5728\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u7ec8\u7aef\u200b\u64cd\u4f5c\u200b\u3002</p> <p></p> <p>\u200b\u53e6\u5916\u200b\uff0c\u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u6309\u200b\u8fd9\u4e2a\u200b \u200b\u62c6\u5206\u200b\u952e\u200b \uff0c\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u540c\u65f6\u200b\u663e\u793a\u200b\u4e24\u4e2a\u200b\u7ec8\u7aef\u200b\u4e86\u200b\u3002</p> <p></p>"},{"location":"lab5/part5/#2","title":"2. \u200b\u6302\u8f7d\u200b\u5931\u8d25\u200b\uff1f","text":"<p>\u200b\u63d0\u793a\u200b\"fuse: bad mount point\" \u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u5c31\u662f\u200b\u4e0d\u200b\u6b63\u5e38\u200b\u7684\u200b\u5378\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\uff0c\u200b\u6211\u4eec\u200b\u663e\u5f0f\u200b\u5730\u200b\u8c03\u7528\u200b \u200b\u5378\u8f7d\u200b\u6587\u4ef6\u7cfb\u7edf\u200b \u200b\u5373\u53ef\u200b\uff1a</p> <pre><code>teststu_8@OSLabExecNode0:~/pyq/user-land-filesystem/fs/newfs$ fusermount -u ./tests/mnt\nteststu_8@OSLabExecNode0:~/pyq/user-land-filesystem/fs/newfs$ </code></pre>"},{"location":"lab5/part5/#3","title":"3. \u200b\u6302\u8f7d\u200b\u70b9\u4e0d\u7a7a\u200b\uff1f","text":"<p>\u200b\u63d0\u793a\u200b\"mountpoint is not empty\" \u200b\u5982\u4e0b\u200b\u56fe\u200b\u6240\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u5c31\u662f\u200b\u5728\u200b\u6d4b\u8bd5\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4e0d\u200b\u5c0f\u5fc3\u200b\u7ed9\u200b<code>mnt</code>\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\u521b\u5efa\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u9519\u8bef\u200b\u53d1\u751f\u200b\uff0c\u200b\u628a\u200b \u200b\u6587\u4ef6\u200b\u5220\u9664\u200b \u200b\u5c31\u884c\u200b\u3002</p>"},{"location":"lab5/part5/#4-ext2","title":"4. \u200b\u5982\u4f55\u200b\u89e3\u8bfb\u200bEXT2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5e03\u5c40\u200b\uff1f","text":"<p>\u200b\u53ef\u4ee5\u200b\u67e5\u770b\u200b<code>dump</code>\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u955c\u50cf\u200b\uff0c\u200b\u5bf9\u200b\u955c\u50cf\u200b\u8fdb\u884c\u200b\u89e3\u8bfb\u200b\uff1a</p> <p></p> <p>\u200b\u5229\u7528\u200b <code>ddriver -d</code> \u200b\u751f\u6210\u200bddriver\u200b\u955c\u50cf\u200b\u547d\u4ee4\u200b\u67e5\u770b\u200b\u955c\u50cf\u200b\u3002</p> <p>\u200b\u4ee5\u200bsimplefs\u200b\u955c\u50cf\u200b\u4e3a\u4f8b\u200b\uff1a</p> <pre><code>~/user-land-filesystem/fs/simplefs$ ddriver -d\n[sudo] password for test_19:\n\u200b\u76ee\u6807\u200b\u8bbe\u5907\u200b /home/students/test_19/ddriver\n8192+0 records in\n8192+0 records out\n4194304 bytes (4.2 MB, 4.0 MiB) copied, 0.0632482 s, 66.3 MB/s\n\u200b\u6587\u4ef6\u200b\u5df2\u200b\u5bfc\u51fa\u200b\u81f3\u200b/home/students/test_19/user-land-filesystem/fs/simplefs/ddriver_dump\uff0c\u200b\u8bf7\u200b\u5b89\u88c5\u200bHexEditor\u200b\u63d2\u4ef6\u200b\u67e5\u770b\u200b\u5176\u200b\u5185\u5bb9\u200b\n</code></pre> <p>\u200b\u5728\u200bVSCode\u200b\u4e0a\u200b\u5b89\u88c5\u200bHexEditor\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u5373\u53ef\u200b\u67e5\u770b\u200b<code>ddriver_dump</code>\u200b\u955c\u50cf\u200b\u7684\u200b\u5185\u5bb9\u200b\u3002</p>"},{"location":"lab5/part5/#5","title":"5. \u200b\u5b9e\u9a8c\u200b\u8bc4\u6d4b\u200b\u4e2d\u200b\u7684\u200b\u4f4d\u56fe\u200b\u68c0\u67e5\u200b\u539f\u7406","text":"<p>\u200b\u4e3a\u200b\u907f\u514d\u200b\u5927\u5bb6\u200b\u7167\u642c\u200bSimple File System\u200b\u4ee3\u7801\u200b\uff0c\u200b\u5b9e\u9a8c\u200b\u8bc4\u6d4b\u200b\u811a\u672c\u200b<code>./tests/checkbm/check_bm.py</code>\u200b\u4f1a\u200b\u6839\u636e\u200b\u5927\u5bb6\u200b\u586b\u5199\u200b\u7684\u200bfs.layout\u200b\u6587\u4ef6\u200b\uff0c\u200b\u786e\u5b9a\u200bddriver\u200b\u78c1\u76d8\u200b\u5e03\u5c40\u200b\uff0c\u200b\u68c0\u67e5\u200bsuper\u3001inode_map\u3001data_map\u200b\u5404\u9879\u200b\u5185\u5bb9\u200b\uff0c\u200b\u5982\u679c\u200b\u68c0\u67e5\u200b\u5931\u8d25\u200b\uff0ccheck_bm.py\u200b\u4f1a\u200b\u8fd4\u56de\u200b\u76f8\u5e94\u200b\u7684\u200b\u9519\u8bef\u200b\uff0c\u200b\u5927\u5bb6\u200b\u4f9d\u9519\u200b\u81ea\u884c\u200b\u67e5\u6539\u200b\u5373\u53ef\u200b\u3002</p> <p>\u200b\u5177\u4f53\u200b\u68c0\u67e5\u200b\u539f\u7406\u200b\u53ef\u4ee5\u200b\u67e5\u770b\u200b\uff1ahttps://gitee.com/ftutorials/user-land-filesystem/blob/main/fs/template/tests/checkbm/README.md</p>"},{"location":"oscomp/oscomp/","title":"2023\u200b\u5e74\u200b\u201c\u200b\u5168\u56fd\u200b\u5927\u5b66\u751f\u200b\u8ba1\u7b97\u673a\u7cfb\u7edf\u200b\u80fd\u529b\u200b\u5927\u8d5b\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u8d5b\u200b\u201d\u200b\u706b\u70ed\u200b\u62a5\u540d\u200b\u4e2d\u200b\uff01","text":""},{"location":"oscomp/oscomp/#1","title":"1. \u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u8d5b\u200b\u7b80\u4ecb","text":"<p>\ud83d\udce2 \u200b\u4ec0\u4e48\u200b\u662f\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u8d5b\u200b?</p> <ul> <li> <p> \u200b\u5168\u79f0\u200b \uff1a \u200b\u5168\u56fd\u200b\u5927\u5b66\u751f\u200b\u8ba1\u7b97\u673a\u7cfb\u7edf\u200b\u80fd\u529b\u200b\u5927\u8d5b\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u5927\u8d5b\u200b </p> <ul> <li> <p>\u200b\u7531\u200b\u6559\u80b2\u90e8\u200b\u9ad8\u7b49\u5b66\u6821\u200b\u8ba1\u7b97\u673a\u200b\u7c7b\u200b\u4e13\u4e1a\u200b\u6559\u5b66\u200b\u6307\u5bfc\u200b\u59d4\u5458\u4f1a\u200b\u548c\u200b\u7cfb\u7edf\u200b\u80fd\u529b\u200b\u57f9\u517b\u200b\u7814\u7a76\u200b\u4e13\u5bb6\u7ec4\u200b\u5171\u540c\u200b\u53d1\u8d77\u200b\uff0c\u200b\u76ee\u524d\u200b\u5df2\u7ecf\u200b\u4e3e\u529e\u200b2\u200b\u5c4a\u200b\u3002</p> </li> <li> <p>\u200b\u7b2c\u4e00\u5c4a\u200b\u4e8e\u200b2021\u200b\u5e74\u200b\u4e3e\u529e\u200b\uff0c\u200b\u8fd1\u200b200\u200b\u652f\u200b\u961f\u4f0d\u200b \u200b\u53c2\u8d5b\u200b\u3002\u200b\u7b2c\u4e8c\u5c4a\u200b\u7684\u200b\u53c2\u8d5b\u200b\u961f\u4f0d\u200b\u589e\u52a0\u200b\u5230\u200b\u4e86\u200b 300\u200b\u4f59\u652f\u200b \u3002</p> </li> <li> <p>\u200b\u6bd4\u8d5b\u200b\u5206\u4e3a\u200b\u4e24\u4e2a\u200b\u8d5b\u9053\u200b\uff1a\u200b\u5185\u6838\u200b\u8d5b\u9053\u200b \u200b\u548c\u200b \u200b\u529f\u80fd\u200b\u8d5b\u9053\u200b</p> </li> <li>\u200b\u5927\u8d5b\u200b\u5b98\u7f51\u200b\uff1ahttps://os.educg.net</li> </ul> </li> <li> <p> \u200b\u5185\u6838\u200b\u8d5b\u9053\u200b \uff1a</p> <ul> <li>\u200b\u5236\u4f5c\u200b\u4e00\u4e2a\u200b \u200b\u5b8c\u6574\u200b\u7684\u200b\u5185\u6838\u200b \uff0c\u200b\u901a\u8fc7\u200b\u8d5b\u65b9\u200b\u63d0\u4f9b\u200b\u7684\u200b\u7528\u6237\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u6709\u200b\u4f59\u529b\u200b\u7684\u200b\u961f\u4f0d\u200b\u8fd8\u200b\u53ef\u4ee5\u200b\u53bb\u200b\u652f\u6301\u200bpython\uff0crust\uff0credis......</li> <li>\u200b\u529f\u80fd\u200b \u200b\u4e0e\u200b \u200b\u6027\u80fd\u200b \u200b\u7684\u200b\u6bd4\u62fc\u200b</li> </ul> </li> <li> <p> \u200b\u529f\u80fd\u200b\u8d5b\u9053\u200b \uff1a</p> <ul> <li>\u200b\u5b9e\u73b0\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\u7684\u200b \u200b\u67d0\u9879\u200b \u200b\u524d\u6cbf\u200b\u529f\u80fd\u200b</li> <li>\u200b\u591a\u79cd\u200b\u8bfe\u9898\u200b \u200b\u4efb\u9009\u200b\uff0c\u200b\u6d89\u53ca\u200b\u8c03\u5ea6\u200b\u3001\u200b\u901a\u4fe1\u200b\u3001\u200b\u5b58\u50a8\u200b\u3001\u200b\u5b89\u5168\u200b\u3001\u200b\u5e94\u7528\u200b\u7b49\u200b\u4e0d\u540c\u200b\u9886\u57df\u200b</li> </ul> </li> <li> <p> \u200b\u5173\u4e8e\u200b\u6bd4\u8d5b\u200b\u7ec4\u961f\u200b \uff1a</p> <ul> <li>\u200b\u4e0d\u200b\u9650\u5236\u200b\u5b66\u6821\u200b\u7684\u200b\u53c2\u8d5b\u200b\u961f\u4f0d\u200b\u6570\u200b\uff0c\u200b\u4e00\u652f\u200b\u961f\u4f0d\u200b\u6700\u591a\u4e09\u4eba\u200b</li> </ul> </li> <li> <p> \u200b\u7b2c\u4e8c\u5c4a\u200b\uff082022\u200b\u5e74\u200b\uff09\u200b\u6bd4\u8d5b\u200b\u91cd\u8981\u200b\u65f6\u95f4\u200b\u70b9\u200b \uff1a</p> </li> </ul> <p></p> <ul> <li> <p> \u200b\u6bd4\u8d5b\u200b\u5956\u9879\u200b\u8bbe\u7f6e\u200b \uff1a </p> \u200b\u8d5b\u9053\u200b \u200b\u4e00\u7b49\u5956\u200b \u200b\u4e8c\u7b49\u5956\u200b \u200b\u4e09\u7b49\u5956\u200b \u200b\u5185\u6838\u200b\u8d5b\u9053\u200b 6\u200b\u652f\u200b\u961f\u4f0d\u200b 9\u200b\u652f\u200b\u961f\u4f0d\u200b 11\u200b\u652f\u200b\u961f\u4f0d\u200b \u200b\u529f\u80fd\u200b\u8d5b\u9053\u200b 6\u200b\u652f\u200b\u961f\u4f0d\u200b 9\u200b\u652f\u200b\u961f\u4f0d\u200b 15\u200b\u652f\u200b\u961f\u4f0d\u200b </li> <li> <p>\u200b\u6ce8\u200b\uff1a\u200b\u5165\u56f4\u200b\u51b3\u8d5b\u200b\u5373\u200b\u83b7\u5f97\u200b\u4f18\u80dc\u5956\u200b\uff0c\u200b\u51e0\u4e4e\u200b\u6240\u6709\u200b\u961f\u4f0d\u200b\u90fd\u200b\u80fd\u200b\u62ff\u5230\u200b ~   \u200b\u200b    </p> </li> </ul> <p></p>"},{"location":"oscomp/oscomp/#2","title":"2. \u200b\u53c2\u8d5b\u200b\u8981\u6c42","text":"<p>\ud83d\udce2 \u200b\u54ea\u4e9b\u200b\u540c\u5b66\u200b\u9002\u5408\u200b\u53c2\u8d5b\u200b?</p> <ul> <li>\u200b\u5199\u4e2a\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b \u200b\u800c\u5df2\u200b\uff0c\u200b\u6709\u624b\u200b\u5c31\u200b\u884c\u200b\uff1b  </li> <li>\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b \u200b\u5b8c\u6574\u200b\u4f53\u7cfb\u200b \u200b\u5145\u6ee1\u200b\u5174\u8da3\u200b\uff1b</li> <li> <p>\u200b\u5bf9\u200b\u5185\u6838\u200b \u200b\u4f18\u5316\u200b \u200b\u5145\u6ee1\u200b\u60f3\u6cd5\u200b</p> <ul> <li> \u200b\u5185\u6838\u200b\u8d5b\u9053\u200b\u6b22\u8fce\u200b\u4f60\u200b\uff01 </li> </ul> <p></p> </li> <li> <p>\u200b\u5e0c\u671b\u200b\u5c1d\u8bd5\u200b \u200b\u79d1\u7814\u200b or \u200b\u63d0\u524d\u200b\u63a5\u89e6\u200b \u200b\u5de5\u4e1a\u754c\u200b </p> </li> <li> <p>\u200b\u5e0c\u671b\u200b\u5bf9\u200b \u200b\u524d\u6cbf\u200b\u3001\u200b\u672a\u77e5\u200b \u200b\u7684\u200b\u6280\u672f\u200b\u8fdb\u884c\u200b\u63a2\u7d22\u200b</p> <ul> <li> \u200b\u529f\u80fd\u200b\u8d5b\u9053\u200b\u6b22\u8fce\u200b\u4f60\u200b\uff01 </li> </ul> </li> </ul>"},{"location":"oscomp/oscomp/#3","title":"3. \u200b\u53c2\u8d5b\u200b\u6536\u83b7","text":""},{"location":"oscomp/oscomp/#31","title":"3.1 \u200b\u6821\u5185\u200b\u6536\u83b7","text":"<p>\ud83d\udce2 \u200b\u5728\u200b\u5b66\u6821\u200b\u5185\u200b\uff0c\u200b\u4f60\u200b\u80fd\u200b\u6536\u83b7\u200b\u4ec0\u4e48\u200b?</p> <ul> <li> <p>\u200b\u63a5\u89e6\u200b\u5e76\u200b\u4eb2\u81ea\u200b\u5c1d\u8bd5\u200b \u200b\u524d\u6cbf\u200b \u200b\u7684\u200b\u6280\u672f\u200b</p> </li> <li> <p>\u200b\u7ed3\u8bc6\u200b \u200b\u5f88\u591a\u200b\u884c\u4e1a\u200b\u5927\u4f6c\u200b\u3001\u200b\u540c\u9f84\u200b\u5927\u4f6c\u200b</p> </li> </ul> <p></p> <ul> <li>\u200b\u83b7\u5f97\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u6574\u4e2a\u200b\u4f53\u7cfb\u200b\u6216\u200b\u67d0\u4e2a\u200b\u9886\u57df\u200b\u7684\u200b\u6df1\u523b\u200b \u200b\u7406\u89e3\u200b</li> <li>\u200b\u5feb\u901f\u200b\u63d0\u5347\u200b\u52a8\u624b\u200b\u80fd\u529b\u200b\u548c\u200b\u521b\u65b0\u80fd\u529b\u200b\uff0c\u200b\u4e30\u5bcc\u200b\u81ea\u5df1\u200b\u7684\u200b\u8f6f\u786c\u4ef6\u200b \u200b\u6280\u672f\u200b\u6808\u200b</li> <li>\u200b\u96be\u5f97\u200b\u7684\u200b\u673a\u4f1a\u200b\uff1a\u200b\u628a\u200b\u5927\u80c6\u200b\u7684\u200b \u200b\u60f3\u6cd5\u200b\u53d8\u4e3a\u200b\u73b0\u5b9e\u200b</li> <li>\u200b\u83b7\u5f97\u200b \u200b\u7efc\u6d4b\u200b\u52a0\u5206\u200b \u200b\u673a\u4f1a\u200b\uff0c\u200b\u5956\u5b66\u91d1\u200b++</li> <li>\u200b\u5bf9\u200b\u672a\u6765\u200b\u7684\u200b \u200b\u5347\u5b66\u200b \u200b\u6709\u200b\u975e\u5e38\u200b\u5927\u200b\u7684\u200b\u5e2e\u52a9\u200b</li> <li>( \u200b\u4e00\u7b14\u200b\u975e\u5e38\u200b\u53ef\u89c2\u200b\u7684\u200b\u5956\u91d1\u200b\uff1a\u200b\u53c2\u52a0\u200b\u6bd4\u8d5b\u200b\uff0c\u200b\u987a\u4fbf\u200b\u6323\u4e2a\u200bW\uff0c\u200b\u5988\u5988\u200b\u518d\u4e5f\u200b\u4e0d\u7528\u200b\u62c5\u5fc3\u200b\u6211\u200b\u751f\u6d3b\u200b\u8fc7\u5f97\u200b\u4e0d\u597d\u200b\u4e86\u200b</li> </ul>"},{"location":"oscomp/oscomp/#32","title":"3.2 \u200b\u6821\u5916\u200b\u6536\u83b7","text":"<p>\ud83d\udce2 \u200b\u5728\u200b\u5b66\u6821\u200b\u5916\u200b\uff0c\u200b\u4f60\u200b\u53c8\u200b\u80fd\u200b\u6536\u83b7\u200b\u4ec0\u4e48\u200b?</p> <ul> <li>\u200b\u5b9e\u4e60\u200bOffer\u200b\u7387\u200b++\uff1a\u200b\u6691\u671f\u200b\u534e\u4e3a\u200b\u5b9e\u4e60\u200bOffer\u200b\u7387\u200b\u76f4\u5347\u200b \u200b\u5341\u51e0\u4e2a\u200b \u200b\u767e\u5206\u70b9\u200b\uff08\u200b\u534e\u4e3a\u200b\u6025\u7f3a\u200b\u7cfb\u7edf\u6027\u200b\u4eba\u624d\u200b\uff09</li> <li>\u200b\u9876\u7ea7\u200bOffer\u200b\u7387\u200b++\uff1a\u200b\u67d0\u200b\u51e0\u4e2a\u200b\u961f\u957f\u200b\u4e00\u4e0d\u5c0f\u5fc3\u200b\u5c31\u200b\u6536\u5272\u200b\u4e86\u200b\u534e\u4e3a\u200b\u7684\u200b\u7814\u7a76\u751f\u200b\u624d\u80fd\u200b\u62ff\u5230\u200b\u7684\u200b\u9876\u7ea7\u200bOffer</li> </ul>"},{"location":"oscomp/oscomp/#4","title":"4. \u200b\u6bd4\u8d5b\u200b\u51c6\u5907","text":"<p>\ud83d\udce2 \u200b\u8fd9\u4e2a\u200b\u6bd4\u8d5b\u200b\u96be\u200b\u5417\u200b?</p> <p>\u200b\u96be\u200b \uff0c\u200b\u96be\u5f97\u200b\u5f88\u200b</p> <ul> <li>\u200b\u60f3\u8981\u200b\u53d6\u5f97\u200b\u597d\u200b\u6210\u7ee9\u200b\uff0c\u200b\u9762\u5bf9\u200b\u7684\u200b\u4e00\u5207\u90fd\u662f\u200b \u200b\u65b0\u200b \u200b\u7684\u200b<ul> <li>\u200b\u65b0\u200b\u7684\u200b\u77e5\u8bc6\u200b\uff0c\u200b\u65b0\u200b\u7684\u200b\u8bed\u8a00\u200b\uff0c\u200b\u65b0\u200b\u7684\u200b\u6d4b\u8bc4\u200b\uff0c\u200b\u65b0\u200b\u7684\u200b\u5de5\u5177\u200b\uff0c\u200b\u65b0\u200b\u7684\u200b\u8981\u6c42\u200b ...</li> </ul> </li> <li> <p>\u200b\u7cfb\u7edf\u200b\u7684\u200b \u200b\u8c03\u8bd5\u200b \u200b\u5e38\u5e38\u200b\u6d89\u53ca\u200b\u786c\u4ef6\u200b\u67b6\u6784\u200b\uff0c\u200b\u96be\u5ea6\u200b\u5927\u5927\u200b\u63d0\u5347\u200b</p> </li> <li> <p>\u200b\u8d5b\u7a0b\u200b\u5f88\u957f\u200b \uff0c\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u662f\u200b \u200b\u5174\u8da3\u200b\u548c\u200b\u575a\u6301\u200b \uff0c\u200b\u5f88\u591a\u200b\u961f\u4f0d\u200b\u5230\u200b\u540e\u9762\u200b\u4f1a\u200b\u653e\u5f03\u200b\uff0c\u200b\u809d\u5230\u200b\u80dc\u5229\u200b</p> <ul> <li>\u200b\u4e8b\u5b9e\u4e0a\u200b\uff0c\u200b\u5927\u90e8\u5206\u200b\u961f\u4f0d\u200b\u4ece\u200b \u200b\u5e74\u521d\u200b \u200b\u5c31\u200b\u5f00\u59cb\u200b\u5907\u8d5b\u200b\uff0c \u200b\u4e00\u4e9b\u200b\u961f\u4f0d\u200b\u751a\u81f3\u200b\u524d\u200b\u4e00\u5e74\u200b\u5c31\u200b\u6709\u6240\u51c6\u5907\u200b\uff0c\u200b\u8fd8\u6709\u200b\u53c2\u52a0\u200b\u4e86\u200b\u4e24\u5c4a\u200b\u7684\u200b\u961f\u5458\u200b</li> </ul> </li> </ul> <p></p> <p>\u200b\u6700\u200b\u5173\u952e\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u7cfb\u7edf\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u6ca1\u6709\u200b\u4e0a\u9650\u200b \uff0c\u200b\u60f3\u8981\u200b\u505a\u597d\u200b\u5c31\u200b\u5fc5\u987b\u200b\u6709\u6240\u200b\u4ed8\u51fa\u200b</p>"},{"location":"oscomp/oscomp/#5","title":"5. \u200b\u5f80\u5c4a\u200b\u6218\u7ee9","text":"<p>\ud83d\udce2 \u200b\u6211\u4eec\u200b\u7684\u200b\u6218\u7ee9\u200b</p> <p>\u200b\u7b2c\u4e00\u5c4a\u200b\uff1a</p> <ul> <li>\u201c UltraOS \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u5185\u6838\u200b\u5b9e\u73b0\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b\uff08\u200b\u8d5b\u9053\u200b\u6392\u540d\u200b\u7b2c\u4e00\u200b\uff09 ;</li> <li>\u201c HoitFS \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u529f\u80fd\u8bbe\u8ba1\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b\uff08\u200b\u8d5b\u9053\u200b\u6392\u540d\u200b\u7b2c\u4e00\u200b\uff09 ;</li> <li>\u201c \u200b\u538b\u7f29\u200b\u9e2d\u200b \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u529f\u80fd\u8bbe\u8ba1\u200b\u8d5b\u9053\u200b\u4e8c\u7b49\u5956\u200b ;</li> <li>\u201c \u200b\u554a\u200b\u666e\u9c81\u6d3e\u200b\u54d2\u200b\u54d2\u200b\u54d2\u200b;DROP DATABASE teams;\u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u5185\u6838\u200b\u5b9e\u73b0\u200b\u8d5b\u9053\u200b\u4e09\u7b49\u5956\u200b \u3002</li> </ul> <p>\u200b\u7b2c\u4e8c\u5c4a\u200b\uff1a</p> <ul> <li>\u201c FTL OS \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u5185\u6838\u200b\u5b9e\u73b0\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b ;</li> <li>\u201c OopS \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u5185\u6838\u200b\u5b9e\u73b0\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b ;</li> <li>\u201c LMY \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u529f\u80fd\u8bbe\u8ba1\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b ;</li> <li>\u201c \u200b\u5065\u5eb7\u200b\u5411\u4e0a\u200b\u597d\u200b\u9752\u5e74\u200b \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u5185\u6838\u200b\u5b9e\u73b0\u200b\u8d5b\u9053\u200b\u4e8c\u7b49\u5956\u200b ;</li> <li>\u201c \u200b\u7f16\u8bd1\u200b\u901a\u8fc7\u200b\u6c42\u6c42\u200b\u4e86\u200b \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u529f\u80fd\u8bbe\u8ba1\u200b\u8d5b\u9053\u200b\u4e8c\u7b49\u5956\u200b ;</li> <li>\u201c F-Tutorials \u201d\u200b\u961f\u200b\u83b7\u5f97\u200b \u200b\u529f\u80fd\u8bbe\u8ba1\u200b\u8d5b\u9053\u200b\u4e8c\u7b49\u5956\u200b \uff1b</li> <li>\u201c \u200b\u968f\u4fbf\u200b\u53d6\u540d\u200b\u4e0d\u961f\u200b \u201d\u200b\u83b7\u5f97\u200b \u200b\u5185\u6838\u200b\u5b9e\u73b0\u200b\u8d5b\u9053\u200b\u4f18\u80dc\u5956\u200b ;</li> <li>\u201c \u200b\u8ffd\u5149\u200b\u8005\u200b\u961f\u200b\u201d\u200b\u83b7\u5f97\u200b \u200b\u529f\u80fd\u8bbe\u8ba1\u200b\u8d5b\u9053\u200b\u521d\u8d5b\u200b\u4f18\u80dc\u5956\u200b \u3002</li> </ul> <p>\u200b\u5927\u8d5b\u200b\u83b7\u5956\u200b\u56e2\u961f\u200b\u5c06\u200b\u83b7\u5f97\u200b\u4e30\u539a\u200b\u5956\u91d1\u200b\uff0c\u200b\u5176\u4e2d\u200b\u4e00\u7b49\u5956\u200b\u56e2\u961f\u200b\u83b7\u5f97\u200b30000\u200b\u5143\u200b\u5956\u91d1\u200b\uff0c\u200b\u4e8c\u7b49\u5956\u200b\u56e2\u961f\u200b\u83b7\u200b10000\u200b\u5143\u200b\u5956\u91d1\u200b\uff0c\u200b\u4e09\u7b49\u5956\u200b\u56e2\u961f\u200b\u83b7\u5f97\u200b3000\u200b\u5143\u200b\u5956\u91d1\u200b\u3002</p> <p>\u200b\u7b2c\u4e8c\u5c4a\u200b\u83b7\u5956\u200b\u65b0\u95fb\u200b\u8be6\u89c1\u200b\u54c8\u5de5\u5927\u200b\uff08\u200b\u6df1\u5733\u200b\uff09\u200b\u8ba1\u7b97\u673a\u79d1\u5b66\u200b\u4e0e\u200b\u6280\u672f\u200b\u5b66\u9662\u200b-\u200b\u91cd\u8981\u200b\u65b0\u95fb\u200b\uff1a\u200b\u83b7\u5956\u200b\u6570\u91cf\u200b\u5168\u56fd\u200b\u5c45\u9996\u200b\uff01\u200b\u54c8\u5de5\u5927\u200b\uff08\u200b\u6df1\u5733\u200b\uff09\u200b\u5b66\u5b50\u200b\u5728\u200b\u5168\u56fd\u200b\u5927\u5b66\u751f\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u603b\u8d5b\u200b\u4e2d\u200b\u8868\u73b0\u200b\u4f18\u5f02\u200b\u3002</p> <ul> <li>\u200b\u5185\u6838\u200b\u5b9e\u73b0\u200b\u8d5b\u9053\u200b\u51b3\u8d5b\u200b\u4f5c\u54c1\u200b\u5f00\u6e90\u200b\uff1a\u200b\u70b9\u200b\u8fd9\u91cc\u200b</li> <li>\u200b\u529f\u80fd\u8bbe\u8ba1\u200b\u8d5b\u9053\u200b\u51b3\u8d5b\u200b\u4f5c\u54c1\u200b\u5f00\u6e90\u200b\uff1a\u200b\u70b9\u200b\u8fd9\u91cc\u200b</li> </ul> <p>\u200b\u7b2c\u4e00\u5c4a\u200b\u83b7\u5956\u200b\u65b0\u95fb\u200b\u8be6\u89c1\u200b\u83b7\u5956\u200b\u603b\u6570\u200b\u5168\u56fd\u200b\u7b2c\u4e00\u200b\uff01\u200b\u54c8\u5de5\u5927\u200b\uff08\u200b\u6df1\u5733\u200b\uff09\u200b\u5b66\u5b50\u200b\u5728\u200b\u5168\u56fd\u200b\u5927\u5b66\u751f\u200b\u8ba1\u7b97\u673a\u7cfb\u7edf\u200b\u80fd\u529b\u200b\u5927\u8d5b\u200b\u4e2d\u200b\u6536\u83b7\u200b\u56db\u9879\u200b\u5927\u5956\u200b </p>"},{"location":"oscomp/oscomp/#51-ultraos","title":"5.1 \u200b\u83b7\u5956\u200b\u961f\u4f0d\u200b\u4ecb\u7ecd\u200b\uff1aUltraOS","text":"<p>\ud83d\udce2 \u200b\u7b2c\u4e00\u5c4a\u200b\u5185\u6838\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b\uff1aUltraOS</p> <p>\u200b\u56e2\u961f\u200b\u6210\u5458\u200b\uff1a\u200b\u674e\u7a0b\u200b\u6d69\u200b\uff0c18\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u5bab\u6d69\u8fb0\u200b\uff0c18\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u4efb\u200b\u7fd4\u5b87\u200b\uff0c18\u200b\u7ea7\u200b\u672c\u79d1\u200b</p> <p>\u201c\u200b\u9879\u76ee\u200b\u5386\u65f6\u200b216\u200b\u5929\u200b\uff0c\u200b\u5728\u6b64\u671f\u95f4\u200b\u7f16\u5199\u200b\u4ee3\u7801\u200b149\u200b\u5929\u200b\uff0cUltraOS\u200b\u56e2\u961f\u200b\u6700\u7ec8\u200b\u4ea7\u51fa\u200b\u4e86\u200b\u7ea6\u200b\u4e00\u4e07\u200b\u884c\u200bRust\u200b\u8bed\u8a00\u200b\u4ee3\u7801\u200b\uff08\u200b\u4e0d\u200b\u5305\u62ec\u200b\u8fed\u4ee3\u200b\u4ee3\u7801\u200b\uff09\u3002UltraOS\u200b\u6210\u957f\u200b\u662f\u200b\u8fc5\u901f\u200b\u7684\u200b\uff0c\u200b\u4ece\u200b\u652f\u6301\u200b13\u200b\u6761\u200b\u975e\u6807\u51c6\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\u5230\u200b59\u200b\u6761\u200b\u7cfb\u7edf\u200b\u8c03\u7528\u200b\uff0c\u200b\u4ece\u200b\u53ea\u200b\u652f\u6301\u200b\u4e00\u4e2a\u200b\u7b80\u6613\u200b\u7684\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u5230\u200bFAT32-VFS\u200b\u548c\u200b\u53ef\u200b\u62d3\u5c55\u200b\u8bbe\u5907\u200b\u63a5\u53e3\u200b\u7b49\u200b\u5177\u6709\u200b\u53ef\u200b\u62d3\u5c55\u200b\u7684\u200b\u62bd\u8c61\u200b\uff0c\u200b\u4ece\u200b\u5355\u6838\u200b\u5230\u200b\u591a\u200b\u6838\u200b\uff0c\u200b\u4ece\u200b\u7f13\u6162\u200b\u8fc8\u5411\u200b\u9ad8\u6027\u80fd\u200b\u3002\u200b\u6bcf\u4e00\u4ef6\u200b\u4e8b\u200b\u90fd\u200b\u662f\u200b\u6311\u6218\u200b\uff0c\u200b\u4f46\u200b\u6bcf\u4e00\u4ef6\u200b\u4e8b\u200b\u90fd\u200b\u662f\u200b\u6210\u957f\u200b\u3002\u201d</p> <p>\u200b\u4f5c\u54c1\u200b\u5f00\u6e90\u200b\uff1a\u200b\u70b9\u200b\u8fd9\u91cc\u200b</p> <p> </p>"},{"location":"oscomp/oscomp/#52-hoitfs","title":"5.2 \u200b\u83b7\u5956\u200b\u961f\u4f0d\u200b\u4ecb\u7ecd\u200b: HoitFS","text":"<p>\ud83d\udce2 \u200b\u7b2c\u4e00\u5c4a\u200b\u529f\u80fd\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b\uff1aHoitFS</p> <p>\u200b\u56e2\u961f\u200b\u6210\u5458\u200b\uff1a\u200b\u6f58\u5ef6\u200b\u9e92\u200b\uff0c18\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u80e1\u200b\u667a\u80dc\u200b\uff0c18\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u5f20\u6960\u200b\uff0c18\u200b\u7ea7\u200b\u672c\u79d1\u200b</p> <p>\u201c\u200b\u6211\u4eec\u200b\u7684\u200b\u9879\u76ee\u200b\u4ee5\u200bJFFS2\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u4e3a\u200b\u539f\u578b\u200b\uff0c\u200b\u5bf9\u200b\u5176\u200bSylixOS\u200b\u4e0a\u200b\u8fdb\u884c\u200b\u4e8c\u6b21\u5f00\u53d1\u200b\uff0c\u200b\u5e76\u200b\u9488\u5bf9\u200bJFFS2\u200b\u5b58\u5728\u200b\u7684\u200b\u4e00\u4e9b\u200b\u95ee\u9898\u200b\u8fdb\u884c\u200b\u9488\u5bf9\u6027\u200b\u4f18\u5316\u200b(\u200b\u4f18\u5316\u200b\u7b56\u7565\u200b\u6bd4\u8f83\u7b80\u5355\u200b)\uff0c\u200b\u5f62\u6210\u200b\u4e86\u200bHoitFS\uff0c\u200b\u6700\u540e\u200b\u901a\u8fc7\u200b\u4e0e\u200bSPIFFS\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u505a\u200b\u5bf9\u6bd4\u200b\uff0c\u200b\u53d1\u73b0\u200b\u6211\u4eec\u200bHoitFS\u200b\u7684\u200b\u6027\u80fd\u200b\u76f8\u5bf9\u200bSPIFFS\u200b\u6765\u8bf4\u200b\u6709\u200b\u660e\u663e\u200b\u7684\u200b\u4f18\u52bf\u200b\u3002\u200b\u672c\u200b\u9879\u76ee\u200b\u5386\u65f6\u200b\u8fd1\u200b\u4e00\u5e74\u200b\uff0c\u200b\u671f\u95f4\u200b\u4e00\u5ea6\u200b\u611f\u5230\u200b\u529b\u4e0d\u4ece\u5fc3\u200b\uff0c\u200b\u4f46\u200b\u5728\u200b\u8001\u5e08\u200b\u7684\u200b\u6307\u5bfc\u200b\u4e0b\u200b\uff0c\u200b\u56e2\u961f\u200b\u6210\u5458\u200b\u7684\u200b\u4e92\u76f8\u200b\u9f13\u52b1\u200b\u4e0b\u200b\uff0c\u200b\u6700\u540e\u200b\u90fd\u200b\u54ac\u7259\u200b\u575a\u6301\u200b\u5230\u200b\u4e86\u200b\u51b3\u8d5b\u200b\u3002\u201d</p> <p>\u200b\u4f5c\u54c1\u200b\u5f00\u6e90\u200b\uff1a\u200b\u70b9\u200b\u8fd9\u91cc\u200b</p> <p> </p>"},{"location":"oscomp/oscomp/#53-ftl-os","title":"5.3 \u200b\u83b7\u5956\u200b\u961f\u4f0d\u200b\u4ecb\u7ecd\u200b: FTL OS","text":"<p>\ud83d\udce2 \u200b\u7b2c\u4e8c\u5c4a\u200b\u5185\u6838\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b\uff1aFTL OS</p> <p>\u200b\u56e2\u961f\u200b\u6210\u5458\u200b\uff1a\u200b\u53f6\u200b\u81ea\u7acb\u200b\uff0c19\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u6a0a\u535a\u200b\uff0c20\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u674e\u7fbf\u5ef7\u200b\uff0c19\u200b\u7ea7\u200b\u672c\u79d1\u200b</p> <p>\u201c\u200b\u975e\u5e38\u200b\u8363\u5e78\u200b\u80fd\u591f\u200b\u83b7\u5f97\u200b\u5927\u8d5b\u200b\u4e00\u7b49\u5956\u200b\uff0c\u200b\u8fd9\u6b21\u200b\u6bd4\u8d5b\u200b\u4e2d\u200b\u6211\u4eec\u200b\u4e00\u8def\u200b\u62ab\u8346\u65a9\u68d8\u200b\uff0c\u200b\u901a\u8fc7\u200b\u4e86\u200b\u5168\u90e8\u200b\u7684\u200b\u529f\u80fd\u6d4b\u8bd5\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u51b3\u8d5b\u200b\u7b2c\u4e8c\u9636\u6bb5\u200b\u5168\u7a0b\u200b\u4fdd\u6301\u200b\u6027\u80fd\u200b\u5206\u200b\u7b2c\u4e00\u200b\u3002</p> <p>\u200b\u6211\u4eec\u200b\u5145\u6ee1\u200b\u68a6\u60f3\u200b\uff0cFTL\u200b\u610f\u200b\u4e3a\u200bFaster Than Light\uff0c\u200b\u5b83\u200b\u8574\u542b\u200b\u4e86\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5bf9\u200b\u6027\u80fd\u200b\u7684\u200b\u6e34\u671b\u200b\u3002\u200b\u4e3a\u4e86\u200b\u5b9e\u73b0\u200b\u8fd9\u4e00\u200b\u76ee\u6807\u200b\uff0c\u200b\u6211\u4eec\u200b\u7528\u200b\u4e86\u200b\u4e0e\u4f17\u4e0d\u540c\u200b\u7684\u200b\u5f00\u53d1\u65b9\u5f0f\u200b\uff1a\u200b\u6211\u4eec\u200b\u4ece\u96f6\u5f00\u59cb\u200b\uff0c\u200b\u5148\u200b\u7f16\u5199\u200b\u6587\u6863\u200b\uff0c\u200b\u4ece\u200b\u8d77\u6b65\u200b\u5c31\u200b\u8fdb\u884c\u200b\u5927\u91cf\u200b\u4f18\u5316\u200b\u3002\u200b\u6211\u4eec\u200b\u4e50\u89c2\u200b\u5730\u200b\u8ba4\u4e3a\u200b\u53ea\u8981\u200b\u5e94\u7528\u200b\u4e86\u200b\u4e00\u5207\u200b\u53ef\u80fd\u200b\u7684\u200b\u4f18\u5316\u200b\uff0cFTLOS\u200b\u5c31\u200b\u80fd\u200b\u8fbe\u5230\u200b\u6781\u81f4\u200b\u7684\u200b\u3001\u200b\u540e\u65e0\u6765\u8005\u200b\u7684\u200b\u6027\u80fd\u200b\u3002\u200b\u4ece\u200b\u7ed3\u679c\u200b\u6765\u770b\u200b\uff0c\u200b\u6b64\u200b\u65b9\u6848\u200b\u5927\u4f53\u200b\u6210\u529f\u200b\uff0c\u200b\u6211\u4eec\u200b\u5168\u7a0b\u200b\u6027\u80fd\u200b\u5206\u200b\u7b2c\u4e00\u200b\uff0c\u200b\u4f46\u200b\u56e0\u4e3a\u200b\u8c03\u7814\u200b\u4e0d\u8db3\u200b\u7684\u200b\u539f\u56e0\u200b\uff0c\u200b\u6587\u4ef6\u7cfb\u7edf\u200b\u7684\u200b\u9519\u8bef\u200b\u8bbe\u8ba1\u200b\u5f71\u54cd\u200b\u4e86\u200b\u91cd\u6784\u200b\uff0cFTLOS\u200b\u65e0\u6cd5\u200b\u5728\u200b\u5168\u90e8\u200b\u7684\u200b\u6d4b\u8bd5\u70b9\u200b\u4e0a\u200b\u83b7\u5f97\u200b\u7b2c\u4e00\u200b\uff0c\u200b\u4e5f\u200b\u8ba9\u200b\u6211\u4eec\u200b\u6ca1\u6709\u200b\u592a\u200b\u591a\u200b\u65f6\u95f4\u200b\u53bb\u200b\u79fb\u690d\u200b\u771f\u5b9e\u200b\u5e94\u7528\u7a0b\u5e8f\u200b\u3002</p> <p>\u200b\u8fd9\u662f\u200b\u6211\u4eec\u200b\u7b2c\u4e00\u6b21\u200b\u53c2\u52a0\u200b\u7cfb\u7edf\u200b\u80fd\u529b\u200b\u5927\u8d5b\u200b\uff0c\u200b\u5b83\u200b\u8ba9\u200b\u6211\u4eec\u200b\u63a5\u89e6\u200b\u5230\u200b\u4e86\u200b\u5927\u91cf\u200b\u65e0\u6cd5\u200b\u4ece\u200b\u8bfe\u672c\u4e0a\u200b\u5b66\u5230\u200b\u7684\u200b\u77e5\u8bc6\u200b\uff0c\u200b\u4f7f\u200b\u6211\u4eec\u200b\u4e86\u89e3\u200b\u4e86\u200b\u73b0\u4ee3\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u8fd0\u884c\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u6709\u200b\u4e86\u200b\u66f4\u200b\u6df1\u5c42\u6b21\u200b\u7684\u200b\u7406\u89e3\u200b\uff0c\u200b\u8fd8\u200b\u663e\u8457\u200b\u63d0\u5347\u200b\u4e86\u200b\u5de5\u7a0b\u200b\u5b9e\u8df5\u200b\u80fd\u529b\u200b\u3002\u200b\u611f\u8c22\u200b\u5168\u90e8\u200b\u961f\u5458\u200b\u3001\u200b\u4f19\u4f34\u200b\u961f\u4f0d\u200b\u7684\u200b\u52aa\u529b\u200b\uff0c\u200b\u611f\u8c22\u200b\u590f\u6587\u200b\u3001\u200b\u4ec7\u6d01\u5a77\u200b\u8001\u5e08\u200b\u7684\u200b\u503e\u529b\u200b\u5e2e\u52a9\u200b\uff0c\u200b\u4e5f\u200b\u611f\u8c22\u200b\u6240\u6709\u200b\u5728\u200b\u6bd4\u8d5b\u200b\u4e2d\u200b\u5b9e\u65f6\u200b\u5f00\u200b\u6e90\u4ee3\u7801\u200b\u3001\u200b\u5c55\u793a\u200b\u6587\u6863\u200b\u7684\u200b\u53c2\u8d5b\u200b\u961f\u4f0d\u200b\u3002\u200b\u613f\u200b\u6bd4\u8d5b\u200b\u5728\u200b\u672a\u6765\u200b\u66f4\u52a0\u200b\u5b8c\u5584\u200b\uff0c\u200b\u8d8a\u6765\u8d8a\u200b\u597d\u200b\u3002\u201d</p> <p>\u200b\u4f5c\u54c1\u200b\u5f00\u6e90\u200b\uff1a\u200b\u70b9\u200b\u8fd9\u91cc\u200b</p> <p> </p>"},{"location":"oscomp/oscomp/#54-oops","title":"5.4 \u200b\u83b7\u5956\u200b\u961f\u4f0d\u200b\u4ecb\u7ecd\u200b: OopS","text":"<p>\ud83d\udce2 \u200b\u7b2c\u4e8c\u5c4a\u200b\u5185\u6838\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b\uff1aOopS</p> <p>\u200b\u56e2\u961f\u200b\u6210\u5458\u200b\uff1a\u200b\u5f20\u827a\u67ab\u200b\uff0c19\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u674e\u8bfa\u821f\u200b\uff0c19\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u5218\u5609\u741b\u200b\uff0c19\u200b\u7ea7\u200b\u672c\u79d1\u200b</p> <p>\u201cOopS\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7528\u200bRust\u200b\u7f16\u5199\u200b\u7684\u200bRISC-V64\u200b\u591a\u6838\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u9879\u76ee\u200b\u603b\u200b\u5386\u65f6\u200b\u7ea6\u200b7\u200b\u4e2a\u200b\u6708\u200b\u3002\u200b\u6211\u4eec\u200b\u56e2\u961f\u200b\u4ece\u200b\u4eca\u5e74\u200b\u7684\u200b\u5bd2\u5047\u200b\u671f\u95f4\u200b\u5c31\u200b\u5f00\u59cb\u200b\u5b66\u4e60\u200brust\u200b\u53ca\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u76f8\u5173\u200b\u77e5\u8bc6\u200b\uff0c\u200b\u4e3a\u200b\u8be5\u200b\u6bd4\u8d5b\u200b\u505a\u200b\u51c6\u5907\u200b\u3002</p> <p>\u200b\u5728\u200b\u5f00\u53d1\u200b\u524d\u200b\uff0c\u200b\u6211\u4eec\u200b\u8003\u8651\u200b\u5230\u200b\u4ece\u200b0\u200b\u5f00\u59cb\u200b\u8bbe\u8ba1\u200b\u4e00\u4e2a\u200b\u5185\u6838\u200b\u4f1a\u200b\u5e26\u6765\u200b\u5927\u91cf\u200b\u7684\u200bbug\u200b\u548c\u200b\u65f6\u95f4\u200b\u5f00\u9500\u200b\uff0c\u200b\u6240\u4ee5\u200b\u6211\u4eec\u200b\u51b3\u5b9a\u200b\u53c2\u8003\u200brCore-Tutorial\u200b\u5feb\u901f\u200b\u5f00\u53d1\u200b\u51fa\u200b\u4e00\u4e2a\u200b\u57fa\u672c\u200b\u7684\u200b\u5185\u6838\u200b\u3002\u200b\u4e4b\u540e\u200b\uff0c\u200b\u6211\u4eec\u200b\u6bd4\u8f83\u987a\u5229\u200b\u5730\u200b\u901a\u8fc7\u200b\u4e86\u200b\u521d\u8d5b\u200b\u7684\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u8fd9\u200b\u7ed9\u200b\u4e86\u200b\u6211\u4eec\u200b\u4fe1\u5fc3\u200b\uff0c\u200b\u4e8e\u662f\u200b\u6211\u4eec\u200b\u5bf9\u200b\u539f\u672c\u200b\u7684\u200b\u57fa\u7840\u67b6\u6784\u200b\u505a\u200b\u4e86\u200b\u5927\u91cf\u200b\u4fee\u6539\u200b\u3002\u200b\u901a\u8fc7\u200b\u4e0d\u65ad\u200b\u5730\u200b\u8e29\u200b\u5751\u200b\u548c\u200b\u91cd\u6784\u200b\uff0c\u200b\u5e76\u200b\u7ed3\u5408\u200b\u5176\u4ed6\u200b\u5185\u6838\u200b\u7684\u200b\u8bbe\u8ba1\u200b\u548c\u200b\u6211\u4eec\u200b\u7684\u200b\u601d\u8003\u200b\uff0c\u200b\u6700\u7ec8\u200b\u6253\u9020\u51fa\u200b\u4e86\u200b\u73b0\u5728\u200b\u7684\u200bOopS\u200b\u5185\u6838\u200b\u3002</p> <p>\u200b\u901a\u8fc7\u200b\u8fd9\u6b21\u200b\u6bd4\u8d5b\u200b\uff0c\u200b\u52a0\u6df1\u200b\u4e86\u200b\u6211\u4eec\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u7406\u89e3\u200b\uff0c\u200b\u63d0\u5347\u200b\u4e86\u200b\u6211\u4eec\u200b\u7684\u200b\u5de5\u7a0b\u200b\u80fd\u529b\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u672c\u6b21\u200b\u6bd4\u8d5b\u200b\u8ba9\u200b\u6211\u4eec\u200b\u66f4\u52a0\u200b\u7406\u89e3\u200b\u4e86\u200b\u5f00\u6e90\u200b\u7684\u200b\u7cbe\u795e\u200b\uff0c\u200b\u6211\u4eec\u200b\u7684\u200b\u5fc3\u6001\u200b\u4e5f\u200b\u4ece\u200b\u76f8\u4e92\u7ade\u4e89\u200b\u8f6c\u53d8\u200b\u4e3a\u4e86\u200b\u76f8\u4e92\u200b\u5b66\u4e60\u200b\u3002\u200b\u6211\u4eec\u200b\u53d1\u73b0\u200b\uff0c\u200b\u4e0e\u200b\u7b2c\u4e00\u5c4a\u200b\u53c2\u8d5b\u200b\u4f5c\u54c1\u200b\u76f8\u6bd4\u200b\uff0c\u200b\u672c\u5c4a\u200b\u53c2\u8d5b\u200b\u4f5c\u54c1\u200b\u5728\u200b\u529f\u80fd\u200b\u548c\u200b\u6027\u80fd\u200b\u65b9\u9762\u200b\u90fd\u200b\u6709\u200b\u4e86\u200b\u4e0d\u5c0f\u200b\u7684\u200b\u63d0\u5347\u200b\u3002\u200b\u8fd9\u8981\u200b\u611f\u8c22\u200b\u7ec4\u59d4\u4f1a\u200b\u548c\u200b\u4e3b\u529e\u65b9\u200b\u4e3a\u200b\u9009\u624b\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u5e73\u53f0\u200b\uff0c\u200b\u8ba9\u200b\u6211\u4eec\u200b\u6709\u200b\u673a\u4f1a\u200b\u5438\u53d6\u200b\u5f80\u5c4a\u200b\u53c2\u8d5b\u200b\u4f5c\u54c1\u200b\u7684\u200b\u7ecf\u9a8c\u200b\uff0c\u200b\u8e29\u200b\u5728\u200b\u5de8\u4eba\u200b\u7684\u200b\u80a9\u8180\u200b\u4e0a\u200b\u5e76\u200b\u66f4\u8fdb\u4e00\u6b65\u200b\u3002\u200b\u4ee5\u540e\u200b\u7684\u200b\u53c2\u8d5b\u200b\u4f5c\u54c1\u200b\u65e0\u7591\u200b\u4e5f\u200b\u4f1a\u200b\u6bd4\u200b\u6211\u4eec\u200b\u8fd9\u5c4a\u200b\u7684\u200b\u4f5c\u54c1\u200b\u8981\u200b\u66f4\u52a0\u200b\u4f18\u79c0\u200b\u3002</p> <p>\u200b\u5728\u200b\u8fd9\u91cc\u200b\uff0c\u200b\u8fd8\u8981\u200b\u611f\u8c22\u200b\u540c\u6821\u200b\u7684\u200b\u53c2\u8d5b\u200b\u961f\u4f0d\u200b\u548c\u200b\u6307\u5bfc\u8001\u5e08\u200b\u7684\u200b\u5e2e\u52a9\u200b\u548c\u200b\u6307\u5bfc\u200b\uff0c\u200b\u7279\u522b\u200b\u662f\u200b\u7b2c\u4e00\u5c4a\u200b\u53c2\u8d5b\u9009\u624b\u200b\u9ece\u5e9a\u7949\u200b\u5b66\u957f\u200b\u7ed9\u200b\u6211\u4eec\u200b\u4f20\u6388\u200b\u4e86\u200b\u5927\u91cf\u200b\u7684\u200b\u7ecf\u9a8c\u200b\u548c\u200b\u7075\u611f\u200b\u3002\u201d</p> <p>\u200b\u4f5c\u54c1\u200b\u5f00\u6e90\u200b\uff1a\u200b\u70b9\u200b\u8fd9\u91cc\u200b</p> <p> </p>"},{"location":"oscomp/oscomp/#55-lmy","title":"5.5 \u200b\u83b7\u5956\u200b\u961f\u4f0d\u200b\u4ecb\u7ecd\u200b: LMY","text":"<p>\ud83d\udce2 \u200b\u7b2c\u4e8c\u5c4a\u200b\u529f\u80fd\u200b\u8d5b\u9053\u200b\u4e00\u7b49\u5956\u200b\uff1aLMY</p> <p>\u200b\u56e2\u961f\u200b\u6210\u5458\u200b\uff1a\u200b\u4e8e\u4f2f\u6df3\u200b\uff0c20\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u6ee1\u6d0b\u200b\uff0c20\u200b\u7ea7\u200b\u672c\u79d1\u200b\uff1b\u200b\u674e\u6021\u51ef\u200b\uff0c19\u200b\u7ea7\u200b\u672c\u79d1\u200b</p> <p>\u201c\u200b\u5f88\u200b\u8363\u5e78\u200b\u80fd\u591f\u200b\u5728\u200b\u672c\u6b21\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u8d5b\u200b\u529f\u80fd\u200b\u8d5b\u9053\u200b\u4e2d\u200b\u83b7\u5f97\u200b\u4e00\u7b49\u5956\u200b\uff0c\u200b\u5728\u200b\u5927\u8d5b\u200b\u7ed3\u675f\u200b\u4e4b\u9645\u200b\uff0c\u200b\u56de\u60f3\u200b\u53c2\u8d5b\u200b\u4ee5\u6765\u200b\u7684\u200b\u70b9\u70b9\u6ef4\u6ef4\u200b\uff0c\u200b\u6211\u4eec\u200b\u611f\u6982\u200b\u9887\u200b\u591a\u200b\u3002</p> <p>\u200b\u6700\u521d\u200b\u51b3\u5b9a\u200b\u53c2\u8d5b\u200b\uff0c\u200b\u662f\u200b\u5076\u7136\u200b\u5728\u200b\u5b66\u6821\u200b\u7684\u200bLinux\u200b\u4ea4\u6d41\u200b\u7fa4\u200b\u770b\u5230\u200b\u8001\u5e08\u200b\u5bf9\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u529f\u80fd\u200b\u8d5b\u200b\u7684\u200b\u5ba3\u4f20\u200b\u3002\u200b\u90a3\u65f6\u200b\u6211\u200b\u548c\u200b\u6ee1\u6d0b\u200b\u6ca1\u6709\u200b\u5b8c\u6574\u200b\u5b66\u4e60\u200b\u8fc7\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u4f46\u200b\u51ed\u7740\u200b\u5bf9\u200bOS\u200b\u7684\u200b\u5174\u8da3\u200b\uff0c\u200b\u6211\u4eec\u200b\u51b3\u5b9a\u200b\u8bd5\u7740\u200b\u53c2\u8d5b\u200b\u3002</p> <p>\u200b\u9009\u5b9a\u200b\u8d5b\u9898\u200b\u65f6\u200b\uff0c\u200b\u7ecf\u9a8c\u4e0d\u8db3\u200b\u7684\u200b\u6211\u4eec\u200b\u672c\u60f3\u200b\u9009\u53d6\u200b\u4e00\u4e2a\u200b\u8f83\u4e3a\u7b80\u5355\u200b\u7684\u200b\u9898\u76ee\u200b\uff1b\u200b\u4f46\u200b\u4e24\u4f4d\u200b\u6307\u5bfc\u8001\u5e08\u200b\u9f13\u52b1\u200b\u6211\u4eec\u200b\u9009\u62e9\u200b\u66f4\u4e3a\u200b\u590d\u6742\u200b\u7684\u200b\u9898\u76ee\u200bproj120\u2014\u2014\u200b\u667a\u80fd\u5316\u200b\u7684\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5f02\u5e38\u200b\u68c0\u6d4b\u200b\uff0c\u200b\u540c\u65f6\u200b\u674e\u6021\u51ef\u200b\u5b66\u957f\u200b\u7684\u200b\u52a0\u5165\u200b\u4e5f\u200b\u4e3a\u200b\u6211\u4eec\u200b\u5e26\u6765\u200b\u66f4\u200b\u591a\u200b\u4fe1\u5fc3\u200b\uff0c\u200b\u6211\u4eec\u200b\u6700\u7ec8\u200b\u63a5\u53d7\u200b\u4e86\u200b\u6311\u6218\u200b\u3002</p> <p>\u200b\u521d\u671f\u200b\uff0c\u200b\u6211\u4eec\u200b\u51ed\u501f\u200b\u8001\u5e08\u200b\u6089\u5fc3\u200b\u7684\u200b\u6307\u5bfc\u200b\uff0c\u200b\u4e0e\u200b\u534e\u4e3a\u200b\u4e13\u5bb6\u200b\u7684\u200b\u6c9f\u901a\u200b\uff0c\u200b\u52aa\u529b\u200b\u5bfb\u627e\u200b\u8d5b\u9898\u200b\u7684\u200b\u5207\u5165\u70b9\u200b\uff0c\u200b\u4e4b\u540e\u200b\u4fbf\u662f\u200b\u6309\u90e8\u5c31\u73ed\u200b\u5730\u200b\u5b9e\u73b0\u200b\u3002\u200b\u7531\u4e8e\u200b\u9879\u76ee\u200b\u7ecf\u9a8c\u4e0d\u8db3\u200b\uff0c\u200b\u540e\u671f\u200b\u65f6\u95f4\u200b\u5b89\u6392\u200b\u5f97\u200b\u5f88\u200b\u7d27\u5f20\u200b\uff0c\u200b\u4f46\u200b\u4e5f\u200b\u8dcc\u8dcc\u649e\u649e\u200b\u8fdb\u5165\u200b\u4e86\u200b\u51b3\u8d5b\u200b\u3002\u200b\u51b3\u8d5b\u200b\u9636\u6bb5\u200b\uff0c\u200b\u6211\u4eec\u200b\u5b9e\u73b0\u200b\u4e86\u200b\u8001\u5e08\u200b\u5efa\u8bae\u200b\u7684\u200b\u521b\u65b0\u200b\u70b9\u200b\uff0c\u200b\u5e76\u200b\u628a\u200b20\u200b\u591a\u9875\u200b\u7684\u200b\u6587\u6863\u200b\u5b8c\u5584\u200b\u81f3\u8fd1\u200b80\u200b\u9875\u200b\u3002\u200b\u4e3a\u4e86\u200b\u51c6\u5907\u200b\u7b54\u8fa9\u200b\uff0cPPT\u200b\u4e5f\u200b\u5728\u200b\u8001\u5e08\u200b\u7684\u200b\u6307\u5bfc\u200b\u4e0b\u200b\u66f4\u65b0\u200b\u4e86\u200b\u4e00\u7248\u200b\u53c8\u200b\u4e00\u7248\u200b\u3002</p> <p>\u200b\u6700\u7ec8\u200b\u7684\u200b\u7ed3\u679c\u200b\u51fa\u4e4e\u200b\u6211\u4eec\u200b\u7684\u200b\u610f\u6599\u200b\uff0c\u200b\u4f46\u200b\u56de\u987e\u200b\u4e00\u8def\u200b\u4ee5\u6765\u200b\u4ed8\u51fa\u200b\u7684\u200b\u5fc3\u8840\u200b\u548c\u200b\u8001\u5e08\u200b\u7684\u200b\u8033\u200b\u63d0\u200b\u9762\u6388\u200b\uff0c\u200b\u5374\u200b\u53c8\u200b\u663e\u5f97\u200b\u7406\u6240\u5e94\u5f53\u200b\u3002\u200b\u5728\u200b\u5927\u8d5b\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u7684\u200b\u4e13\u4e1a\u200b\u7d20\u517b\u200b\u5f97\u5230\u200b\u4e86\u200b\u953b\u70bc\u200b\uff0c\u200b\u6587\u6863\u200b\u7f16\u5199\u200b\u548c\u200b\u4ea4\u6d41\u200b\u5408\u4f5c\u200b\u7684\u200b\u80fd\u529b\u200b\u4e5f\u200b\u5f97\u5230\u200b\u4e86\u200b\u63d0\u9ad8\u200b\u3002\u200b\u867d\u7136\u200b\u8f9b\u82e6\u200b\uff0c\u200b\u4f46\u200b\u4e5f\u200b\u4e3a\u200b\u4eca\u540e\u200b\u7684\u200b\u4e13\u4e1a\u200b\u9053\u8def\u200b\u503e\u6ce8\u200b\u4e86\u200b\u66f4\u200b\u6df1\u539a\u200b\u7684\u200b\u529b\u91cf\u200b\u3002\u201d</p> <p>\u200b\u4f5c\u54c1\u200b\u5f00\u6e90\u200b\uff1a\u200b\u70b9\u200b\u8fd9\u91cc\u200b</p> <p> </p>"},{"location":"oscomp/oscomp/#6","title":"6. \u200b\u62a5\u540d\u200b\u65b9\u5f0f","text":"<p>\ud83d\udce2 \u200b\u5982\u4f55\u200b\u62a5\u540d\u200b\uff1f</p> <p>\u200b\u6211\u6821\u200bOS\u200b\u6bd4\u8d5b\u200b\u5c06\u200b\u9884\u8ba1\u200b\u5728\u200b\u5143\u65e6\u8282\u200b\u524d\u540e\u200b\uff08\u200b\u5177\u4f53\u200b\u65f6\u95f4\u200b\u5f85\u200b\u786e\u5b9a\u200b\uff09\u200b\u5f00\u653e\u200b\u62a5\u540d\u200b\u3002\u200b\u73b0\u5728\u200b\u53c2\u52a0\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5927\u8d5b\u200b\uff0c\u200b\u5c06\u200b\u83b7\u5f97\u200b\u9000\u4f11\u200b\u9009\u624b\u200b\u7684\u200b\u5b9d\u8d35\u200b\u53c2\u8d5b\u200b\u7ecf\u9a8c\u200b\uff0c\u200b\u673a\u4f1a\u96be\u5f97\u200b\uff01\u200b\u611f\u5174\u8da3\u200b\u7684\u200b\u540c\u5b66\u200b\u6b22\u8fce\u200b\u5165\u7fa4\u200b\uff1a</p> <p> </p> <p></p> <p>\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u662f\u200b\u8ba1\u7b97\u673a\u9886\u57df\u200b\u7684\u200b\u4e00\u5927\u200b\u6838\u5fc3\u200b\uff0c \u200b\u6df1\u5165\u200b\u7406\u89e3\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\uff0c\u200b\u4e0d\u7ba1\u200b\u4ee5\u540e\u200b\u53c2\u4e0e\u200b\u5230\u200b\u54ea\u4e2a\u200b\u65b9\u5411\u200b\u7684\u200b\u5de5\u4f5c\u200b\u4e2d\u200b\uff0c\u200b\u90fd\u200b\u4f1a\u200b\u4ece\u4e2d\u200b\u83b7\u76ca\u200b\u3002 \u200b\u6b22\u8fce\u200b\u53c2\u52a0\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u8d5b\u200b\uff0c\u200b\u4f53\u9a8c\u200b\u7cfb\u7edf\u200b\u8bbe\u8ba1\u200b\u7684\u200b\u72ec\u7279\u200b\u9b45\u529b\u200b\u3002</p>"}]}